<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Crm.Views.EmdepSitesMapWindow"
                         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                         xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                         Height="500" Width="700"
                         xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
                         xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
                         xmlns:dxm="http://schemas.devexpress.com/winfx/2008/xaml/map"
                         WindowStartupLocation="CenterScreen"  ShowIcon="False" TitleStyle="{x:Null}"
                         xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.Crm.ViewModels"
                         xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
                         xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
                         Style="{DynamicResource WinUIDialogWindowStyle}">

    <!--<dxwui:WinUIDialogWindow.DataContext>
        <ViewModels:EmdepSitesWiseMapWindowViewModel/>
    </dxwui:WinUIDialogWindow.DataContext>-->

    <Window.Background>
        <SolidColorBrush Color="#FF494848" Opacity="0"/>
    </Window.Background>

    <Window.Resources>
        <DataTemplate x:Key="PushPin">
            <StackPanel ToolTipService.ToolTip="{Binding Path=MapItem.Information}" Margin="-30 -60" >
                <Image  Source="/Emdep.Geos.Modules.Crm;component/Assets/Images/Icon.ico"  />
                <TextBlock 
                    Margin="6"
                    Foreground="Blue"
                    Text="{Binding Path=MapItem.Text}" />
            </StackPanel>
        </DataTemplate>
    </Window.Resources>

    <Grid >
        <Grid.RowDefinitions>
            <RowDefinition Height="20"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Image Source="/Emdep.Geos.Modules.Crm;component/Assets/Images/Close.png" 
               Name="imageclose"   VerticalAlignment="Top" HorizontalAlignment="Right" Grid.Row="0"  >
            <dxmvvm:Interaction.Triggers>
                <dxmvvm:EventToCommand EventName="MouseLeftButtonDown"
                                       PassEventArgsToCommand="True"
                                       Command="{Binding EmdepSitesMapClose,Mode=TwoWay}" >
                </dxmvvm:EventToCommand>
            </dxmvvm:Interaction.Triggers>
        </Image>
        <Border Grid.Row="0">
            <Border.Style>
                <Style TargetType="{x:Type Border}" >
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="BorderBrush" Value="Transparent"></Setter>
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="BorderThickness" Value="1" />
                            <Setter Property="BorderBrush" Value="#515151"></Setter>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
        </Border>

        <dxm:MapControl ZoomLevel="12"
                        BorderBrush="Black"
                        CenterPoint="{Binding MapLatitudeAndLongitude}" 
                        Grid.Row="1" x:Name="mapconrol1" Height="500" Width="700">
            <dxm:ImageTilesLayer>
                <dxm:ImageTilesLayer.DataProvider>
                    <dxm:BingMapDataProvider Kind="Road" BingKey="AvDFbBPV8HPb4W8q69S960LXa9LCTGDZgo2k2tLQhe6YTchMVJTVaDLo899kViVr"/>
                </dxm:ImageTilesLayer.DataProvider>
            </dxm:ImageTilesLayer>

            <dxm:VectorLayer  >
                <dxm:MapItemStorage>
                    <dxm:MapPushpin Location="{Binding MapLatitudeAndLongitude}" 
                                    Text="{Binding MapPushPin}"
                                    MarkerTemplate="{StaticResource PushPin}" />
                </dxm:MapItemStorage>
            </dxm:VectorLayer>

            <dxm:MapControl.ScalePanelOptions>
                <dxm:ScalePanelOptions HorizontalAlignment="Right" VerticalAlignment="Bottom" Visible="False" />
            </dxm:MapControl.ScalePanelOptions>
            <dxm:MapControl.CoordinatesPanelOptions>
                <dxm:CoordinatesPanelOptions VerticalAlignment="Top" HorizontalAlignment="Right" Visible="False" />
            </dxm:MapControl.CoordinatesPanelOptions>
        </dxm:MapControl>
    </Grid>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</dxwui:WinUIDialogWindow>