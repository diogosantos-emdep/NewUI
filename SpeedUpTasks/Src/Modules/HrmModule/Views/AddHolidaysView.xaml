<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Hrm.Views.AddHolidaysView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Emdep.Geos.Modules.Hrm.Views"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
             xmlns:HrmApplication="clr-namespace:Emdep.Geos.Modules.Hrm" 
             xmlns:Validation ="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
             xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"  
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"                        
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300"
                          TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}"
                          Style="{DynamicResource WinUIDialogWindowStyle}">

    <dxwui:WinUIDialogWindow.Resources>
        <UIConverter:DateFormatConverter x:Key="DateFormatConverter" />
        <sys:String x:Key="ShortDateTimeFormat">dd/MM/yyyy hh:mm tt</sys:String>
        <sys:String x:Key="ShortTimeFormat">hh:mm tt</sys:String>
        <sys:String x:Key="ShortDateFormat">dd/MM/yyyy</sys:String>
    </dxwui:WinUIDialogWindow.Resources>
    
    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape"  Command="{Binding AddHolidaysViewCancelButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>

    <!--Sprint-41 HRM-M041-07	New configuration section Holidays-Sdesai-->
    <Grid Margin="0,-50,0,0">
        <Grid.RowDefinitions>
            <RowDefinition Height="55"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="40"/>

        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="120"/>
            <ColumnDefinition Width="150"/>
            <ColumnDefinition Width="125"/>
            <ColumnDefinition Width="150"/>
        </Grid.ColumnDefinitions>

        <Label Content="{Binding WindowHeader}" HorizontalAlignment="Left" Style="{StaticResource LabelTitleStyle}" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" />
        <!--Holiday Name-->
        <Label Grid.Row="1" Grid.Column="0" Content="{DynamicResource HolidayName}"  Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,10,0,10"/>
        <dxe:TextEdit Text="{Binding HolidayName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Margin="0,0,0,0" Grid.Row="1" Grid.Column="1" Width="270" Height="30" VerticalAlignment="Center" HorizontalAlignment="Left" 
                      AllowNullInput="True" InvalidValueBehavior="AllowLeaveEditor" Grid.ColumnSpan="2"
                      IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxe:TextEdit.EditValue>
                <Binding Path="HolidayName" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:HolidaysValidation FieldName="HolidayName" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:TextEdit.EditValue>
        </dxe:TextEdit>

        <!--Holiday Type-->
        <Label Grid.Row="2" Grid.Column="0" Content="{DynamicResource HolidayType}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,10,0,10"/>

        <dxe:ComboBoxEdit Grid.Row="2" Grid.Column="1" HorizontalAlignment="Left" 
                         Grid.ColumnSpan="2" Height="30" Width="270" VerticalAlignment="Center"  ItemsSource="{Binding HolidaysTypeList,Mode=TwoWay}"                         
                          DisplayMember="Value" ValueMember="IdLookupValue" 
                          AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True">

            <dxe:ComboBoxEdit.SelectedIndex>
                <Binding Path="SelectedIndexHolidayType" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:HolidaysValidation FieldName="SelectedIndexHolidayType" ValidationStep="UpdatedValue" />
                    </Binding.ValidationRules>
                </Binding>
            </dxe:ComboBoxEdit.SelectedIndex>

            <dxe:ComboBoxEdit.ItemContainerStyle>
                <Style TargetType="dxe:ComboBoxEditItem">
                    <Setter Property="IsEnabled" Value="{Binding InUse}" />
                </Style>
            </dxe:ComboBoxEdit.ItemContainerStyle>

        </dxe:ComboBoxEdit>


        <!--Holiday Start Date-->
        <Label Grid.Row="3" Grid.Column="0" Content="{DynamicResource HolidayStartDate}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,10,0,10"/>
        <dxe:DateEdit Margin="0,0,0,0" Grid.Row="3" Grid.Column="1" Width="150" Height="30" VerticalAlignment="Center" HorizontalAlignment="Left"
                   IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxe:DateEdit.EditValue>
                <Binding Path="StartDate" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay"
                                                 ValidatesOnDataErrors="True">
                    <Binding.ValidationRules>
                        <Validation:HolidaysValidation FieldName="StartDate" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:DateEdit.EditValue>
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding DataContext.OnDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
        </dxe:DateEdit>

        <dxe:ComboBoxEdit Grid.Row="3" Grid.Column="2" VerticalAlignment="Top" Margin="5,5,5,5" Height="30" Width="114"
                                                   IsEnabled="{Binding InvertIsAllDayEvent,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    ItemsSource="{Binding FromDates}"
                                                    MaskType="DateTimeAdvancingCaret" Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    DisplayFormatString="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }" HorizontalAlignment="Stretch"
                                                   IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxe:ComboBoxEdit.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Converter={StaticResource DateFormatConverter}}"/>
                </DataTemplate>
            </dxe:ComboBoxEdit.ItemTemplate>
            <dxe:ComboBoxEdit.SelectedItem>
                <Binding Path="DataContext.StartTime" RelativeSource="{RelativeSource AncestorType=dxwui:WinUIDialogWindow}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:LeaveValidations FieldName="StartTime" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:ComboBoxEdit.SelectedItem>

            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="SelectedIndexChanged" Command="{Binding DataContext.OnTimeEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
        </dxe:ComboBoxEdit>

        <!--Holiday End Date-->
        <Label Grid.Row="4" Grid.Column="0" Content="{DynamicResource HolidayEndDate}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,10,0,10"/>
        <dxe:DateEdit Margin="0,0,0,0" Grid.Row="4" Grid.Column="1" Width="150"  Height="30" VerticalAlignment="Center" HorizontalAlignment="Left"
                   IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxe:DateEdit.EditValue>
                <Binding Path="EndDate" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay"
                                                 ValidatesOnDataErrors="True">
                    <Binding.ValidationRules>
                        <Validation:HolidaysValidation FieldName="EndDate" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:DateEdit.EditValue>
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding DataContext.OnDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
        </dxe:DateEdit>

        <dxe:ComboBoxEdit Grid.Row="4" Grid.Column="2" VerticalAlignment="Top" Margin="5,5,5,5" Height="30" Width="114"
                                                  IsEnabled="{Binding InvertIsAllDayEvent,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    ItemsSource="{Binding ToDates}" 
                                                    MaskType="DateTimeAdvancingCaret" Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    DisplayFormatString="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }" HorizontalAlignment="Stretch" 
                                                  IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxe:ComboBoxEdit.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Converter={StaticResource DateFormatConverter}}"/>
                </DataTemplate>
            </dxe:ComboBoxEdit.ItemTemplate>
            <dxe:ComboBoxEdit.SelectedItem>
                <Binding Path="DataContext.EndTime" RelativeSource="{RelativeSource AncestorType=dxwui:WinUIDialogWindow}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:LeaveValidations FieldName="EndTime" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:ComboBoxEdit.SelectedItem>
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="SelectedIndexChanged" Command="{Binding DataContext.OnTimeEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
        </dxe:ComboBoxEdit>

        <!--Holiday All Day Event-->
        <dxe:CheckEdit Content="{DynamicResource HolidayAllDayEvent}" Grid.Row="3" Grid.Column="3" x:Name="chkAllDay" Height="30" FontSize="16"
                                      Margin="5 5 5 5"
                                     HorizontalAlignment="Left"
                                     IsChecked="{Binding IsAllDayEvent,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                       IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="Checked" Command="{Binding DataContext.CheckedCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"></dxmvvm:EventToCommand>
                <dxmvvm:EventToCommand EventName="Unchecked" Command="{Binding DataContext.CheckedCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"></dxmvvm:EventToCommand>
            </dxmvvm:Interaction.Behaviors>
        </dxe:CheckEdit>

        <!--Holiday Is Recursive-->
        <Label Grid.Row="5" Grid.Column="0" Content="{DynamicResource HolidayIsRecursive}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,10,0,10"/>
        <dxe:ToggleSwitch x:Name="chkIsRecursive" Grid.Row="5" Grid.Column="1" Height="30" HorizontalAlignment="Left" VerticalAlignment="Center" ContentPlacement="Inside"
                                                       CheckedStateContent="Yes" UncheckedStateContent="No" ToggleSwitchWidth="50" ToggleSwitchHeight="22" IsThreeState="False"                                
                                               IsChecked="{Binding InUse,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                         IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="Checked" Command="{Binding DataContext.CheckedCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"></dxmvvm:EventToCommand>
                <dxmvvm:EventToCommand EventName="Unchecked" Command="{Binding DataContext.CheckedCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"></dxmvvm:EventToCommand>
            </dxmvvm:Interaction.Behaviors>
        </dxe:ToggleSwitch>

        <StackPanel Grid.Row="6" Grid.Column="1" Grid.ColumnSpan="2"
                    HorizontalAlignment="Left" 
                    Orientation="Horizontal"
                    Margin="0,0,0,0"
                    Width="250">

            <Button Content="{DynamicResource HolidaysAcceptButton}"
                    Command="{Binding AddHolidayViewAcceptButtonCommand}"
                    Height="30"
                    Width="100"
                    Margin="0,0,10,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" 
                    IsEnabled="{Binding IsAcceptEnabled}"/>

            <Button Content="{DynamicResource HolidaysCancelButton}"
                    Command="{Binding AddHolidaysViewCancelButtonCommand}" 
                    Height="30"
                    Width="100"
                    Margin="10,0,0,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" />
        </StackPanel>
    </Grid>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</dxwui:WinUIDialogWindow> 
