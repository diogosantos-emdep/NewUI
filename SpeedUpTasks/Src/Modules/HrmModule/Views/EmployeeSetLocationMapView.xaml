
    <dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Hrm.Views.EmployeeSetLocationMapView"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Emdep.Geos.Modules.Hrm.Views"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:dxm="http://schemas.devexpress.com/winfx/2008/xaml/map" 
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" 
             xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" 
             xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.Hrm.ViewModels"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:Interactive="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:Behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             mc:Ignorable="d"
             Style="{DynamicResource WinUIDialogWindowStyle}">
    <Window.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding EmployeeSetLocationMapViewCloseButtonCommand,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" />
    </Window.InputBindings>
    <dxwui:WinUIDialogWindow.Resources>
        <sys:String x:Key="bingKey">s2gyr2NLYqXFe3lNMXLY~5tf9Ztp4qv52kNeVXarbwQ~ArREQRhM-E2eTViuLV2QdA_sdv_K--IlaZ_o-hXzdWemNOKlnPOiuEVQaCA0FDaV</sys:String>
        <!--region #DistanceUnits-->
        <ObjectDataProvider x:Key="distanceUnits"
            ObjectType="{x:Type sys:Enum}"  MethodName="GetValues">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="dxm:DistanceMeasureUnit"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <!--endregion #DistanceUnits-->

        <Style TargetType="dxm:MapControl">
            <Setter Property="ToolTipTemplate">
                <Setter.Value>
                    <DataTemplate x:Name="ToolTipTemplate">
                        <Grid x:Name="Tooltip" HorizontalAlignment="Center" VerticalAlignment="Center" UseLayoutRounding="True">
                            <Grid x:Name="Shadow" Margin="0,4,0,-4" Opacity="0.1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="12"/>
                                </Grid.RowDefinitions>
                                <Path x:Name="Arrow" Stretch="Fill" Fill="Black" Data="F1 M 461,303L 474,316L 487,303L 461,303 Z " HorizontalAlignment="Center" Height="13" Grid.Row="1" Width="26" Margin="0,-1,0,0"/>
                                <Border x:Name="ContentBack" Background="Black"/>
                            </Grid>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="12"/>
                                </Grid.RowDefinitions>
                                <Path x:Name="Arrow1" Stretch="Fill" Fill="#FF303030" Data="F1 M 461,303L 474,316L 487,303L 461,303 Z " HorizontalAlignment="Center" Height="13" Grid.Row="1" Width="26" Margin="0,-1,0,0"/>
                                <Border x:Name="ContentBack1" Background="#FF303030"/>
                                <ContentPresenter Content="{Binding}" ContentTemplate="{Binding ContentTemplate}"/>
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="ZoomRegionTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Border x:Name="zoomRegionBorder"
                        BorderThickness="2"
                        Background="#204ACBFC"
                        BorderBrush="#FF4ACBFC" />
                    </DataTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="ShowSearchPanel"  Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="dxm:MapControl">
                        <Grid FlowDirection="LeftToRight" >
                            <Rectangle x:Name="PART_DraggingElement" Fill="Transparent" Stretch="Fill" />
                            <Border Background="{TemplateBinding Background}" >
                                <ItemsControl x:Name="PART_LayersContainer">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <Grid/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                            </Border>
                            <Canvas x:Name="PART_ContainerOfRectangleToZoomIn">
                                <ContentPresenter
                                x:Name="PART_RectangleToZoomIn"
                                Visibility="Collapsed"
                                ContentTemplate="{Binding Path=ZoomRegionTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
                            </Canvas>
                            <dxm:OverlayItemsControl x:Name="PART_OverlaysContainer">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <dxm:MapOverlaysPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </dxm:OverlayItemsControl>
                            <dxm:ToolTipPanel x:Name="PART_ToolTipPanel"
                            Visibility="{Binding Path=ToolTipInfo.Visibility, RelativeSource={RelativeSource TemplatedParent}}"
                            Position="{Binding Path=ToolTipInfo.ToolTipPosition, RelativeSource={RelativeSource TemplatedParent}}">
                                <ContentPresenter
                                Content="{Binding Path=ToolTipInfo, RelativeSource={RelativeSource TemplatedParent}}"
                                ContentTemplate="{Binding Path=ToolTipTemplate, RelativeSource={RelativeSource TemplatedParent}}">
                                </ContentPresenter>
                            </dxm:ToolTipPanel>
                            <Grid x:Name="PART_InvalidKeyPanel" Visibility="Collapsed" Margin="2,2,0,0" MinHeight="0" HorizontalAlignment="Center" VerticalAlignment="Center" Width="0">
                                <Border Background="#FFDD0000" Opacity="0.75" CornerRadius="5" />
                                <TextBlock TextWrapping="Wrap" Text="CustomText" Foreground="White" FontSize="14.667" Margin="32" TextAlignment="Center"/>
                            </Grid>
                        </Grid>

                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background" Value="#FFC9E9F4"/>
            <Setter  Property="dxm:MapControl.ZoomLevel" Value="3"/>
            <Setter  Property="dxm:MapControl.CenterPoint" Value="{Binding DataContext.MapLatitudeAndLongitude, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding DataContext.IsCoordinatesNull, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" Value="True">
                    <Setter  Property="dxm:MapControl.CenterPoint" Value="{Binding DataContext.MapLatitudeAndLongitude, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"/>
                    <Setter  Property="dxm:MapControl.ZoomLevel" Value="10"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding DataContext.IsCoordinatesNull, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" Value="{x:Null}">
                    <Setter Property="dxm:VectorLayer.Visibility" Value="Hidden"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

    </dxwui:WinUIDialogWindow.Resources>
    <Grid  Width="{Binding DialogWidth}" Height="{Binding DialogHeight}">
        <Grid.RowDefinitions>
            <RowDefinition Height="40"></RowDefinition>
            <RowDefinition Height="40*"></RowDefinition>
            <RowDefinition Height="40"></RowDefinition>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100"/>
                <!--<ColumnDefinition Width="150"/>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="150"/>-->
                <ColumnDefinition Width="10*"/>
            </Grid.ColumnDefinitions>

            <!--<TextBlock Text="Search" Grid.Column="0" Height="30" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="100" Margin="0,0,5,0"/>
            <dxe:TextEdit Text="{Binding SearchTxt, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Height="30" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="100" Margin="0,0,5,0"/>
            <Button Command="{Binding SearchCompletedCommand}" Content="Search" Grid.Column="2" Height="30" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="100" Margin="0,0,5,0"/>-->
            <Border BorderBrush="{DynamicResource BorderColorStyle}"  BorderThickness="1" CornerRadius="12" Grid.Column="4" Height="35" HorizontalAlignment="Right" Width="250" Margin="10,1,30,0">
                <dxe:ComboBoxEdit ItemsSource="{Binding SearchResultsList , Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                              Style="{DynamicResource ComboBoxEditStyle}"
                              IsTextEditable="True"
                              ShowPopupWaitIndicator ="True"
                              IsSynchronizedWithCurrentItem="True"
                              ShowPopupIfItemsSourceEmpty="True"
                              ShowText="True"
			                  ImmediatePopup="True"
				              IncrementalFiltering="True"
                              FilterCondition="Contains"
                              ValidateOnTextInput="True"
                              x:Name="SearchLocation" 
                              AllowDefaultButton="False"
                              ShowBorder="False"
                              Focusable="True"
                              SelectionStart="0"    
                              FocusManager.FocusedElement="{Binding ElementName=SearchLocation}"
                              EditValue="{Binding SearchTxt,ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                              HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Height="30"  Margin="7,1,7,0">

                    <Interactive:Interaction.Triggers>
                        <Interactive:EventTrigger  EventName="EditValueChanged">
                            <Behaviors:InvokeDelegateCommandAction Command="{Binding ComboBoxEditValueChangeCommand}" 
                                                                           CommandParameter="{Binding RelativeSource={RelativeSource Self}, Path=InvokeParameter}" />
                        </Interactive:EventTrigger>
                    </Interactive:Interaction.Triggers>

                    <dxe:ComboBoxEdit.Buttons>
                        <dxe:ButtonInfo GlyphKind="Custom" x:Name="buttonClear" >
                            <dxe:ButtonInfo.Template>
                                <DataTemplate>
                                    <dxe:ButtonClose Command="{Binding DataContext.SearchClearCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="2,0" />
                                </DataTemplate>
                            </dxe:ButtonInfo.Template>
                        </dxe:ButtonInfo>
                        <!--<dxe:ButtonInfo IsDefaultButton="True" GlyphKind="DropDown"/>-->
                    </dxe:ComboBoxEdit.Buttons>
                </dxe:ComboBoxEdit>
            </Border>
            <!--SelectedItem="{Binding SelectedLocationInformation, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"-->
            <!--<dxe:ComboBoxEdit   Grid.Column="3"  Grid.Row="1"  Height="30"
                                SelectionStart="0"    
                                Width="145" 
                                AllowDefaultButton="False"                               
                                ItemsSource="{Binding SearchResultsList, UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"                            
                                AutoComplete="False" 
                                IsTextEditable="True"
                                ImmediatePopup="True"
                                HorizontalAlignment="Left" 
                                VerticalAlignment="Top" 
                            Style="{DynamicResource ComboBoxEditStyle}"
                            EditValue="{Binding DispalyName,ValidatesOnDataErrors=True, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                <dxe:ComboBoxEdit.PopupContentTemplate>
                    <ControlTemplate>
                        <dxg:GridControl Name="PART_GridControl" Height="Auto" ItemsSource="{Binding SearchResultsList, UpdateSourceTrigger=PropertyChanged}" >
                            <dxg:GridControl.Columns>
                                <dxg:GridColumn FieldName="DispalyName" Width="160" ReadOnly="True"/>
                            </dxg:GridControl.Columns>
                            <dxg:GridControl.View>
                                <dxg:TableView AutoWidth="True" ShowColumnHeaders="False" ShowIndicator="False" ShowGroupPanel="False"
                                           ShowSearchPanelMode="Never" ShowHorizontalLines="False" ShowVerticalLines="False" 
                                           ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                           ScrollViewer.VerticalScrollBarVisibility="Visible"/>
                            </dxg:GridControl.View>
                        </dxg:GridControl>
                    </ControlTemplate>
                </dxe:ComboBoxEdit.PopupContentTemplate>
              </dxe:ComboBoxEdit>-->

        </Grid>
        <dxm:MapControl  x:Name="mapControl1" Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="30,0,30,0" >

            <!--<dxm:MapControl.Style>
                <Style>
                    <Setter  Property="dxm:MapControl.ZoomLevel" Value="2.7"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataContext.IsCoordinatesNull, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" Value="True">
                            <Setter  Property="dxm:MapControl.CenterPoint" Value="{Binding DataContext.MapLatitudeAndLongitude, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"/>
                            <Setter  Property="dxm:MapControl.ZoomLevel" Value="10"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </dxm:MapControl.Style>-->

            <dxm:MapControl.CoordinatesPanelOptions>
                <dxm:CoordinatesPanelOptions Visible="False"/>
            </dxm:MapControl.CoordinatesPanelOptions>

            <dxm:MapControl.ScalePanelOptions>
                <dxm:ScalePanelOptions HorizontalAlignment="Right" VerticalAlignment="Bottom" Visible="False" />
            </dxm:MapControl.ScalePanelOptions>

            <dxm:ImageTilesLayer>
                <dxm:ImageTilesLayer.DataProvider>
                    <dxm:BingMapDataProvider Kind="Road" BingKey="{Binding Source={StaticResource bingKey}}"/>
                </dxm:ImageTilesLayer.DataProvider>
            </dxm:ImageTilesLayer>

            <dxm:VectorLayer  >
                <dxm:VectorLayer.Style>
                    <Style>
                        <Setter Property="dxm:VectorLayer.Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding DataContext.MapLatitudeAndLongitude, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" Value="{x:Null}">
                                <Setter Property="dxm:VectorLayer.Visibility" Value="Hidden"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </dxm:VectorLayer.Style>
                <dxm:MapItemStorage>
                    <dxm:MapPushpin  Location="{Binding MapLatitudeAndLongitude}" 
                                     Text="{Binding MapPushPin}"                                  
                                     />
                </dxm:MapItemStorage>
            </dxm:VectorLayer>

            <dxm:InformationLayer >
                <!--region #SearchProvider-->
                <dxm:InformationLayer.DataProvider>
                    <dxm:BingSearchDataProvider x:Name="searchProvider" 
                                                ShowSearchPanel="False" 
                                                BingKey="{Binding Source={StaticResource bingKey}}"
                                                >
                        <dxm:BingSearchDataProvider.SearchOptions>
                            <dxm:BingSearchOptions x:Name="options"  
                                                   AutocorrectQuery="{Binding ElementName=cbAutocorrect, Path=IsChecked}"
                                                   DistanceUnit="{Binding ElementName=lbDistanceUnits, Path=SelectedValue}">
                            </dxm:BingSearchOptions>
                        </dxm:BingSearchDataProvider.SearchOptions>
                    </dxm:BingSearchDataProvider>

                </dxm:InformationLayer.DataProvider>

                <!--endregion #SearchProvider-->
            </dxm:InformationLayer>

            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand  Command="{Binding MouseDoubleClickCommand, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  EventName="MouseDoubleClick"
                                        PassEventArgsToCommand="True"/>

            </dxmvvm:Interaction.Behaviors>
        </dxm:MapControl>
        <DockPanel Grid.Row="2" HorizontalAlignment="Center" Width="250">
            <Button Height="30" Width="100" Content="{DynamicResource EmployeeSetLocationMapViewAccept}" Command="{Binding EmployeeSetLocationMapViewAcceptButtonCommand,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                    />
            <Button Height="30" Width="100" Content="{DynamicResource EmployeeSetLocationMapViewCancel}" Command="{Binding EmployeeSetLocationMapViewCloseButtonCommand,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
        </DockPanel>
    </Grid>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</dxwui:WinUIDialogWindow>
