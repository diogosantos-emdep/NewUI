<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Hrm.Views.ExportAttendanceView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"    
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.Hrm.ViewModels"
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
             xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:Validation ="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
                         xmlns:Converters="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
                         xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
                         xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
                         xmlns:HrmApplication="clr-namespace:Emdep.Geos.Modules.Hrm"
             mc:Ignorable="d" 
             d:DesignHeight="860" d:DesignWidth="900" Loaded="WinUIDialogWindow_Loaded">
    <!--Title="{DynamicResource HrmMainViewModelExportAttendance}"
             TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}" Loaded="WinUIDialogWindow_Loaded"-->


    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape"  Command="{Binding ExportAttendanceViewCancelButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>

    <dxwui:WinUIDialogWindow.Resources>
        <Converters:ByteToYesNoConverter x:Key="ByteToYesNoConverter"/>
    </dxwui:WinUIDialogWindow.Resources>

    <Grid>
        <dxg:GridControl x:Name="GridControlAttendanceDetails"
                         ItemsSource="{Binding EmployeeAttendanceList,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                         SelectionMode="Row" Width="Auto" Height="Auto"                         
                         ImplyNullLikeEmptyStringWhenFiltering="True" Visibility="Hidden">
            <dxg:GridColumn Header="{DynamicResource AttendanceCompany}" FieldName="CurrentContractForAttendance" FilterPopupMode="CheckedList" Width="110" FixedWidth="True" ReadOnly="True" />
            <dxg:GridColumn Header="{DynamicResource EmployeeCode}" FieldName="Employee.EmployeeCode" FilterPopupMode="CheckedList" Width="120" FixedWidth="True" ReadOnly="True" />
            <dxg:GridColumn Header="{DynamicResource EmpFullName}" FieldName="Employee.FullName" FilterPopupMode="CheckedList" Width="250" FixedWidth="True" ReadOnly="True" />
            <dxg:GridColumn Header="{DynamicResource AttendanceJDCode}" FieldName="Employee.EmpJobCodes" Width="230" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True" />
            <dxg:GridColumn Header="{DynamicResource AttendanceJobTitle}" FieldName="Employee.EmployeeJobTitles" Width="230" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True" />
            <dxg:GridColumn Header="{DynamicResource ProfessionalJobDescriptionDepartment}" FieldName="Employee.LstEmployeeDepartments" FilterPopupMode="CheckedList" Width="230" FixedWidth="True" ReadOnly="True" Name="Departments"/>

            <dxg:GridColumn Header="{DynamicResource AttendanceType}" FieldName="CompanyWork.Name" FilterPopupMode="CheckedList" FixedWidth="True" Width="120" ReadOnly="True">
            </dxg:GridColumn>

            <dxg:GridColumn Header="{DynamicResource AttendanceManual}" Binding="{Binding IsManual, Converter={StaticResource ByteToYesNoConverter}, Mode=TwoWay}" Width="70" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True" >
            </dxg:GridColumn>

            <dxg:GridColumn Header="{DynamicResource AttendanceGridColumnMonthNumber}" FieldName="StartDate.Month" FilterPopupMode="CheckedList" Width="70" FixedWidth="True" ReadOnly="True">
                <dxg:GridColumn.EditSettings>
                    <dxe:TextEditSettings HorizontalContentAlignment="Left" />
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridColumn Header="{DynamicResource AttendanceGridColumnWeekNumber}" FieldName="WeekNumber" FilterPopupMode="CheckedList" Width="70" FixedWidth="True" ReadOnly="True">
                <dxg:GridColumn.EditSettings>
                    <dxe:TextEditSettings HorizontalContentAlignment="Left" />
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridColumn Header="{DynamicResource AccountingDateColHeader}" FieldName="AccountingDate" Width="100" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True"/>



            <dxg:GridColumn Header="{DynamicResource EmpEducationStartDate}" FieldName="StartDate" Width="100" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True"/>



            <dxg:GridColumn Header="{DynamicResource LeaveStartTime}" FieldName="StartTime" Width="90" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True"/>



            <dxg:GridColumn Header="{DynamicResource EmpEducationEndDate}" FieldName="EndDate" Width="100" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True"/>



            <dxg:GridColumn Header="{DynamicResource LeaveEndTime}" FieldName="EndTime" FilterPopupMode="CheckedList" Width="90" FixedWidth="True" ReadOnly="True">
                <dxg:GridColumn.EditSettings>
                    <dxe:TextEditSettings MaskType="DateTime"
                                           Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    MaskUseAsDisplayFormat="True"
                                           />
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridColumn Header="{DynamicResource TotalTime}" FieldName="TotalTime" FilterPopupMode="CheckedList" Width="100" FixedWidth="True" ReadOnly="True">
                <dxg:GridColumn.EditSettings>
                    <dxe:TextEditSettings MaskType="DateTime"
                                           MaskUseAsDisplayFormat="True"
                                           Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    />
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>
            <dxg:GridColumn Header="{DynamicResource EmployeeAttendanceBreakTime}" FieldName="CompanyShift.BreakTime" FilterPopupMode="CheckedList" Width="100" FixedWidth="True" ReadOnly="True">
                <dxg:GridColumn.EditSettings>
                    <dxe:TextEditSettings MaskType="DateTimeAdvancingCaret" MaskUseAsDisplayFormat="True"
                                           Mask="HH:mm" />
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridControl.View>
                <dxg:TableView x:Name="AttendanceProfileTableView"
                                   NavigationStyle="Row"
                                   RowDetailsVisibilityMode="Visible"
                                   ShowHorizontalLines="True"
                                   ShowColumnHeaders="True"
                                   AllowFixedColumnMenu="False"
                                   ShowTotalSummary="True"
                                   ShowFixedTotalSummary="True"
                                   SearchPanelHorizontalAlignment="Stretch"
                                   AllowGrouping="True"
                                   ShowGroupPanel="False"
                                   ShowIndicator="False" >
                </dxg:TableView>
            </dxg:GridControl.View>
        </dxg:GridControl>
        <Grid HorizontalAlignment="Center" Margin="0,-50,0,0" Background="Transparent">
            <Grid.RowDefinitions>
                <RowDefinition Height="55"/>
                <RowDefinition Height="40"/>
                <RowDefinition Height="40"/>
                <RowDefinition Height="40"/>
                <RowDefinition Height="40"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="125"/>
                <ColumnDefinition Width="150"/>
            </Grid.ColumnDefinitions>

            <Label Content="{DynamicResource HrmMainViewModelExportAttendance}" Margin="10,0,0,10" HorizontalAlignment="Left" Style="{StaticResource LabelTitleStyle}" Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" />
            <!--Plant Name-->
            <Label Grid.Row="1" Grid.Column="1" Content="{DynamicResource CommonPlanWithoutColon}"  Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,10,0,10"/>

            <dxe:ComboBoxEdit Name="cmbPlant" Style="{DynamicResource ComboBoxEditStyle}" Grid.Row="1" Grid.Column="2" Width="150" Height="30" Margin="0,0,0,0"
                              Grid.ColumnSpan="2" HorizontalAlignment="Left" VerticalAlignment="Center"
                                ItemsSource="{Binding IsCompanyList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                EditValue="{Binding SelectedAuthorizedPlantsList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                DisplayMember="ShortName">
                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:CheckedComboBoxStyleSettings />
                </dxe:ComboBoxEdit.StyleSettings>

                <!--<dxmvvm:Interaction.Triggers>
                    <dxmvvm:EventToCommand EventName="EditValueChanged"
                                           Command="{Binding DataContext.PlantOwnerEditValueChangedCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" 
                                           PassEventArgsToCommand="True">
                        <dxmvvm:EventToCommand.CommandParameter>
                            <MultiBinding Converter="{Converters:ConverterForRefresh}">
                                <Binding ElementName="scheduler" />
                                <Binding ElementName="accordionControl" />
                            </MultiBinding>
                        </dxmvvm:EventToCommand.CommandParameter>
                    </dxmvvm:EventToCommand>

                </dxmvvm:Interaction.Triggers>-->
            </dxe:ComboBoxEdit>


            <!--Start Date-->
            <Label Grid.Row="2" Grid.Column="1" Content="{DynamicResource EmpEducationStartDate}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,10,0,10"/>

            <dxe:DateEdit  Grid.Row="2" Grid.Column="2" HorizontalAlignment="Left" 
                         Grid.ColumnSpan="2" Height="30" Width="150"  VerticalAlignment="Center"                    
                       AllowNullInput="True" DateTime="{Binding StartDate}" Mask="dd/MM/yyyy" MaskUseAsDisplayFormat="True"
                       IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">

                <dxe:DateEdit.EditValue>
                    <Binding Path="StartDate" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay"
                                                  ValidatesOnDataErrors="True">
                        <Binding.ValidationRules>
                            <Validation:LeaveValidations FieldName="StartDate" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:DateEdit.EditValue>
                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding DataContext.OnDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
            </dxe:DateEdit>

            <!--end date-->
            <Label Grid.Row="3" Grid.Column="1" Content="{DynamicResource EmpEducationEndDate}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="10,10,0,10"/>

            <dxe:DateEdit Grid.Row="3" Grid.Column="2" Width="150" Height="30" ValidateOnEnterKeyPressed="True"
                       HorizontalAlignment="Left" VerticalAlignment="Center"  Grid.ColumnSpan="2"
                      AllowNullInput="True" EditValue="{Binding EndDate}" Mask="dd/MM/yyyy" MaskUseAsDisplayFormat="True"
                      IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">

                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding DataContext.OnDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>

            </dxe:DateEdit>

            <StackPanel Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2"
                    HorizontalAlignment="Left" 
                    Orientation="Horizontal"
                    Margin="40,0,0,-10"
                    Width="250">

                <Button Content="{DynamicResource AddEmployeesViewAccept}"
                    Command="{Binding ExportAttendanceViewAcceptButtonCommand}"
                    CommandParameter="{Binding ElementName=AttendanceProfileTableView}"
                    Height="30"
                    Width="100"
                    Margin="0,0,10,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" />

                <Button Content="{DynamicResource AddEmployeesViewCancel}"
                    Command="{Binding ExportAttendanceViewCancelButtonCommand}" 
                    Height="30"
                    Width="100"
                    Margin="10,0,0,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" />
            </StackPanel>
        </Grid>
    </Grid>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</dxwui:WinUIDialogWindow>