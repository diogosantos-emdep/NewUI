<UserControl x:Class="Emdep.Geos.Modules.PCM.Views.ProductTypeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:Emdep.Geos.Modules.PCM.Views"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxdo="http://schemas.devexpress.com/winfx/2008/xaml/docking"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:dxn="http://schemas.devexpress.com/winfx/2008/xaml/navbar"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
             xmlns:ViewModel="clr-namespace:Emdep.Geos.Modules.PCM.ViewModels"
             xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
             xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing"
             xmlns:dxci="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"
             xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
             xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
             xmlns:Behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             xmlns:dxwuin="http://schemas.devexpress.com/winfx/2008/xaml/windowsui/navigation" 
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             xmlns:dxnav="http://schemas.devexpress.com/winfx/2008/xaml/navigation"
             xmlns:Converters="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters" 
             mc:Ignorable="d"
             d:DesignHeight="500"
             d:DesignWidth="800"
             Style="{DynamicResource UserControlStyle}">

    <UserControl.Resources>

        <Converters:ImageConverter x:Key="ImageConverter"/>
        <Converters:CellColorConverterForPoDate x:Key="CellColorConverterForPoDate"/>
        <Converters:CellBackroundColorOtTypeConvertorSAM x:Key="CellBackroundColorOtTypeConvertorSAM"/>
        <Converters:CellBackroundColorProducedModuleConvertor x:Key="CellBackroundColorProducedModuleConvertor"/>
        <UIHelper:MultipleCellEditHelperSAMWorkOrder x:Key="multipleCellEditHelperSAMWorkOrder"/>
        <UIHelper:CellTemplateSelector x:Key="myTemplateSelector"/>
        <UIHelper:ColumnTemplateSelectorSAM x:Key="ColumnTemplateSelectorSAM"/>
        <Converters:ForegroundColorConverter x:Key="ForegroundColorConverter"/>

        <Style x:Key="HideButtonStyle" TargetType="{x:Type ToggleButton}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border BorderThickness="0" Background="{TemplateBinding Background}">
                            <Grid>
                                <Image Stretch="None" VerticalAlignment="Center" HorizontalAlignment="Center"
                                   Source="/Emdep.Geos.Modules.PCM;component/Assets/Images/ArrowRight.png"
                                   Visibility="{TemplateBinding IsChecked, Converter={dxmvvm:BooleanToVisibilityConverter Inverse=True}}"/>
                                <Image Stretch="None" VerticalAlignment="Center" HorizontalAlignment="Center"
                                   Source="/Emdep.Geos.Modules.PCM;component/Assets/Images/ArrowLeft.png"
                                   Visibility="{TemplateBinding IsChecked, Converter={dxmvvm:BooleanToVisibilityConverter}}"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>


        <Style x:Key="LeftPanelTileItemStyle" TargetType="{x:Type dxnav:TileBarItem}">
            <Setter Property="Foreground" Value="{Binding ForeColor,Converter={UIConverter:ForegroundColorConverter}}"/>
            <Setter Property="BorderBrush" Value="#FFD6D6D6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{Binding BackColor}"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Stretch"/>
            <Setter Property="Height" Value="{Binding Height}"/>
            <Setter Property="Width" Value="{Binding Width}"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="SelectionPadding" Value="0" />
            <Setter Property="ContentTemplate" >
                <Setter.Value >
                    <DataTemplate >
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Left" Width="195" Height="75"  >
                            <Label Content="{Binding EntitiesCount,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Right"   Margin="0,-5,8,0" VerticalContentAlignment="Top" FontSize="36" Visibility="{Binding EntitiesCountVisibility}"></Label>
                            <Label Content="{Binding Caption, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Left" Margin="6,0,0,3" VerticalAlignment="Bottom" FontSize="15" ></Label>
                        </StackPanel>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="BorderThickness" Value="5"/>
                    <Setter Property="BorderBrush" Value="{DynamicResource TileBarItemColorStyle}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="dxg:GridColumnHeader">
            <Setter Property="Height" Value="150" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=(dxg:ColumnBase.HeaderPresenterType)}"
                             Value="ColumnChooser">
                    <Setter Property="Height" Value="30"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ColumnStyle" TargetType="dxg:GridColumn">
            <Setter Property="FilterPopupMode" Value="CheckedList"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsVertical}" Value="true">
                    <Setter Property="HeaderTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <ContentControl Content="{Binding}">
                                    <ContentControl.LayoutTransform>
                                        <RotateTransform Angle="-90"/>
                                    </ContentControl.LayoutTransform>
                                </ContentControl>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="FilterEditorHeaderTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <ContentControl Content="{Binding}">
                                    <ContentControl.LayoutTransform>
                                        <RotateTransform Angle="0"/>
                                    </ContentControl.LayoutTransform>
                                </ContentControl>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="ColumnChooserHeaderCaption">
                        <Setter.Value>
                            <dxmvvm:ValueFactory>
                                <dxmvvm:ValueFactory.ValueTemplate>
                                    <DataTemplate>
                                        <ContentControl Content="{Binding HeaderCaption}">
                                            <ContentControl.LayoutTransform>
                                                <RotateTransform Angle="90" />
                                            </ContentControl.LayoutTransform>
                                        </ContentControl>
                                    </DataTemplate>
                                </dxmvvm:ValueFactory.ValueTemplate>
                            </dxmvvm:ValueFactory>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <DataTemplate x:Key="DefaultColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).ColumnFieldName, RelativeSource={RelativeSource Self}}"
                                Header="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).HeaderText, RelativeSource={RelativeSource Self}}"
                                Width="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Width, RelativeSource={RelativeSource Self}}"
                                Visible="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Visible, RelativeSource={RelativeSource Self},Mode=TwoWay}"
                                Style="{StaticResource ColumnStyle}"
                                AllowCellMerge="False"
                                AllowBestFit="true"
                                AllowEditing="False"
                                AllowAutoFilter="False"
                                MinWidth="{Binding Width}">
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="FixedColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).ColumnFieldName, RelativeSource={RelativeSource Self}}" 
                                Header="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).HeaderText, RelativeSource={RelativeSource Self}}" 
                                AllowCellMerge="False"
                                FixedWidth="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).FixedWidth, RelativeSource={RelativeSource Self}}"
                                AllowBestFit="True"
                                Width="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Width, RelativeSource={RelativeSource Self}}"
                                AllowEditing="False" 
                                AllowAutoFilter="False"
                                Visible="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Visible, RelativeSource={RelativeSource Self}, Mode=TwoWay}"
                                MinWidth="{Binding Width}"/>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="HiddenColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).ColumnFieldName, RelativeSource={RelativeSource Self}}"
                                Header="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).HeaderText, RelativeSource={RelativeSource Self}}"
                                AllowCellMerge="False"
                                FixedWidth="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).FixedWidth, RelativeSource={RelativeSource Self}}"
                                AllowBestFit="True"
                                Width="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Width, RelativeSource={RelativeSource Self}}"
                                AllowEditing="False" 
                                AllowAutoFilter="False"
                                Visible="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Visible, RelativeSource={RelativeSource Self}, Mode=TwoWay}"
                                ShowInColumnChooser="False"
                                MinWidth="{Binding Width}"/>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="LastUpdateColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).ColumnFieldName, RelativeSource={RelativeSource Self}}"
                                Header="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).HeaderText, RelativeSource={RelativeSource Self}}"
                                Width="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Width, RelativeSource={RelativeSource Self}}"
                                Visible="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Visible, RelativeSource={RelativeSource Self}, Mode=TwoWay}"
                                AllowBestFit="true"
                                AllowCellMerge="False"
                                AllowAutoFilter="False"
                                HorizontalHeaderContentAlignment="Center"
                                FilterPopupMode="CheckedList"
                                FixedWidth="True"
                                MinWidth="{Binding Width}">
                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings DisplayFormat="d" />
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="DeleteColumnTemplate">
            <ContentControl>
                <dxg:GridColumn Fixed="Right" MinWidth="30" Width="40" ReadOnly="True" FixedWidth="True" FilterPopupMode="CheckedList" Visible="True" >
                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <Button Name="deleteRowItem" ToolTip="{DynamicResource Delete}" 
                                    Command="{Binding View.DataContext.DeleteProductTypeBandCommand,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}" CommandParameter="{Binding RowData.Row}">
                                <Button.ContentTemplate>
                                    <DataTemplate>
                                        <Image Height="16" Width="16"  Style="{ DynamicResource DeleteStyle}" />
                                    </DataTemplate>
                                </Button.ContentTemplate>
                                <Button.Style>
                                    <Style TargetType="{x:Type Button}">
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Cursor" Value="Hand"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="SummaryTemplate">
            <ContentControl>
                <dxg:GridSummaryItem FieldName="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).FieldName, RelativeSource={RelativeSource Self}}"
                                     SummaryType="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Type, RelativeSource={RelativeSource Self}}"
                                     DisplayFormat= "{Binding Path=(dxci:DependencyObjectExtensions.DataContext).DisplayFormat, RelativeSource={RelativeSource Self}}" />
            </ContentControl>
        </DataTemplate>

        <Style x:Key="PrintColumnHeaderStyle" TargetType="dxe:TextEdit"  BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=Column.DataContext.IsVertical}" Value="True">
                    <Setter Property="dxp:ExportSettings.TargetType" Value="Image"/>
                    <Setter Property="Height" Value="150"/>
                    <Setter Property="DisplayTemplate">
                        <Setter.Value>
                            <ControlTemplate>
                                <dxe:TextEdit Name="PART_Editor" HorizontalAlignment="Left" Text="{Binding Path=Column.DataContext.FieldName}" IsPrintingMode="True" >
                                    <dxe:TextEdit.LayoutTransform >
                                        <RotateTransform Angle="-90"/>
                                    </dxe:TextEdit.LayoutTransform>
                                </dxe:TextEdit>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <UIHelper:ProductTypeColumnTemplateSelector x:Key="ColumnTemplateSelector" 
                                                    DefaultTemplate="{StaticResource DefaultColumnTemplate}"
                                                    FixedTemplate="{StaticResource FixedColumnTemplate}"
                                                    LastUpdateTemplate="{StaticResource LastUpdateColumnTemplate}"
                                                    HiddenTemplate="{StaticResource HiddenColumnTemplate}"
                                                    DeleteTemplate="{StaticResource DeleteColumnTemplate}"/>

        <DataTemplate x:Key="BandTemplate">
            <ContentControl>
                <dxg:GridControlBand UIHelper:NameBinder.Name="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).BandName, RelativeSource={RelativeSource Self}}" 
                                    Header="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).BandHeader, RelativeSource={RelativeSource Self}}" 
                                    Fixed="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).FixedStyle, RelativeSource={RelativeSource Self}}" 
                                    OverlayHeaderByChildren="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).OverlayHeaderByChildren, RelativeSource={RelativeSource Self}}" 
                                    HorizontalHeaderContentAlignment="Center"
                                    ColumnsSource="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Columns, RelativeSource={RelativeSource Self}}"
                                    ColumnGeneratorTemplateSelector="{StaticResource ColumnTemplateSelector}"/>
            </ContentControl>
        </DataTemplate>
    </UserControl.Resources>

    <Grid ShowGridLines="False" >
        <Grid.RowDefinitions>
            <RowDefinition Height="70"/>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Label Content="{Binding Title,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}" Style="{StaticResource LabelTitleStyle}"
                    Grid.Row="0"
                    VerticalAlignment="Center" />

            <Grid Grid.Row="0" Grid.Column="1" HorizontalAlignment="Right">
                <Grid HorizontalAlignment="Right" Width="Auto" Height="45" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="45"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Add Button -->
                    <Button Content=" " Grid.Row="0" Grid.Column="0" Height="40" Width="40" HorizontalAlignment="Right"
                  Command="{Binding AddProductTypeButtonCommand}" CommandParameter="{Binding ElementName=ItemListTableView}" Margin="0,0,5,5">
                        <Button.ToolTip>
                            <TextBlock Text="{DynamicResource ButtonAdd}"/>
                        </Button.ToolTip>
                        <Button.ContentTemplate>
                            <DataTemplate>
                                <Image Style="{ DynamicResource PCMAddButtonImageStyle}"  Height="24" Width="24" Margin="-10"/>
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>

                    <!-- Refresh Button -->
                    <Button Content=" " Grid.Row="0" Grid.Column="1" Height="40" Width="40" HorizontalAlignment="Right"
                  Command="{Binding RefreshProductTypeCommand}" CommandParameter="{Binding ElementName=ItemListTableView}" Margin="0,0,5,5">
                        <Button.ToolTip>
                            <TextBlock Text="{DynamicResource ButtonRefresh}"/>
                        </Button.ToolTip>
                        <Button.ContentTemplate>
                            <DataTemplate>
                                <Image Style="{ DynamicResource PCMRefreshButtonImageStyle}"  Height="24" Width="24" Margin="-10"/>
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>

                    <!-- Print Button -->
                    <Button Content=" " Grid.Row="0" Grid.Column="2" Height="40" Width="40" HorizontalAlignment="Right"
                            Command="{Binding PrintModulesCommand}" CommandParameter="{Binding ElementName=ItemListTableView}" Margin="0,0,5,5">
                        <Button.ToolTip>
                            <TextBlock Text="{DynamicResource ButtonPrint}"/>
                        </Button.ToolTip>
                        <Button.ContentTemplate>
                            <DataTemplate>
                                <Image Style="{DynamicResource PCMPrintButtonImageStyle}"  Height="24" Width="24" Margin="-10"/>
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>

                    <!-- Export to Excel -->
                    <Button Content=" " Grid.Row="0" Grid.Column="3" Height="40" Width="40" HorizontalAlignment="Right"
                  Command="{Binding ExportModulesCommand}" CommandParameter="{Binding ElementName=ItemListTableView}" Margin="0,0,5,5">
                        <Button.ToolTip>
                            <TextBlock Text="{DynamicResource ButtonExportToExcel}"/>
                        </Button.ToolTip>
                        <Button.ContentTemplate>
                            <DataTemplate>
                                <Image Style="{DynamicResource PCMExportToExcelButtonImageStyle}"  Height="24" Width="24" Margin="-10"/>
                            </DataTemplate>
                        </Button.ContentTemplate>
                    </Button>

                    <!-- Switch View -->
                    <dx:DropDownButton x:Name="dropdownButton" Content="Dropdown button" 
                                   HorizontalAlignment="Right" Height="40" Width="40" Grid.Row="0" Grid.Column="4" Margin="0,0,5,5" VerticalAlignment="Center">
                        <dx:DropDownButton.Style>
                            <Style>
                                <Setter Property="dx:DropDownButtonBase.ArrowAlignment" Value="Right" />
                                <Setter Property="dx:DropDownButtonBase.ArrowPadding" Value="0" />
                            </Style>
                        </dx:DropDownButton.Style>

                        <Button.ToolTip>
                            <TextBlock Text="Switch View"></TextBlock>
                        </Button.ToolTip>

                        <Button.ContentTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Image Style="{ DynamicResource PCMSwitchViewButtonImageStyle}" Grid.Column="0" Height="24" Width="24" Margin="-20" />
                                </Grid>
                            </DataTemplate>
                        </Button.ContentTemplate>

                        <dxb:PopupMenu>
                            <dxb:BarButtonItem Name="GridrView" Content="Grid View" Glyph="{DynamicResource SwitchActivityCalendar}" Command="{Binding ShowGridViewCommand}"
                                               CommandParameter="{Binding ElementName=rootGridControl}">
                                <dxb:BarButtonItem.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <Trigger Property="dxb:BarButtonItem.IsMouseOver" Value="True">
                                                <Setter Property="dxb:BarButtonItem.Glyph" Value="{DynamicResource SwitchActivityCalendarMouseOver}" />
                                            </Trigger>
                                            <Trigger Property="dxb:BarButtonItem.IsMouseOver" Value="False">
                                                <Setter Property="dxb:BarButtonItem.Glyph" Value="{DynamicResource SwitchActivityCalendar}" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </dxb:BarButtonItem.Style>
                            </dxb:BarButtonItem>

                            <dxb:BarButtonItem Name="BandView" Content="Band View" Glyph="{DynamicResource SwitchActivityGridview}" Command="{Binding ShowBandViewCommand}"
                                               CommandParameter="{Binding ElementName=rootGridControl}">
                                <dxb:BarButtonItem.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <Trigger Property="dxb:BarButtonItem.IsMouseOver" Value="True">
                                                <Setter Property="dxb:BarButtonItem.Glyph" Value="{DynamicResource SwitchActivityGridviewMouseOver}" />
                                            </Trigger>
                                            <Trigger Property="dxb:BarButtonItem.IsMouseOver" Value="False">
                                                <Setter Property="dxb:BarButtonItem.Glyph" Value="{DynamicResource SwitchActivityGridview}" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </dxb:BarButtonItem.Style>
                            </dxb:BarButtonItem>
                        </dxb:PopupMenu>
                    </dx:DropDownButton>
                </Grid>
            </Grid>
        </Grid>
        
        <DockPanel Grid.Row="1" HorizontalAlignment="Stretch">
            <!--<Grid>-->
                <!--<Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>-->

            <UIHelper:DpiResizingPanel DockPanel.Dock="Left" Visibility="{Binding IsTileBarVisible}">
                <dxnav:TileBar DockPanel.Dock="Left"
                               Visibility="{Binding ElementName=expandButton, Path=IsChecked, Converter={dxmvvm:BooleanToVisibilityConverter}}"
                               Margin="0,-20,0,0"
                               SelectedIndex="{Binding SelectedTileIndex,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                               Orientation="Vertical"
                               Width="215"
                               ItemSpacing="5"
                               ItemsSource="{Binding Listofitem,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               ItemContainerStyle="{StaticResource LeftPanelTileItemStyle}"
                               Padding="0">

                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{Binding CommandShowFilterPopupClick}" EventName="SelectionChanged" PassEventArgsToCommand="True"/>
                        <dxmvvm:EventToCommand Command="{Binding CommandTileBarClickDoubleClick}"  EventName="MouseDoubleClick" CommandParameter="{Binding ElementName=ItemListTableView}"/>
                    </dxmvvm:Interaction.Behaviors>
                </dxnav:TileBar>
            </UIHelper:DpiResizingPanel>

            <ToggleButton Grid.Column="1" x:Name="expandButton" DockPanel.Dock="Left" Style="{StaticResource HideButtonStyle}" IsChecked="True" VerticalAlignment="Center"
                              Visibility="{Binding IsTileBarVisible}"/>
            <!--</Grid>-->

            <Grid Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" DockPanel.Dock="Right" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Visibility="{Binding BandVisibility,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">
                <dxg:GridControl x:Name="rootGridControl"
                                 FilterString="{Binding MyFilterString,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                             ItemsSource="{Binding DataTable, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"
                             BandsSource="{Binding Bands, Mode=OneWay,UpdateSourceTrigger=PropertyChanged}"
                             BandGeneratorTemplate="{StaticResource BandTemplate}"
                             TotalSummarySource="{Binding TotalSummary}"
                             TotalSummaryGeneratorTemplate="{StaticResource SummaryTemplate}">

                    <dxmvvm:Interaction.Behaviors>
                        <UIHelper:GridSelectingBehavior />
                        <UIHelper:BestFitBehavior />
                        <dxmvvm:DependencyPropertyBehavior Binding="{Binding VisibleRowCount, Mode=OneWayToSource}"
                                                       EventName="FilterChanged"
                                                       PropertyName="VisibleRowCount" />

                    </dxmvvm:Interaction.Behaviors>

                    <dxg:GridControl.View>
                        <dxg:TableView x:Name="ItemListTableView"
                                 ShowSearchPanelMode="Always"
                                 NavigationStyle="Row"
                                 ShowTotalSummary="True"
                                 IsTotalSummaryMenuEnabled ="False"
                                 ShowHorizontalLines="True"
                                 AllowPerPixelScrolling="True"
                                 AllowEditing="False"
                                 AllowGrouping="True"
                                 ShowGroupPanel="False"
                                 AllowColumnMoving="True"
                                 AutoMoveRowFocus="False"
                                 AllowScrollAnimation="True"
                                 ShowColumnHeaders="True"
                                 ShowVerticalLines="True"
                                 ShowIndicator="True"
                                 AllowResizing="False"
                                 AllowConditionalFormattingMenu="True"
                                 HorizontalScrollbarVisibility="Visible"
                                 VerticalScrollbarVisibility="Auto"
                                 HorizontalContentAlignment="Center"
                                 ShowAutoFilterRow="False"
                                 RowMinHeight="25"
                                 AllowSorting="True"
                                 AllowScrollHeaders="False"
                                 AllowBestFit="True"
                                 PrintColumnHeaderStyle="{StaticResource PrintColumnHeaderStyle}"
                                 IsColumnChooserVisible="{Binding IsModuleColumnChooserVisible,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                 ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly"
                                 SearchPanelHorizontalAlignment="Stretch"
                                 ShowFilterPopup="{DXEvent Handler='@args.PopupBaseEdit.PopupWidth=200'}" 
                                       AllowColumnFiltering="True"
                                 UseLegacyFilterEditor="True">

                            <dxmvvm:Interaction.Behaviors>
                                <dxmvvm:EventToCommand Command="{Binding DataContext.ProductTypeDoubleClickCommand,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=UserControl}}"
                                     EventName="MouseDoubleClick"
                                     CommandParameter="{Binding ElementName=ItemListTableView}">
                                    <dxmvvm:EventToCommand.EventArgsConverter>
                                        <dx:EventArgsToDataRowConverter />
                                    </dxmvvm:EventToCommand.EventArgsConverter>
                                </dxmvvm:EventToCommand>

                                <dxmvvm:EventToCommand EventName="Loaded"
                                     Command="{Binding GridControlLoadedCommand}"
                                     CommandParameter="{Binding ElementName=rootGridControl}" >
                                </dxmvvm:EventToCommand>

                                <dxmvvm:EventToCommand EventName="ShownColumnChooser"
                                     Command="{Binding ItemListTableViewLoadedCommand}"
                                     CommandParameter="{Binding ElementName=ItemListTableView}" >
                                </dxmvvm:EventToCommand>
                                <dxmvvm:EventToCommand Command="{Binding DataContext.FilterEditorCreatedCommand,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                   EventName="FilterEditorCreated"
                                                   PassEventArgsToCommand="True" />


                            </dxmvvm:Interaction.Behaviors>

                            <dxg:TableView.Resources>
                                <DataTemplate x:Key="ModulesReportPrintHeaderTemplate">
                                    <Grid Width="{Binding UsablePageWidth}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="50" />
                                            <ColumnDefinition Width="130" />
                                        </Grid.ColumnDefinitions>
                                        <dxe:TextEdit Text=" " Width="{Binding UsablePageWidth}" Grid.ColumnSpan="3" IsPrintingMode="True" Background="#333E5E" HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" Style="{DynamicResource TextEdit20Style}" FontWeight="Bold" Height="50" />
                                        <dxe:TextEdit Text="Modules Report" IsPrintingMode="True" HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" Style="{DynamicResource TextEdit20Style}" FontWeight="Bold" />
                                        <Image Source="/Emdep.Geos.Modules.PCM;component/Assets/Images/GeosReportLogo.png" Height="50" Width="80"  dxp:ExportSettings.TargetType="Image" Grid.Column="2" />
                                    </Grid>
                                </DataTemplate>

                                <DataTemplate x:Key="ModulesReportPrintFooterTemplate">
                                    <dxe:TextEdit HorizontalContentAlignment="Center"
                                  Width="{Binding Path=UsablePageWidth, Mode=OneWay}"
                                  dxp:ExportSettings.TargetType="PageNumber"
                                  dxp:PageNumberExportSettings.Kind="NumberOfTotal"
                                  dxp:PageNumberExportSettings.Format="Page {0} of {1}"/>
                                </DataTemplate>

                                <DataTemplate x:Key="StructuresReportPrintHeaderTemplate">
                                    <Grid Width="{Binding UsablePageWidth}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="50" />
                                            <ColumnDefinition Width="130" />
                                        </Grid.ColumnDefinitions>
                                        <dxe:TextEdit Text=" " Width="{Binding UsablePageWidth}" Grid.ColumnSpan="3" IsPrintingMode="True" Background="#333E5E" HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" Style="{DynamicResource TextEdit20Style}" FontWeight="Bold" Height="50" />
                                        <dxe:TextEdit Text="Structures Report" IsPrintingMode="True" HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" Style="{DynamicResource TextEdit20Style}" FontWeight="Bold" />
                                        <Image Source="/Emdep.Geos.Modules.PCM;component/Assets/Images/GeosReportLogo.png" Height="50" Width="80"  dxp:ExportSettings.TargetType="Image" Grid.Column="2" />
                                    </Grid>
                                </DataTemplate>

                                <DataTemplate x:Key="StructuresReportPrintFooterTemplate">
                                    <dxe:TextEdit HorizontalContentAlignment="Center"
                                  Width="{Binding Path=UsablePageWidth, Mode=OneWay}"
                                  dxp:ExportSettings.TargetType="PageNumber"
                                  dxp:PageNumberExportSettings.Kind="NumberOfTotal"
                                  dxp:PageNumberExportSettings.Format="Page {0} of {1}"/>
                                </DataTemplate>
                            </dxg:TableView.Resources>
                        </dxg:TableView>
                    </dxg:GridControl.View>
                </dxg:GridControl>
            </Grid>
           
        </DockPanel>
    </Grid>
</UserControl>
