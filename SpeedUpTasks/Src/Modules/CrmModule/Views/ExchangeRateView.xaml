<UserControl x:Class="Emdep.Geos.Modules.Crm.Views.ExchangeRateView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.Crm.ViewModels" 
             xmlns:dxpgi="http://schemas.devexpress.com/winfx/2008/xaml/pivotgrid/internal"
             mc:Ignorable="d" 
             xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/charts"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxpg="http://schemas.devexpress.com/winfx/2008/xaml/pivotgrid"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" 
             xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
             xmlns:Converter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:local="clr-namespace:Emdep.Geos.Modules.Crm.ViewModels"
             xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing" 
             xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
             xmlns:dxn="http://schemas.devexpress.com/winfx/2008/xaml/navbar"
             xmlns:dxnav="http://schemas.devexpress.com/winfx/2008/xaml/navigation"
             xmlns:dxdo="http://schemas.devexpress.com/winfx/2008/xaml/docking" 
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
             xmlns:dxcr="http://schemas.devexpress.com/winfx/2008/xaml/charts/rangecontrolclient"
             xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             Height="Auto" Width="Auto"
             Style="{DynamicResource UserControlStyle}">
    
    <dxmvvm:Interaction.Behaviors>
        <dxmvvm:SaveFileDialogService Title="Save Excel Report"/>
    </dxmvvm:Interaction.Behaviors>

    <Grid x:Name="gridExchangeRateView" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <Grid.Resources>
            <Style TargetType="{x:Type dxnav:TileBarItem}" x:Key="TileBarItemStyleBase">
                <Setter Property="FontFamily" Value="{Binding Path= FontFamilyAsPerTheme,Source={x:Static GeosApplication:GeosApplication.Instance}}"/>
                <Setter Property="ContentTemplate">
                    <Setter.Value>
                        <DataTemplate>
                            <StackPanel Orientation="Vertical">
                                <Image Source="{Binding Path=GlyphUri}" Width="24" Height="24" HorizontalAlignment="Stretch"/>
                                <TextBlock Text="{Binding Caption}" HorizontalAlignment="Center"/>
                                <ContentControl Content="{Binding}" >
                                </ContentControl>
                            </StackPanel>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="Width" Value="60"/>
                <Setter Property="Foreground" Value="{DynamicResource ForegroundDefaultColorStyle}"/>
                <Setter Property="Background" Value="{DynamicResource BackgroundDefaultColorStyle}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource BorderBrushDefaultColorStyle}"/>
                <Setter Property="BorderThickness" Value="0.5"/>
                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="Background" Value="{DynamicResource TileBarItemColorStyle}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            <DataTemplate x:Key="pageHeader">
                <Grid Width="{Binding UsablePageWidth}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="50" />
                        <ColumnDefinition Width="130" />
                    </Grid.ColumnDefinitions>
                    <dxe:TextEdit Text=" " Width="{Binding UsablePageWidth}" Grid.ColumnSpan="3" IsPrintingMode="True" Background="#333E5E"   HorizontalAlignment="Stretch" 
                                                  VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" FontWeight="Bold" FontSize="20" Height="50" />
                    <dxe:TextEdit Text="Currency Exchange Rate Report" IsPrintingMode="True"     HorizontalAlignment="Stretch" 
                                                  VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" FontWeight="Bold" FontSize="20" />
                    <Image Source="/Emdep.Geos.Modules.Crm;component/Assets/Images/GeosReportLogo.png" Height="50" Width="80"  dxp:ExportSettings.TargetType="Image" Grid.Column="2" />
                </Grid>
            </DataTemplate>
            <DataTemplate x:Key="pageFooter">
                <dxe:TextEdit HorizontalContentAlignment="Center" 
                                              Width="{Binding Path=UsablePageWidth, Mode=OneWay}" 
                                              dxp:ExportSettings.TargetType="PageNumber" 
                                              dxp:PageNumberExportSettings.Kind="NumberOfTotal" 
                                              dxp:PageNumberExportSettings.Format="Page {0} of {1}">
                </dxe:TextEdit>
            </DataTemplate>
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height=".75*"/>
            <RowDefinition Height=".25*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <TextBlock Text="{DynamicResource ExchangeRateViewHeader}" Grid.Column="0" Grid.Row="0" Style="{DynamicResource TextBlock30Style}" FontWeight="Bold" HorizontalAlignment="Left"/>

        <dxnav:TileBar x:Name="CurrencyTileBar" Orientation="Horizontal"  HorizontalAlignment="Stretch" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" VerticalAlignment="top" Padding="0" Margin="2" 
                                       SelectedItem="{Binding SelectedCurrency,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                       ItemsSource="{Binding TileCollectionCurrency,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                       ItemContainerStyle="{StaticResource TileBarItemStyleBase}" 
                                       HorizontalContentAlignment="Center" VerticalContentAlignment="Stretch"/>

        <Button Height="40" Width="40" Grid.Row="0" Grid.Column="1" 
                HorizontalAlignment="Right" Margin="0,0,5,0"
                Command="{Binding RefreshButtonCommand}" 
                CommandParameter="{Binding ElementName=gridExchangeRateView}" >
            <Button.ToolTip>
                <TextBlock Text="{DynamicResource ButtonRefresh}"/>
            </Button.ToolTip>
            <Button.ContentTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Image Style="{ DynamicResource RefreshButtonImageStyle}" Grid.Column="0" Height="24" Width="24" Margin="-10"/>
                    </Grid>
                </DataTemplate>
            </Button.ContentTemplate>
        </Button>

        <Button Height="40" Width="40" Grid.Row="0" Grid.Column="2" 
                HorizontalAlignment="Right"  Margin="0,0,5,0"
                Command="{Binding PrintButtonCommand}" 
                CommandParameter="{Binding ElementName=gridExchangeRateView}" >
            <Button.ToolTip>
                <TextBlock Text="{DynamicResource ButtonPrint}"/>
            </Button.ToolTip>
            <Button.ContentTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Image Style="{ DynamicResource PrinterButtonImageStyle}" Grid.Column="0" Height="24" Width="24" Margin="-10"/>
                    </Grid>
                </DataTemplate>
            </Button.ContentTemplate>
        </Button>

        <Button Height="40" Width="40" Grid.Row="0" Grid.Column="3" 
                HorizontalAlignment="Right" Margin="0,0,5,0"
                Command="{Binding ExportButtonCommand}" 
                CommandParameter="{Binding ElementName=gridExchangeRateView}" >
            <Button.ToolTip>
                <TextBlock Text="{DynamicResource ButtonExportToExcel}"/>
            </Button.ToolTip>
            <Button.ContentTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Image Style="{ DynamicResource ExcelExportButtonImageStyle}" Grid.Column="0" Height="24" Width="24" Margin="-10"/>
                    </Grid>
                </DataTemplate>
            </Button.ContentTemplate>
        </Button>

        <dxc:ChartControl x:Name="ChartCurrencyExchangeRate" BorderThickness="0" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4"  IsManipulationEnabled="True" BoundDataChanged="ChartCurrencyExchangeRate_BoundDataChanged">
            <dxc:ChartControl.Legends>
                <dxc:Legend HorizontalPosition="Right" VerticalPosition="Top" Orientation="Vertical" UseCheckBoxes="True" />
            </dxc:ChartControl.Legends>

            <dxc:XYDiagram2D SeriesDataMember="CurrencySeriesName" SeriesItemsSource="{Binding CurrencySeries,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  DependentAxesYRange="True" EnableAxisXNavigation="True">

                <dxc:XYDiagram2D.AxisX>
                    <dxc:AxisX2D x:Name="AxisX">
                        <dxc:AxisX2D.DateTimeScaleOptions>
                            <dxc:ManualDateTimeScaleOptions />
                        </dxc:AxisX2D.DateTimeScaleOptions>
                    </dxc:AxisX2D>
                </dxc:XYDiagram2D.AxisX>

                <dxc:XYDiagram2D.AxisY>
                    <dxc:AxisY2D x:Name="AxisY1">
                    </dxc:AxisY2D>
                </dxc:XYDiagram2D.AxisY>
                <dxc:XYDiagram2D.SecondaryAxesY>
                    <dxc:SecondaryAxisY2D Name="AxisY2">
                    </dxc:SecondaryAxisY2D>
                </dxc:XYDiagram2D.SecondaryAxesY>
                <dxc:XYDiagram2D.SeriesItemTemplate>
                    <DataTemplate>
                        <dxc:LineSeries2D DisplayName="{Binding CurrencySeriesName}" 
                                          Brush="{Binding SeriesColor}" 
                                          DataSource="{Binding Values}"
                                          ArgumentDataMember="CurrencyConversionDate" CheckableInLegend="True"
                                          ValueDataMember="CurrencyConversationRate" CrosshairLabelPattern="{}{S} : {V:F2}">
                            <dxc:LineSeries2D.LineStyle>
                                <dxc:LineStyle Thickness="3"/>
                            </dxc:LineSeries2D.LineStyle>
                        </dxc:LineSeries2D>
                    </DataTemplate>
                </dxc:XYDiagram2D.SeriesItemTemplate>
            </dxc:XYDiagram2D>
        </dxc:ChartControl>

        <dxe:RangeControl Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4" AllowZoom="False">
            <dxe:RangeControl.Client>
                <dxcr:ChartBoundRangeControlClient Chart="{Binding ElementName=ChartCurrencyExchangeRate}" ThumbLabelFormatString="{}{0:dd MM yyyy}">
                    <dxcr:ChartBoundRangeControlClient.ScaleOptions>
                        <dxcr:ScaleOptions>
                            <dxcr:ScaleOptions.SnapBehavior>
                                <dxcr:ManualSnapBehavior Alignment="Day"/>
                            </dxcr:ScaleOptions.SnapBehavior>
                        </dxcr:ScaleOptions>
                    </dxcr:ChartBoundRangeControlClient.ScaleOptions>
                </dxcr:ChartBoundRangeControlClient>
            </dxe:RangeControl.Client>
        </dxe:RangeControl>
    </Grid>
</UserControl>
