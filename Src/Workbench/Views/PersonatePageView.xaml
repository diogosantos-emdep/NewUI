<UserControl 
    x:Class="Workbench.Views.PersonatePageView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
    xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
    xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
    xmlns:Helpers="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
    xmlns:Converter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
    xmlns:ViewModels="clr-namespace:Workbench.ViewModels"
    mc:Ignorable="d"
    HorizontalAlignment="Stretch"
    VerticalAlignment="Stretch">
    <UserControl.Resources>
        <Style x:Key="LoginTextBlockStyle" TargetType="TextBlock">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="BlackAndBlue">
                    <Setter Property="Background" Value="#333333" />
                    <Setter Property="Foreground" Value="#2EADED" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="WhiteAndBlue">
                    <Setter Property="Background" Value="White" />
                    <Setter Property="Foreground" Value="#686868" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    <UserControl.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding DataContext.LoginImpersonateEscapeActionCommand, RelativeSource={RelativeSource AncestorType=Window}}" />
    </UserControl.InputBindings>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="500" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TabControl Grid.Row="1" Grid.Column="1" BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Background" Value="White" />
                    <Setter Property="Foreground" Value="#424242" />
                    <Setter Property="FontFamily" Value="Inter" />
                    <Setter Property="FontSize" Value="12" />
                    <Setter Property="Padding" Value="10,5" />
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="Border" BorderThickness="0" Padding="10,5">
                                    <ContentPresenter x:Name="ContentSite"
                                                      VerticalAlignment="Center"
                                                      HorizontalAlignment="Center"
                                                      ContentSource="Header"
                                                      RecognizesAccessKey="True"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="#074792"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="False">
                                        <Setter TargetName="Border" Property="Background" Value="White"/>
                                        <Setter Property="Foreground" Value="#424242"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>

            <!-- PRODUCTION Tab -->
            <TabItem Header="{StaticResource OfficeTabHeader}" Height="50" Width="300">
                <StackPanel>
                    <Grid>
                        <!-- Copied RowDefinitions from the first TabItem -->
                        <Grid.RowDefinitions>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="0"/>
                            <RowDefinition Height="56"/>
                            <RowDefinition Height="15"/>
                            <RowDefinition Height="70"/>
                            <RowDefinition Height="56"/>
                            <RowDefinition Height="40"/>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="36"/>
                            <RowDefinition Height="20"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="40"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="32"/>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="32"/>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="20"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="256" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- App Logo -->
                        <Image Source="/Assets/Images/geos_logo.png"
                   Grid.Row="2" Grid.Column="1"
                   HorizontalAlignment="Left"
                   Margin="52,0,0,0" RenderOptions.BitmapScalingMode="HighQuality" />

                        <!-- Profile Icon -->
                        <Image Source="/Assets/Images/personate icon.png"
                   Grid.Row="4" Grid.Column="1"
                   HorizontalAlignment="Center" RenderOptions.BitmapScalingMode="HighQuality"/>

                        <StackPanel Orientation="Horizontal" Grid.Row="6" Grid.Column="1" >
                            <!-- ComboBox -->
                            <dxe:ComboBoxEdit Name="UserControlImpersonate" Margin="0,0,-255,0" GotFocus="UserControlImpersonate_GotFocus" LostFocus="UserControlImpersonate_LostFocus"
                  Grid.Row="6" Grid.Column="1" ShowErrorToolTip="False" Validation.ErrorTemplate="{x:Null}"
                  Padding="5"
                  FontSize="15"
                  FontFamily="Inter"
                  BorderBrush="#E6E6E6"
                  AllowDefaultButton="False"
                  ItemsSource="{Binding ImpersonateUserList}"
                  Text="{Binding LoginImpersonateName, UpdateSourceTrigger=PropertyChanged}"
                  SelectedIndex="{Binding SelectedIndexImpersonateUser, UpdateSourceTrigger=PropertyChanged}"
                  NullText="{DynamicResource OfficeUserLoginDefaultLoginNameMessage}"
                  AutoComplete="True"
                  IsTextEditable="True"
                  ImmediatePopup="True"
                  IncrementalFiltering="True"
                  TabIndex="0"
                  Style="{DynamicResource ComboBoxEditStyle}"
                  FocusManager.FocusedElement="{Binding ElementName=UserControlImpersonate}">

                                <dxe:ComboBoxEdit.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" FontSize="15" FontFamily="Inter"/>
                                    </DataTemplate>
                                </dxe:ComboBoxEdit.ItemTemplate>
                                <dxe:ComboBoxEdit.BorderTemplate>
                                    <ControlTemplate>
                                        <Border x:Name="border" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1" >
                                            <ContentPresenter Content="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}" 
ContentTemplate="{Binding ContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <DataTrigger Binding="{Binding Path=(Validation.HasError), ElementName=UserControlImpersonate}" Value="True">
                                                <Setter TargetName="border" Property="BorderBrush" Value="#FF2626"/>
                                            </DataTrigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="border" Property="BorderBrush" Value="#686868"/>
                                            </Trigger>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsKeyboardFocusWithin}" Value="True"/>
                                                    <Condition Binding="{Binding Path=(Validation.HasError), ElementName=UserControlImpersonate}" Value="False"/>
                                                </MultiDataTrigger.Conditions>
                                                <Setter TargetName="border" Property="BorderBrush" Value="#083493"/>
                                            </MultiDataTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </dxe:ComboBoxEdit.BorderTemplate>
                                <dxe:ComboBoxEdit.EditValue>
                                    <Binding Path="LoginImpersonateName" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" NotifyOnValidationError="True"
         ValidatesOnDataErrors="True" >
                                        <Binding.ValidationRules>
                                            <Helpers:CustomRequiredFieldValidation 
            ValidationMessage="{StaticResource OfficeUserLoginViewDefaultLoginNameMessage}"
            ValidationStep="UpdatedValue" />
                                        </Binding.ValidationRules>
                                    </Binding>
                                </dxe:ComboBoxEdit.EditValue>
                            </dxe:ComboBoxEdit>
                            <!--[nsatpute][01.09.2025][GEOS2-9342]-->
                            <TextBlock Text="{DynamicResource OfficeUserLoginDefaultLoginNameMessage}" 
                                        Visibility="{Binding ShowLoginImpersonateNameLabel}"
                                        Margin="5,-37,0,0"
                                        VerticalAlignment="Center"                                        
                                        Padding="5,0,5,0"
                                        FontSize="12"
                                        FontFamily="Inter" >

                                <TextBlock.Style>
                                    <Style BasedOn="{StaticResource LoginTextBlockStyle}" TargetType="TextBlock">
                                        <Style.Triggers>

                                            <DataTrigger Binding="{Binding Path=(Validation.HasError), ElementName=UserControlImpersonate}" Value="True">
                                                <Setter Property="Foreground"  Value="#FF2626"/>
                                            </DataTrigger>
                                            <!-- MouseOver trigger for when UserControlImpersonate is hovered -->
                                            <DataTrigger Binding="{Binding IsMouseOver, ElementName=UserControlImpersonate}" Value="True">
                                                <Setter Property="Foreground" Value="#686868"/>
                                            </DataTrigger>

                                            <!-- Keyboard focus within UserControlImpersonate when no validation error -->
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding IsKeyboardFocusWithin, ElementName=UserControlImpersonate}" Value="True"/>
                                                    <Condition Binding="{Binding Path=(Validation.HasError), ElementName=UserControlImpersonate}" Value="False"/>
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Foreground" Value="#083493"/>
                                            </MultiDataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                        <TextBlock Grid.Row="8" Grid.Column="1" Margin="5,-6,0,0" FontFamily="Intern" FontSize="12" Foreground="{Binding LoginImpersonateNameErrorColor}" Text="{DynamicResource Loginview_Theusernamefieldismandator}"></TextBlock>
                        <!-- Accept Button -->
						<!--[nsatpute][29.08.2025][GEOS2-7914]-->
                        <Button Content="{DynamicResource Loginpage_Accept}"
                    Grid.Row="14" Grid.Column="1"
                    FontSize="14" FontFamily="Inter" TabIndex="1"
                    Command="{Binding LoginImpersonateAcceptButtonCommand}"
                    IsDefault="True">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Background" Value="#074792"/>
                                    <Setter Property="Foreground" Value="White"/>
                                    <Setter Property="BorderBrush" Value="#074792"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="0">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#0B5BA5"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                        </Button>

                        <!-- Back Button -->
					<!--[nsatpute][29.08.2025][GEOS2-7914]-->
                        <Button Content="{DynamicResource Loginpage_Back}"
                    Grid.Row="16" Grid.Column="1"
                    FontSize="14" FontFamily="Inter" TabIndex="2"
                    Command="{Binding LoginImpersonateCancelButtonCommand}">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Background" Value="White"/>
                                    <Setter Property="Foreground" Value="#808080"/>
                                    <Setter Property="BorderBrush" Value="#E1E1E1"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="0">
                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="#F0F0F0"/>
                                                        <Setter Property="Foreground" Value="#444"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </Button.Style>
                        </Button>

                        <!-- Help Link -->
                        <TextBlock VerticalAlignment="Center"
       HorizontalAlignment="Center"
       Grid.Row="18" Grid.Column="1"
       Foreground="#939393">
<Hyperlink Command="{Binding NeedHelpCommand}">
    <Run Text="{DynamicResource OfficeUserLoginViewHelp}" />
</Hyperlink>
                        </TextBlock>
                    </Grid>
                </StackPanel>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>
