using Emdep.Geos.Data.BusinessLogic.Logging;
using Emdep.Geos.Data.Common;
using Emdep.Geos.Data.Common.Epc;
using Emdep.Geos.Data.Common.SCM;
using Emdep.Geos.Data.DataAccess;
using MySql.Data.MySqlClient;
using Prism.Logging;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;
using System.Transactions;
using System.Collections.ObjectModel;
using System.Net;

namespace Emdep.Geos.Data.BusinessLogic
{
    public class SCMManager
    {
        bool isCheckedPosition = false;
        Int64 addedPosition = 0;

        #region [GEOS2-5404][rdixit][13.08.2024]
        public SCMManager()
        {
            try
            {
                if (Log4NetLogger.Logger == null)
                {
                    string ApplicationLogFilePath = System.Web.Hosting.HostingEnvironment.MapPath("/") + "log4net.config";
                    CreateIfNotExists(ApplicationLogFilePath);
                    FileInfo file = new FileInfo(ApplicationLogFilePath);
                    Log4NetLogger.Logger = LoggerFactory.CreateLogger(LogType.Log4Net, file);
                    Log4NetLogger.Logger.Log(string.Format("SCMManager()..... Constructor Executed"), category: Category.Info, priority: Priority.Low);
                }
            }
            catch
            {
                throw;
            }
        }
        void CreateIfNotExists(string config_path)
        {
            string log4netConfig = @"<?xml version=""1.0"" encoding=""utf-8""?>
                                        <configuration>
                                          <configSections>
                                            <section name=""log4net"" type=""log4net.Config.Log4NetConfigurationSectionHandler, log4net"" />
                                          </configSections>
                                          <log4net debug=""true"">
                                            <appender name=""RollingLogFileAppender"" type=""log4net.Appender.RollingFileAppender"">
                                              <file value=""C:\Temp\LogsService.txt""/>
                                              <appendToFile value=""true"" />
                                              <rollingStyle value=""Size"" />
                                              <maxSizeRollBackups value=""10"" />
                                              <maximumFileSize value=""10MB"" />
                                              <staticLogFileName value=""true"" />
                                              <layout type=""log4net.Layout.PatternLayout"">
                                                <conversionPattern value=""%-5p %d %5rms - %m%n"" />
                                              </layout>
                                            </appender>
                                            <root>
                                              <level value=""Info"" />
                                              <appender-ref ref=""RollingLogFileAppender"" />
                                            </root>
                                          </log4net>
                                        </configuration>";

            if (!File.Exists(config_path))
            {
                File.WriteAllText(config_path, log4netConfig);
            }
        }
        #endregion

        #region GetMethods

        //[nsatpute] Add new module SCM and search options (2/5). https://helpdesk.emdep.com/browse/GEOS2-4398
        public List<Data.Common.SCM.Company> GetAllCompany(string localGeosConnectionString)
        {
            TransactionScope transactionScope = null;
            List<Data.Common.SCM.Company> lstCompany = new List<Data.Common.SCM.Company>();
            Data.Common.SCM.Company company;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllCompany", connActivity);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                company = new Data.Common.SCM.Company();
                                company.Id = Convert.ToUInt32(rdr["IdCustomer"]);
                                company.Name = Convert.ToString(rdr["Name"]);
                                lstCompany.Add(company);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstCompany;
            }
        }
        //[nsatpute] Add new module SCM and search options (2/5). https://helpdesk.emdep.com/browse/GEOS2-4398
        public List<Family> GetAllFamilies(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<Family> lstFamily = new List<Family>();
            Family family;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllFamilies", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                family = new Family();
                                family.Id = Convert.ToUInt16(rdr["IdFamily"]);
                                family.Name = Convert.ToString(rdr["Name"]);
                                lstFamily.Add(family);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstFamily;
            }
        }
        //[nsatpute] Add new module SCM and search options (2/5). https://helpdesk.emdep.com/browse/GEOS2-4398
        public List<Subfamily> GetAllSubfamilies(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<Subfamily> lstSubfamily = new List<Subfamily>();
            Subfamily subFamily;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllSubfamilies", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                subFamily = new Subfamily();
                                subFamily.Id = Convert.ToUInt16(rdr["IdConnectorSubfamily"]);
                                subFamily.IdFamily = Convert.ToUInt16(rdr["IdConnectorFamily"]);
                                subFamily.Name = Convert.ToString(rdr["Name"]);
                                lstSubfamily.Add(subFamily);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstSubfamily;
            }
        }
        //[nsatpute] Add new module SCM and search options (2/5). https://helpdesk.emdep.com/browse/GEOS2-4398
        public List<Color> GetAllColors(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            char[] charsToTrim = { 'z', 'Z' };
            List<Color> lstColors = new List<Color>();
            Color color;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllColors", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                color = new Color();
                                //[rdixit][GEOS-4644][22.06.2023]
                                if (rdr["IdColor"] != DBNull.Value)
                                    color.Id = Convert.ToUInt16(rdr["IdColor"]);
                                if (color.Id == 17 || color.Id == 12)
                                {
                                    color.ImageVisibility = System.Windows.Visibility.Visible;
                                    color.ColorVisibility = System.Windows.Visibility.Collapsed;
                                }
                                else
                                {
                                    color.ColorVisibility = System.Windows.Visibility.Visible;
                                    color.ImageVisibility = System.Windows.Visibility.Collapsed;
                                }
                                if (rdr["Name"] != DBNull.Value)
                                    color.Name = Convert.ToString(rdr["Name"]).TrimStart(charsToTrim);
                                if (rdr["HtmlValue"] != DBNull.Value)
                                    color.HtmlColor = Convert.ToString(rdr["HtmlValue"]);
                                lstColors.Add(color);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstColors;
            }
        }
        //[nsatpute] Add new module SCM and search options (2/5). https://helpdesk.emdep.com/browse/GEOS2-4398
        public bool IsConnectionStringNameExist(string name)
        {
            bool isExist = false;
            ConnectionStringSettingsCollection settings = ConfigurationManager.ConnectionStrings;
            if (settings != null)
            {
                foreach (ConnectionStringSettings cs in settings)
                {
                    if (cs.Name == name)
                    {
                        isExist = true;
                        return isExist;
                    }
                }
            }
            return isExist;
        }

        //[rdixit][GEOS2-4399][23.06.2023]
        public List<Gender> GetGender(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<Gender> lstGender = new List<Gender>();
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetGender", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                Gender gender = new Gender();
                                gender.Id = Convert.ToUInt16(rdr["IdTerminal"]);
                                gender.Name = Convert.ToString(rdr["Name"]);
                                lstGender.Add(gender);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstGender;
            }
        }

        //[nsatpute][10-07-2023] SCM - Properties Manager (2/4) GEOS2-4501
        public List<ConnectorProperties> GetConnectorProperties(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<ConnectorProperties> lstConnectorProperties = new List<ConnectorProperties>();
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorProperties", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        ConnectorProperties property = null;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                property = new ConnectorProperties();
                                property.IdConnectorCategory = Convert.ToInt32(rdr["IdConnectorCategory"]);
                                property.CategoryName = Convert.ToString(rdr["CategoryName"]);
                                property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                                property.PropertyName = Convert.ToString(rdr["PropertyName"]);
                                lstConnectorProperties.Add(property);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstConnectorProperties;
            }
        }

        //[Sudhir.Jangra][GEOS2-4502][11/07/2023]
        public bool AddNewValueKey(ValueKey valueKey, string GeosSettingsKey, string connectionstring)
        {
            bool isUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionstring))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertNewValueKey", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        mySqlCommand.Parameters.AddWithValue("_Value", valueKey.LookupKeyName);
                        string IdlookupKey = Convert.ToString(mySqlCommand.ExecuteScalar());
                        mySqlConnection.Close();
                        GeosSettingsKey = GeosSettingsKey.Insert(GeosSettingsKey.Length, "," + IdlookupKey);

                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                    isUpdated = true;
                    if (isUpdated == true)
                    {
                        string LocalConnectionString = ConfigurationManager.ConnectionStrings["MainServerContext"].ConnectionString;
                        UpdateGeosSetting(GeosSettingsKey, LocalConnectionString);
                    }

                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddNewValueKey(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return isUpdated;
        }

        public bool UpdateGeosSetting(string GeosSettingsKey, string connectionstring)
        {
            bool isUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {

                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionstring))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("UpdateGeosSettings_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        mySqlCommand.Parameters.AddWithValue("_SettingName", "SCM_ConnectorList_LookupKeys");
                        mySqlCommand.Parameters.AddWithValue("_SettingValue", GeosSettingsKey);
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                    isUpdated = true;
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddNewValueKey(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return isUpdated;
        }

        //[Sudhir.Jangra][GEOS2-4502][18/07/2023]
        /// <summary>
        /// This method is used to get all Languages.
        /// </summary>
        /// <param name="PCMConnectionString">The pcm connection string.</param>
        /// <returns>The list of Language.</returns>
        public List<Language> GetAllLanguages(string PCMConnectionString)
        {
            List<Language> Languages = new List<Language>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(PCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllLanguages", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Language Language = new Language();
                            Language.IdLanguage = Convert.ToInt32(reader["IdLanguage"]);

                            if (reader["Name"] != DBNull.Value)
                            {
                                Language.Name = Convert.ToString(reader["Name"]);
                            }
                            if (reader["TwoLetterIsoLanguage"] != DBNull.Value)
                            {
                                Language.TwoLetterISOLanguage = Convert.ToString(reader["TwoLetterIsoLanguage"]);
                            }
                            Languages.Add(Language);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllLanguages(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return Languages;
        }
        #endregion

        //[Sudhir.Jangra][GEOS2-4501][19/07/2023]
        //[nsatpute][GEOS2-4501][20/07/2023]
        public void AddPropertyManager(string MainServerConnectionString, List<ConnectorProperties> connectorProperty)
        {
            try
            {
                if (connectorProperty != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConnectorProperties property in connectorProperty)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorPropertiesByFamily", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdConnectorProperty", property.IdConnectorProperty);
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", property.IdFamily);
                            mySqlCommand.Parameters.AddWithValue("_IsEnabled", property.IsEnabled);
                            if (property.DefaultValue == null)
                                mySqlCommand.Parameters.AddWithValue("_DefaultValue", DBNull.Value);
                            else
                                mySqlCommand.Parameters.AddWithValue("_DefaultValue", Convert.ToString(property.DefaultValue));
                            mySqlCommand.Parameters.AddWithValue("_Min_Value", property.MinValue);
                            mySqlCommand.Parameters.AddWithValue("_Max_Value", property.MaxValue);

                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddPropertyManager().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        //[nsatpute][GEOS2-4501][26/07/2023]
        public void DeletePropertyManager(string MainServerConnectionString, List<ConnectorProperties> connectorProperty)
        {
            try
            {
                if (connectorProperty != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConnectorProperties property in connectorProperty)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteConnectorPropertiesByFamily", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdConnectorProperty", property.IdConnectorProperty);
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", property.IdFamily);
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddPropertyManager().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }
        //[nsatpute][GEOS2-4501][20/07/2023]
        public List<ConnectorProperties> GetPropertyManager(string MainServerConnectionString)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorPropertiesByFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();
                            property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                            property.IdFamily = Convert.ToUInt32(rdr["IdFamily"]);
                            property.IsEnabled = Convert.ToBoolean(rdr["IsEnabled"]);
                            if (rdr["DefaultValue"] != DBNull.Value)
                                property.DefaultValue = Convert.ToString(rdr["DefaultValue"]);
                            if (rdr["Min_Value"] != DBNull.Value)
                            {
                                property.MinValue = Convert.ToUInt32(rdr["Min_Value"]);
                            }
                            if (rdr["Max_Value"] != DBNull.Value)
                            {
                                property.MaxValue = Convert.ToUInt32(rdr["Max_Value"]);
                            }

                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetPropertyManager().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }
        //[Sudhir.Jangra][GEOS2-4502][19/07/2023]
        public bool AddCustomProperty(string MainServerConnectionString, CustomProperty customProperty)
        {
            bool isUpdated = false;
            try
            {
                if (customProperty != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertCustomProperties", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        mySqlCommand.Parameters.AddWithValue("_Name", customProperty.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", customProperty.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", customProperty.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", customProperty.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", customProperty.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", customProperty.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", customProperty.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", customProperty.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", customProperty.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", customProperty.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", customProperty.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", customProperty.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", customProperty.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", customProperty.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_IdConnectorType", customProperty.IdConnectorType);
                        mySqlCommand.Parameters.AddWithValue("_IdLookupKey", customProperty.IdLookupKey);
                        mySqlCommand.Parameters.AddWithValue("_IdConnectorCategory", customProperty.IdConnectorCategory);
                        mySqlCommand.ExecuteNonQuery();

                        mySqlConnection.Close();
                        isUpdated = true;
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddPropertyManager().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return isUpdated;
        }


        //[Sudhir.Jangra][GEOS2-4502][31/07/2023]
        public List<Common.SCM.ValueType> GetValueType(string connectionstring)
        {
            List<Common.SCM.ValueType> valueType = new List<Common.SCM.ValueType>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionstring))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetValueType", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            Common.SCM.ValueType type = new Common.SCM.ValueType();
                            if (rdr["IdLookupValue"] != DBNull.Value)
                            {
                                type.IdLookupValue = Convert.ToInt32(rdr["IdLookupValue"]);
                            }
                            if (rdr["Value"] != DBNull.Value)
                            {
                                type.Name = Convert.ToString(rdr["Value"]);
                            }
                            valueType.Add(type);
                        }
                    }
                    mySqlConnection.Close();
                }

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetValueType().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return valueType;
        }



        //[Sudhir.Jangra][GEOS2-4504]
        public List<ValueKey> GetValueKey(string connectionString, string LookupValueKey)
        {
            List<ValueKey> valueKey = new List<ValueKey>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("Get_ValueKeys", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_LookupValueKey", LookupValueKey);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ValueKey key = new ValueKey();
                            if (rdr["IdLookupKey"] != DBNull.Value)
                            {
                                key.IdLookupKey = Convert.ToInt32(rdr["IdLookupKey"]);
                            }
                            if (rdr["LookupKeyName"] != DBNull.Value)
                            {
                                key.LookupKeyName = Convert.ToString(rdr["LookupKeyName"]);
                            }
                            valueKey.Add(key);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetValueType().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return valueKey;
        }

        //[Sudhir.Jangra][GEOS2-4504]
        public bool UpdateValueKey(string connectionString, ValueKey valueKey)
        {
            bool isUpdated = false;
            try
            {
                if (valueKey != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Update_ValueKey", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        mySqlCommand.Parameters.AddWithValue("_IdLookupKey", valueKey.IdLookupKey);
                        mySqlCommand.Parameters.AddWithValue("_LookupKeyName", valueKey.LookupKeyName);

                        mySqlCommand.ExecuteNonQuery();

                        mySqlConnection.Close();
                        isUpdated = true;
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateValueKey().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return isUpdated;
        }


        public CustomProperty GetEditCustomProperty(string connectionString, Int32 Id)
        {
            CustomProperty customProperty = new CustomProperty();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_Get_Custom_Property_Record_By_IdConnector_V2420", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdConnectorProperty", Id);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            if (rdr["IdCustomConnectorProperty"] != DBNull.Value)
                            {
                                customProperty.IdCustomConnectorProperty = Convert.ToInt16(rdr["IdCustomConnectorProperty"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                customProperty.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                customProperty.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                customProperty.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                customProperty.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                customProperty.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                customProperty.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                customProperty.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                customProperty.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["Description_es"] != DBNull.Value)
                            {
                                customProperty.Description_es = Convert.ToString(rdr["Description_es"]);
                            }
                            if (rdr["Description_fr"] != DBNull.Value)
                            {
                                customProperty.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            }
                            if (rdr["Description_pt"] != DBNull.Value)
                            {
                                customProperty.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            }
                            if (rdr["Description_ro"] != DBNull.Value)
                            {
                                customProperty.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            }
                            if (rdr["Description_zh"] != DBNull.Value)
                            {
                                customProperty.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            }
                            if (rdr["Description_ru"] != DBNull.Value)
                            {
                                customProperty.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            }
                            if (rdr["IdConnectorType"] != DBNull.Value)
                            {
                                customProperty.IdConnectorType = Convert.ToInt16(rdr["IdConnectorType"]);
                                //customProperty.ValueType = new Common.SCM.ValueType();
                                //customProperty.ValueType.IdLookupValue = Convert.ToInt16(rdr["IdConnectorType"]);

                                //if (rdr["ValueType"] != DBNull.Value)
                                //{
                                //    customProperty.ValueType.Name = Convert.ToString(rdr["ValueType"]);
                                //}
                            }
                            if (rdr["IdLookupKey"] != DBNull.Value)
                            {
                                customProperty.IdLookupKey = Convert.ToInt16(rdr["IdLookupKey"]);
                                //customProperty.ValueKey = new ValueKey();
                                //customProperty.ValueKey.IdLookupKey = Convert.ToInt16(rdr["IdLookupKey"]);
                                //if (rdr["ValueKey"] != DBNull.Value)
                                //{
                                //    customProperty.ValueKey.LookupKeyName = Convert.ToString(rdr["ValueKey"]);
                                //}
                            }
                            if (rdr["IdConnectorCategory"] != DBNull.Value)
                            {
                                customProperty.IdConnectorCategory = Convert.ToInt16(rdr["IdConnectorCategory"]);

                            }
                        }
                    }
                    mySqlConnection.Close();


                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetEditCustomProperty().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return customProperty;
        }


        //[Sudhir.Jangra][GEOS2-4503]
        public bool UpdateEditCustomProperty(string connectionString, CustomProperty customProperty)
        {
            bool isUpdated = false;
            try
            {
                if (customProperty != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("Update_Edit_Custom_Property_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        //mySqlCommand.Parameters.AddWithValue("_IdConnectorProperty", customProperty.IdCustomConnectorProperty);
                        //mySqlCommand.Parameters.AddWithValue("_Name", customProperty.Name);
                        //mySqlCommand.Parameters.AddWithValue("_Description", customProperty.Description);
                        //mySqlCommand.Parameters.AddWithValue("_IdConnectorType", customProperty.ValueType.IdLookupValue);
                        //mySqlCommand.Parameters.AddWithValue("_IdLookupKey", customProperty.ValueKey.IdLookupValue);

                        mySqlCommand.Parameters.AddWithValue("_IdCustomConnectorProperty", customProperty.IdCustomConnectorProperty);
                        mySqlCommand.Parameters.AddWithValue("_Name", customProperty.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", customProperty.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", customProperty.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", customProperty.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", customProperty.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", customProperty.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", customProperty.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", customProperty.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", customProperty.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", customProperty.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", customProperty.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", customProperty.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", customProperty.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", customProperty.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_IdConnectorType", customProperty.IdConnectorType);
                        mySqlCommand.Parameters.AddWithValue("_IdLookupKey", customProperty.IdLookupKey);
                        mySqlCommand.Parameters.AddWithValue("_IdConnectorCategory", customProperty.IdConnectorCategory);
                        mySqlCommand.ExecuteNonQuery();

                        mySqlConnection.Close();
                        isUpdated = true;
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateEditCustomProperty().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return isUpdated;
        }

        //[pallavi.jadhav][GEOS2-4562][27/07/2023]

        public List<ConnectorFamilies> GetConnectorFamilies(string MainServerConnectionString, string ConnectorFamiliesImagePath)
        {
            List<ConnectorFamilies> connector = new List<ConnectorFamilies>();
            List<ConnectorFamilies> ConList = new List<ConnectorFamilies>();
            List<int> IntList = new List<int>();
            string FamiliesImagePath = string.Empty;
            string SubFamiliesImagePath = string.Empty;
            try
            {

                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GETConnectorFamilies_V2420", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        // int IdKey = 0;
                        while (rdr.Read())
                        {
                            ConnectorFamilies connectorFamilies = new ConnectorFamilies();
                            //   connectorFamilies.Key = IdKey;
                            //  connectorFamilies.Parent = -1;
                            if (rdr["ParentFamilyID"] != DBNull.Value)
                            {
                                connectorFamilies.IdFamily = Convert.ToInt32(rdr["ParentFamilyID"]);
                                IntList.Add(connectorFamilies.IdFamily);
                            }
                            if (rdr["ParentName"] != DBNull.Value)
                                connectorFamilies.ParentName = Convert.ToString(rdr["ParentName"]);
                            if (rdr["ParentDescription"] != DBNull.Value)
                                connectorFamilies.ParentDescription = Convert.ToString(rdr["ParentDescription"]);
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                                connectorFamilies.FilePath = Convert.ToString(rdr["VisualAidPATH"]);
                            if (rdr["ParentFilePath"] != DBNull.Value)
                                connectorFamilies.ParentFilePath = Convert.ToString(rdr["ParentFilePath"]);

                            if (rdr["ParentInUse"] != DBNull.Value)
                            {

                                connectorFamilies.InUseYesNoParent = Convert.ToSByte(rdr["ParentInUse"]);
                                if (connectorFamilies.InUseYesNoParent == 1)
                                {
                                    connectorFamilies.IsInUseParent = "Yes";
                                }
                                else
                                {
                                    connectorFamilies.IsInUseParent = "No";
                                }
                            }
                            if (rdr["Parent_Category"] != DBNull.Value)
                                connectorFamilies.Parent = Convert.ToString(rdr["Parent_Category"]);
                            if (rdr["KeyName"] != DBNull.Value)
                                connectorFamilies.Key = Convert.ToString(rdr["KeyName"]);
                            if (connectorFamilies.Key == null)
                            {
                                connectorFamilies.Key = Convert.ToString(connectorFamilies.IdFamily);
                            }
                            if (rdr["SubfamilyName"] != DBNull.Value)
                                connectorFamilies.Name = Convert.ToString(rdr["SubfamilyName"]);
                            if (rdr["SubfamilyDescription"] != DBNull.Value)
                                connectorFamilies.Description = Convert.ToString(rdr["SubfamilyDescription"]);
                            //else
                            //    connectorFamilies.Description = string.Empty;
                            if (rdr["SubfamilyInUse"] != DBNull.Value)
                            {
                                connectorFamilies.InUseYesNo = Convert.ToSByte(rdr["SubfamilyInUse"]);
                                if (connectorFamilies.InUseYesNo == 1)
                                {
                                    connectorFamilies.IsInUse = "Yes";
                                }
                                else
                                {
                                    connectorFamilies.IsInUse = "No";
                                }
                            }

                            if (rdr["SubfamilyID"] != DBNull.Value)
                                connectorFamilies.IdSubFamilyConnector = Convert.ToInt32(rdr["SubfamilyID"]);


                            //if (rdr["IdSCMFamilyImage"] != DBNull.Value)
                            //    connectorFamilies.IdSCMFamilyImage = Convert.ToUInt64(rdr["IdSCMFamilyImage"]);

                            //if (rdr["IdSCMSubFamilyImage"] != DBNull.Value)
                            //    connectorFamilies.IdSCMSubFamilyImage = Convert.ToUInt64(rdr["IdSCMSubFamilyImage"]);
                            ////   ProductTypeImage.IdCPType = Convert.ToUInt64(reader["IdCPType"]);

                            //if (rdr["SavedFileName"] != DBNull.Value)
                            //{
                            //    connectorFamilies.SavedFileName = Convert.ToString(rdr["SavedFileName"]);
                            //}
                            //if (rdr["SavedFileNameParent"] != DBNull.Value)
                            //{
                            //    connectorFamilies.SavedFileNameParent = Convert.ToString(rdr["SavedFileNameParent"]);
                            //}
                            //if (rdr["OriginalFileName"] != DBNull.Value)
                            //{
                            //    connectorFamilies.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);
                            //}
                            //if (rdr["Position"] != DBNull.Value)
                            //{
                            //    connectorFamilies.PositionParent = Convert.ToUInt64(rdr["Position"]);
                            //}
                            //if (rdr["subfamilyPosition"] != DBNull.Value)
                            //{
                            //    connectorFamilies.Position = Convert.ToUInt64(rdr["subfamilyPosition"]);
                            //}
                            //if (connectorFamilies.IdSCMFamilyImage == 3)
                            //{
                            // }
                            // FamiliesImagePath = ConnectorFamiliesImagePath + connectorFamilies.ParentFilePath;
                            // SubFamiliesImagePath = ConnectorFamiliesImagePath + connectorFamilies.FilePath;
                            connector.Add(connectorFamilies);
                        }
                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {

                                ConnectorFamilies connectorFamiliesimage = new ConnectorFamilies();
                                ConnectorFamilies connectorFamiliesimagepath = new ConnectorFamilies();
                                List<ConnectorFamilies> connectorFamiliesimageList = new List<ConnectorFamilies>();
                                connectorFamiliesimagepath = connector.FirstOrDefault(i => i.IdFamily == Convert.ToInt32(rdr["familyimageIdFamily"]));
                                //foreach(var item in connectorFamiliesimageList)
                                //{
                                //    FamiliesImagePath = ConnectorFamiliesImagePath + connectorFamiliesimageList.Where(a=>a.ParentFilePath);
                                //}
                                if (rdr["familyimageIdFamily"] != DBNull.Value)
                                {
                                    connectorFamiliesimage.IdFamilyimageIdFamily = Convert.ToInt32(rdr["familyimageIdFamily"]);
                                }
                                //connectorFamiliesimage = connector.FirstOrDefault(i => i.IdFamily == connectorFamiliesimage.IdFamilyimageIdFamily);

                                //if (connectorFamiliesimage != null)
                                //{
                                if (rdr["Position"] != DBNull.Value)
                                {
                                    connectorFamiliesimage.PositionParenttemp = Convert.ToUInt64(rdr["Position"]);
                                }
                                //if (connectorFamiliesimage.PositionParenttemp == 1)
                                //{
                                if (rdr["IdSCMFamilyImage"] != DBNull.Value)
                                    connectorFamiliesimage.IdSCMFamilyImage = Convert.ToUInt64(rdr["IdSCMFamilyImage"]);


                                if (rdr["SavedFileNameParent"] != DBNull.Value)
                                {
                                    connectorFamiliesimage.SavedFileNameParent = Convert.ToString(rdr["SavedFileNameParent"]);
                                }
                                //if (rdr["OriginalFileName"] != DBNull.Value)
                                //{
                                //    connectorFamiliesimage.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);
                                //}
                                if (rdr["Position"] != DBNull.Value)
                                {
                                    connectorFamiliesimage.PositionParent = Convert.ToUInt64(rdr["Position"]);
                                }
                                if (connectorFamiliesimagepath != null)
                                {
                                    FamiliesImagePath = ConnectorFamiliesImagePath + connectorFamiliesimagepath.ParentFilePath;
                                    connectorFamiliesimage.ConnectorFamilyImageInBytesParent = GetFamilyImage(Convert.ToString(connectorFamiliesimage.IdFamilyimageIdFamily), FamiliesImagePath, connectorFamiliesimage.SavedFileNameParent);

                                }// connector.Add(connectorFamiliesimage);
                                connectorFamiliesimage.FamilyImagesList = GetFamilyImageImagesByIdFamily(MainServerConnectionString, connectorFamiliesimagepath.IdFamily, FamiliesImagePath);
                                ConList.Add(connectorFamiliesimage);
                                //}

                                //}

                            }

                        }

                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamilies connectorFamiliesSubimage = new ConnectorFamilies();
                                ConnectorFamilies connectorFamiliesSubimagePath = new ConnectorFamilies();
                                //  connectorFamiliesSubimagePath = connector.FirstOrDefault(i => i.IdSubFamilyConnector == Convert.ToInt32(rdr["IdSubFamily"]));
                                if (rdr["IdSubFamily"] != DBNull.Value)
                                {
                                    connectorFamiliesSubimage.IdSubFamily = Convert.ToInt32(rdr["IdSubFamily"]);
                                }
                                //    List<ConnectorFamilies> UpdateconnectorFamiliesList = connector.Where(i => i.IdFamily == Convert.ToInt64(rdr["familyimageIdFamily"])).ToList();
                                connectorFamiliesSubimage = connector.FirstOrDefault(i => i.IdSubFamilyConnector == Convert.ToInt64(rdr["IdSubFamily"]));
                                if (connectorFamiliesSubimage != null)
                                {
                                    if (rdr["subfamilyPosition"] != DBNull.Value)
                                    {
                                        connectorFamiliesSubimage.Positiontemp = Convert.ToUInt64(rdr["subfamilyPosition"]);
                                    }
                                    if (connectorFamiliesSubimage.Positiontemp == 1)
                                    {
                                        if (rdr["IdSCMSubFamilyImage"] != DBNull.Value)
                                            connectorFamiliesSubimage.IdSCMSubFamilyImage = Convert.ToUInt64(rdr["IdSCMSubFamilyImage"]);


                                        if (rdr["SavedFileName"] != DBNull.Value)
                                        {
                                            connectorFamiliesSubimage.SavedFileName = Convert.ToString(rdr["SavedFileName"]);
                                        }
                                        if (rdr["OriginalFileName"] != DBNull.Value)
                                        {
                                            connectorFamiliesSubimage.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);
                                        }
                                        if (rdr["subfamilyPosition"] != DBNull.Value)
                                        {
                                            connectorFamiliesSubimage.Position = Convert.ToUInt64(rdr["subfamilyPosition"]);
                                        }
                                        SubFamiliesImagePath = ConnectorFamiliesImagePath + connectorFamiliesSubimage.FilePath;
                                        connectorFamiliesSubimage.ConnectorFamilyImageInBytes = GetFamilyImage(Convert.ToString(connectorFamiliesSubimage.IdSubFamily), SubFamiliesImagePath, connectorFamiliesSubimage.SavedFileName);



                                        //connectorFamiliesSubimage.SubFamilyList.Add(connectorFamiliesSubimage);
                                        //var subfamily = connectorFamiliesSubimage.SubFamilyList.FirstOrDefault();
                                        //if (subfamily != null)
                                        //{
                                        //    var newImage = new SubFamilyImage(); // Create a new SubFamilyImage object
                                        //    subfamily.ImageList.Add(newImage);   // Add the new image to the ImageList of the subfamily
                                        //}

                                        // connectorFamiliesSubimage.SubFamilyList.FirstOrDefault(i => i.ImageList.Add((SubFamilyImage)connectorFamiliesSubimage));
                                    }
                                }
                                //connector.Add(connectorFamiliesSubimage);

                            }

                        }
                        IntList = IntList.Distinct().ToList();
                        foreach (var cin in IntList)
                        {
                            ConnectorFamilies con = new ConnectorFamilies();
                            con.IdFamily = cin;
                            con.Key = "Parent_" + cin;
                            con.Name = connector.FirstOrDefault(i => i.IdFamily == cin).ParentName;
                            con.IsInUse = connector.FirstOrDefault(i => i.IdFamily == cin).IsInUseParent;
                            con.Description = connector.FirstOrDefault(i => i.IdFamily == cin).ParentDescription;
                            ConnectorFamilies conn = new ConnectorFamilies();
                            conn = ConList.FirstOrDefault(i => i.IdFamilyimageIdFamily == cin);
                            if (conn != null)
                            {
                                con.PositionParent = conn.PositionParent;
                                //con.IdFamilyimage = connector.FirstOrDefault(i => i.IdFamily == cin).IdFamilyimage;
                                //con.IdSCMSubFamilyImage = connector.FirstOrDefault(i => i.IdFamily == cin).IdSCMSubFamilyImage;

                                con.IdSCMFamilyImage = conn.IdSCMFamilyImage;
                                //  con.OriginalFileName = connector.FirstOrDefault(i => i.IdFamily == cin).OriginalFileName;
                                con.SavedFileNameParent = conn.SavedFileNameParent;
                                // con.Position = connector.FirstOrDefault(i => i.IdFamily == cin).PositionParent;
                                con.FamilyImagesList = conn.FamilyImagesList;
                                con.ConnectorFamilyImageInBytesParent = conn.ConnectorFamilyImageInBytesParent;
                            }
                            connector.Add(con);
                            //connector.Where(a=>a.IdFamily==cin).ToList().ForEach(i => i.Key = "Parent_" + cin);
                        }
                        // IdKey++;
                    }
                    mySqlConnection.Close();
                }

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorFamilies().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connector;
        }


        public byte[] GetFamilyImage(string IdFamilyAndSubFamily, string FamiliesImagePath, string SavedFileName)
        {
            byte[] bytes = null;
            string fileUploadPath = string.Empty;
            // string filepath = string.Format(@"{0}\{1}",ProductTypeImagePath, IdProductTypeImage);
            //if (SavedFileName != null)
            //{
            //}
            //if (!Directory.Exists(Convert.ToString(filepath)))
            //{
            //    Directory.CreateDirectory(Convert.ToString(filepath));
            //}
            try
            {
                //foreach (FamilyImage file in FamilyImagesList)
                //{
                fileUploadPath = string.Format(@"{0}\{1}", FamiliesImagePath, SavedFileName);

                if (File.Exists(fileUploadPath))
                {
                    using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                    {
                        bytes = new byte[stream.Length];
                        int numBytesToRead = (int)stream.Length;
                        int numBytesRead = 0;

                        while (numBytesToRead > 0)
                        {
                            // Read may return anything from 0 to numBytesToRead.
                            int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                            // Break when the end of the file is reached.
                            if (n == 0)
                                break;

                            numBytesRead += n;
                            numBytesToRead -= n;
                        }
                    }
                }
                //}
                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetProductTypeImage(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        public byte[] GetFamilysubImage(string ProductTypeImagePath, List<ConnectorFamilies> FamilysubImagesList)
        {
            byte[] bytes = null;
            string fileUploadPath = string.Empty;
            // string filepath = string.Format(@"{0}\{1}",ProductTypeImagePath, IdProductTypeImage);
            //if (SavedFileName != null)
            //{
            //}
            //if (!Directory.Exists(Convert.ToString(filepath)))
            //{
            //    Directory.CreateDirectory(Convert.ToString(filepath));
            //}
            try
            {
                foreach (ConnectorFamilies file in FamilysubImagesList)
                {
                    fileUploadPath = string.Format(@"{0}\{1}", ProductTypeImagePath, file.SavedFileName);

                    if (File.Exists(fileUploadPath))
                    {
                        using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                        {
                            bytes = new byte[stream.Length];
                            int numBytesToRead = (int)stream.Length;
                            int numBytesRead = 0;

                            while (numBytesToRead > 0)
                            {
                                // Read may return anything from 0 to numBytesToRead.
                                int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                                // Break when the end of the file is reached.
                                if (n == 0)
                                    break;

                                numBytesRead += n;
                                numBytesToRead -= n;
                            }
                        }
                    }
                }
                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetProductTypeImage(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }




        //[Sudhir.Jangra][GEOS2-4565]
        public List<Subfamily> AddSubFamily(string connectionString, Int32 IdFamily, List<Subfamily> SubFamiliesList, string SubFamilyImagePath)
        {
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {

                        foreach (Subfamily subFamily in SubFamiliesList)
                        {
                            //if (subFamily.ImageList!=null)
                            //{
                            //    SubFamilyImage savefilename = subFamily.ImageList.FirstOrDefault(i => i.SavedFileName != null);
                            //    string completePath = string.Format(@"{0}", SubFamilyImagePath);
                            //    string filePath = completePath + "\\" + subFamily.Name + "\\" + savefilename.SavedFileName;
                            //}
                            // SubFamilyImage savefilename = subFamily.ImageList.FirstOrDefault(i => i.SavedFileName);
                            string Path = string.Format(@"{0}", SubFamilyImagePath);
                            string subfilePath = Path + "\\" + subFamily.Name;
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_SubFamily_Insert", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;

                            mySqlCommand.Parameters.AddWithValue("_Name", subFamily.Name);
                            mySqlCommand.Parameters.AddWithValue("_Name_es", subFamily.Name_es);
                            mySqlCommand.Parameters.AddWithValue("_Name_fr", subFamily.Name_fr);
                            mySqlCommand.Parameters.AddWithValue("_Name_pt", subFamily.Name_pt);
                            mySqlCommand.Parameters.AddWithValue("_Name_ro", subFamily.Name_ro);
                            mySqlCommand.Parameters.AddWithValue("_Name_zh", subFamily.Name_zh);
                            mySqlCommand.Parameters.AddWithValue("_Name_ru", subFamily.Name_ru);
                            mySqlCommand.Parameters.AddWithValue("_Description", subFamily.Description);
                            mySqlCommand.Parameters.AddWithValue("_Description_es", subFamily.Description_es);
                            mySqlCommand.Parameters.AddWithValue("_Description_fr", subFamily.Description_fr);
                            mySqlCommand.Parameters.AddWithValue("_Description_ro", subFamily.Description_ro);
                            mySqlCommand.Parameters.AddWithValue("_Description_zh", subFamily.Description_zh);
                            mySqlCommand.Parameters.AddWithValue("_Description_pt", subFamily.Description_pt);
                            mySqlCommand.Parameters.AddWithValue("_Description_ru", subFamily.Description_ru);
                            mySqlCommand.Parameters.AddWithValue("_InUse", subFamily.IsInUse);
                            //mySqlCommand.Parameters.AddWithValue("_createdBy", subFamily.CreatedBy);
                            //mySqlCommand.Parameters.AddWithValue("_createdIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                            mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", subfilePath);
                            mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", IdFamily);
                            subFamily.Id = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                            mySqlConnection.Close();

                            if (subFamily.Id > 0)
                            {
                                if (subFamily.ImageList != null)
                                {
                                    AddSubFamilyImageBySubFamily(connectionString, subFamily.Id, subFamily.ImageList, subfilePath);
                                }
                            }
                        }

                    }
                    transactionScope.Complete();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddSubFamily(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return SubFamiliesList;
        }

        //[Sudhir.Jangra][GEOS2-4565]
        public void AddSubFamilyImageBySubFamily(string connectionstring, UInt32 IdSubFamily, ObservableCollection<SubFamilyImage> SubFamilyImageList, string SubFamilyImagePath)
        {
            try
            {
                if (SubFamilyImageList.Count > 0)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionstring))
                    {
                        mySqlConnection.Open();
                        foreach (SubFamilyImage item in SubFamilyImageList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_SubFamilyImage_Insert", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", IdSubFamily);
                            mySqlCommand.Parameters.AddWithValue("_SavedFileName", item.SavedFileName);
                            mySqlCommand.Parameters.AddWithValue("_Description", item.Description);
                            mySqlCommand.Parameters.AddWithValue("_OriginalFileName", item.OriginalFileName);
                            mySqlCommand.Parameters.AddWithValue("_CreatedBy", item.CreatedBy);
                            mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                            mySqlCommand.Parameters.AddWithValue("_Position", item.Position);
                            mySqlCommand.ExecuteNonQuery();
                            // item.IdSubFamilyImage = Convert.ToUInt32(mySqlCommand.ExecuteScalar());

                            //if (item.IdSubFamilyImage > 0)
                            //{
                            AddSubFamilyImageToPath(item, SubFamilyImagePath);
                            // }
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddSubFamilyImageBySubFamily(). IdDetection- {0} ErrorMessage- {1}", IdSubFamily, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        //[Sudhir.Jangra][GEOS2-4565]
        public bool AddSubFamilyImageToPath(SubFamilyImage subFamilyImage, string subFamilyImagePath)
        {
            if (subFamilyImage.SubFamilyImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}", subFamilyImagePath);
                    string filePath = completePath + "\\" + subFamilyImage.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    else
                    {
                        DirectoryInfo di = new DirectoryInfo(completePath);
                        foreach (FileInfo file in di.GetFiles())
                        {
                            file.Delete();
                        }
                    }
                    File.WriteAllBytes(filePath, subFamilyImage.SubFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddDetectionImageToPath()- Filename - {0}. ErrorMessage- {1}", subFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }


        //[GEOS2-4563][rupali sarode][31-07-2023]
        public ConnectorFamilies AddConnectorFamilies_V2420(string MainServerConnectionString, ConnectorFamilies ConnectorFamily, string ConnectorFamilyImagePath, List<Subfamily> SubFamiliesList)
        {
            // ConnectorFamilies ConnectorFamily = new ConnectorFamilies(); ;
            bool IsInserted = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    string FamiliesImagePath = string.Empty;
                    FamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name;
                    // string SubFamiliesImagePath = string.Empty;
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Insert_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", ConnectorFamily.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);

                        ConnectorFamily.IdFamily = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                        IsInserted = true;
                        mySqlConnection.Close();



                    }
                    if (ConnectorFamily.IdFamily > 0)
                    {
                        AddConnectorFamilyImages_V2420(MainServerConnectionString, Convert.ToUInt16(ConnectorFamily.IdFamily), ConnectorFamily.FamilyImagesList, FamiliesImagePath);
                    }
                    if (SubFamiliesList != null)
                    {
                        ConnectorFamily.SubFamilyList = AddSubFamily(MainServerConnectionString, ConnectorFamily.IdFamily, SubFamiliesList, FilePath);
                    }
                    transactionScope.Complete();
                    //transactionScope.Dispose();


                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilies_V2420(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }

            return ConnectorFamily;
        }

        //[GEOS2-4563][rupali sarode][31-07-2023]
        public void AddConnectorFamilyImages_V2420(string MainServerConnectionString, UInt16 IdFamily, List<FamilyImage> FamilyImageList, string connectorFamilyImagePath)
        {
            bool IsInserted = false;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    foreach (FamilyImage FamilyImage in FamilyImageList.Distinct())
                    {
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Family_Images_Insert_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_SavedFileName", FamilyImage.SavedFileName);
                        mySqlCommand.Parameters.AddWithValue("_Description", FamilyImage.Description);
                        mySqlCommand.Parameters.AddWithValue("_OriginalFileName", FamilyImage.OriginalFileName);
                        mySqlCommand.Parameters.AddWithValue("_ImagePosition", FamilyImage.ImagePosition);
                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", FamilyImage.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));

                        mySqlCommand.ExecuteNonQuery();

                        ConnectorFamilyImageToPath(IdFamily, FamilyImage, connectorFamilyImagePath);
                    }
                    mySqlConnection.Close();
                }
                IsInserted = true;

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilyImages_V2420(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        //[GEOS2-4563][rupali sarode][31-07-2023]
        public bool ConnectorFamilyImageToPath(UInt16 IdFamily, FamilyImage ConnectorFamilyImage, string connectorFamilyImagePath)
        {
            if (ConnectorFamilyImage.ConnectorFamilyImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\", connectorFamilyImagePath);
                    string filePath = completePath + "\\" + ConnectorFamilyImage.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    File.WriteAllBytes(filePath, ConnectorFamilyImage.ConnectorFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error ConnectorFamilyImageToPath()- Filename - {0}. ErrorMessage- {1}", ConnectorFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }

        //[gulab lakade][GEOS2-4506][16 08 2023]
        public List<ValueKey> GetAllLookupKey(string connectionString)
        {
            List<ValueKey> valueKey = new List<ValueKey>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("Get_AllLookupKeys_V2420", mySqlConnection);
                    //mySqlCommand.Parameters.AddWithValue("_LookupValueKey", LookupValueKey);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ValueKey key = new ValueKey();
                            if (rdr["IdLookupKey"] != DBNull.Value)
                            {
                                key.IdLookupKey = Convert.ToInt32(rdr["IdLookupKey"]);
                            }
                            if (rdr["LookupKeyName"] != DBNull.Value)
                            {
                                key.LookupKeyName = Convert.ToString(rdr["LookupKeyName"]);
                            }
                            valueKey.Add(key);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllLookupKey().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return valueKey;
        }

        //[Gulab lakade][GEOS2-4506][16 08 2023]
        public List<LookUpValues> GetAllLookUpValuesRecordByIDLookupkey(string connectionString, int IdLookupKey)
        {
            List<LookUpValues> valueKey = new List<LookUpValues>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_Get_lookup_values_Record_By_IdLookupKey_V2420", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdLookupKey", IdLookupKey);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            LookUpValues key = new LookUpValues();
                            if (rdr["IdLookupValue"] != DBNull.Value)
                            {
                                key.IdLookupValue = Convert.ToInt32(rdr["IdLookupValue"]);
                            }
                            if (rdr["Value"] != DBNull.Value)
                            {
                                key.Value_en = Convert.ToString(rdr["Value"]);
                            }
                            if (rdr["Value_es"] != DBNull.Value)
                            {
                                key.Value_es = Convert.ToString(rdr["Value_es"]);
                            }
                            if (rdr["Value_fr"] != DBNull.Value)
                            {
                                key.Value_fr = Convert.ToString(rdr["Value_fr"]);
                            }
                            if (rdr["Value_pt"] != DBNull.Value)
                            {
                                key.Value_pt = Convert.ToString(rdr["Value_pt"]);
                            }
                            if (rdr["Value_ro"] != DBNull.Value)
                            {
                                key.Value_ro = Convert.ToString(rdr["Value_ro"]);
                            }
                            if (rdr["Value_ru"] != DBNull.Value)
                            {
                                key.Value_ru = Convert.ToString(rdr["Value_ru"]);
                            }
                            if (rdr["Value_zh"] != DBNull.Value)
                            {
                                key.Value_zh = Convert.ToString(rdr["Value_zh"]);
                            }
                            if (rdr["IdLookupKey"] != DBNull.Value)
                            {
                                key.IdLookupKey = Convert.ToInt32(rdr["IdLookupKey"]);
                            }
                            if (rdr["HtmlColor"] != DBNull.Value)
                            {
                                key.HtmlColor = Convert.ToString(rdr["HtmlColor"]);
                            }
                            if (rdr["Position"] != DBNull.Value)
                            {
                                key.Position = Convert.ToInt32(rdr["Position"]);
                            }
                            if (rdr["Abbreviation"] != DBNull.Value)
                            {
                                key.Abbreviation = Convert.ToString(rdr["Abbreviation"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                key.InUse = Convert.ToInt32(rdr["InUse"]);
                            }
                            valueKey.Add(key);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllLookUpValuesRecordByIDLookupkey().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return valueKey;
        }

        //[Gulab lakade][GEOS2-4506][16 08 2023]

        public bool InsertLookupKey_V2420(LookUpValues valueKey, string connectionstring)
        {
            bool isUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionstring))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Insert_lookup_values_Record_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", valueKey.IdLookupValue);
                        mySqlCommand.Parameters.AddWithValue("_IdLookupKey", valueKey.IdLookupKey);
                        mySqlCommand.Parameters.AddWithValue("_Value", valueKey.Value_en);
                        mySqlCommand.Parameters.AddWithValue("_Value_es", valueKey.Value_es);
                        mySqlCommand.Parameters.AddWithValue("_Value_fr", valueKey.Value_fr);
                        mySqlCommand.Parameters.AddWithValue("_Value_pt", valueKey.Value_pt);
                        mySqlCommand.Parameters.AddWithValue("_Value_ro", valueKey.Value_ro);
                        mySqlCommand.Parameters.AddWithValue("_Value_ru", valueKey.Value_ru);
                        mySqlCommand.Parameters.AddWithValue("_Value_zh", valueKey.Value_zh);
                        mySqlCommand.Parameters.AddWithValue("_HtmlColor", valueKey.HtmlColor);
                        mySqlCommand.Parameters.AddWithValue("_Position", valueKey.Position);
                        mySqlCommand.Parameters.AddWithValue("_Abbreviation", valueKey.Abbreviation);
                        mySqlCommand.Parameters.AddWithValue("_InUse", valueKey.InUse);
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();


                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                    isUpdated = true;


                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error InsertLookupKey_V2420(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return isUpdated;
        }
        //[Gulab lakade][GEOS2-4506][16 08 2023]
        public bool UpdateLookupKey_V2420(string connectionString, LookUpValues valueKey)
        {
            bool isUpdated = false;
            try
            {
                if (valueKey != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Update_lookup_values_Record_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", valueKey.IdLookupValue);
                        mySqlCommand.Parameters.AddWithValue("_IdLookupKey", valueKey.IdLookupKey);
                        mySqlCommand.Parameters.AddWithValue("_Value", valueKey.Value_en);
                        mySqlCommand.Parameters.AddWithValue("_Value_es", valueKey.Value_es);
                        mySqlCommand.Parameters.AddWithValue("_Value_fr", valueKey.Value_fr);
                        mySqlCommand.Parameters.AddWithValue("_Value_pt", valueKey.Value_pt);
                        mySqlCommand.Parameters.AddWithValue("_Value_ro", valueKey.Value_ro);
                        mySqlCommand.Parameters.AddWithValue("_Value_ru", valueKey.Value_ru);
                        mySqlCommand.Parameters.AddWithValue("_Value_zh", valueKey.Value_zh);
                        mySqlCommand.Parameters.AddWithValue("_HtmlColor", valueKey.HtmlColor);
                        mySqlCommand.Parameters.AddWithValue("_Position", valueKey.Position);
                        mySqlCommand.Parameters.AddWithValue("_Abbreviation", valueKey.Abbreviation);
                        mySqlCommand.Parameters.AddWithValue("_InUse", valueKey.InUse);
                        mySqlCommand.ExecuteNonQuery();

                        mySqlConnection.Close();
                        isUpdated = true;
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateLookupKey_V2420().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return isUpdated;
        }

        //[Gulab lakade][GEOS2-4506][16 08 2023]
        public bool IsDeletedValueList_V2420(int IdLookupValue, string MainServerConnectionString)
        {
            bool isDeleted = false;
            if (IdLookupValue > 0)
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Delete_lookup_values_Record_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", IdLookupValue);
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();
                        isDeleted = true;
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error IsDeletedValueList_V2420(). IdProductType- {0} ErrorMessage- {1}", IdLookupValue, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }
            return isDeleted;
        }


        public ConnectorFamilies UpdateConnectorFamilies_V2420(string MainServerConnectionString, ConnectorFamilies ConnectorFamily, Int32 IdFamily, string ConnectorFamilyImagePath, List<Subfamily> SubFamiliesList)
        {
            // ConnectorFamilies ConnectorFamily = new ConnectorFamilies(); ;
            bool IsUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    string SubFamiliesImagePath = string.Empty;
                    SubFamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name;
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Update_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", ConnectorFamily.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);

                        //   ConnectorFamily.IdFamily = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                        mySqlCommand.ExecuteNonQuery();
                        IsUpdated = true;
                        mySqlConnection.Close();

                        if (IdFamily > 0)
                        {
                            UpdateConnectorFamilyImages_V2420(MainServerConnectionString, IdFamily, ConnectorFamily.FamilyImagesList, SubFamiliesImagePath);
                        }

                        if (SubFamiliesList != null)
                        {
                            ConnectorFamily.SubFamilyList = UpdateSubFamily(MainServerConnectionString, IdFamily, SubFamiliesList, FilePath);
                        }

                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();


                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilies_V2420(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }

            return ConnectorFamily;
        }

        public void UpdateConnectorFamilyImages_V2420(string MainServerConnectionString, Int32 IdFamily, List<FamilyImage> FamilyImageList, string connectorFamilyImagePath)
        {
            bool IsUpdated = false;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    if (FamilyImageList != null)
                    {
                        foreach (FamilyImage FamilyImage in FamilyImageList.Distinct())
                        {


                            if (FamilyImage.TransactionOperation == ModelBase.TransactionOperations.Delete)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_family_images_Delete", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdSCMFamilyImage", FamilyImage.IdSCMFamilyImage);
                                mySqlCommand.ExecuteNonQuery();

                                IsDeleteFamilyeImageFromPath(FamilyImage, connectorFamilyImagePath);
                            }
                            else if (FamilyImage.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                if (FamilyImage.IdSCMFamilyImage > 0)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("scm_family_images_Update_V2420", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdSCMFamilyImage", FamilyImage.IdSCMFamilyImage);
                                    mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                                    mySqlCommand.Parameters.AddWithValue("_SavedFileName", FamilyImage.SavedFileName);
                                    mySqlCommand.Parameters.AddWithValue("_Description", FamilyImage.Description);
                                    mySqlCommand.Parameters.AddWithValue("_OriginalFileName", FamilyImage.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_ImagePosition", FamilyImage.ImagePosition);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", FamilyImage.CreatedBy);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));

                                    mySqlCommand.ExecuteNonQuery();

                                    updateConnectorFamilyImageToPath(IdFamily, FamilyImage, connectorFamilyImagePath);

                                    //  AddProductTypeImageToPath(productTypeImageList, ProductTypeImagePath);
                                }
                            }
                            else if (FamilyImage.TransactionOperation == ModelBase.TransactionOperations.Add)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_Family_Images_Insert_V2420", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;

                                mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                                mySqlCommand.Parameters.AddWithValue("_SavedFileName", FamilyImage.SavedFileName);
                                mySqlCommand.Parameters.AddWithValue("_Description", FamilyImage.Description);
                                mySqlCommand.Parameters.AddWithValue("_OriginalFileName", FamilyImage.OriginalFileName);
                                mySqlCommand.Parameters.AddWithValue("_ImagePosition", FamilyImage.ImagePosition);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", FamilyImage.CreatedBy);
                                mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));

                                mySqlCommand.ExecuteNonQuery();

                                ConnectorFamilyImageToPath(Convert.ToUInt16(IdFamily), FamilyImage, connectorFamilyImagePath);

                                //if (productTypeImageList.IdCPTypeImage > 0)
                                //{
                                //    AddProductTypeImageToPath(productTypeImageList, ProductTypeImagePath);
                                //}
                            }
                        }





                        mySqlConnection.Close();
                    }
                }
                IsUpdated = true;

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilyImages_V2420(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        public bool updateConnectorFamilyImageToPath(Int32 IdFamily, FamilyImage ConnectorFamilyImage, string connectorFamilyImagePath)
        {
            if (ConnectorFamilyImage.ConnectorFamilyImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}", connectorFamilyImagePath);
                    string filePath = completePath + "\\" + ConnectorFamilyImage.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    else
                    {
                        DirectoryInfo di = new DirectoryInfo(completePath);
                        foreach (FileInfo file in di.GetFiles())
                        {
                            if (file.FullName == filePath)
                                file.Delete();
                        }
                    }
                    File.WriteAllBytes(filePath, ConnectorFamilyImage.ConnectorFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error ConnectorFamilyImageToPath()- Filename - {0}. ErrorMessage- {1}", ConnectorFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }


        public bool IsDeleteFamilyeImageFromPath(FamilyImage familyImage, string connectorFamilyImagePath)
        {
            try
            {
                if (connectorFamilyImagePath != null)
                {
                    string completePath = string.Format(@"{0}", connectorFamilyImagePath);
                    string filePath = completePath + "\\" + familyImage.SavedFileName;
                    // string completePath = string.Format(@"{0}\{1}", ProductTypeImagePath, productTypeImage.IdCPTypeImage);

                    if (!Directory.Exists(completePath))
                    {
                        return false;
                    }
                    else
                    {
                        if (File.Exists(filePath))
                        {
                            File.Delete(filePath);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error IsDeleteProductTypeImageFromPath()- Filename - {0}. ErrorMessage- {1}", familyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return true;
        }

        public List<FamilyImage> GetFamilyImageImagesByIdFamily(string SCMConnectionString, Int32 IdFamily, string FamiliesImagePath)
        {
            List<FamilyImage> FamilyImage = new List<FamilyImage>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyImagesByIdFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            FamilyImage familyImage = new FamilyImage();

                            familyImage.IdSCMFamilyImage = Convert.ToUInt32(reader["IdSCMFamilyImage"]);
                            familyImage.IdFamily = Convert.ToUInt16(reader["IdFamily"]);

                            if (reader["SavedFileName"] != DBNull.Value)
                            {
                                familyImage.SavedFileName = Convert.ToString(reader["SavedFileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                familyImage.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["OriginalFileName"] != DBNull.Value)
                            {
                                familyImage.OriginalFileName = Convert.ToString(reader["OriginalFileName"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                familyImage.Position = Convert.ToUInt64(reader["Position"]);
                            }

                            familyImage.ConnectorFamilyImageInBytesParent = GetFamilyImage(Convert.ToString(familyImage.IdFamily), FamiliesImagePath, familyImage.SavedFileName);
                            FamilyImage.Add(familyImage);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetProductTypeImagesByIdProductType(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return FamilyImage;
        }

        //[Aishwarya Ingale]
        public List<Subfamily> GetSubFamily(string localGeosConnectionString, int IdFamily, string FamiliesImagePath)
        {
            List<Subfamily> subFamily = new List<Subfamily>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GETSubFamilies_V2420", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            Subfamily family = new Subfamily();
                            if (rdr["idConnectorSubfamily"] != DBNull.Value)
                            {
                                family.Id = Convert.ToUInt16(rdr["idConnectorSubfamily"]);
                            }
                            if (rdr["idConnectorFamily"] != DBNull.Value)
                            {
                                family.IdFamily = Convert.ToUInt16(rdr["idConnectorFamily"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                family.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                family.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                family.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                family.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                family.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                family.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                family.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                family.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                //   family.InUse = Convert.ToBoolean(rdr["InUse"]);
                            }
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                            {
                                family.Path = Convert.ToString(rdr["VisualAidPATH"]);
                            }
                            string subPath = FamiliesImagePath + "\\" + family.Path;

                            family.ImageList = new ObservableCollection<SubFamilyImage>(GetSubFamilyImageImagesByIdSubFamily(localGeosConnectionString, family.Id, subPath));

                            subFamily.Add(family)
;
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamily().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return subFamily;
        }


        public List<SubFamilyImage> GetSubFamilyImageImagesByIdSubFamily(string SCMConnectionString, uint IdSubFamily, string FamiliesImagePath)
        {
            List<SubFamilyImage> FamilyImage = new List<SubFamilyImage>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyImagesByIdSubFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", IdSubFamily);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SubFamilyImage familyImage = new SubFamilyImage();

                            familyImage.IdSubFamilyImage = Convert.ToUInt32(reader["IdSCMSubFamilyImage"]);
                            familyImage.IdSubFamily = Convert.ToUInt16(reader["IdSubFamily"]);

                            if (reader["SavedFileName"] != DBNull.Value)
                            {
                                familyImage.SavedFileName = Convert.ToString(reader["SavedFileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                familyImage.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["OriginalFileName"] != DBNull.Value)
                            {
                                familyImage.OriginalFileName = Convert.ToString(reader["OriginalFileName"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                familyImage.Position = Convert.ToUInt64(reader["Position"]);
                            }

                            familyImage.SubFamilyImageInBytes = GetFamilyImage(Convert.ToString(familyImage.IdSubFamily), FamiliesImagePath, familyImage.SavedFileName);
                            FamilyImage.Add(familyImage);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetProductTypeImagesByIdProductType(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return FamilyImage;
        }
        //[Aishwarya Ingale[21-08-2023]]
        public List<Subfamily> UpdateSubFamily(string connectionString, int idfamily, List<Subfamily> UpdatesubFamily, string SubFamilyPath)
        {
            bool isUpdated = false;

            try
            {
                //Subfamily selectedfilename = UpdatesubFamily.
                //string FilePath = SubFamilyPath + "\\"+;
                if (UpdatesubFamily != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();
                        foreach (Subfamily subfamily in UpdatesubFamily)
                        {
                            string selectedfilename = subfamily.Name;
                            string FilePath = SubFamilyPath + "\\" + selectedfilename;
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_Update_Subfamily_V2420", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;

                            mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", subfamily.Id);
                            mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", idfamily);
                            mySqlCommand.Parameters.AddWithValue("_Name", subfamily.Name);
                            mySqlCommand.Parameters.AddWithValue("_Name_es", subfamily.Name_es);
                            mySqlCommand.Parameters.AddWithValue("_Name_fr", subfamily.Name_fr);
                            mySqlCommand.Parameters.AddWithValue("_Name_pt", subfamily.Name_pt);
                            mySqlCommand.Parameters.AddWithValue("_Name_ro", subfamily.Name_ro);
                            mySqlCommand.Parameters.AddWithValue("_Name_zh", subfamily.Name_zh);
                            mySqlCommand.Parameters.AddWithValue("_Name_ru", subfamily.Name_ru);
                            mySqlCommand.Parameters.AddWithValue("_Description", subfamily.Description);
                            mySqlCommand.Parameters.AddWithValue("_Description_es", subfamily.Description_es);
                            mySqlCommand.Parameters.AddWithValue("_Description_fr", subfamily.Description_fr);
                            mySqlCommand.Parameters.AddWithValue("_Description_ro", subfamily.Description_ro);
                            mySqlCommand.Parameters.AddWithValue("_Description_zh", subfamily.Description_zh);
                            mySqlCommand.Parameters.AddWithValue("_Description_pt", subfamily.Description_pt);
                            mySqlCommand.Parameters.AddWithValue("_Description_ru", subfamily.Description_ru);
                            mySqlCommand.Parameters.AddWithValue("_InUse", subfamily.IsInUse);
                            mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                            mySqlCommand.ExecuteNonQuery();

                            mySqlConnection.Close();
                            isUpdated = true;

                            if (subfamily.Id > 0)
                            {
                                if (subfamily.ImageList != null)
                                {
                                    UpdateConnectorSubFamilyImages_V2420(connectionString, Convert.ToInt32(subfamily.Id), subfamily.ImageList.ToList(), FilePath);
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateSubFamily().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return UpdatesubFamily;
        }


        //SubfamilyImage[Aishwarya Ingale]]
        public void UpdateConnectorSubFamilyImages_V2420(string MainServerConnectionString, Int32 IdFamily, List<SubFamilyImage> SubFamilyImageList, string connectorFamilyImagePath)
        {
            bool IsUpdated = false;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    if (SubFamilyImageList != null)
                    {
                        foreach (SubFamilyImage SubFamilyImage in SubFamilyImageList.Distinct())
                        {
                            if (SubFamilyImage.TransactionOperation == ModelBase.TransactionOperations.Delete)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_Subfamily_images_Delete", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdSCMFamilyImage", SubFamilyImage.IdSCMFamilyImage);
                                mySqlCommand.ExecuteNonQuery();

                                IsDeleteSubFamilyeImageFromPath(SubFamilyImage, connectorFamilyImagePath);
                            }
                            else if (SubFamilyImage.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                if (SubFamilyImage.IdSCMFamilyImage > 0)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("scm_Subfamily_images_Update_V2420", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdSCMFamilyImage", SubFamilyImage.IdSCMFamilyImage);
                                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", SubFamilyImage.IdSubFamily);
                                    mySqlCommand.Parameters.AddWithValue("_SavedFileName", SubFamilyImage.SavedFileName);
                                    mySqlCommand.Parameters.AddWithValue("_Description", SubFamilyImage.Description);
                                    mySqlCommand.Parameters.AddWithValue("_OriginalFileName", SubFamilyImage.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_ImagePosition", SubFamilyImage.ImagePosition);
                                    mySqlCommand.Parameters.AddWithValue("_ModifiedBy", SubFamilyImage.ModifiedBy);
                                    mySqlCommand.Parameters.AddWithValue("_ModifiedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                    mySqlCommand.ExecuteNonQuery();
                                    updateConnectorSubFamilyImageToPath(IdFamily, SubFamilyImage, connectorFamilyImagePath);
                                }
                            }
                            else if (SubFamilyImage.TransactionOperation == ModelBase.TransactionOperations.Add)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("scm_Subfamily_images_Insert_V2420", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;

                                mySqlCommand.Parameters.AddWithValue("_IdSubFamily", SubFamilyImage.IdSubFamily);
                                mySqlCommand.Parameters.AddWithValue("_SavedFileName", SubFamilyImage.SavedFileName);
                                mySqlCommand.Parameters.AddWithValue("_Description", SubFamilyImage.Description);
                                mySqlCommand.Parameters.AddWithValue("_OriginalFileName", SubFamilyImage.OriginalFileName);
                                mySqlCommand.Parameters.AddWithValue("_ImagePosition", SubFamilyImage.ImagePosition);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", SubFamilyImage.CreatedBy);
                                mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));

                                mySqlCommand.ExecuteNonQuery();

                                ConnectorSubFamilyImageToPath(Convert.ToUInt16(SubFamilyImage.IdSubFamily), SubFamilyImage, connectorFamilyImagePath);

                                //if (productTypeImageList.IdCPTypeImage > 0)
                                //{
                                //    AddProductTypeImageToPath(productTypeImageList, ProductTypeImagePath);
                                //}
                            }
                        }





                        mySqlConnection.Close();
                    }
                }
                IsUpdated = true;

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilyImages_V2420(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }


        public bool IsDeleteSubFamilyeImageFromPath(SubFamilyImage SubfamilyImage, string connectorFamilyImagePath)
        {
            try
            {
                if (connectorFamilyImagePath != null)
                {
                    string completePath = string.Format(@"{0}", connectorFamilyImagePath);
                    string filePath = completePath + "\\" + SubfamilyImage.SavedFileName;
                    // string completePath = string.Format(@"{0}\{1}", ProductTypeImagePath, productTypeImage.IdCPTypeImage);

                    if (!Directory.Exists(completePath))
                    {
                        return false;
                    }
                    else
                    {
                        Directory.Delete(completePath, true);
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error IsDeleteProductTypeImageFromPath()- Filename - {0}. ErrorMessage- {1}", SubfamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return true;
        }


        //[Aishwarya Ingale[23-08-23]]

        public bool updateConnectorSubFamilyImageToPath(Int32 IdFamily, SubFamilyImage ConnectorSubFamilyImage, string connectorFamilyImagePath)
        {
            if (ConnectorSubFamilyImage.ConnectorSubFamilyImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}", connectorFamilyImagePath);
                    string filePath = completePath + "\\" + ConnectorSubFamilyImage.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    else
                    {
                        DirectoryInfo di = new DirectoryInfo(completePath);
                        foreach (FileInfo file in di.GetFiles())
                        {
                            file.Delete();
                        }
                    }
                    File.WriteAllBytes(filePath, ConnectorSubFamilyImage.ConnectorSubFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error ConnectorFamilyImageToPath()- Filename - {0}. ErrorMessage- {1}", ConnectorSubFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }


        //[Aishwarya Ingale[23-08-23]]
        public bool ConnectorSubFamilyImageToPath(UInt16 IdFamily, SubFamilyImage ConnectorSubFamilyImage, string connectorSubFamilyImagePath)
        {
            if (ConnectorSubFamilyImage.ConnectorSubFamilyImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\", connectorSubFamilyImagePath);
                    string filePath = completePath + "\\" + ConnectorSubFamilyImage.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    File.WriteAllBytes(filePath, ConnectorSubFamilyImage.ConnectorFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error ConnectorFamilyImageToPath()- Filename - {0}. ErrorMessage- {1}", ConnectorSubFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }

        #region V2430
        //[rdixit][01.09.2023][GEOS2-4565]
        public List<ConnectorSubFamily> GetAllSubfamilies_V2430(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<ConnectorSubFamily> lstSubfamily = new List<ConnectorSubFamily>();
            ConnectorSubFamily subFamily;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllSubfamilies", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                subFamily = new ConnectorSubFamily();
                                subFamily.Id = Convert.ToUInt16(rdr["IdConnectorSubfamily"]);
                                subFamily.IdFamily = Convert.ToUInt16(rdr["IdConnectorFamily"]);
                                subFamily.Name = Convert.ToString(rdr["Name"]);
                                lstSubfamily.Add(subFamily);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstSubfamily;
            }
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public List<ConnectorFamily> GetConnectorFamilies_V2430(string MainServerConnectionString, string ConnectorFamiliesImagePath)
        {
            List<ConnectorFamily> connector = new List<ConnectorFamily>();
            List<int> IntList = new List<int>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GETConnectorFamilies_V2430", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorFamily connectorFamilies = new ConnectorFamily();
                            if (rdr["KeyName"] != DBNull.Value)
                                connectorFamilies.Key = Convert.ToString(rdr["KeyName"]);
                            if (rdr["SubfamilyID"] != DBNull.Value)
                                connectorFamilies.IdSubFamilyConnector = Convert.ToInt32(rdr["SubfamilyID"]);
                            if (rdr["ParentFamilyID"] != DBNull.Value)
                                connectorFamilies.IdFamily = Convert.ToInt32(rdr["ParentFamilyID"]);
                            if (rdr["Parent_Category"] != DBNull.Value)
                                connectorFamilies.Parent = Convert.ToString(rdr["Parent_Category"]);
                            if (rdr["Name"] != DBNull.Value)
                                connectorFamilies.Name = Convert.ToString(rdr["Name"]);
                            if (rdr["Name_es"] != DBNull.Value)
                                connectorFamilies.Name_es = Convert.ToString(rdr["Name_es"]);
                            if (rdr["Name_fr"] != DBNull.Value)
                                connectorFamilies.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            if (rdr["Name_pt"] != DBNull.Value)
                                connectorFamilies.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            if (rdr["Name_ro"] != DBNull.Value)
                                connectorFamilies.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            if (rdr["Name_ru"] != DBNull.Value)
                                connectorFamilies.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            if (rdr["Name_zh"] != DBNull.Value)
                                connectorFamilies.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            if (rdr["Description"] != DBNull.Value)
                                connectorFamilies.Description = Convert.ToString(rdr["Description"]);
                            if (rdr["Description_es"] != DBNull.Value)
                                connectorFamilies.Description_es = Convert.ToString(rdr["Description_es"]);
                            if (rdr["Description_fr"] != DBNull.Value)
                                connectorFamilies.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            if (rdr["Description_pt"] != DBNull.Value)
                                connectorFamilies.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            if (rdr["Description_ro"] != DBNull.Value)
                                connectorFamilies.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            if (rdr["Description_ru"] != DBNull.Value)
                                connectorFamilies.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            if (rdr["Description_zh"] != DBNull.Value)
                                connectorFamilies.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                                connectorFamilies.FilePath = Convert.ToString(rdr["VisualAidPATH"]);
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                sbyte InUseYesNoParent = Convert.ToSByte(rdr["InUse"]);
                                if (InUseYesNoParent == 1)
                                    connectorFamilies.IsInUse = "Yes";
                                else
                                    connectorFamilies.IsInUse = "No";
                            }
                            connector.Add(connectorFamilies);
                        }
                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamily selectedConnectorFamily = new ConnectorFamily();
                                if (Convert.ToUInt64(rdr["Position"]) == 1)
                                {
                                    List<ConnectorFamily> connectorFamiliesimageList = new List<ConnectorFamily>();
                                    selectedConnectorFamily = connector.FirstOrDefault(i => i.IdFamily == Convert.ToInt32(rdr["familyimageIdFamily"]) && i.IdSubFamilyConnector == 0);
                                    if (selectedConnectorFamily != null)
                                    {
                                        if (rdr["familyimageIdFamily"] != DBNull.Value)
                                            selectedConnectorFamily.IdFamilyimageIdFamily = Convert.ToInt32(rdr["familyimageIdFamily"]);
                                        if (rdr["IdSCMFamilyImage"] != DBNull.Value)
                                            selectedConnectorFamily.IdSCMFamilyImage = Convert.ToUInt64(rdr["IdSCMFamilyImage"]);
                                        if (rdr["SavedFileNameParent"] != DBNull.Value)
                                            selectedConnectorFamily.SavedFileNameParent = Convert.ToString(rdr["SavedFileNameParent"]);
                                        if (rdr["Position"] != DBNull.Value)
                                            selectedConnectorFamily.Position = Convert.ToUInt64(rdr["Position"]);

                                        selectedConnectorFamily.ConnectorFamilyImageInBytes = GetFamilyImage_V2430(selectedConnectorFamily.Name, ConnectorFamiliesImagePath, selectedConnectorFamily.SavedFileNameParent);
                                    }
                                }
                            }
                        }

                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamily selectedConnectorSubFamily = new ConnectorFamily();

                                if (Convert.ToUInt64(rdr["subfamilyPosition"]) == 1)
                                {
                                    string SubFolderPath = string.Empty;
                                    selectedConnectorSubFamily = connector.FirstOrDefault(i => i.IdSubFamilyConnector == Convert.ToInt64(rdr["IdSubFamily"]));
                                    if (selectedConnectorSubFamily != null)
                                    {
                                        if (rdr["subfamilyPosition"] != DBNull.Value)
                                            selectedConnectorSubFamily.Position = Convert.ToUInt64(rdr["subfamilyPosition"]);

                                        if (rdr["IdSubFamily"] != DBNull.Value)
                                            selectedConnectorSubFamily.IdSubFamilyConnector = Convert.ToInt32(rdr["IdSubFamily"]);

                                        if (rdr["IdSCMSubFamilyImage"] != DBNull.Value)
                                            selectedConnectorSubFamily.IdSCMSubFamilyImage = Convert.ToUInt64(rdr["IdSCMSubFamilyImage"]);

                                        if (rdr["SavedFileName"] != DBNull.Value)
                                            selectedConnectorSubFamily.SavedFileName = Convert.ToString(rdr["SavedFileName"]);

                                        if (rdr["OriginalFileName"] != DBNull.Value)
                                            selectedConnectorSubFamily.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);

                                        if (rdr["VisualAidPATH"] != DBNull.Value)
                                            SubFolderPath = Convert.ToString(rdr["VisualAidPATH"]);

                                        string subPath = ConnectorFamiliesImagePath + SubFolderPath + "\\" + selectedConnectorSubFamily.Name;
                                        selectedConnectorSubFamily.ConnectorFamilyImageInBytes = GetSubFamilyImage_V2430(subPath, selectedConnectorSubFamily.SavedFileName);
                                    }
                                }
                            }
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorFamilies().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connector;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public byte[] GetFamilyImage_V2430(string familyName, string FamiliesImagePath, string SavedFileName)
        {
            byte[] bytes = null;
            string fileUploadPath = string.Empty;
            try
            {
                fileUploadPath = string.Format(@"{0}\{1}\{2}\{3}", FamiliesImagePath, "EXTRAS\\Familiy&Subfamily", familyName, SavedFileName);

                if (File.Exists(fileUploadPath))
                {
                    using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                    {
                        bytes = new byte[stream.Length];
                        int numBytesToRead = (int)stream.Length;
                        int numBytesRead = 0;

                        while (numBytesToRead > 0)
                        {
                            // Read may return anything from 0 to numBytesToRead.
                            int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                            // Break when the end of the file is reached.
                            if (n == 0)
                                break;

                            numBytesRead += n;
                            numBytesToRead -= n;
                        }
                    }
                }
                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetFamilyImage_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public byte[] GetSubFamilyImage_V2430(string FamiliesImagePath, string SavedFileName)
        {
            byte[] bytes = null;
            string fileUploadPath = string.Empty;
            try
            {
                fileUploadPath = string.Format(@"{0}\{1}", FamiliesImagePath, SavedFileName);

                if (File.Exists(fileUploadPath))
                {
                    using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                    {
                        bytes = new byte[stream.Length];
                        int numBytesToRead = (int)stream.Length;
                        int numBytesRead = 0;

                        while (numBytesToRead > 0)
                        {
                            // Read may return anything from 0 to numBytesToRead.
                            int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                            // Break when the end of the file is reached.
                            if (n == 0)
                                break;

                            numBytesRead += n;
                            numBytesToRead -= n;
                        }
                    }
                }
                //}
                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamilyImage_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public void AddSubFamilyImageBySubFamily_V2430(string connectionstring, UInt32 IdSubFamily, ObservableCollection<SubFamilyImage> SubFamilyImageList, string SubFamilyImagePath, string ConnectorFamilyImagePath)
        {
            try
            {
                if (SubFamilyImageList.Count > 0)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionstring))
                    {
                        mySqlConnection.Open();
                        foreach (SubFamilyImage item in SubFamilyImageList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_SubFamilyImage_Insert", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", IdSubFamily);
                            mySqlCommand.Parameters.AddWithValue("_SavedFileName", item.SavedFileName);
                            mySqlCommand.Parameters.AddWithValue("_Description", item.Description);
                            mySqlCommand.Parameters.AddWithValue("_OriginalFileName", item.OriginalFileName);
                            mySqlCommand.Parameters.AddWithValue("_CreatedBy", item.CreatedBy);
                            mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                            mySqlCommand.Parameters.AddWithValue("_Position", item.Position);
                            mySqlCommand.ExecuteNonQuery();
                            AddSubFamilyImageToPath_V2430(item, SubFamilyImagePath, ConnectorFamilyImagePath);
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddSubFamilyImageBySubFamily_V2430(). IdDetection- {0} ErrorMessage- {1}", IdSubFamily, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public bool AddSubFamilyImageToPath_V2430(SubFamilyImage subFamilyImage, string subFamilyImagePath, string ConnectorFamilyImagePath)
        {
            if (subFamilyImage.SubFamilyImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\{1}", ConnectorFamilyImagePath, subFamilyImagePath);
                    string filePath = completePath + "\\" + subFamilyImage.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    File.WriteAllBytes(filePath, subFamilyImage.SubFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddSubFamilyImageToPath_V2430()- Filename - {0}. ErrorMessage- {1}", subFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public bool ConnectorFamilyImageToPath_V2430(UInt16 IdFamily, FamilyImage ConnectorFamilyImage, string connectorFamilyImagePath)
        {
            if (ConnectorFamilyImage.ConnectorFamilyImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\", connectorFamilyImagePath);
                    string filePath = completePath + ConnectorFamilyImage.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    File.WriteAllBytes(filePath, ConnectorFamilyImage.ConnectorFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error ConnectorFamilyImageToPath_V2430()- Filename - {0}. ErrorMessage- {1}", ConnectorFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public ConnectorFamily AddConnectorFamilies_V2430(string MainServerConnectionString, ConnectorFamily ConnectorFamily, string ConnectorFamilyImagePath)
        {
            bool IsInserted = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    string FamiliesImagePath = string.Empty;
                    FamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name;
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Insert_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", ConnectorFamily.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        ConnectorFamily.IdFamily = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                        IsInserted = true;
                        mySqlConnection.Close();
                    }
                    if (ConnectorFamily.FamilyImagesList?.Count > 0)
                    {
                        AddConnectorFamilyImages_V2430(MainServerConnectionString, Convert.ToUInt16(ConnectorFamily.IdFamily), ConnectorFamily.FamilyImagesList, FamiliesImagePath);
                    }
                    //if (SubFamiliesList != null && ConnectorFamily.IdFamily > 0)
                    //{                        
                    //    ConnectorFamily.SubFamilyList = AddSubFamily_V2430(MainServerConnectionString, ConnectorFamily.IdFamily, SubFamiliesList, FilePath, ConnectorFamilyImagePath);
                    //}
                    if (ConnectorFamily.SubFamilyList?.Count > 0)
                    {
                        foreach (var item in ConnectorFamily.SubFamilyList)
                        {
                            item.IdFamily = (uint)ConnectorFamily.IdFamily;
                            if (item.TransactionOperation == ModelBase.TransactionOperations.Add)
                                InsertSubFamily_V2430(MainServerConnectionString, item, ConnectorFamilyImagePath);
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilies_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }

            return ConnectorFamily;
        }

        public List<ConnectorSubFamily> AddSubFamily_V2430(string connectionString, Int32 IdFamily, List<ConnectorSubFamily> SubFamiliesList, string SubFamilyImagePath, string ConnectorFamilyImagePath)
        {
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {

                        foreach (ConnectorSubFamily subFamily in SubFamiliesList)
                        {
                            string Path = string.Format(@"{0}", SubFamilyImagePath);
                            string subfilePath = Path + "\\" + subFamily.FamilyName;
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_SubFamily_Insert", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;

                            mySqlCommand.Parameters.AddWithValue("_Name", subFamily.Name);
                            mySqlCommand.Parameters.AddWithValue("_Name_es", subFamily.Name_es);
                            mySqlCommand.Parameters.AddWithValue("_Name_fr", subFamily.Name_fr);
                            mySqlCommand.Parameters.AddWithValue("_Name_pt", subFamily.Name_pt);
                            mySqlCommand.Parameters.AddWithValue("_Name_ro", subFamily.Name_ro);
                            mySqlCommand.Parameters.AddWithValue("_Name_zh", subFamily.Name_zh);
                            mySqlCommand.Parameters.AddWithValue("_Name_ru", subFamily.Name_ru);
                            mySqlCommand.Parameters.AddWithValue("_Description", subFamily.Description);
                            mySqlCommand.Parameters.AddWithValue("_Description_es", subFamily.Description_es);
                            mySqlCommand.Parameters.AddWithValue("_Description_fr", subFamily.Description_fr);
                            mySqlCommand.Parameters.AddWithValue("_Description_ro", subFamily.Description_ro);
                            mySqlCommand.Parameters.AddWithValue("_Description_zh", subFamily.Description_zh);
                            mySqlCommand.Parameters.AddWithValue("_Description_pt", subFamily.Description_pt);
                            mySqlCommand.Parameters.AddWithValue("_Description_ru", subFamily.Description_ru);
                            mySqlCommand.Parameters.AddWithValue("_InUse", subFamily.IsInUse);
                            mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", subfilePath);
                            mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", IdFamily);
                            subFamily.Id = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                            mySqlConnection.Close();

                            if (subFamily.Id > 0)
                            {
                                if (subFamily.ImageList != null)
                                {
                                    AddSubFamilyImageBySubFamily_V2430(connectionString, subFamily.Id, subFamily.ImageList, subfilePath + "\\" + subFamily.Name, ConnectorFamilyImagePath);
                                }
                            }
                        }

                    }
                    transactionScope.Complete();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddSubFamily_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return SubFamiliesList;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public ConnectorFamily UpdateConnectorFamilies_V2430(string MainServerConnectionString, ConnectorFamily ConnectorFamily, string ConnectorFamilyImagePath)
        {
            bool IsUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    string destinationDirectory = string.Empty;
                    destinationDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name;
                    #region If Name changes path will also change
                    if (ConnectorFamily.OldName.ToLower() != ConnectorFamily.Name.ToLower())
                    {
                        string sourceDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.OldName;
                        try
                        {
                            // Create the destination directory if it doesn't exist
                            if (!Directory.Exists(destinationDirectory))
                            {
                                Directory.CreateDirectory(destinationDirectory);
                            }
                            if (Directory.Exists(sourceDirectory))
                            {
                                foreach (string file in Directory.GetFiles(sourceDirectory))
                                {
                                    string fileName = Path.GetFileName(file);
                                    string destFile = Path.Combine(destinationDirectory, fileName);
                                    if (File.Exists(destFile))
                                    {
                                        File.Delete(destFile);
                                    }
                                    File.Copy(file, destFile);
                                }
                                string[] subdirectories = Directory.GetDirectories(sourceDirectory);
                                foreach (string subdirectory in subdirectories)
                                {
                                    string subdirectoryName = Path.GetFileName(subdirectory);
                                    string destinationSubdirectory = Path.Combine(destinationDirectory, subdirectoryName);
                                    CopyDirectory(subdirectory, destinationSubdirectory);
                                }
                                Directory.Delete(sourceDirectory, true);
                            }
                        }
                        catch (Exception ex)
                        {
                            Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilyImages_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                        }
                    }
                    #endregion

                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Update_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdFamily", ConnectorFamily.IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_ModifiedBy", ConnectorFamily.ModifiedBy);
                        mySqlCommand.Parameters.AddWithValue("_ModifiedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.ExecuteNonQuery();
                        IsUpdated = true;
                        mySqlConnection.Close();

                        if (ConnectorFamily.IdFamily > 0 && ConnectorFamily.FamilyImagesList?.Count > 0)
                        {
                            if (ConnectorFamily.FamilyImagesList.Any(i => i.TransactionOperation == ModelBase.TransactionOperations.Add || i.TransactionOperation == ModelBase.TransactionOperations.Delete || i.TransactionOperation == ModelBase.TransactionOperations.Update))
                                UpdateConnectorFamilyImages_V2430(MainServerConnectionString, ConnectorFamily.IdFamily, ConnectorFamily.FamilyImagesList, destinationDirectory);
                        }
                        if (ConnectorFamily.SubFamilyList?.Count > 0)
                        {
                            foreach (var item in ConnectorFamily.SubFamilyList)
                            {
                                if (item.TransactionOperation == ModelBase.TransactionOperations.Update)
                                    UpdateSubFamily_V2430(MainServerConnectionString, item, ConnectorFamilyImagePath);
                                else if (item.TransactionOperation == ModelBase.TransactionOperations.Add)
                                    InsertSubFamily_V2430(MainServerConnectionString, item, ConnectorFamilyImagePath);
                            }
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilies_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return ConnectorFamily;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public void UpdateConnectorFamilyImages_V2430(string MainServerConnectionString, Int32 IdFamily, List<FamilyImage> FamilyImageList, string connectorFamilyImagePath)
        {
            bool IsUpdated = false;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    if (FamilyImageList != null)
                    {
                        foreach (FamilyImage FamilyImage in FamilyImageList.Distinct())
                        {
                            if (FamilyImage.TransactionOperation == ModelBase.TransactionOperations.Delete)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_family_images_Delete", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdSCMFamilyImage", FamilyImage.IdSCMFamilyImage);
                                mySqlCommand.ExecuteNonQuery();
                                IsDeleteFamilyeImageFromPath(FamilyImage, connectorFamilyImagePath);
                            }
                            else if (FamilyImage.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                if (FamilyImage.IdSCMFamilyImage > 0)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("scm_family_images_Update_V2430", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdSCMFamilyImage", FamilyImage.IdSCMFamilyImage);
                                    mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                                    mySqlCommand.Parameters.AddWithValue("_SavedFileName", FamilyImage.SavedFileName);
                                    mySqlCommand.Parameters.AddWithValue("_Description", FamilyImage.Description);
                                    mySqlCommand.Parameters.AddWithValue("_OriginalFileName", FamilyImage.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_ImagePosition", FamilyImage.Position);
                                    mySqlCommand.Parameters.AddWithValue("_ModifiedBy", FamilyImage.CreatedBy);
                                    mySqlCommand.Parameters.AddWithValue("_ModifiedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                    mySqlCommand.ExecuteNonQuery();
                                    updateConnectorFamilyImageToPath(IdFamily, FamilyImage, connectorFamilyImagePath);
                                }
                            }
                            else if (FamilyImage.TransactionOperation == ModelBase.TransactionOperations.Add)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_Family_Images_Insert_V2420", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;

                                mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                                mySqlCommand.Parameters.AddWithValue("_SavedFileName", FamilyImage.SavedFileName);
                                mySqlCommand.Parameters.AddWithValue("_Description", FamilyImage.Description);
                                mySqlCommand.Parameters.AddWithValue("_OriginalFileName", FamilyImage.OriginalFileName);
                                mySqlCommand.Parameters.AddWithValue("_ImagePosition", FamilyImage.Position);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", FamilyImage.CreatedBy);
                                mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                mySqlCommand.ExecuteNonQuery();
                                ConnectorFamilyImageToPath_V2430(Convert.ToUInt16(IdFamily), FamilyImage, connectorFamilyImagePath);
                            }
                        }
                        mySqlConnection.Close();
                    }
                }
                IsUpdated = true;

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilyImages_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public List<FamilyImage> GetFamilyImageImagesByIdFamily_V2430(string SCMConnectionString, int idFamily, string familyName, string FamiliesImagePath)
        {
            List<FamilyImage> FamilyImage = new List<FamilyImage>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyImagesByIdFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", idFamily);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            FamilyImage familyImage = new FamilyImage();

                            familyImage.IdSCMFamilyImage = Convert.ToUInt32(reader["IdSCMFamilyImage"]);
                            familyImage.IdFamily = Convert.ToUInt16(reader["IdFamily"]);

                            if (reader["SavedFileName"] != DBNull.Value)
                            {
                                familyImage.SavedFileName = Convert.ToString(reader["SavedFileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                familyImage.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["OriginalFileName"] != DBNull.Value)
                            {
                                familyImage.OriginalFileName = Convert.ToString(reader["OriginalFileName"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                familyImage.Position = Convert.ToUInt64(reader["Position"]);
                            }

                            familyImage.ConnectorFamilyImageInBytes = GetFamilyImage_V2430(familyName, FamiliesImagePath, familyImage.SavedFileName);
                            FamilyImage.Add(familyImage);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetFamilyImageImagesByIdFamily_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return FamilyImage;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public List<ConnectorSubFamily> GetSubFamily_V2430(string localGeosConnectionString, int IdFamily, string FamilyName, string FamiliesImagePath)
        {
            List<ConnectorSubFamily> subFamily = new List<ConnectorSubFamily>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSubFamilies_V2430", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorSubFamily family = new ConnectorSubFamily();
                            if (rdr["idConnectorSubfamily"] != DBNull.Value)
                            {
                                family.Id = Convert.ToUInt16(rdr["idConnectorSubfamily"]);
                            }
                            if (rdr["idConnectorFamily"] != DBNull.Value)
                            {
                                family.IdFamily = Convert.ToUInt16(rdr["idConnectorFamily"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                family.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                family.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                family.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                family.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                family.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                family.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                family.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                family.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["Description_fr"] != DBNull.Value)
                            {
                                family.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            }
                            if (rdr["Description_es"] != DBNull.Value)
                            {
                                family.Description_es = Convert.ToString(rdr["Description_es"]);
                            }
                            if (rdr["Description_pt"] != DBNull.Value)
                            {
                                family.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            }
                            if (rdr["Description_ro"] != DBNull.Value)
                            {
                                family.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            }
                            if (rdr["Description_zh"] != DBNull.Value)
                            {
                                family.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            }
                            if (rdr["Description_ru"] != DBNull.Value)
                            {
                                family.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                bool InUse = Convert.ToBoolean(rdr["InUse"]);
                                if (InUse)
                                    family.IsInUse = "1";
                                else
                                    family.IsInUse = "0";
                            }
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                            {
                                family.Path = Convert.ToString(rdr["VisualAidPATH"]);
                            }
                            string subPath = FamiliesImagePath + family.Path + "\\" + family.Name;

                            family.ImageList = new ObservableCollection<SubFamilyImage>(GetSubFamilyImageImagesByIdSubFamily_V2430(localGeosConnectionString, family.Id, subPath));

                            subFamily.Add(family)
;
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamily_V2430().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return subFamily;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public List<SubFamilyImage> GetSubFamilyImageImagesByIdSubFamily_V2430(string SCMConnectionString, uint IdSubFamily, string FamiliesImagePath)
        {
            List<SubFamilyImage> FamilyImage = new List<SubFamilyImage>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyImagesByIdSubFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", IdSubFamily);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SubFamilyImage familyImage = new SubFamilyImage();

                            familyImage.IdSubFamilyImage = Convert.ToUInt32(reader["IdSCMSubFamilyImage"]);
                            familyImage.IdSubFamily = Convert.ToUInt16(reader["IdSubFamily"]);

                            if (reader["SavedFileName"] != DBNull.Value)
                            {
                                familyImage.SavedFileName = Convert.ToString(reader["SavedFileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                familyImage.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["OriginalFileName"] != DBNull.Value)
                            {
                                familyImage.OriginalFileName = Convert.ToString(reader["OriginalFileName"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                familyImage.Position = Convert.ToUInt64(reader["Position"]);
                            }

                            familyImage.SubFamilyImageInBytes = GetSubFamilyImage_V2430(FamiliesImagePath, familyImage.SavedFileName);
                            FamilyImage.Add(familyImage);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamilyImageImagesByIdSubFamily_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return FamilyImage;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public void UpdateConnectorSubFamilyImages_V2430(string MainServerConnectionString, Int32 IdFamily, List<SubFamilyImage> SubFamilyImageList, string ConnectorFamilyImagePath)
        {
            bool IsUpdated = false;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    if (SubFamilyImageList != null)
                    {
                        foreach (SubFamilyImage SubFamilyImage in SubFamilyImageList.Distinct())
                        {
                            if (SubFamilyImage.TransactionOperation == ModelBase.TransactionOperations.Delete)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_Subfamily_images_Delete", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdSCMFamilyImage", SubFamilyImage.IdSubFamilyImage);
                                mySqlCommand.ExecuteNonQuery();
                                IsDeleteSubFamilyeImageFromPath_V2430(SubFamilyImage, ConnectorFamilyImagePath);
                            }
                            else if (SubFamilyImage.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                if (SubFamilyImage.IdSubFamilyImage > 0)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("scm_Subfamily_images_Update_V2430", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdSCMSubFamilyImage", SubFamilyImage.IdSubFamilyImage);
                                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", SubFamilyImage.IdSubFamily);
                                    mySqlCommand.Parameters.AddWithValue("_SavedFileName", SubFamilyImage.SavedFileName);
                                    mySqlCommand.Parameters.AddWithValue("_Description", SubFamilyImage.Description);
                                    mySqlCommand.Parameters.AddWithValue("_OriginalFileName", SubFamilyImage.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_ImagePosition", SubFamilyImage.Position);
                                    mySqlCommand.Parameters.AddWithValue("_ModifiedBy", SubFamilyImage.ModifiedBy);
                                    mySqlCommand.Parameters.AddWithValue("_ModifiedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                    mySqlCommand.ExecuteNonQuery();
                                    UpdateConnectorSubFamilyImageToPath_V2430(IdFamily, SubFamilyImage, ConnectorFamilyImagePath);
                                }
                            }
                            else if (SubFamilyImage.TransactionOperation == ModelBase.TransactionOperations.Add)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("scm_Subfamily_images_Insert_V2430", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdSubFamily", SubFamilyImage.IdSubFamily);
                                mySqlCommand.Parameters.AddWithValue("_SavedFileName", SubFamilyImage.SavedFileName);
                                mySqlCommand.Parameters.AddWithValue("_Description", SubFamilyImage.Description);
                                mySqlCommand.Parameters.AddWithValue("_OriginalFileName", SubFamilyImage.OriginalFileName);
                                mySqlCommand.Parameters.AddWithValue("_ImagePosition", SubFamilyImage.Position);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", SubFamilyImage.CreatedBy);
                                mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                mySqlCommand.ExecuteNonQuery();
                                ConnectorSubFamilyImageToPath_V2430(Convert.ToUInt16(SubFamilyImage.IdSubFamily), SubFamilyImage, ConnectorFamilyImagePath);
                            }
                        }
                        mySqlConnection.Close();
                    }
                }
                IsUpdated = true;

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorSubFamilyImages_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public bool IsDeleteSubFamilyeImageFromPath_V2430(SubFamilyImage SubfamilyImage, string connectorFamilyImagePath)
        {
            try
            {
                string completePath = string.Format(@"{0}", connectorFamilyImagePath);
                string filePath = completePath + "\\" + SubfamilyImage.SavedFileName;
                if (connectorFamilyImagePath != null)
                {
                    if (!Directory.Exists(connectorFamilyImagePath))
                    {
                        return false;
                    }
                    else
                    {
                        if (File.Exists(filePath))
                        {
                            File.Delete(filePath);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error IsDeleteSubFamilyeImageFromPath_V2430()- Filename - {0}. ErrorMessage- {1}", SubfamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return true;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public bool UpdateConnectorSubFamilyImageToPath_V2430(Int32 IdFamily, SubFamilyImage ConnectorSubFamilyImage, string connectorFamilyImagePath)
        {
            if (ConnectorSubFamilyImage.SubFamilyImageInBytes != null)
            {
                try
                {
                    string filePath = connectorFamilyImagePath + "\\" + ConnectorSubFamilyImage.SavedFileName;

                    if (!Directory.Exists(connectorFamilyImagePath))
                    {
                        Directory.CreateDirectory(connectorFamilyImagePath);
                    }
                    else
                    {
                        DirectoryInfo di = new DirectoryInfo(connectorFamilyImagePath);
                        foreach (FileInfo file in di.GetFiles())
                        {
                            if (file.FullName == filePath)
                                file.Delete();
                        }
                    }
                    File.WriteAllBytes(filePath, ConnectorSubFamilyImage.SubFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error updateConnectorSubFamilyImageToPath_V2430()- Filename - {0}. ErrorMessage- {1}", ConnectorSubFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public bool ConnectorSubFamilyImageToPath_V2430(UInt16 IdFamily, SubFamilyImage ConnectorSubFamilyImage, string connectorSubFamilyImagePath)
        {
            if (ConnectorSubFamilyImage.SubFamilyImageInBytes != null)
            {
                try
                {
                    string filePath = connectorSubFamilyImagePath + "\\" + ConnectorSubFamilyImage.SavedFileName;

                    if (!Directory.Exists(connectorSubFamilyImagePath))
                    {
                        Directory.CreateDirectory(connectorSubFamilyImagePath);
                    }
                    File.WriteAllBytes(filePath, ConnectorSubFamilyImage.SubFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error ConnectorSubFamilyImageToPath_V2430()- Filename - {0}. ErrorMessage- {1}", ConnectorSubFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }
        //[rdixit][01.09.2023][GEOS2-4565]
        public void AddConnectorFamilyImages_V2430(string MainServerConnectionString, UInt16 IdFamily, List<FamilyImage> FamilyImageList, string connectorFamilyImagePath)
        {
            bool IsInserted = false;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    foreach (FamilyImage FamilyImage in FamilyImageList.Distinct())
                    {
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Family_Images_Insert_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_SavedFileName", FamilyImage.SavedFileName);
                        mySqlCommand.Parameters.AddWithValue("_Description", FamilyImage.Description);
                        mySqlCommand.Parameters.AddWithValue("_OriginalFileName", FamilyImage.OriginalFileName);
                        mySqlCommand.Parameters.AddWithValue("_ImagePosition", FamilyImage.Position);
                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", FamilyImage.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));

                        mySqlCommand.ExecuteNonQuery();

                        ConnectorFamilyImageToPath_V2430(IdFamily, FamilyImage, connectorFamilyImagePath);
                    }
                    mySqlConnection.Close();
                }
                IsInserted = true;

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilyImages_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }
        //[GEOS2-4564][rdixit][05.09.2023]
        public bool UpdateSubFamily_V2430(string connectionString, ConnectorSubFamily subFamily, string ConnectorFamilyImagePath)
        {
            try
            {
                string SubFamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.FamilyName + "\\" + subFamily.Name;
                if (subFamily != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();
                        string selectedfilename = subFamily.Name;
                        string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.FamilyName;
                        string destinationDirectory = ConnectorFamilyImagePath + FilePath + "\\" + subFamily.Name;
                        #region If Name changes path will also change
                        if (subFamily.OldSubFamilyName.ToLower() != subFamily.Name.ToLower())
                        {
                            string sourceDirectory = ConnectorFamilyImagePath + FilePath + "\\" + subFamily.OldSubFamilyName;
                            try
                            {
                                if (!Directory.Exists(destinationDirectory))
                                {
                                    Directory.CreateDirectory(destinationDirectory);
                                }
                                if (Directory.Exists(sourceDirectory))
                                {
                                    foreach (string file in Directory.GetFiles(sourceDirectory))
                                    {
                                        string fileName = Path.GetFileName(file);
                                        string destFile = Path.Combine(destinationDirectory, fileName);
                                        if (File.Exists(destFile))
                                        {
                                            File.Delete(destFile);
                                        }
                                        File.Copy(file, destFile);
                                    }
                                    Directory.Delete(sourceDirectory, true);
                                }
                            }
                            catch (Exception ex)
                            {
                                Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilyImages_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                            }
                        }
                        #endregion

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Update_Subfamily_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", subFamily.Id);
                        mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", subFamily.IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_Name", subFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", subFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", subFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", subFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", subFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", subFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", subFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", subFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", subFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", subFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", subFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", subFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", subFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", subFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", subFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();

                        if (subFamily.Id > 0)
                        {
                            if (subFamily.ImageList != null)
                            {
                                UpdateConnectorSubFamilyImages_V2430(connectionString, Convert.ToInt32(subFamily.Id), subFamily.ImageList.ToList(), ConnectorFamilyImagePath + FilePath + "\\" + subFamily.Name);
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateSubFamily_V2430().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return true;
        }
        //[GEOS2-4564][rdixit][05.09.2023]
        public bool InsertSubFamily_V2430(string connectionString, ConnectorSubFamily subFamily, string ConnectorFamilyImagePath)
        {
            try
            {
                if (subFamily != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();
                        string subfilePath = "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.FamilyName;
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_SubFamily_Insert", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_Name", subFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", subFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", subFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", subFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", subFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", subFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", subFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", subFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", subFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", subFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", subFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", subFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", subFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", subFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", subFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", subfilePath);
                        mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", subFamily.IdFamily);
                        subFamily.Id = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                        mySqlConnection.Close();

                        if (subFamily.Id > 0)
                        {
                            if (subFamily.ImageList?.Count > 0)
                            {
                                AddSubFamilyImageBySubFamily_V2430(connectionString, subFamily.Id, subFamily.ImageList, subfilePath + "\\" + subFamily.Name, ConnectorFamilyImagePath);
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error InsertSubFamily_V2430().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return true;
        }
        //[GEOS2-4564][rdixit][05.09.2023]
        static void CopyDirectory(string sourceDir, string destDir)
        {
            if (!Directory.Exists(destDir))
            {
                Directory.CreateDirectory(destDir);
            }

            // Get the files in the source directory and copy them to the destination
            foreach (string file in Directory.GetFiles(sourceDir))
            {
                string fileName = Path.GetFileName(file);
                string destFile = Path.Combine(destDir, fileName);
                if (File.Exists(destFile))
                {
                    File.Delete(destFile);
                }
                File.Copy(file, destFile);
            }
        }
        //[GEOS2-4564][rdixit][05.09.2023]
        public ConnectorSubFamily GetSubFamilyDetails(string localGeosConnectionString, int idSubFamily, string FamilyName, string FamiliesImagePath)
        {
            ConnectorSubFamily subFamily = new ConnectorSubFamily();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSubFamilyDetailsByIdSubFamily", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", idSubFamily);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            if (rdr["idConnectorSubfamily"] != DBNull.Value)
                            {
                                subFamily.Id = Convert.ToUInt16(rdr["idConnectorSubfamily"]);
                            }
                            if (rdr["idConnectorFamily"] != DBNull.Value)
                            {
                                subFamily.IdFamily = Convert.ToUInt16(rdr["idConnectorFamily"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                subFamily.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                subFamily.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                subFamily.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                subFamily.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                subFamily.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                subFamily.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                subFamily.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                subFamily.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["Description_fr"] != DBNull.Value)
                            {
                                subFamily.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            }
                            if (rdr["Description_es"] != DBNull.Value)
                            {
                                subFamily.Description_es = Convert.ToString(rdr["Description_es"]);
                            }
                            if (rdr["Description_pt"] != DBNull.Value)
                            {
                                subFamily.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            }
                            if (rdr["Description_ro"] != DBNull.Value)
                            {
                                subFamily.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            }
                            if (rdr["Description_zh"] != DBNull.Value)
                            {
                                subFamily.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            }
                            if (rdr["Description_ru"] != DBNull.Value)
                            {
                                subFamily.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                bool InUse = Convert.ToBoolean(rdr["InUse"]);
                                if (InUse)
                                    subFamily.IsInUse = "1";
                                else
                                    subFamily.IsInUse = "0";
                            }
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                            {
                                subFamily.Path = Convert.ToString(rdr["VisualAidPATH"]);
                            }
                            string subPath = FamiliesImagePath + subFamily.Path + "\\" + subFamily.Name;

                            subFamily.ImageList = new ObservableCollection<SubFamilyImage>(GetSubFamilyImageImagesByIdSubFamily_V2430(localGeosConnectionString, subFamily.Id, subPath));
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamilyDetails().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return subFamily;
        }

        #endregion

        //Shubham[skadam] GEOS2-4595 SCM - Search results (1/4) 08 09 2023 
        //public List<Connectors> GetAllConnectors(string SCMConnectionString,uint? IdCompany, uint? IdSubFamily, uint? IdFamily, uint? IdColor, uint? IdGender, Int32? IdShape)
        public List<Connectors> GetAllConnectors(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompany != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", Connectors.SelectedCompany.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", Connectors.SelectedFamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", Connectors.SelectedSubfamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColor != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", Connectors.SelectedColor.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGender != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", Connectors.SelectedGender.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);

                    if (!string.IsNullOrEmpty(Connectors.Ways))
                        mySqlCommand.Parameters.AddWithValue("_Cavities", Connectors.Ways);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Cavities", null);


                    if (!string.IsNullOrEmpty(Connectors.DiameterInternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", Connectors.DiameterInternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", null);

                    if (!string.IsNullOrEmpty(Connectors.DiameterExternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", Connectors.DiameterExternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", null);

                    if (!string.IsNullOrEmpty(Connectors.Height))
                        mySqlCommand.Parameters.AddWithValue("_height", Connectors.Height);
                    else
                        mySqlCommand.Parameters.AddWithValue("_height", null);

                    if (!string.IsNullOrEmpty(Connectors.Length))
                        mySqlCommand.Parameters.AddWithValue("_length", Connectors.Length);
                    else
                        mySqlCommand.Parameters.AddWithValue("_length", null);

                    if (!string.IsNullOrEmpty(Connectors.Width))
                        mySqlCommand.Parameters.AddWithValue("_width", Connectors.Width);
                    else
                        mySqlCommand.Parameters.AddWithValue("_width", null);

                    if (Connectors.IsSealingEnabled != null)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.IsSealingEnabled);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            //[rdixit][GEOS2-4602][13.09.2023]
                            if (reader["componentIdType"] != DBNull.Value)
                            {
                                connector.ComponentIdType = Convert.ToInt32(reader["componentIdType"]);
                            }
                            if (reader["componentIdColor"] != DBNull.Value)
                            {
                                connector.ComponentIdColor = Convert.ToUInt16(reader["componentIdColor"]);
                            }
                            if (reader["componentRef"] != DBNull.Value)
                            {
                                connector.ComponentRef = Convert.ToString(reader["componentRef"]);
                            }
                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            try
            {
                foreach (Connectors itemConnectors in ConnectorsList)
                {
                    itemConnectors.ConnectorsImagePath = string.Format(@"{0}\{1}", ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.FileName);
                    itemConnectors.ConnectorsImageInBytes = GetConnectorsImages(ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.FileName);
                }
            }
            catch (Exception ex)
            {

                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ConnectorsList;
        }
        //Shubham[skadam] GEOS2-4595 SCM - Search results (1/4) 08 09 2023 
        public byte[] GetConnectorsImages(string FamiliesImagePath, string SavedFileName)
        {
            byte[] bytes = null;
            string fileUploadPath = string.Empty;
            try
            {
                fileUploadPath = string.Format(@"{0}\{1}", FamiliesImagePath, SavedFileName);

                if (File.Exists(fileUploadPath))
                {
                    using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                    {
                        bytes = new byte[stream.Length];
                        int numBytesToRead = (int)stream.Length;
                        int numBytesRead = 0;

                        while (numBytesToRead > 0)
                        {
                            // Read may return anything from 0 to numBytesToRead.
                            int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                            // Break when the end of the file is reached.
                            if (n == 0)
                                break;

                            numBytesRead += n;
                            numBytesToRead -= n;
                        }
                    }
                }
                //}
                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorsImages(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }
        //Shubham[skadam] GEOS2-4596 SCM - Search results (2/4) 12 09 2023 
        public List<SCMConnectorImage> GetAllConnectorImages(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<SCMConnectorImage> ConnectorImages = new List<Common.SCM.SCMConnectorImage>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectorImages", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SCMConnectorImage connector = new SCMConnectorImage();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                connector.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                            }
                            if (Connectors.Ref != null)
                            {
                                connector.Ref = Convert.ToString(Connectors.Ref);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.SavedFileName = Convert.ToString(reader["FileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            ConnectorImages.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImages(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            try
            {
                foreach (SCMConnectorImage itemConnectors in ConnectorImages)
                {
                    itemConnectors.ImagePath = string.Format(@"{0}\{1}", ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);
                    itemConnectors.ConnectorsImageInBytes = GetConnectorsImages(ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImages(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ConnectorImages;
        }

        //[rdixit][14.09.2023][GEOS2-4602]
        public List<ComponentType> GetAllComponentTypes(string SCMConnectionString)
        {
            List<ComponentType> ComponentTypeList = new List<Common.SCM.ComponentType>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllComponentTypes", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            ComponentType ComponentType = new ComponentType();
                            if (reader["IdType"] != DBNull.Value)
                            {
                                ComponentType.IdType = Convert.ToInt32(reader["IdType"]);
                            }
                            if (reader["Name"] != DBNull.Value)
                            {
                                ComponentType.Name = Convert.ToString(reader["Name"]);
                            }
                            if (reader["Name_es"] != DBNull.Value)
                            {
                                ComponentType.Name_es = Convert.ToString(reader["Name_es"]);
                            }
                            if (reader["Name_fr"] != DBNull.Value)
                            {
                                ComponentType.Name_fr = Convert.ToString(reader["Name_fr"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                ComponentType.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Description_es"] != DBNull.Value)
                            {
                                ComponentType.Description_es = Convert.ToString(reader["Description_es"]);
                            }
                            if (reader["Description_fr"] != DBNull.Value)
                            {
                                ComponentType.Description_fr = Convert.ToString(reader["Description_fr"]);
                            }
                            if (reader["VisualAidPATH"] != DBNull.Value)
                            {
                                ComponentType.VisualAidPATH = Convert.ToString(reader["VisualAidPATH"]);
                            }
                            ComponentTypeList.Add(ComponentType);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllComponentTypes(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ComponentTypeList;
        }

        public List<CustomProperty> GetAllCustomeData(string SCMConnectionString)
        {
            List<CustomProperty> CustomPropertyList = new List<Common.SCM.CustomProperty>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllCustomData_V2440", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {

                            CustomProperty CustomProperty = new CustomProperty();
                            CustomProperty.ValueType = new Common.SCM.ValueType();
                            CustomProperty.ValueKey = new Common.SCM.ValueKey();
                            if (reader["IdCustomConnectorProperty"] != DBNull.Value)
                            {
                                CustomProperty.IdCustomConnectorProperty = Convert.ToInt32(reader["IdCustomConnectorProperty"]);
                            }
                            if (reader["Name"] != DBNull.Value)
                            {
                                CustomProperty.Name = Convert.ToString(reader["Name"]);
                            }
                            if (reader["IdConnectorType"] != DBNull.Value)
                            {
                                CustomProperty.IdConnectorType = Convert.ToInt32(reader["IdConnectorType"]);
                            }
                            if (reader["IdLookupKey"] != DBNull.Value)
                            {
                                CustomProperty.ValueKey.IdLookupKey = Convert.ToInt32(reader["IdLookupKey"]);
                            }
                            if (reader["Value"] != DBNull.Value)
                            {

                                CustomProperty.ValueKey.LookupKeyName = Convert.ToString(reader["Value"]);
                            }
                            if (reader["IdLookupValue"] != DBNull.Value)
                            {
                                CustomProperty.ValueType.IdLookupValue = Convert.ToInt32(reader["IdLookupValue"]);
                            }
                            if (reader["ConnectorTypeValue"] != DBNull.Value)
                            {

                                CustomProperty.ValueType.Name = Convert.ToString(reader["ConnectorTypeValue"]);
                            }


                            if (reader["IdConnectorCategory"] != DBNull.Value)
                            {
                                CustomProperty.IdConnectorCategory = Convert.ToInt32(reader["IdConnectorCategory"]);
                            }
                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                CustomProperty.IdFamily = Convert.ToInt32(reader["IdFamily"]);
                            }
                            CustomPropertyList.Add(CustomProperty);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllCustomeData(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return CustomPropertyList;
        }

        public List<Connectors> GetAllConnectors_V2440(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2440", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompany != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", Connectors.SelectedCompany.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", Connectors.SelectedFamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", Connectors.SelectedSubfamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColor != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", Connectors.SelectedColor.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGender != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", Connectors.SelectedGender.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);

                    if (!string.IsNullOrEmpty(Connectors.Ways))
                        mySqlCommand.Parameters.AddWithValue("_Cavities", Connectors.Ways);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Cavities", null);


                    if (!string.IsNullOrEmpty(Connectors.DiameterInternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", Connectors.DiameterInternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", null);

                    if (!string.IsNullOrEmpty(Connectors.DiameterExternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", Connectors.DiameterExternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", null);

                    if (!string.IsNullOrEmpty(Connectors.Height))
                        mySqlCommand.Parameters.AddWithValue("_height", Connectors.Height);
                    else
                        mySqlCommand.Parameters.AddWithValue("_height", null);

                    if (!string.IsNullOrEmpty(Connectors.Length))
                        mySqlCommand.Parameters.AddWithValue("_length", Connectors.Length);
                    else
                        mySqlCommand.Parameters.AddWithValue("_length", null);

                    if (!string.IsNullOrEmpty(Connectors.Width))
                        mySqlCommand.Parameters.AddWithValue("_width", Connectors.Width);
                    else
                        mySqlCommand.Parameters.AddWithValue("_width", null);

                    if (Connectors.IsSealingEnabled != null)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.IsSealingEnabled);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    if (Connectors.SelectedValueType.Count > 0)
                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", Connectors.CustomValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            //[rdixit][GEOS2-4602][13.09.2023]
                            if (reader["componentIdType"] != DBNull.Value)
                            {
                                connector.ComponentIdType = Convert.ToInt32(reader["componentIdType"]);
                            }
                            if (reader["componentIdColor"] != DBNull.Value)
                            {
                                connector.ComponentIdColor = Convert.ToUInt16(reader["componentIdColor"]);
                            }
                            if (reader["componentRef"] != DBNull.Value)
                            {
                                connector.ComponentRef = Convert.ToString(reader["componentRef"]);
                            }
                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2440(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            try
            {
                foreach (Connectors itemConnectors in ConnectorsList)
                {
                    itemConnectors.ConnectorsImagePath = string.Format(@"{0}\{1}", ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.FileName);
                    itemConnectors.ConnectorsImageInBytes = GetConnectorsImages(ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.FileName);
                }
            }
            catch (Exception ex)
            {

                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2440(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ConnectorsList;
        }

        #region [rdixit][GEOS2-4958][20.10.2023]
        public List<ConnectorFamily> GetConnectorFamilies_V2450(string MainServerConnectionString, string ConnectorFamiliesImagePath)
        {
            List<ConnectorFamily> connector = new List<ConnectorFamily>();
            List<int> IntList = new List<int>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GETConnectorFamilies_V2430", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorFamily connectorFamilies = new ConnectorFamily();
                            if (rdr["KeyName"] != DBNull.Value)
                                connectorFamilies.Key = Convert.ToString(rdr["KeyName"]);
                            if (rdr["SubfamilyID"] != DBNull.Value)
                                connectorFamilies.IdSubFamilyConnector = Convert.ToInt32(rdr["SubfamilyID"]);
                            if (rdr["ParentFamilyID"] != DBNull.Value)
                                connectorFamilies.IdFamily = Convert.ToInt32(rdr["ParentFamilyID"]);
                            if (rdr["Parent_Category"] != DBNull.Value)
                                connectorFamilies.Parent = Convert.ToString(rdr["Parent_Category"]);
                            if (rdr["Name"] != DBNull.Value)
                                connectorFamilies.Name = Convert.ToString(rdr["Name"]);
                            if (rdr["Name_es"] != DBNull.Value)
                                connectorFamilies.Name_es = Convert.ToString(rdr["Name_es"]);
                            if (rdr["Name_fr"] != DBNull.Value)
                                connectorFamilies.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            if (rdr["Name_pt"] != DBNull.Value)
                                connectorFamilies.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            if (rdr["Name_ro"] != DBNull.Value)
                                connectorFamilies.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            if (rdr["Name_ru"] != DBNull.Value)
                                connectorFamilies.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            if (rdr["Name_zh"] != DBNull.Value)
                                connectorFamilies.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            if (rdr["Description"] != DBNull.Value)
                                connectorFamilies.Description = Convert.ToString(rdr["Description"]);
                            if (rdr["Description_es"] != DBNull.Value)
                                connectorFamilies.Description_es = Convert.ToString(rdr["Description_es"]);
                            if (rdr["Description_fr"] != DBNull.Value)
                                connectorFamilies.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            if (rdr["Description_pt"] != DBNull.Value)
                                connectorFamilies.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            if (rdr["Description_ro"] != DBNull.Value)
                                connectorFamilies.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            if (rdr["Description_ru"] != DBNull.Value)
                                connectorFamilies.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            if (rdr["Description_zh"] != DBNull.Value)
                                connectorFamilies.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                                connectorFamilies.FilePath = Convert.ToString(rdr["VisualAidPATH"]);
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                sbyte InUseYesNoParent = Convert.ToSByte(rdr["InUse"]);
                                if (InUseYesNoParent == 1)
                                    connectorFamilies.IsInUse = "Yes";
                                else
                                    connectorFamilies.IsInUse = "No";
                            }
                            connector.Add(connectorFamilies);
                        }
                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamily selectedConnectorFamily = new ConnectorFamily();
                                if (Convert.ToUInt64(rdr["Position"]) == 1)
                                {
                                    List<ConnectorFamily> connectorFamiliesimageList = new List<ConnectorFamily>();
                                    selectedConnectorFamily = connector.FirstOrDefault(i => i.IdFamily == Convert.ToInt32(rdr["familyimageIdFamily"]) && i.IdSubFamilyConnector == 0);
                                    if (selectedConnectorFamily != null)
                                    {
                                        if (rdr["familyimageIdFamily"] != DBNull.Value)
                                            selectedConnectorFamily.IdFamilyimageIdFamily = Convert.ToInt32(rdr["familyimageIdFamily"]);
                                        if (rdr["IdSCMFamilyImage"] != DBNull.Value)
                                            selectedConnectorFamily.IdSCMFamilyImage = Convert.ToUInt64(rdr["IdSCMFamilyImage"]);
                                        if (rdr["SavedFileNameParent"] != DBNull.Value)
                                            selectedConnectorFamily.SavedFileNameParent = Convert.ToString(rdr["SavedFileNameParent"]);
                                        if (rdr["Position"] != DBNull.Value)
                                            selectedConnectorFamily.Position = Convert.ToUInt64(rdr["Position"]);

                                        selectedConnectorFamily.ConnectorFamilyImageInBytes = GetFamilyImage_V2450(selectedConnectorFamily.Name_es, ConnectorFamiliesImagePath, selectedConnectorFamily.SavedFileNameParent);
                                    }
                                }
                            }
                        }

                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamily selectedConnectorSubFamily = new ConnectorFamily();

                                if (Convert.ToUInt64(rdr["subfamilyPosition"]) == 1)
                                {
                                    string SubFolderPath = string.Empty;
                                    selectedConnectorSubFamily = connector.FirstOrDefault(i => i.IdSubFamilyConnector == Convert.ToInt64(rdr["IdSubFamily"]));
                                    if (selectedConnectorSubFamily != null)
                                    {
                                        if (rdr["subfamilyPosition"] != DBNull.Value)
                                            selectedConnectorSubFamily.Position = Convert.ToUInt64(rdr["subfamilyPosition"]);

                                        if (rdr["IdSubFamily"] != DBNull.Value)
                                            selectedConnectorSubFamily.IdSubFamilyConnector = Convert.ToInt32(rdr["IdSubFamily"]);

                                        if (rdr["IdSCMSubFamilyImage"] != DBNull.Value)
                                            selectedConnectorSubFamily.IdSCMSubFamilyImage = Convert.ToUInt64(rdr["IdSCMSubFamilyImage"]);

                                        if (rdr["SavedFileName"] != DBNull.Value)
                                            selectedConnectorSubFamily.SavedFileName = Convert.ToString(rdr["SavedFileName"]);

                                        if (rdr["OriginalFileName"] != DBNull.Value)
                                            selectedConnectorSubFamily.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);

                                        if (rdr["VisualAidPATH"] != DBNull.Value)
                                            SubFolderPath = Convert.ToString(rdr["VisualAidPATH"]);

                                        string subPath = ConnectorFamiliesImagePath + SubFolderPath;
                                        selectedConnectorSubFamily.ConnectorFamilyImageInBytes = GetSubFamilyImage_V2450(subPath, selectedConnectorSubFamily.SavedFileName);
                                    }
                                }
                            }
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorFamilies().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connector;
        }

        public List<SubFamilyImage> GetSubFamilyImageImagesByIdSubFamily_V2450(string SCMConnectionString, uint IdSubFamily, string FamiliesImagePath)
        {
            List<SubFamilyImage> FamilyImage = new List<SubFamilyImage>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyImagesByIdSubFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", IdSubFamily);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SubFamilyImage familyImage = new SubFamilyImage();

                            familyImage.IdSubFamilyImage = Convert.ToUInt32(reader["IdSCMSubFamilyImage"]);
                            familyImage.IdSubFamily = Convert.ToUInt16(reader["IdSubFamily"]);

                            if (reader["SavedFileName"] != DBNull.Value)
                            {
                                familyImage.SavedFileName = Convert.ToString(reader["SavedFileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                familyImage.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["OriginalFileName"] != DBNull.Value)
                            {
                                familyImage.OriginalFileName = Convert.ToString(reader["OriginalFileName"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                familyImage.Position = Convert.ToUInt64(reader["Position"]);
                            }

                            familyImage.SubFamilyImageInBytes = GetSubFamilyImage_V2450(FamiliesImagePath, familyImage.SavedFileName);
                            FamilyImage.Add(familyImage);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamilyImageImagesByIdSubFamily_V2450(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return FamilyImage;
        }

        public List<ConnectorSubFamily> GetSubFamily_V2450(string localGeosConnectionString, int IdFamily, string FamilyName, string FamiliesImagePath)
        {
            List<ConnectorSubFamily> subFamily = new List<ConnectorSubFamily>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSubFamilies_V2430", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", IdFamily);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorSubFamily family = new ConnectorSubFamily();
                            if (rdr["idConnectorSubfamily"] != DBNull.Value)
                            {
                                family.Id = Convert.ToUInt16(rdr["idConnectorSubfamily"]);
                            }
                            if (rdr["idConnectorFamily"] != DBNull.Value)
                            {
                                family.IdFamily = Convert.ToUInt16(rdr["idConnectorFamily"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                family.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                family.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                family.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                family.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                family.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                family.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                family.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                family.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["Description_fr"] != DBNull.Value)
                            {
                                family.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            }
                            if (rdr["Description_es"] != DBNull.Value)
                            {
                                family.Description_es = Convert.ToString(rdr["Description_es"]);
                            }
                            if (rdr["Description_pt"] != DBNull.Value)
                            {
                                family.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            }
                            if (rdr["Description_ro"] != DBNull.Value)
                            {
                                family.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            }
                            if (rdr["Description_zh"] != DBNull.Value)
                            {
                                family.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            }
                            if (rdr["Description_ru"] != DBNull.Value)
                            {
                                family.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                bool InUse = Convert.ToBoolean(rdr["InUse"]);
                                if (InUse)
                                    family.IsInUse = "1";
                                else
                                    family.IsInUse = "0";
                            }
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                            {
                                family.Path = Convert.ToString(rdr["VisualAidPATH"]);
                            }
                            string subPath = FamiliesImagePath + family.Path;

                            family.ImageList = new ObservableCollection<SubFamilyImage>(GetSubFamilyImageImagesByIdSubFamily_V2450(localGeosConnectionString, family.Id, subPath));

                            subFamily.Add(family)
;
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamily_V2430().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return subFamily;
        }
        public ConnectorSubFamily GetSubFamilyDetails_V2450(string localGeosConnectionString, int idSubFamily, string FamilyName, string FamiliesImagePath)
        {
            ConnectorSubFamily subFamily = new ConnectorSubFamily();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSubFamilyDetailsByIdSubFamily", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", idSubFamily);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            if (rdr["idConnectorSubfamily"] != DBNull.Value)
                            {
                                subFamily.Id = Convert.ToUInt16(rdr["idConnectorSubfamily"]);
                            }
                            if (rdr["idConnectorFamily"] != DBNull.Value)
                            {
                                subFamily.IdFamily = Convert.ToUInt16(rdr["idConnectorFamily"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                subFamily.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                subFamily.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                subFamily.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                subFamily.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                subFamily.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                subFamily.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                subFamily.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                subFamily.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["Description_fr"] != DBNull.Value)
                            {
                                subFamily.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            }
                            if (rdr["Description_es"] != DBNull.Value)
                            {
                                subFamily.Description_es = Convert.ToString(rdr["Description_es"]);
                            }
                            if (rdr["Description_pt"] != DBNull.Value)
                            {
                                subFamily.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            }
                            if (rdr["Description_ro"] != DBNull.Value)
                            {
                                subFamily.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            }
                            if (rdr["Description_zh"] != DBNull.Value)
                            {
                                subFamily.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            }
                            if (rdr["Description_ru"] != DBNull.Value)
                            {
                                subFamily.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                bool InUse = Convert.ToBoolean(rdr["InUse"]);
                                if (InUse)
                                    subFamily.IsInUse = "1";
                                else
                                    subFamily.IsInUse = "0";
                            }
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                            {
                                subFamily.Path = Convert.ToString(rdr["VisualAidPATH"]);
                            }
                            string subPath = FamiliesImagePath + subFamily.Path;

                            subFamily.ImageList = new ObservableCollection<SubFamilyImage>(GetSubFamilyImageImagesByIdSubFamily_V2450(localGeosConnectionString, subFamily.Id, subPath));
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamilyDetails().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return subFamily;
        }

        public byte[] GetSubFamilyImage_V2450(string FamiliesImagePath, string SavedFileName)
        {
            byte[] bytes = null;
            string fileUploadPath = string.Empty;
            try
            {

                fileUploadPath = Path.Combine(FamiliesImagePath, SavedFileName);

                if (File.Exists(fileUploadPath))
                {
                    using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                    {
                        bytes = new byte[stream.Length];
                        int numBytesToRead = (int)stream.Length;
                        int numBytesRead = 0;

                        while (numBytesToRead > 0)
                        {
                            // Read may return anything from 0 to numBytesToRead.
                            int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                            // Break when the end of the file is reached.
                            if (n == 0)
                                break;

                            numBytesRead += n;
                            numBytesToRead -= n;
                        }
                    }
                }
                //}
                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamilyImage_V2450(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        public List<FamilyImage> GetFamilyImageImagesByIdFamily_V2450(string SCMConnectionString, int idFamily, string familyName, string FamiliesImagePath)
        {
            List<FamilyImage> FamilyImage = new List<FamilyImage>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyImagesByIdFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", idFamily);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            FamilyImage familyImage = new FamilyImage();

                            familyImage.IdSCMFamilyImage = Convert.ToUInt32(reader["IdSCMFamilyImage"]);
                            familyImage.IdFamily = Convert.ToUInt16(reader["IdFamily"]);

                            if (reader["SavedFileName"] != DBNull.Value)
                            {
                                familyImage.SavedFileName = Convert.ToString(reader["SavedFileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                familyImage.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["OriginalFileName"] != DBNull.Value)
                            {
                                familyImage.OriginalFileName = Convert.ToString(reader["OriginalFileName"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                familyImage.Position = Convert.ToUInt64(reader["Position"]);
                            }

                            familyImage.ConnectorFamilyImageInBytes = GetFamilyImage_V2450(familyName, FamiliesImagePath, familyImage.SavedFileName);
                            FamilyImage.Add(familyImage);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetFamilyImageImagesByIdFamily_V2450(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return FamilyImage;
        }

        public byte[] GetFamilyImage_V2450(string familyName, string FamiliesImagePath, string SavedFileName)
        {
            byte[] bytes = null;
            string fileUploadPath = string.Empty;
            try
            {
                fileUploadPath = Path.Combine(FamiliesImagePath, "EXTRAS\\Familiy&Subfamily", familyName, SavedFileName);

                if (File.Exists(fileUploadPath))
                {
                    using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                    {
                        bytes = new byte[stream.Length];
                        int numBytesToRead = (int)stream.Length;
                        int numBytesRead = 0;

                        while (numBytesToRead > 0)
                        {
                            // Read may return anything from 0 to numBytesToRead.
                            int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                            // Break when the end of the file is reached.
                            if (n == 0)
                                break;

                            numBytesRead += n;
                            numBytesToRead -= n;
                        }
                    }
                }
                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetFamilyImage_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        public List<Family> GetAllFamilies_V2450(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<Family> lstFamily = new List<Family>();
            Family family;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllFamilies_V2450", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                family = new Family();
                                family.Id = Convert.ToUInt16(rdr["IdFamily"]);
                                family.Name = Convert.ToString(rdr["Name"]);
                                family.Name_es = Convert.ToString(rdr["Name_es"]);
                                lstFamily.Add(family);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstFamily;
            }
        }

        public bool InsertSubFamily_V2450(string connectionString, ConnectorSubFamily subFamily, string ConnectorFamilyImagePath)
        {
            try
            {
                if (subFamily != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();
                        string subfilePath = Path.Combine("\\EXTRAS\\Familiy&Subfamily\\", subFamily.FamilyName, subFamily.Name_es);
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_SubFamily_Insert", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_Name", subFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", subFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", subFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", subFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", subFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", subFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", subFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", subFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", subFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", subFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", subFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", subFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", subFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", subFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", subFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", subfilePath);
                        mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", subFamily.IdFamily);
                        subFamily.Id = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                        mySqlConnection.Close();

                        if (subFamily.Id > 0)
                        {
                            if (subFamily.ImageList?.Count > 0)
                            {
                                AddSubFamilyImageBySubFamily_V2430(connectionString, subFamily.Id, subFamily.ImageList, subfilePath, ConnectorFamilyImagePath);
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error InsertSubFamily_V2450().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return true;
        }

        public ConnectorFamily AddConnectorFamilies_V2450(string MainServerConnectionString, ConnectorFamily ConnectorFamily, string ConnectorFamilyImagePath)
        {
            bool IsInserted = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    string FamiliesImagePath = string.Empty;
                    FamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name_es;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name_es;
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Insert_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", ConnectorFamily.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        ConnectorFamily.IdFamily = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                        IsInserted = true;
                        mySqlConnection.Close();
                    }
                    if (ConnectorFamily.FamilyImagesList?.Count > 0)
                    {
                        AddConnectorFamilyImages_V2430(MainServerConnectionString, Convert.ToUInt16(ConnectorFamily.IdFamily), ConnectorFamily.FamilyImagesList, FamiliesImagePath);
                    }
                    if (ConnectorFamily.SubFamilyList?.Count > 0)
                    {
                        foreach (var item in ConnectorFamily.SubFamilyList)
                        {
                            item.IdFamily = (uint)ConnectorFamily.IdFamily;
                            if (item.TransactionOperation == ModelBase.TransactionOperations.Add)
                                InsertSubFamily_V2450(MainServerConnectionString, item, ConnectorFamilyImagePath);
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilies_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }

            return ConnectorFamily;
        }

        public ConnectorFamily UpdateConnectorFamilies_V2450(string MainServerConnectionString, ConnectorFamily ConnectorFamily, string ConnectorFamilyImagePath)
        {
            bool IsUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    string destinationDirectory = string.Empty;
                    destinationDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name_es;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name_es;
                    #region If Name changes path will also change
                    if (ConnectorFamily.OldName.ToLower() != ConnectorFamily.Name_es.ToLower())
                    {
                        string sourceDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.OldName;
                        try
                        {
                            // Create the destination directory if it doesn't exist
                            if (!Directory.Exists(destinationDirectory))
                            {
                                Directory.CreateDirectory(destinationDirectory);
                            }
                            if (Directory.Exists(sourceDirectory))
                            {
                                foreach (string file in Directory.GetFiles(sourceDirectory))
                                {
                                    string fileName = Path.GetFileName(file);
                                    string destFile = Path.Combine(destinationDirectory, fileName);
                                    if (File.Exists(destFile))
                                    {
                                        File.Delete(destFile);
                                    }
                                    File.Copy(file, destFile);
                                }
                                string[] subdirectories = Directory.GetDirectories(sourceDirectory);
                                foreach (string subdirectory in subdirectories)
                                {
                                    string subdirectoryName = Path.GetFileName(subdirectory);
                                    string destinationSubdirectory = Path.Combine(destinationDirectory, subdirectoryName);
                                    CopyDirectory(subdirectory, destinationSubdirectory);
                                }
                                Directory.Delete(sourceDirectory, true);
                            }
                        }
                        catch (Exception ex)
                        {
                            Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilyImages_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                        }
                    }
                    #endregion

                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Update_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdFamily", ConnectorFamily.IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_ModifiedBy", ConnectorFamily.ModifiedBy);
                        mySqlCommand.Parameters.AddWithValue("_ModifiedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.ExecuteNonQuery();
                        IsUpdated = true;
                        mySqlConnection.Close();

                        if (ConnectorFamily.IdFamily > 0 && ConnectorFamily.FamilyImagesList?.Count > 0)
                        {
                            if (ConnectorFamily.FamilyImagesList.Any(i => i.TransactionOperation == ModelBase.TransactionOperations.Add || i.TransactionOperation == ModelBase.TransactionOperations.Delete || i.TransactionOperation == ModelBase.TransactionOperations.Update))
                                UpdateConnectorFamilyImages_V2430(MainServerConnectionString, ConnectorFamily.IdFamily, ConnectorFamily.FamilyImagesList, destinationDirectory);
                        }
                        if (ConnectorFamily.SubFamilyList?.Count > 0)
                        {
                            foreach (var item in ConnectorFamily.SubFamilyList)
                            {
                                if (item.TransactionOperation == ModelBase.TransactionOperations.Update)
                                    UpdateSubFamily_V2450(MainServerConnectionString, item, ConnectorFamilyImagePath);
                                else if (item.TransactionOperation == ModelBase.TransactionOperations.Add)
                                    InsertSubFamily_V2450(MainServerConnectionString, item, ConnectorFamilyImagePath);
                            }
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilies_V2450(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return ConnectorFamily;
        }

        public bool UpdateSubFamily_V2450(string connectionString, ConnectorSubFamily subFamily, string ConnectorFamilyImagePath)
        {
            try
            {
                string SubFamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.FamilyName + "\\" + subFamily.Name_es;
                if (subFamily != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();
                        string selectedfilename = subFamily.Name;
                        string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.FamilyName + "\\" + subFamily.Name_es;
                        string destinationDirectory = ConnectorFamilyImagePath + FilePath;
                        string sourceDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.FamilyName + "\\" + subFamily.OldSubFamilyName;
                        #region If Name changes path will also change
                        if (!string.IsNullOrEmpty(subFamily.OldSubFamilyName) && !string.IsNullOrEmpty(subFamily.Name_es))
                        {
                            if (subFamily.OldSubFamilyName.ToLower() != subFamily.Name_es.ToLower())
                            {
                                try
                                {
                                    if (!Directory.Exists(destinationDirectory))
                                    {
                                        Directory.CreateDirectory(destinationDirectory);
                                    }
                                    if (Directory.Exists(sourceDirectory))
                                    {
                                        foreach (string file in Directory.GetFiles(sourceDirectory))
                                        {
                                            string fileName = Path.GetFileName(file);
                                            string destFile = Path.Combine(destinationDirectory, fileName);
                                            if (File.Exists(destFile))
                                            {
                                                File.Delete(destFile);
                                            }
                                            File.Copy(file, destFile);
                                        }
                                        Directory.Delete(sourceDirectory, true);
                                    }
                                }
                                catch (Exception ex)
                                {
                                    Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilyImages_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                }
                            }
                        }
                        #endregion

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Update_Subfamily_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", subFamily.Id);
                        mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", subFamily.IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_Name", subFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", subFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", subFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", subFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", subFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", subFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", subFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", subFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", subFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", subFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", subFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", subFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", subFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", subFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", subFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();

                        if (subFamily.Id > 0)
                        {
                            if (subFamily.ImageList != null)
                            {
                                UpdateConnectorSubFamilyImages_V2430(connectionString, Convert.ToInt32(subFamily.Id), subFamily.ImageList.ToList(), ConnectorFamilyImagePath + FilePath);
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateSubFamily_V2450().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return true;
        }
        #endregion

        //[rdixit][29.11.2023][GEOS2-4955]
        public List<ConnectorProperties> GetPropertyManager_V2460(string MainServerConnectionString)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorPropertiesByFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();
                            property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                            property.IdFamily = Convert.ToUInt32(rdr["IdFamily"]);
                            property.IsEnabled = Convert.ToBoolean(rdr["IsEnabled"]);
                            if (rdr["DefaultValue"] != DBNull.Value)
                                property.DefaultValue = Convert.ToString(rdr["DefaultValue"]);
                            if (rdr["Min_Value"] != DBNull.Value)
                            {
                                property.MinValueNew = Convert.ToString(rdr["Min_Value"]);
                            }
                            if (rdr["Max_Value"] != DBNull.Value)
                            {
                                property.MaxValueNew = Convert.ToString(rdr["Max_Value"]);
                            }

                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetPropertyManager_V2460().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }

        //[rdixit][29.11.2023][GEOS2-4955]
        public void AddPropertyManager_V2460(string MainServerConnectionString, List<ConnectorProperties> connectorProperty)
        {
            try
            {
                if (connectorProperty != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConnectorProperties property in connectorProperty)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorPropertiesByFamily", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdConnectorProperty", property.IdConnectorProperty);
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", property.IdFamily);
                            mySqlCommand.Parameters.AddWithValue("_IsEnabled", property.IsEnabled);
                            if (string.IsNullOrEmpty(property.DefaultValue))
                                mySqlCommand.Parameters.AddWithValue("_DefaultValue", DBNull.Value);
                            else
                                mySqlCommand.Parameters.AddWithValue("_DefaultValue", property.DefaultValue);

                            if (string.IsNullOrEmpty(property.MinValueNew))
                                mySqlCommand.Parameters.AddWithValue("_Min_Value", DBNull.Value);
                            else
                                mySqlCommand.Parameters.AddWithValue("_Min_Value", property.MinValueNew);

                            if (string.IsNullOrEmpty(property.MaxValueNew))
                                mySqlCommand.Parameters.AddWithValue("_Max_Value", DBNull.Value);
                            else
                                mySqlCommand.Parameters.AddWithValue("_Max_Value", property.MaxValueNew);

                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddPropertyManager_V2460().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }




        //[Sudhir.Jangra][GEOS2-4973]
        public List<Family> GetFamiliesForSearchFamilyConfiguration_V2460(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<Family> lstFamily = new List<Family>();
            Family family;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("GetFamiliesForSearchFamilyConfiguration_V2460", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                family = new Family();
                                family.Id = Convert.ToUInt16(rdr["IdFamily"]);
                                family.Name = Convert.ToString(rdr["Name"]);
                                family.Name_es = Convert.ToString(rdr["Name_es"]);
                                lstFamily.Add(family);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstFamily;
            }
        }


        //[Sudhir.Jangra][GEOS2-4973]
        public List<Family> GetConfigurationsForSearchFilters_V2460(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<Family> lstFamily = new List<Family>();
            Family family;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("GetConfigurationForSearchFilters_V2460", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                family = new Family();
                                family.Id = Convert.ToUInt16(rdr["IdFamily"]);
                                family.Name = Convert.ToString(rdr["Name"]);
                                family.Name_es = Convert.ToString(rdr["Name_es"]);
                                lstFamily.Add(family);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstFamily;
            }
        }

        //[rdixit][GEOS2-4951][08.12.2023]
        public List<Connectors> GetAllConnectors_V2460(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2460", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompany != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", Connectors.SelectedCompany.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", Connectors.SelectedFamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", Connectors.SelectedSubfamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColor != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", Connectors.SelectedColor.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGender != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", Connectors.SelectedGender.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);

                    if (!string.IsNullOrEmpty(Connectors.Ways))
                        mySqlCommand.Parameters.AddWithValue("_Cavities", Connectors.Ways);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Cavities", null);


                    if (!string.IsNullOrEmpty(Connectors.DiameterInternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", Connectors.DiameterInternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", null);

                    if (!string.IsNullOrEmpty(Connectors.DiameterExternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", Connectors.DiameterExternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", null);

                    if (!string.IsNullOrEmpty(Connectors.Height))
                        mySqlCommand.Parameters.AddWithValue("_height", Connectors.Height);
                    else
                        mySqlCommand.Parameters.AddWithValue("_height", null);

                    if (!string.IsNullOrEmpty(Connectors.Length))
                        mySqlCommand.Parameters.AddWithValue("_length", Connectors.Length);
                    else
                        mySqlCommand.Parameters.AddWithValue("_length", null);

                    if (!string.IsNullOrEmpty(Connectors.Width))
                        mySqlCommand.Parameters.AddWithValue("_width", Connectors.Width);
                    else
                        mySqlCommand.Parameters.AddWithValue("_width", null);

                    if (Connectors.IsSealingEnabled != null)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.IsSealingEnabled);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    if (Connectors.SelectedValueType.Count > 0)
                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", Connectors.CustomValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            //[rdixit][GEOS2-4602][13.09.2023]
                            if (reader["componentIdType"] != DBNull.Value)
                            {
                                connector.ComponentIdType = Convert.ToInt32(reader["componentIdType"]);
                            }
                            if (reader["componentIdColor"] != DBNull.Value)
                            {
                                connector.ComponentIdColor = Convert.ToUInt16(reader["componentIdColor"]);
                            }
                            if (reader["componentRef"] != DBNull.Value)
                            {
                                connector.ComponentRef = Convert.ToString(reader["componentRef"]);
                            }
                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2440(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }

        //[rdixit][GEOS2-4951][08.12.2023]
        public List<SCMConnectorImage> GetAllConnectorImages_V2460(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<SCMConnectorImage> ConnectorImages = new List<Common.SCM.SCMConnectorImage>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectorImagesForImageSection_V2510", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SCMConnectorImage connector = new SCMConnectorImage();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                connector.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                            }
                            if (Connectors.Ref != null)
                            {
                                connector.Ref = Convert.ToString(Connectors.Ref);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.SavedFileName = Convert.ToString(reader["FileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            ConnectorImages.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImages(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            try
            {
                foreach (SCMConnectorImage itemConnectors in ConnectorImages)
                {
                    // itemConnectors.ImagePath = string.Format(@"{0}\{1}", ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);                                    
                    // itemConnectors.ConnectorsImageInBytes = GetConnectorsImages(ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);
                    itemConnectors.ImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + itemConnectors.Ref + "/" + itemConnectors.SavedFileName;

                    if (!string.IsNullOrEmpty(itemConnectors.ImagePath))
                    {
                        //using (WebClient webClient = new WebClient())
                        //{
                        //    itemConnectors.ConnectorsImageInBytes = webClient.DownloadData(itemConnectors.ImagePath);
                        //}
                        itemConnectors.ConnectorsImageInBytes = Utility.ImageUtil.GetImageByWebClient(itemConnectors.ImagePath);
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImages(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ConnectorImages;
        }

        #region [rdixit][GEOS2-4973][14.12.2023]
        public List<ConfigurationFamily> GetConfigurationsForSearchFilters_V2460(string localGeosConnectionString)
        {
            TransactionScope transactionScope = null;
            List<ConfigurationFamily> lstFamily = new List<ConfigurationFamily>();
            ConfigurationFamily family;
            using (transactionScope = new TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("GetConfigurationForSearchFilters_2460", connActivity);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                family = new ConfigurationFamily();
                                if (rdr["IdFamily"] != DBNull.Value)
                                    family.IdFamily = Convert.ToUInt16(rdr["IdFamily"]);
                                if (rdr["Name"] != DBNull.Value)
                                    family.NameFamily = Convert.ToString(rdr["Name"]);
                                if (rdr["WaysPages"] != DBNull.Value)
                                    family.WaysPages = Convert.ToString(rdr["WaysPages"]);
                                if (rdr["ColorPages"] != DBNull.Value)
                                    family.ColorPages = Convert.ToString(rdr["ColorPages"]);
                                if (rdr["ComponentsPages"] != DBNull.Value)
                                    family.CompPages = Convert.ToString(rdr["ComponentsPages"]);
                                if (rdr["SizePages"] != DBNull.Value)
                                    family.SizePages = Convert.ToString(rdr["SizePages"]);
                                if (rdr["ReferencePages"] != DBNull.Value)
                                    family.RefPages = Convert.ToString(rdr["ReferencePages"]);
                                if (rdr["NumberOfPages"] != DBNull.Value)
                                    family.NoOfPages = Convert.ToInt32(rdr["NumberOfPages"]);
                                if (rdr["IdSearchConfiguration"] != DBNull.Value)
                                    family.IdSearchConfiguration = Convert.ToInt32(rdr["IdSearchConfiguration"]);
                                lstFamily.Add(family);
                            }
                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));
                                    if (selectedConfig != null)
                                    {
                                        if (rdr["Margin"] != DBNull.Value)
                                            selectedConfig.WayMargin = Convert.ToInt32(rdr["Margin"]);
                                        if (rdr["IdNumberMargin"] != DBNull.Value)
                                            selectedConfig.IdWayMargin = Convert.ToInt32(rdr["IdNumberMargin"]);
                                    }
                                }
                            }

                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));

                                    if (selectedConfig != null)
                                    {
                                        if (rdr["height"] != DBNull.Value)
                                            selectedConfig.Height = Convert.ToInt32(rdr["height"]);
                                        if (rdr["width"] != DBNull.Value)
                                            selectedConfig.Width = Convert.ToInt32(rdr["width"]);
                                        if (rdr["length"] != DBNull.Value)
                                            selectedConfig.Length = Convert.ToInt32(rdr["length"]);
                                        if (rdr["internal"] != DBNull.Value)
                                            selectedConfig.Internal = Convert.ToInt32(rdr["internal"]);
                                        if (rdr["external"] != DBNull.Value)
                                            selectedConfig.External = Convert.ToInt32(rdr["external"]);
                                    }
                                }
                            }

                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));

                                    if (selectedConfig != null)
                                    {
                                        if (selectedConfig.SimilarCharactersList == null)
                                            selectedConfig.SimilarCharactersList = new List<SimilarCharactersByConfiguration>();

                                        SimilarCharactersByConfiguration reference = new SimilarCharactersByConfiguration();

                                        if (rdr["IdSearchConfiguration"] != DBNull.Value)
                                            reference.IdSearchConfiguration = Convert.ToUInt16(rdr["IdSearchConfiguration"]);
                                        if (rdr["CharacterA"] != DBNull.Value)
                                            reference.CharacterA = Convert.ToString(rdr["CharacterA"]);
                                        if (rdr["CharacterB"] != DBNull.Value)
                                            reference.CharacterB = Convert.ToString(rdr["CharacterB"]);
                                        if (rdr["Description"] != DBNull.Value)
                                            reference.Description = Convert.ToString(rdr["Description"]);
                                        selectedConfig.SimilarCharactersList.Add(reference);
                                    }
                                }
                            }
                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));
                                    if (selectedConfig != null)
                                    {
                                        if (selectedConfig.ColorSimilarityList == null)
                                            selectedConfig.ColorSimilarityList = new List<SimilarColorsByConfiguration>();

                                        SimilarColorsByConfiguration color = new SimilarColorsByConfiguration();

                                        if (rdr["IdSearchConfiguration"] != DBNull.Value)
                                            color.IdSearchConfiguration = Convert.ToUInt16(rdr["IdSearchConfiguration"]);
                                        if (rdr["IdColorA"] != DBNull.Value)
                                            color.IdColorA = Convert.ToInt32(rdr["IdColorA"]);
                                        selectedConfig.IdColor = color.IdColorA;
                                        if (rdr["IdColorB"] != DBNull.Value)
                                            color.IdColorB = Convert.ToInt32(rdr["IdColorB"]);
                                        selectedConfig.ColorSimilarityList.Add(color);
                                    }
                                }
                            }
                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));
                                    if (selectedConfig != null)
                                    {
                                        if (selectedConfig.ComponentsList == null)
                                            selectedConfig.ComponentsList = new List<ComponentsByConfiguration>();

                                        ComponentsByConfiguration component = new ComponentsByConfiguration();

                                        if (rdr["IdSearchConfiguration"] != DBNull.Value)
                                            component.IdSearchConfiguration = Convert.ToUInt16(rdr["IdSearchConfiguration"]);
                                        if (rdr["IdColor"] != DBNull.Value)
                                            component.IdColor = Convert.ToInt32(rdr["IdColor"]);
                                        if (rdr["IdType"] != DBNull.Value)
                                            component.IdType = Convert.ToInt32(rdr["IdType"]);
                                        var con = 0;
                                        if (rdr["Condition"] != DBNull.Value)
                                            con = Convert.ToInt32(rdr["Condition"]);
                                        if (con == 1)
                                            component.SelectedCondition = "IS";
                                        else
                                            component.SelectedCondition = "NOT";
                                        if (rdr["Reference"] != DBNull.Value)
                                            component.Reference = Convert.ToString(rdr["Reference"]);
                                        selectedConfig.ComponentsList.Add(component);
                                    }
                                }
                            }
                        }
                        connActivity.Close();

                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddPropertyManager_V2460().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }

                return lstFamily;
            }
        }

        public bool SaveConfigurationsForSearchFilters(List<ConfigurationFamily> configurationList, string mainServerConnectionString)
        {
            bool isUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(mainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConfigurationFamily item in configurationList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertSearchConfiguration_V2460", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("p_IdFamily", item.IdFamily);
                            mySqlCommand.Parameters.AddWithValue("p_NumberOfPages", item.NoOfPages);
                            mySqlCommand.Parameters.AddWithValue("p_ReferencePages", item.RefPages);
                            mySqlCommand.Parameters.AddWithValue("p_ColorPages", item.ColorPages);
                            mySqlCommand.Parameters.AddWithValue("p_SizePages", item.SizePages);
                            mySqlCommand.Parameters.AddWithValue("p_ComponentsPages", item.CompPages);
                            mySqlCommand.Parameters.AddWithValue("p_WaysPages", item.WaysPages);
                            item.IdSearchConfiguration = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                            mySqlCommand.ExecuteNonQuery();
                            mySqlConnection.Close();

                            if (item.SimilarCharactersList != null)
                            {
                                item.SimilarCharactersList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddCharactersByConfiguration(mainServerConnectionString, item.SimilarCharactersList, item.IdSearchConfiguration);
                            }

                            if (item.ColorSimilarityList != null)
                            {
                                item.ColorSimilarityList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddColorsByConfiguration(mainServerConnectionString, item.ColorSimilarityList, item.IdSearchConfiguration, item.IdColor);
                            }

                            if (item.ComponentsList != null)
                            {
                                item.ComponentsList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddComponentsByConfiguration(mainServerConnectionString, item.ComponentsList, item.IdSearchConfiguration);
                            }
                            AddWaysMarginByConfiguration(mainServerConnectionString, item);
                            AddSizeDiameterByConfiguration(mainServerConnectionString, item);
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                    isUpdated = true;
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    Log4NetLogger.Logger.Log(string.Format("Error SaveConfigurationsForSearchFilters() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    throw;
                }
            }
            return isUpdated;
        }

        public void AddCharactersByConfiguration(string MainServerConnectionString, List<SimilarCharactersByConfiguration> ReferenceList, Int32 idSearchConfiguration)
        {
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_Deletesimilarcharactersbyconfiguration_V2460", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", idSearchConfiguration);
                    mySqlCommand.ExecuteNonQuery();
                    mySqlConnection.Close();
                }

                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    foreach (SimilarCharactersByConfiguration item in ReferenceList)
                    {
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Insertsimilarcharactersbyconfiguration_V2460", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", item.IdSearchConfiguration);
                        mySqlCommand.Parameters.AddWithValue("p_CharacterA", item.CharacterA);
                        mySqlCommand.Parameters.AddWithValue("p_CharacterB", item.CharacterB);
                        mySqlCommand.Parameters.AddWithValue("p_Description", item.Description);
                        mySqlCommand.Parameters.AddWithValue("p_CreatedBy", item.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("p_ModifiedBy", item.ModifiedBy);
                        mySqlCommand.ExecuteNonQuery();
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddCharactersByConfiguration() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        public void AddColorsByConfiguration(string MainServerConnectionString, List<SimilarColorsByConfiguration> ColorsList, Int32 idSearchConfiguration, Int32 idColorA)
        {
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_Deletesimilarcolorsbyconfiguration_V2460", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", idSearchConfiguration);
                    mySqlCommand.ExecuteNonQuery();
                    mySqlConnection.Close();
                }
                if (ColorsList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (SimilarColorsByConfiguration item in ColorsList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_Insertsimilarcolorsbyconfiguration_V2460", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", item.IdSearchConfiguration);
                            mySqlCommand.Parameters.AddWithValue("p_IdColorA", idColorA);
                            mySqlCommand.Parameters.AddWithValue("p_IdColorB", item.SelectedColor?.Id);
                            mySqlCommand.Parameters.AddWithValue("p_CreatedBy", item.CreatedBy);
                            mySqlCommand.Parameters.AddWithValue("p_ModifiedBy", item.ModifiedBy);
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddColorsByConfiguration() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        public void AddComponentsByConfiguration(string MainServerConnectionString, List<ComponentsByConfiguration> ComponentList, Int32 idSearchConfiguration)
        {
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteComponentsbyConfiguration_V2460", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", idSearchConfiguration);
                    mySqlCommand.ExecuteNonQuery();
                    mySqlConnection.Close();
                }
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    foreach (ComponentsByConfiguration item in ComponentList)
                    {
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertComponentsbyConfiguration_V2460", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", item.IdSearchConfiguration);
                        mySqlCommand.Parameters.AddWithValue("p_Condition", item.SelectedCondition == "IS" ? 1 : 0);
                        mySqlCommand.Parameters.AddWithValue("p_IdColor", item.SelectedColor?.Id);
                        mySqlCommand.Parameters.AddWithValue("p_IdType", item.SelectedComponentType?.IdType);
                        mySqlCommand.Parameters.AddWithValue("p_Reference", item.Reference);
                        mySqlCommand.Parameters.AddWithValue("p_CreatedBy", item.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("p_ModifiedBy", item.ModifiedBy);
                        mySqlCommand.ExecuteNonQuery();
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddComponentsByConfiguration() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        public void AddWaysMarginByConfiguration(string MainServerConnectionString, ConfigurationFamily Configuration)
        {
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertNumbersmarginbyconfiguration_V2460", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", Configuration.IdSearchConfiguration);
                    mySqlCommand.Parameters.AddWithValue("p_Margin", Configuration.WayMargin);
                    mySqlCommand.Parameters.AddWithValue("p_CreatedBy", Configuration.CreatedBy);
                    mySqlCommand.Parameters.AddWithValue("p_ModifiedBy", Configuration.ModifiedBy);
                    mySqlCommand.ExecuteNonQuery();
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddWaysMarginByConfiguration() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        public void AddSizeDiameterByConfiguration(string MainServerConnectionString, ConfigurationFamily Configuration)
        {
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertDiameterSizeByConfiguration_V2460", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", Configuration.IdSearchConfiguration);
                    mySqlCommand.Parameters.AddWithValue("p_external", Configuration.External);
                    mySqlCommand.Parameters.AddWithValue("p_internal", Configuration.Internal);
                    mySqlCommand.Parameters.AddWithValue("p_height", Configuration.Height);
                    mySqlCommand.Parameters.AddWithValue("p_length", Configuration.Length);
                    mySqlCommand.Parameters.AddWithValue("p_width", Configuration.Width);
                    mySqlCommand.ExecuteNonQuery();
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddSizeDiameterByConfiguration() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }//rajashri GEOS2-4956  //rajashri
        public ConnectorFamily GetFamilyDetails_V2470(string localGeosConnectionString, int idFamily)
        {
            ConnectorFamily Family = new ConnectorFamily();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyDetailsByIdFamily_V2470", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdConnectorFamily", idFamily);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            if (rdr["IdFamily"] != DBNull.Value)
                            {
                                Family.IdFamily = Convert.ToUInt16(rdr["IdFamily"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                Family.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                Family.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                Family.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                Family.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                Family.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                Family.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                Family.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                Family.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["Description_fr"] != DBNull.Value)
                            {
                                Family.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            }
                            if (rdr["Description_es"] != DBNull.Value)
                            {
                                Family.Description_es = Convert.ToString(rdr["Description_es"]);
                            }
                            if (rdr["Description_pt"] != DBNull.Value)
                            {
                                Family.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            }
                            if (rdr["Description_ro"] != DBNull.Value)
                            {
                                Family.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            }
                            if (rdr["Description_zh"] != DBNull.Value)
                            {
                                Family.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            }
                            if (rdr["Description_ru"] != DBNull.Value)
                            {
                                Family.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                bool InUse = Convert.ToBoolean(rdr["InUse"]);
                                if (InUse)
                                    Family.IsInUse = "1";
                                else
                                    Family.IsInUse = "0";
                            }
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                            {
                                Family.FilePath = Convert.ToString(rdr["VisualAidPATH"]);
                            }
                            //string subPath = FamiliesImagePath + subFamily.Path;
                            //subFamily.ImageList = new ObservableCollection<SubFamilyImage>(GetSubFamilyImageImagesByIdSubFamily_V2450(localGeosConnectionString, subFamily.Id, subPath));
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetFamilyDetails_V2470().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return Family;
        }
        #endregion

        #region [rdixit][GEOS2-5148,5149,5150][29.01.2024]
        public List<ConnectorFamily> GetConnectorFamilies_V2480(string MainServerConnectionString, string ConnectorFamiliesImagePath)
        {
            List<ConnectorFamily> connector = new List<ConnectorFamily>();
            List<int> IntList = new List<int>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GETConnectorFamilies_V2480", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorFamily connectorFamilies = new ConnectorFamily();
                            if (rdr["KeyName"] != DBNull.Value)
                                connectorFamilies.Key = Convert.ToString(rdr["KeyName"]);
                            if (rdr["SubfamilyID"] != DBNull.Value)
                                connectorFamilies.IdSubFamilyConnector = Convert.ToInt32(rdr["SubfamilyID"]);
                            if (rdr["ParentFamilyID"] != DBNull.Value)
                                connectorFamilies.IdFamily = Convert.ToInt32(rdr["ParentFamilyID"]);
                            if (rdr["Parent_Category"] != DBNull.Value)
                                connectorFamilies.Parent = Convert.ToString(rdr["Parent_Category"]);
                            if (rdr["Name"] != DBNull.Value)
                                connectorFamilies.Name = Convert.ToString(rdr["Name"]);
                            if (rdr["Name_es"] != DBNull.Value)
                                connectorFamilies.Name_es = Convert.ToString(rdr["Name_es"]);
                            if (rdr["Name_fr"] != DBNull.Value)
                                connectorFamilies.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            if (rdr["Name_pt"] != DBNull.Value)
                                connectorFamilies.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            if (rdr["Name_ro"] != DBNull.Value)
                                connectorFamilies.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            if (rdr["Name_ru"] != DBNull.Value)
                                connectorFamilies.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            if (rdr["Name_zh"] != DBNull.Value)
                                connectorFamilies.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            if (rdr["Description"] != DBNull.Value)
                                connectorFamilies.Description = Convert.ToString(rdr["Description"]);
                            if (rdr["Description_es"] != DBNull.Value)
                                connectorFamilies.Description_es = Convert.ToString(rdr["Description_es"]);
                            if (rdr["Description_fr"] != DBNull.Value)
                                connectorFamilies.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            if (rdr["Description_pt"] != DBNull.Value)
                                connectorFamilies.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            if (rdr["Description_ro"] != DBNull.Value)
                                connectorFamilies.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            if (rdr["Description_ru"] != DBNull.Value)
                                connectorFamilies.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            if (rdr["Description_zh"] != DBNull.Value)
                                connectorFamilies.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                                connectorFamilies.FilePath = Convert.ToString(rdr["VisualAidPATH"]);
                            if (rdr["IdType"] != DBNull.Value)
                            {
                                connectorFamilies.ConnectorType = new LookUpValues();
                                connectorFamilies.ConnectorType.IdLookupValue = Convert.ToInt32(rdr["IdType"]);
                                if (rdr["Value"] != DBNull.Value)
                                    connectorFamilies.ConnectorType.Value_en = Convert.ToString(rdr["Value"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                sbyte InUseYesNoParent = Convert.ToSByte(rdr["InUse"]);
                                if (InUseYesNoParent == 1)
                                    connectorFamilies.IsInUse = "Yes";
                                else
                                    connectorFamilies.IsInUse = "No";
                            }
                            connector.Add(connectorFamilies);
                        }
                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamily selectedConnectorFamily = new ConnectorFamily();
                                if (Convert.ToUInt64(rdr["Position"]) == 1)
                                {
                                    List<ConnectorFamily> connectorFamiliesimageList = new List<ConnectorFamily>();
                                    selectedConnectorFamily = connector.FirstOrDefault(i => i.IdFamily == Convert.ToInt32(rdr["familyimageIdFamily"]) && i.IdSubFamilyConnector == 0);
                                    if (selectedConnectorFamily != null)
                                    {
                                        if (rdr["familyimageIdFamily"] != DBNull.Value)
                                            selectedConnectorFamily.IdFamilyimageIdFamily = Convert.ToInt32(rdr["familyimageIdFamily"]);
                                        if (rdr["IdSCMFamilyImage"] != DBNull.Value)
                                            selectedConnectorFamily.IdSCMFamilyImage = Convert.ToUInt64(rdr["IdSCMFamilyImage"]);
                                        if (rdr["SavedFileNameParent"] != DBNull.Value)
                                            selectedConnectorFamily.SavedFileNameParent = Convert.ToString(rdr["SavedFileNameParent"]);
                                        if (rdr["Position"] != DBNull.Value)
                                            selectedConnectorFamily.Position = Convert.ToUInt64(rdr["Position"]);

                                        selectedConnectorFamily.ConnectorFamilyImageInBytes = GetFamilyImage_V2450(selectedConnectorFamily.Name_es, ConnectorFamiliesImagePath, selectedConnectorFamily.SavedFileNameParent);
                                    }
                                }
                            }
                        }

                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamily selectedConnectorSubFamily = new ConnectorFamily();

                                if (Convert.ToUInt64(rdr["subfamilyPosition"]) == 1)
                                {
                                    string SubFolderPath = string.Empty;
                                    selectedConnectorSubFamily = connector.FirstOrDefault(i => i.IdSubFamilyConnector == Convert.ToInt64(rdr["IdSubFamily"]));
                                    if (selectedConnectorSubFamily != null)
                                    {
                                        if (rdr["subfamilyPosition"] != DBNull.Value)
                                            selectedConnectorSubFamily.Position = Convert.ToUInt64(rdr["subfamilyPosition"]);

                                        if (rdr["IdSubFamily"] != DBNull.Value)
                                            selectedConnectorSubFamily.IdSubFamilyConnector = Convert.ToInt32(rdr["IdSubFamily"]);

                                        if (rdr["IdSCMSubFamilyImage"] != DBNull.Value)
                                            selectedConnectorSubFamily.IdSCMSubFamilyImage = Convert.ToUInt64(rdr["IdSCMSubFamilyImage"]);

                                        if (rdr["SavedFileName"] != DBNull.Value)
                                            selectedConnectorSubFamily.SavedFileName = Convert.ToString(rdr["SavedFileName"]);

                                        if (rdr["OriginalFileName"] != DBNull.Value)
                                            selectedConnectorSubFamily.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);

                                        if (rdr["VisualAidPATH"] != DBNull.Value)
                                            SubFolderPath = Convert.ToString(rdr["VisualAidPATH"]);

                                        string subPath = ConnectorFamiliesImagePath + SubFolderPath;
                                        selectedConnectorSubFamily.ConnectorFamilyImageInBytes = GetSubFamilyImage_V2450(subPath, selectedConnectorSubFamily.SavedFileName);
                                    }
                                }
                            }
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorFamilies_V2480().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connector;
        }
        //[rdixit][GEOS2-5148,5149,5150][29.01.2024]
        public ConnectorFamily AddConnectorFamilies_V2480(string MainServerConnectionString, ConnectorFamily ConnectorFamily, string ConnectorFamilyImagePath)
        {
            bool IsInserted = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    string FamiliesImagePath = string.Empty;
                    FamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name_es;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name_es;
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Insert_V2480", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", ConnectorFamily.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.Parameters.AddWithValue("_IdType", ConnectorFamily.ConnectorType.IdLookupValue);
                        ConnectorFamily.IdFamily = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                        IsInserted = true;
                        mySqlConnection.Close();
                    }
                    if (ConnectorFamily.FamilyImagesList?.Count > 0)
                    {
                        AddConnectorFamilyImages_V2430(MainServerConnectionString, Convert.ToUInt16(ConnectorFamily.IdFamily), ConnectorFamily.FamilyImagesList, FamiliesImagePath);
                    }
                    if (ConnectorFamily.SubFamilyList?.Count > 0)
                    {
                        foreach (var item in ConnectorFamily.SubFamilyList)
                        {
                            item.IdFamily = (uint)ConnectorFamily.IdFamily;
                            if (item.TransactionOperation == ModelBase.TransactionOperations.Add)
                                InsertSubFamily_V2450(MainServerConnectionString, item, ConnectorFamilyImagePath);
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilies_V2480(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }

            return ConnectorFamily;
        }
        //[rdixit][GEOS2-5148,5149,5150][29.01.2024]
        public ConnectorFamily UpdateConnectorFamilies_V2480(string MainServerConnectionString, ConnectorFamily ConnectorFamily, string ConnectorFamilyImagePath)
        {
            bool IsUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    string destinationDirectory = string.Empty;
                    destinationDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name_es;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.Name_es;
                    #region If Name changes path will also change
                    if (ConnectorFamily.OldName.ToLower() != ConnectorFamily.Name_es.ToLower())
                    {
                        string sourceDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.OldName;
                        try
                        {
                            // Create the destination directory if it doesn't exist
                            if (!Directory.Exists(destinationDirectory))
                            {
                                Directory.CreateDirectory(destinationDirectory);
                            }
                            if (Directory.Exists(sourceDirectory))
                            {
                                foreach (string file in Directory.GetFiles(sourceDirectory))
                                {
                                    string fileName = Path.GetFileName(file);
                                    string destFile = Path.Combine(destinationDirectory, fileName);
                                    if (File.Exists(destFile))
                                    {
                                        File.Delete(destFile);
                                    }
                                    File.Copy(file, destFile);
                                }
                                string[] subdirectories = Directory.GetDirectories(sourceDirectory);
                                foreach (string subdirectory in subdirectories)
                                {
                                    string subdirectoryName = Path.GetFileName(subdirectory);
                                    string destinationSubdirectory = Path.Combine(destinationDirectory, subdirectoryName);
                                    CopyDirectory(subdirectory, destinationSubdirectory);
                                }
                                Directory.Delete(sourceDirectory, true);
                            }
                        }
                        catch (Exception ex)
                        {
                            Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilyImages_V2430(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                        }
                    }
                    #endregion

                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Update_V2480", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdFamily", ConnectorFamily.IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_ModifiedBy", ConnectorFamily.ModifiedBy);
                        mySqlCommand.Parameters.AddWithValue("_ModifiedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.Parameters.AddWithValue("_IdType", ConnectorFamily.ConnectorType.IdLookupValue);
                        mySqlCommand.ExecuteNonQuery();
                        IsUpdated = true;
                        mySqlConnection.Close();

                        if (ConnectorFamily.IdFamily > 0 && ConnectorFamily.FamilyImagesList?.Count > 0)
                        {
                            if (ConnectorFamily.FamilyImagesList.Any(i => i.TransactionOperation == ModelBase.TransactionOperations.Add || i.TransactionOperation == ModelBase.TransactionOperations.Delete || i.TransactionOperation == ModelBase.TransactionOperations.Update))
                                UpdateConnectorFamilyImages_V2430(MainServerConnectionString, ConnectorFamily.IdFamily, ConnectorFamily.FamilyImagesList, destinationDirectory);
                        }
                        if (ConnectorFamily.SubFamilyList?.Count > 0)
                        {
                            foreach (var item in ConnectorFamily.SubFamilyList)
                            {
                                if (item.TransactionOperation == ModelBase.TransactionOperations.Update)
                                    UpdateSubFamily_V2450(MainServerConnectionString, item, ConnectorFamilyImagePath);
                                else if (item.TransactionOperation == ModelBase.TransactionOperations.Add)
                                    InsertSubFamily_V2450(MainServerConnectionString, item, ConnectorFamilyImagePath);
                            }
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilies_V2480(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return ConnectorFamily;
        }
        //[rdixit][GEOS2-5148,5149,5150][29.01.2024]
        public List<Family> GetAllFamilies_V2480(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<Family> lstFamily = new List<Family>();
            Family family;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllFamilies_V2480", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                family = new Family();
                                if (rdr["IdFamily"] != DBNull.Value)
                                    family.Id = Convert.ToUInt16(rdr["IdFamily"]);
                                if (rdr["Name"] != DBNull.Value)
                                    family.Name = Convert.ToString(rdr["Name"]);
                                if (rdr["Name_es"] != DBNull.Value)
                                    family.Name_es = Convert.ToString(rdr["Name_es"]);
                                if (rdr["IdType"] != DBNull.Value)
                                    family.IdType = Convert.ToInt32(rdr["IdType"]);
                                lstFamily.Add(family);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstFamily;
            }
        }

        public List<ConnectorSubFamily> GetAllSubfamilies_V2480(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<ConnectorSubFamily> lstSubfamily = new List<ConnectorSubFamily>();
            ConnectorSubFamily subFamily;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllSubfamilies_V2480", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                subFamily = new ConnectorSubFamily();
                                if (rdr["IdConnectorSubfamily"] != DBNull.Value)
                                    subFamily.Id = Convert.ToUInt16(rdr["IdConnectorSubfamily"]);
                                if (rdr["IdConnectorFamily"] != DBNull.Value)
                                    subFamily.IdFamily = Convert.ToUInt16(rdr["IdConnectorFamily"]);
                                if (rdr["Name"] != DBNull.Value)
                                    subFamily.Name = Convert.ToString(rdr["Name"]);
                                if (rdr["FamilyName_es"] != DBNull.Value)
                                    subFamily.FamilyName = Convert.ToString(rdr["FamilyName_es"]);

                                lstSubfamily.Add(subFamily);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstSubfamily;
            }
        }

        public List<Connectors> GetAllConnectors_V2480(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2480", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompany != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", Connectors.SelectedCompany.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", Connectors.SelectedFamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", Connectors.SelectedSubfamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColor != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", Connectors.SelectedColor.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGender != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", Connectors.SelectedGender.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);

                    if (!string.IsNullOrEmpty(Connectors.Ways))
                        mySqlCommand.Parameters.AddWithValue("_Cavities", Connectors.Ways);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Cavities", null);


                    if (!string.IsNullOrEmpty(Connectors.DiameterInternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", Connectors.DiameterInternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", null);

                    if (!string.IsNullOrEmpty(Connectors.DiameterExternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", Connectors.DiameterExternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", null);

                    if (!string.IsNullOrEmpty(Connectors.Height))
                        mySqlCommand.Parameters.AddWithValue("_height", Connectors.Height);
                    else
                        mySqlCommand.Parameters.AddWithValue("_height", null);

                    if (!string.IsNullOrEmpty(Connectors.Length))
                        mySqlCommand.Parameters.AddWithValue("_length", Connectors.Length);
                    else
                        mySqlCommand.Parameters.AddWithValue("_length", null);

                    if (!string.IsNullOrEmpty(Connectors.Width))
                        mySqlCommand.Parameters.AddWithValue("_width", Connectors.Width);
                    else
                        mySqlCommand.Parameters.AddWithValue("_width", null);

                    if (Connectors.IsSealingEnabled != null)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.IsSealingEnabled);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    if (Connectors.SelectedValueType.Count > 0)
                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", Connectors.CustomValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_IdLookupValue", null);

                    if (string.IsNullOrEmpty(Connectors.ConnectorType))
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", null);
                    else
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", Connectors.ConnectorType);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            //[rdixit][GEOS2-4602][13.09.2023]
                            if (reader["componentIdType"] != DBNull.Value)
                            {
                                connector.ComponentIdType = Convert.ToInt32(reader["componentIdType"]);
                            }
                            if (reader["componentIdColor"] != DBNull.Value)
                            {
                                connector.ComponentIdColor = Convert.ToUInt16(reader["componentIdColor"]);
                            }
                            if (reader["componentRef"] != DBNull.Value)
                            {
                                connector.ComponentRef = Convert.ToString(reader["componentRef"]);
                            }
                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2440(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }
        #endregion
        #region //rajashri GEOS2-5227
        public List<ConnectorProperties> GetConnectorProperties_V2480(string localGeosConnectionString, String language)
        {
            TransactionScope transactionScope = null;
            List<ConnectorProperties> lstConnectorProperties = new List<ConnectorProperties>();
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorProperties_V2480", connActivity);
                        cmd.Parameters.AddWithValue("_Language", language);
                        cmd.CommandType = CommandType.StoredProcedure;
                        ConnectorProperties property = null;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                property = new ConnectorProperties();
                                property.IdConnectorCategory = Convert.ToInt32(rdr["IdConnectorCategory"]);
                                property.CategoryName = Convert.ToString(rdr["CategoryName"]);
                                property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                                property.IdConnectorType = Convert.ToInt32(rdr["IdConnectorType"]);
                                property.PropertyName = Convert.ToString(rdr["PropertyName"]);
                                lstConnectorProperties.Add(property);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstConnectorProperties;
            }
        }
        //rajashri GEOS2-5227
        public List<ValueKey> GetValueKeyOfCustomProperties_V2480(string connectionString, Int32 IdCustomConnectorProperty)
        {
            List<ValueKey> valueKey = new List<ValueKey>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_Get_lookup_Key_Of_CustomProperties_V2480", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdCustomConnectorProperty", IdCustomConnectorProperty);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ValueKey key = new ValueKey();

                            if (rdr["IdLookupKey"] != DBNull.Value)
                            {
                                key.IdLookupKey = Convert.ToInt32(rdr["IdLookupKey"]);
                            }
                            valueKey.Add(key);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetValueType().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return valueKey;
        }
        public List<ConnectorProperties> GetPropertyManagerByFamily_V2480(string MainServerConnectionString, UInt32 familyId)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorPropertiesByFamily_v2480", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", familyId);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();
                            property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                            property.IdFamily = Convert.ToUInt32(rdr["IdFamily"]);
                            property.IsEnabled = Convert.ToBoolean(rdr["IsEnabled"]);
                            if (rdr["DefaultValue"] != DBNull.Value)
                                property.DefaultValue = Convert.ToString(rdr["DefaultValue"]);
                            if (rdr["Min_Value"] != DBNull.Value)
                            {
                                property.MinValueNew = Convert.ToString(rdr["Min_Value"]);
                            }
                            if (rdr["Max_Value"] != DBNull.Value)
                            {
                                property.MaxValueNew = Convert.ToString(rdr["Max_Value"]);
                            }

                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetPropertyManager_V2460().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }
        public List<Connectors> GetAllConnectors_V2490(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2490", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompanyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", string.Join(",", Connectors.SelectedCompanyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", string.Join(",", Connectors.SelectedFamilyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", string.Join(",", Connectors.SelectedSubfamilyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColorList != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", string.Join(",", Connectors.SelectedColorList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGenderList != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", string.Join(",", Connectors.SelectedGenderList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);
                    #region[GEOS2-5296][rdixit][29.02.2024]
                    #region Ways
                    if (Connectors.WaysProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", (Connectors.WaysProp.MinValueNew == string.Empty) ? null : Connectors.WaysProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", (Connectors.WaysProp.MaxValueNew == string.Empty) ? null : Connectors.WaysProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", null);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", null);
                    }
                    #endregion

                    #region DiameterInternal
                    if (Connectors.DiameterInternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", (Connectors.DiameterInternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", (Connectors.DiameterInternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", null);
                    }
                    #endregion

                    #region DiameterExternal
                    if (Connectors.DiameterExternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", (Connectors.DiameterExternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", (Connectors.DiameterExternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", null);
                    }
                    #endregion

                    #region Height
                    if (Connectors.HeightProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", (Connectors.HeightProp.MinValueNew == string.Empty) ? null : Connectors.HeightProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", (Connectors.HeightProp.MaxValueNew == string.Empty) ? null : Connectors.HeightProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", null);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", null);
                    }
                    #endregion

                    #region Length
                    if (Connectors.LengthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", (Connectors.LengthProp.MinValueNew == string.Empty) ? null : Connectors.LengthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", (Connectors.LengthProp.MaxValueNew == string.Empty) ? null : Connectors.LengthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", null);
                    }
                    #endregion

                    #region Width
                    if (Connectors.WidthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", (Connectors.WidthProp.MinValueNew == string.Empty) ? null : Connectors.WidthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", (Connectors.WidthProp.MaxValueNew == string.Empty) ? null : Connectors.WidthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", null);
                    }
                    #endregion
                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion                  

                    if (string.IsNullOrEmpty(Connectors.ConnectorType))
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", null);
                    else
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", Connectors.ConnectorType);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            //[rdixit][GEOS2-4602][13.09.2023]
                            if (reader["componentIdType"] != DBNull.Value)
                            {
                                connector.ComponentIdType = Convert.ToInt32(reader["componentIdType"]);
                            }
                            if (reader["ComponentTypeName"] != DBNull.Value)
                            {
                                connector.ComponentTypeName = Convert.ToString(reader["ComponentTypeName"]);
                            }
                            if (reader["componentIdColor"] != DBNull.Value)
                            {
                                connector.ComponentIdColor = Convert.ToUInt16(reader["componentIdColor"]);
                            }
                            if (reader["componentRef"] != DBNull.Value)
                            {
                                connector.ComponentRef = Convert.ToString(reader["componentRef"]);
                            }
                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2490(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }
        #endregion


        //[Sudhir.Jangra][GEOS2-5204]
        public List<Samples> GetModifiedSamplesByIdSite_V2490(string workbenchConnectionString, DateTime startDate, DateTime endDate, Int32 idSite)
        {
            List<Samples> SamplesList = new List<Samples>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetModifiedSamplesConnectionList_V2490", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_StartDate", startDate);
                    mySqlCommand.Parameters.AddWithValue("_EndDate", endDate);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idSite);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {

                        while (reader.Read())
                        {
                            Samples samples = new Samples();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                samples.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["EmdepReference"] != DBNull.Value)
                            {
                                samples.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                samples.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    samples.SavedFileName = Convert.ToString(reader["FileName"]);
                                    samples.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + samples.EmdepReference + "/" + samples.SavedFileName;

                                }

                            }

                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                samples.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                                if (reader["FamilyName"] != DBNull.Value)
                                {
                                    samples.FamilyName = Convert.ToString(reader["FamilyName"]);
                                }

                            }
                            if (reader["idConnectorSubfamily"] != DBNull.Value)
                            {
                                samples.IdConnectorSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                                if (reader["SubFamilyName"] != DBNull.Value)
                                {
                                    samples.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                                }

                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                samples.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["ModifiedIn"] != DBNull.Value)
                            {
                                samples.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                            }
                            if (reader["ModifiedBy"] != DBNull.Value)
                            {
                                samples.ModifiedBy = Convert.ToUInt32(reader["ModifiedBy"]);
                                if (reader["FirstName"] != DBNull.Value)
                                {
                                    samples.FirstName = Convert.ToString(reader["FirstName"]);
                                }
                                if (reader["LastName"] != DBNull.Value)
                                {
                                    samples.LastName = Convert.ToString(reader["LastName"]);
                                }
                            }
                            if (reader["IdCompany"] != DBNull.Value)
                            {
                                samples.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                                if (reader["PlantName"] != DBNull.Value)
                                {
                                    samples.PlantName = Convert.ToString(reader["PlantName"]);
                                }
                            }
                            if (reader["IdLogEntry"] != DBNull.Value)
                            {
                                samples.IdLogEntry = Convert.ToUInt32(reader["IdLogEntry"]);
                                if (reader["Comments"] != DBNull.Value)
                                {
                                    samples.LogComment = Convert.ToString(reader["Comments"]);
                                }
                            }
                            if (reader["IdLookupValue"] != DBNull.Value)
                            {
                                samples.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                                samples.TypeName = Convert.ToString(reader["TypeName"]);
                            }

                            SamplesList.Add(samples);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetModifiedSamplesByIdSite_V2490(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return SamplesList;
        }

        //[Sudhir.Jangra][GEOS2-5204]
        public List<Common.Company> GetAuthorizedPlantsByIdUser_V2490(string workbenchConnectionString, Int32 idUser)
        {
            List<Common.Company> companies = new List<Common.Company>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("companies_GetAuthorizedPlantsByIdUser_V2490", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_idUser", idUser);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {

                        while (reader.Read())
                        {
                            Common.Company company = new Common.Company();
                            if (reader["idSite"] != DBNull.Value)
                            {
                                company.IdCompany = Convert.ToInt32(reader["idSite"]);
                                if (reader["IP"] != DBNull.Value)
                                {
                                    company.IP = Convert.ToString(reader["IP"]);
                                }
                                if (reader["Code"] != DBNull.Value)
                                {
                                    company.Code = Convert.ToString(reader["Code"]);
                                }
                                if (reader["DatabaseIP"] != DBNull.Value)
                                {
                                    company.DatabaseIP = Convert.ToString(reader["DatabaseIP"]);
                                }
                                if (reader["ShortName"] != DBNull.Value)
                                {
                                    company.ShortName = Convert.ToString(reader["ShortName"]);
                                    company.Alias = Convert.ToString(reader["ShortName"]);
                                }
                                if (reader["Name"] != DBNull.Value)
                                {
                                    company.Name = Convert.ToString(reader["Name"]);
                                }
                                if (reader["ServiceProviderUrl"] != DBNull.Value)
                                {
                                    company.ServiceProviderUrl = Convert.ToString(reader["ServiceProviderUrl"]);
                                }
                                //company.Name = Convert.ToString(reader["CompanyName"]);
                                //company.Alias = Convert.ToString(reader["Alias"]);
                                //company.ShortName = Convert.ToString(reader["Alias"]);
                                //if (reader["IdCountry"] != DBNull.Value)
                                //{
                                //    company.IdCountry = Convert.ToByte(reader["IdCountry"]);
                                //    company.Country = new Country();
                                //    company.Country.IdCountry = Convert.ToByte(reader["IdCountry"]);
                                //    company.Country.Name = Convert.ToString(reader["CountryName"]);
                                //}
                                //if (reader["IsLocation"] != DBNull.Value)
                                //    company.IsLocation = Convert.ToByte(reader["IsLocation"]);

                                //if (reader["IsOrganization"] != DBNull.Value)
                                //    company.IsOrganization = Convert.ToByte(reader["IsOrganization"]);

                                //if (reader["IsCompany"] != DBNull.Value)
                                //    company.IsCompany = Convert.ToByte(reader["IsCompany"]);

                                //if (reader["IsStillActive"] != DBNull.Value)
                                //    company.IsStillActive = Convert.ToByte(reader["IsStillActive"]);

                                //if (reader["IdCurrency"] != DBNull.Value)
                                //{
                                //    company.IdCurrency = Convert.ToInt16(reader["IdCurrency"]);
                                //}
                            }
                            companies.Add(company);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAuthorizedPlantsByIdUser_V2490(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return companies;
        }

        //[Sudhir.Jangra][GEOS2-5205]
        public List<ThreeDConnectorItems> Get3dConnectorByIdSite_V2490(string workbenchConnectionString, DateTime startDate, DateTime endDate, Int32 idSite)
        {
            List<ThreeDConnectorItems> threedConnectorList = new List<ThreeDConnectorItems>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_Get3dConnectionList_V2490", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_StartDate", startDate);
                    mySqlCommand.Parameters.AddWithValue("_EndDate", endDate);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idSite);
                    mySqlCommand.CommandTimeout = 8000;
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            ThreeDConnectorItems threedConnector = new ThreeDConnectorItems();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                threedConnector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["EmdepReference"] != DBNull.Value)
                            {
                                threedConnector.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                            }
                            if (reader["Reference"] != DBNull.Value)
                            {
                                threedConnector.Reference = Convert.ToString(reader["Reference"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                threedConnector.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    threedConnector.SavedFileName = Convert.ToString(reader["FileName"]);
                                    threedConnector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + threedConnector.EmdepReference + "/" + threedConnector.SavedFileName;
                                }
                            }
                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                threedConnector.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                            }
                            if (reader["FamilyName"] != DBNull.Value)
                            {
                                threedConnector.FamilyName = Convert.ToString(reader["FamilyName"]);
                            }
                            if (reader["idConnectorSubfamily"] != DBNull.Value)
                            {
                                threedConnector.IdConnectorsSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                            }
                            if (reader["SubFamilyName"] != DBNull.Value)
                            {
                                threedConnector.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                            }
                            if (reader["CreationDate"] != DBNull.Value)
                            {
                                threedConnector.CreationDate = Convert.ToDateTime(reader["CreationDate"]);
                            }
                            if (reader["IdCompany"] != DBNull.Value)
                            {
                                threedConnector.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                            }
                            if (reader["PlantName"] != DBNull.Value)
                            {
                                threedConnector.PlantName = Convert.ToString(reader["PlantName"]);
                            }
                            if (reader["OTCode"] != DBNull.Value)
                            {
                                threedConnector.OTCode = Convert.ToString(reader["OTCode"]);
                            }
                            if (reader["ItemNumber"] != DBNull.Value)
                            {
                                threedConnector.ItemNumber = Convert.ToUInt32(reader["ItemNumber"]);
                            }
                            if (reader["IdItemOtStatus"] != DBNull.Value)
                            {
                                threedConnector.IdItemOTStatus = Convert.ToUInt32(reader["IdItemOtStatus"]);
                            }
                            if (reader["ItemStatus"] != DBNull.Value)
                            {
                                threedConnector.ItemStatus = Convert.ToString(reader["ItemStatus"]);
                            }
                            if (reader["IdDrawing"] != DBNull.Value)
                            {
                                threedConnector.IdDrawing = Convert.ToUInt32(reader["IdDrawing"]);
                            }
                            if (reader["Revision"] != DBNull.Value)
                            {
                                threedConnector.Revision = Convert.ToString(reader["Revision"]);
                            }
                            if (reader["Reworks"] != DBNull.Value)
                            {
                                threedConnector.Reworks = Convert.ToInt32(reader["Reworks"]);
                            }
                            if (reader["ReworkComment"] != DBNull.Value)
                            {
                                threedConnector.ReworkComment = Convert.ToString(reader["ReworkComment"]);
                            }
                            if (reader["IdLookupValue"] != DBNull.Value)
                            {
                                threedConnector.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                                threedConnector.TypeName = Convert.ToString(reader["TypeName"]);
                            }
                            if (reader["IdPerson"] != DBNull.Value)
                            {
                                threedConnector.IdPerson = Convert.ToUInt32(reader["IdPerson"]);
                                threedConnector.DesignerFullName = Convert.ToString(reader["DesignerFullName"]);
                            }
                            else
                            {
                                threedConnector.DesignerFullName = "-";
                            }
                            if (reader["ReworkStage"] != DBNull.Value)
                            {
                                threedConnector.ReworkStage = Convert.ToString(reader["ReworkStage"]);
                            }
                            else
                            {
                                threedConnector.ReworkStage = "-";
                            }
                            if (reader["DrawingCreatedIN"] != DBNull.Value)
                            {
                                threedConnector.DrawingCreatedIn = Convert.ToDateTime(reader["DrawingCreatedIN"]);
                            }



                            threedConnectorList.Add(threedConnector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error Get3dConnectorByIdSite_V2490(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return threedConnectorList;
        }

        //[Sudhir.Jangra][GEOS2-5203]
        public List<Samples> GetNewSamplesByIdSite_V2490(string workbenchConnectionString, DateTime startDate, DateTime endDate, Int32 idSite)
        {
            List<Samples> SamplesList = new List<Samples>();
            DataTable dt = new DataTable();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetNewSamplesConnectionList_V2490", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_StartDate", startDate);
                    mySqlCommand.Parameters.AddWithValue("_EndDate", endDate);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idSite);

                    MySqlDataAdapter da = new MySqlDataAdapter(mySqlCommand);
                    da.Fill(dt);
                    foreach (DataRow reader in dt.Rows)
                    {
                        Samples samples = new Samples();
                        if (reader["IdConnector"] != DBNull.Value)
                        {
                            samples.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                        }
                        if (reader["EmdepReference"] != DBNull.Value)
                        {
                            samples.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                        }
                        if (reader["Reference"] != DBNull.Value)
                        {
                            samples.Reference = Convert.ToString(reader["Reference"]);
                        }
                        if (reader["IdConnectorImage"] != DBNull.Value)
                        {
                            samples.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                            if (reader["FileName"] != DBNull.Value)
                            {
                                samples.SavedFileName = Convert.ToString(reader["FileName"]);
                                samples.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + samples.EmdepReference + "/" + samples.SavedFileName;
                            }

                        }
                        if (reader["IdWorkflowStatus"] != DBNull.Value)
                        {
                            samples.IdWorkflowStatus = Convert.ToInt64(reader["IdWorkflowStatus"]);
                            samples.Status = new WorkflowStatus();
                            samples.Status.IdWorkflowStatus = (Int32)samples.IdWorkflowStatus;
                            samples.Status.Name = Convert.ToString(reader["StatusName"]);
                            samples.Status.HTMLColor = Convert.ToString(reader["StatusHTMLColor"]);
                            if (reader["StatusName"] != DBNull.Value)
                            {
                                samples.StatusName = Convert.ToString(reader["StatusName"]);
                            }
                            if (reader["StatusHTMLColor"] != DBNull.Value)
                            {
                                samples.StatusHTMLColor = Convert.ToString(reader["StatusHTMLColor"]);
                            }
                        }
                        if (reader["IdFamily"] != DBNull.Value)
                        {
                            samples.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                            if (reader["FamilyName"] != DBNull.Value)
                            {
                                samples.FamilyName = Convert.ToString(reader["FamilyName"]);
                            }

                        }
                        if (reader["idConnectorSubfamily"] != DBNull.Value)
                        {
                            samples.IdConnectorSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                            if (reader["SubFamilyName"] != DBNull.Value)
                            {
                                samples.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                            }

                        }
                        if (reader["CreatedIn"] != DBNull.Value)
                        {
                            samples.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                        }
                        if (reader["ModifiedIn"] != DBNull.Value)
                        {
                            samples.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                        }
                        if (reader["CreatedBy"] != DBNull.Value)
                        {
                            samples.CreatedBy = Convert.ToUInt32(reader["CreatedBy"]);
                            if (reader["FirstName"] != DBNull.Value)
                            {
                                samples.FirstName = Convert.ToString(reader["FirstName"]);
                            }
                            if (reader["LastName"] != DBNull.Value)
                            {
                                samples.LastName = Convert.ToString(reader["LastName"]);
                            }
                        }
                        if (reader["IdCompany"] != DBNull.Value)
                        {
                            samples.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                            if (reader["PlantName"] != DBNull.Value)
                            {
                                samples.PlantName = Convert.ToString(reader["PlantName"]);
                            }
                        }
                        if (reader["Description"] != DBNull.Value)
                        {
                            samples.Description = Convert.ToString(reader["Description"]);
                        }
                        if (reader["IdLookupValue"] != DBNull.Value)
                        {
                            samples.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                            samples.TypeName = Convert.ToString(reader["TypeName"]);
                        }
                        if (reader["DrawingName"] != DBNull.Value)
                        {
                            samples.DrawingName = Convert.ToString(reader["DrawingName"]);
                        }
                        SamplesList.Add(samples);
                    }

                    //using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    //{

                    //    while (reader.Read())
                    //    {
                    //        Samples samples = new Samples();
                    //        if (reader["IdConnector"] != DBNull.Value)
                    //        {
                    //            samples.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                    //        }
                    //        if (reader["EmdepReference"] != DBNull.Value)
                    //        {
                    //            samples.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                    //        }
                    //        if (reader["Reference"] != DBNull.Value)
                    //        {
                    //            samples.Reference = Convert.ToString(reader["Reference"]);
                    //        }
                    //        if (reader["IdConnectorImage"] != DBNull.Value)
                    //        {
                    //            samples.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                    //            if (reader["FileName"] != DBNull.Value)
                    //            {
                    //                samples.SavedFileName = Convert.ToString(reader["FileName"]);
                    //                samples.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + samples.EmdepReference + "/" + samples.SavedFileName;
                    //            }

                    //        }
                    //        if (reader["IdWorkflowStatus"] != DBNull.Value)
                    //        {
                    //            samples.IdWorkflowStatus = Convert.ToInt64(reader["IdWorkflowStatus"]);
                    //            samples.Status = new WorkflowStatus();
                    //            samples.Status.IdWorkflowStatus = (Int32)samples.IdWorkflowStatus;
                    //            samples.Status.Name = Convert.ToString(reader["StatusName"]);
                    //            samples.Status.HTMLColor = Convert.ToString(reader["StatusHTMLColor"]);
                    //            if (reader["StatusName"] != DBNull.Value)
                    //            {
                    //                samples.StatusName = Convert.ToString(reader["StatusName"]);
                    //            }
                    //            if (reader["StatusHTMLColor"] != DBNull.Value)
                    //            {
                    //                samples.StatusHTMLColor = Convert.ToString(reader["StatusHTMLColor"]);
                    //            }
                    //        }
                    //        if (reader["IdFamily"] != DBNull.Value)
                    //        {
                    //            samples.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                    //            if (reader["FamilyName"] != DBNull.Value)
                    //            {
                    //                samples.FamilyName = Convert.ToString(reader["FamilyName"]);
                    //            }

                    //        }
                    //        if (reader["idConnectorSubfamily"] != DBNull.Value)
                    //        {
                    //            samples.IdConnectorSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                    //            if (reader["SubFamilyName"] != DBNull.Value)
                    //            {
                    //                samples.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                    //            }

                    //        }
                    //        if (reader["CreatedIn"] != DBNull.Value)
                    //        {
                    //            samples.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                    //        }
                    //        if (reader["ModifiedIn"] != DBNull.Value)
                    //        {
                    //            samples.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                    //        }
                    //        if (reader["CreatedBy"] != DBNull.Value)
                    //        {
                    //            samples.CreatedBy = Convert.ToUInt32(reader["CreatedBy"]);
                    //            if (reader["FirstName"] != DBNull.Value)
                    //            {
                    //                samples.FirstName = Convert.ToString(reader["FirstName"]);
                    //            }
                    //            if (reader["LastName"] != DBNull.Value)
                    //            {
                    //                samples.LastName = Convert.ToString(reader["LastName"]);
                    //            }
                    //        }
                    //        if (reader["IdCompany"] != DBNull.Value)
                    //        {
                    //            samples.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                    //            if (reader["PlantName"] != DBNull.Value)
                    //            {
                    //                samples.PlantName = Convert.ToString(reader["PlantName"]);
                    //            }
                    //        }
                    //        if (reader["Description"] != DBNull.Value)
                    //        {
                    //            samples.Description = Convert.ToString(reader["Description"]);
                    //        }
                    //        if (reader["IdLookupValue"] != DBNull.Value)
                    //        {
                    //            samples.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                    //            samples.TypeName = Convert.ToString(reader["TypeName"]);
                    //        }
                    //        if (reader["DrawingName"] !=DBNull.Value)
                    //        {
                    //            samples.DrawingName = Convert.ToString(reader["DrawingName"]);
                    //        }
                    //        SamplesList.Add(samples);
                    //    }
                    //}
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetNewSamplesByIdSite_V2490(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return SamplesList;
        }

        //[Sudhir.Jangra][GEOS2-5203]
        public List<WorkflowStatus> GetStatusForNewSamples_V2490(string workbenchConnectionString)
        {
            List<WorkflowStatus> StatusList = new List<WorkflowStatus>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetWorkflowStatusForSamples", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;


                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {

                        while (reader.Read())
                        {
                            WorkflowStatus status = new WorkflowStatus();
                            if (reader["IdWorkflowStatus"] != DBNull.Value)
                            {
                                status.IdWorkflowStatus = Convert.ToInt32(reader["IdWorkflowStatus"]);
                                if (reader["Name"] != DBNull.Value)
                                {
                                    status.Name = Convert.ToString(reader["Name"]);
                                }
                                if (reader["HtmlColor"] != DBNull.Value)
                                {
                                    status.HTMLColor = Convert.ToString(reader["HtmlColor"]);
                                }
                            }



                            StatusList.Add(status);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetStatusForNewSamples_V2490(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return StatusList;
        }

        //[GEOS2-5296][rdixit][29.02.2024]
        public List<ConnectorProperties> GetPropertyManager_V2490(string MainServerConnectionString)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorProperties_V2490", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();
                            property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                            property.IdFamily = Convert.ToUInt32(rdr["IdFamily"]);
                            property.IsEnabled = Convert.ToBoolean(rdr["IsEnabled"]);

                            if (rdr["StanderdFamily"] != DBNull.Value)
                                property.PropertyName = Convert.ToString(rdr["StanderdFamily"]);

                            else if (rdr["CustomFamily"] != DBNull.Value)
                                property.PropertyName = Convert.ToString(rdr["CustomFamily"]);

                            if (rdr["DefaultValue"] != DBNull.Value)
                                property.DefaultValue = Convert.ToString(rdr["DefaultValue"]);

                            if (rdr["Min_Value"] != DBNull.Value)
                            {
                                property.MinValueNew = Convert.ToString(rdr["Min_Value"]);
                                property.MinValueValidation = property.MinValueNew;
                            }
                            if (rdr["Max_Value"] != DBNull.Value)
                            {
                                property.MaxValueNew = Convert.ToString(rdr["Max_Value"]);
                                property.MaxValueValidation = property.MaxValueNew;
                            }

                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetPropertyManager_V2490().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }

        //[GEOS2-5297][rdixit][29.02.2024]
        public List<ConnectorProperties> GetPropertyManagerByFamily_V2490(string MainServerConnectionString, UInt32 familyId)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorPropertiesByFamily_V2490", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", familyId);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();
                            property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                            property.IdFamily = Convert.ToUInt32(rdr["IdFamily"]);
                            property.IsEnabled = Convert.ToBoolean(rdr["IsEnabled"]);
                            if (rdr["StanderdFamily"] != DBNull.Value)
                            {
                                property.PropertyName = Convert.ToString(rdr["StanderdFamily"]);
                            }
                            else if (rdr["CustomFamily"] != DBNull.Value)
                            {
                                property.PropertyName = Convert.ToString(rdr["CustomFamily"]);
                            }
                            if (rdr["DefaultValue"] != DBNull.Value)
                            {
                                property.DefaultValue = Convert.ToString(rdr["DefaultValue"]);
                            }
                            if (rdr["Min_Value"] != DBNull.Value)
                            {
                                property.MinValueNew = Convert.ToString(rdr["Min_Value"]);
                            }
                            if (rdr["Max_Value"] != DBNull.Value)
                            {
                                property.MaxValueNew = Convert.ToString(rdr["Max_Value"]);
                            }
                            if (rdr["isCustProperty"] != DBNull.Value)
                            {
                                property.IsCustomProperty = Convert.ToInt32(rdr["isCustProperty"]) == 1 ? true : false;
                            }
                            if (rdr["IdConnectorType"] != DBNull.Value)
                            {
                                property.IdConnectorType = Convert.ToInt32(rdr["IdConnectorType"]);
                            }
                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetPropertyManager_V2460().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }

        #region [GEOS2-5437][rdixit][07.03.2024]
        public List<SimilarColorsByConfiguration> GetSimilarColorsByConfiguration(string workbenchConnectionString)
        {
            List<SimilarColorsByConfiguration> colorsList = new List<SimilarColorsByConfiguration>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    List<Color> ColorList = GetAllColors(workbenchConnectionString, "");
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSimilarColorsByConfiguration", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {

                        while (reader.Read())
                        {
                            SimilarColorsByConfiguration color = new SimilarColorsByConfiguration();

                            if (reader["IdColorA"] != DBNull.Value)
                                color.IdColorA = Convert.ToInt32(reader["IdColorA"]);

                            if (reader["IdColorB"] != DBNull.Value)
                            {
                                color.ColorList = ColorList;
                                color.IdColorB = Convert.ToInt32(reader["IdColorB"]);
                                color.SelectedColor = ColorList.FirstOrDefault(i => i.Id == color.IdColorB);
                            }
                            if (reader["CreatedBy"] != DBNull.Value)
                                color.CreatedBy = Convert.ToInt32(reader["CreatedBy"]);

                            if (reader["CreatedIn"] != DBNull.Value)
                                color.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);

                            if (reader["ModifiedBy"] != DBNull.Value)
                                color.ModifiedBy = Convert.ToInt32(reader["ModifiedBy"]);

                            if (reader["ModifiedIn"] != DBNull.Value)
                                color.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);

                            colorsList.Add(color);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSimilarColorsByConfiguration(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return colorsList;
        }

        public List<ConfigurationFamily> GetConfigurationsForSearchFilters_V2490(string localGeosConnectionString)
        {
            TransactionScope transactionScope = null;
            List<ConfigurationFamily> lstFamily = new List<ConfigurationFamily>();
            ConfigurationFamily family;
            using (transactionScope = new TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("GetConfigurationForSearchFilters_V2490", connActivity);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                family = new ConfigurationFamily();
                                if (rdr["IdFamily"] != DBNull.Value)
                                    family.IdFamily = Convert.ToUInt16(rdr["IdFamily"]);
                                if (rdr["Name"] != DBNull.Value)
                                    family.NameFamily = Convert.ToString(rdr["Name"]);
                                if (rdr["WaysPages"] != DBNull.Value)
                                    family.WaysPages = Convert.ToString(rdr["WaysPages"]);
                                if (rdr["ColorPages"] != DBNull.Value)
                                    family.ColorPages = Convert.ToString(rdr["ColorPages"]);
                                if (rdr["ComponentsPages"] != DBNull.Value)
                                    family.CompPages = Convert.ToString(rdr["ComponentsPages"]);
                                if (rdr["SizePages"] != DBNull.Value)
                                    family.SizePages = Convert.ToString(rdr["SizePages"]);
                                if (rdr["ReferencePages"] != DBNull.Value)
                                    family.RefPages = Convert.ToString(rdr["ReferencePages"]);
                                if (rdr["NumberOfPages"] != DBNull.Value)
                                    family.NoOfPages = Convert.ToInt32(rdr["NumberOfPages"]);
                                if (rdr["IdSearchConfiguration"] != DBNull.Value)
                                    family.IdSearchConfiguration = Convert.ToInt32(rdr["IdSearchConfiguration"]);
                                if (rdr["IdColorA"] != DBNull.Value)
                                    family.IdColor = Convert.ToInt32(rdr["IdColorA"]);
                                lstFamily.Add(family);
                            }
                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));
                                    if (selectedConfig != null)
                                    {
                                        if (rdr["Margin"] != DBNull.Value)
                                            selectedConfig.WayMargin = Convert.ToInt32(rdr["Margin"]);
                                        if (rdr["IdNumberMargin"] != DBNull.Value)
                                            selectedConfig.IdWayMargin = Convert.ToInt32(rdr["IdNumberMargin"]);
                                    }
                                }
                            }

                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));

                                    if (selectedConfig != null)
                                    {
                                        if (rdr["height"] != DBNull.Value)
                                            selectedConfig.Height = Convert.ToInt32(rdr["height"]);
                                        if (rdr["width"] != DBNull.Value)
                                            selectedConfig.Width = Convert.ToInt32(rdr["width"]);
                                        if (rdr["length"] != DBNull.Value)
                                            selectedConfig.Length = Convert.ToInt32(rdr["length"]);
                                        if (rdr["internal"] != DBNull.Value)
                                            selectedConfig.Internal = Convert.ToInt32(rdr["internal"]);
                                        if (rdr["external"] != DBNull.Value)
                                            selectedConfig.External = Convert.ToInt32(rdr["external"]);
                                    }
                                }
                            }

                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));

                                    if (selectedConfig != null)
                                    {
                                        if (selectedConfig.SimilarCharactersList == null)
                                            selectedConfig.SimilarCharactersList = new List<SimilarCharactersByConfiguration>();

                                        SimilarCharactersByConfiguration reference = new SimilarCharactersByConfiguration();

                                        if (rdr["IdSearchConfiguration"] != DBNull.Value)
                                            reference.IdSearchConfiguration = Convert.ToUInt16(rdr["IdSearchConfiguration"]);
                                        if (rdr["CharacterA"] != DBNull.Value)
                                            reference.CharacterA = Convert.ToString(rdr["CharacterA"]);
                                        if (rdr["CharacterB"] != DBNull.Value)
                                            reference.CharacterB = Convert.ToString(rdr["CharacterB"]);
                                        if (rdr["Description"] != DBNull.Value)
                                            reference.Description = Convert.ToString(rdr["Description"]);
                                        selectedConfig.SimilarCharactersList.Add(reference);
                                    }
                                }
                            }

                            if (rdr.NextResult())
                            {
                                while (rdr.Read())
                                {
                                    ConfigurationFamily selectedConfig = new ConfigurationFamily();
                                    selectedConfig = lstFamily.FirstOrDefault(i => i.IdSearchConfiguration == Convert.ToInt32(rdr["IdSearchConfiguration"]));
                                    if (selectedConfig != null)
                                    {
                                        if (selectedConfig.ComponentsList == null)
                                            selectedConfig.ComponentsList = new List<ComponentsByConfiguration>();

                                        ComponentsByConfiguration component = new ComponentsByConfiguration();

                                        if (rdr["IdSearchConfiguration"] != DBNull.Value)
                                            component.IdSearchConfiguration = Convert.ToUInt16(rdr["IdSearchConfiguration"]);
                                        if (rdr["IdColor"] != DBNull.Value)
                                            component.IdColor = Convert.ToInt32(rdr["IdColor"]);
                                        if (rdr["IdType"] != DBNull.Value)
                                            component.IdType = Convert.ToInt32(rdr["IdType"]);
                                        var con = 0;
                                        if (rdr["Condition"] != DBNull.Value)
                                            con = Convert.ToInt32(rdr["Condition"]);
                                        if (con == 1)
                                            component.SelectedCondition = "IS";
                                        else
                                            component.SelectedCondition = "NOT";
                                        if (rdr["Reference"] != DBNull.Value)
                                            component.Reference = Convert.ToString(rdr["Reference"]);
                                        selectedConfig.ComponentsList.Add(component);
                                    }
                                }
                            }
                        }
                        connActivity.Close();

                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error GetConfigurationsForSearchFilters_V2490().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }

                return lstFamily;
            }
        }

        public bool SaveConfigurationsForSearchFilters_V2490(List<ConfigurationFamily> configurationList, string mainServerConnectionString)
        {
            bool isUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(mainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConfigurationFamily item in configurationList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertSearchConfiguration_V2490", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("p_IdFamily", item.IdFamily);
                            mySqlCommand.Parameters.AddWithValue("p_NumberOfPages", item.NoOfPages);
                            mySqlCommand.Parameters.AddWithValue("p_ReferencePages", item.RefPages);
                            mySqlCommand.Parameters.AddWithValue("p_ColorPages", item.ColorPages);
                            mySqlCommand.Parameters.AddWithValue("p_SizePages", item.SizePages);
                            mySqlCommand.Parameters.AddWithValue("p_ComponentsPages", item.CompPages);
                            mySqlCommand.Parameters.AddWithValue("p_WaysPages", item.WaysPages);
                            mySqlCommand.Parameters.AddWithValue("p_IdColorA", item.IdColor);
                            item.IdSearchConfiguration = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                            mySqlCommand.ExecuteNonQuery();
                            mySqlConnection.Close();

                            if (item.SimilarCharactersList != null)
                            {
                                item.SimilarCharactersList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddCharactersByConfiguration(mainServerConnectionString, item.SimilarCharactersList, item.IdSearchConfiguration);
                            }

                            if (item.ComponentsList != null)
                            {
                                item.ComponentsList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddComponentsByConfiguration(mainServerConnectionString, item.ComponentsList, item.IdSearchConfiguration);
                            }
                            AddWaysMarginByConfiguration(mainServerConnectionString, item);
                            AddSizeDiameterByConfiguration(mainServerConnectionString, item);
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                    isUpdated = true;
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    Log4NetLogger.Logger.Log(string.Format("Error SaveConfigurationsForSearchFilters_V2490() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    throw;
                }
            }
            return isUpdated;
        }

        public bool AddColorsByConfiguration_V2490(string MainServerConnectionString, List<Tuple<int, int>> colorsList, int idUser)
        {
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    var sortbycolor = colorsList.GroupBy(i => i.Item1);
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Deletesimilarcolorsbyconfiguration_V2490", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();
                    }
                    foreach (var item in sortbycolor)
                    {
                        if (colorsList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();
                                foreach (Tuple<int, int> item1 in item)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_Insertsimilarcolorsbyconfiguration_V2490", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("p_IdColorA", item1.Item1);
                                    mySqlCommand.Parameters.AddWithValue("p_IdColorB", item1.Item2);
                                    mySqlCommand.Parameters.AddWithValue("p_CreatedBy", idUser);
                                    mySqlCommand.Parameters.AddWithValue("p_ModifiedBy", idUser);
                                    mySqlCommand.ExecuteNonQuery();
                                }
                                mySqlConnection.Close();
                            }
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddColorsByConfiguration_V2490() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    throw;
                }
            }
            return true;
        }
        #endregion

        //[GEOS2-5296][rdixit][11.03.2024]
        public List<Data.Common.SCM.Company> GetAllCompany_V2490(string localGeosConnectionString)
        {
            TransactionScope transactionScope = null;
            List<Data.Common.SCM.Company> lstCompany = new List<Data.Common.SCM.Company>();
            Data.Common.SCM.Company company;
            using (transactionScope = new System.Transactions.TransactionScope())
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetAllCompany_V2490", connActivity);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                company = new Data.Common.SCM.Company();
                                company.Id = Convert.ToUInt32(rdr["IdCustomer"]);
                                company.Name = Convert.ToString(rdr["Name"]);
                                lstCompany.Add(company);
                            }
                        }
                        connActivity.Close();
                        transactionScope.Complete();
                    }
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }

                return lstCompany;
            }
        }

        // [rdixit][GEOS2-5485][13.03.2024]
        public bool SaveConfigurationsForSearchFilters_V2500(List<ConfigurationFamily> configurationList, string mainServerConnectionString)
        {
            bool isUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(mainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConfigurationFamily item in configurationList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertSearchConfiguration_V2490", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("p_IdFamily", item.IdFamily);
                            mySqlCommand.Parameters.AddWithValue("p_NumberOfPages", item.NoOfPages);
                            mySqlCommand.Parameters.AddWithValue("p_ReferencePages", item.RefPages);
                            mySqlCommand.Parameters.AddWithValue("p_ColorPages", item.ColorPages);
                            mySqlCommand.Parameters.AddWithValue("p_SizePages", item.SizePages);
                            mySqlCommand.Parameters.AddWithValue("p_ComponentsPages", item.CompPages);
                            mySqlCommand.Parameters.AddWithValue("p_WaysPages", item.WaysPages);
                            mySqlCommand.Parameters.AddWithValue("p_IdColorA", item.IdColor);
                            item.IdSearchConfiguration = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                            mySqlCommand.ExecuteNonQuery();
                            mySqlConnection.Close();

                            if (item.SimilarCharactersList != null)
                            {
                                item.SimilarCharactersList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddCharactersByConfiguration(mainServerConnectionString, item.SimilarCharactersList, item.IdSearchConfiguration);
                            }

                            if (item.ComponentsList != null)
                            {
                                item.ComponentsList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddComponentsByConfiguration(mainServerConnectionString, item.ComponentsList, item.IdSearchConfiguration);
                            }
                            AddWaysMarginByConfiguration_V2500(mainServerConnectionString, item);
                            AddSizeDiameterByConfiguration(mainServerConnectionString, item);
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                    isUpdated = true;
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    Log4NetLogger.Logger.Log(string.Format("Error SaveConfigurationsForSearchFilters_V2500() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    throw;
                }
            }
            return isUpdated;
        }

        // [rdixit][GEOS2-5485][13.03.2024]
        public void AddWaysMarginByConfiguration_V2500(string MainServerConnectionString, ConfigurationFamily Configuration)
        {
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertNumbersmarginbyconfiguration_V2500", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("p_IdSearchConfiguration", Configuration.IdSearchConfiguration);
                    mySqlCommand.Parameters.AddWithValue("p_Margin", Configuration.WayMargin);
                    mySqlCommand.Parameters.AddWithValue("p_CreatedBy", Configuration.CreatedBy);
                    mySqlCommand.Parameters.AddWithValue("p_ModifiedBy", Configuration.ModifiedBy);
                    mySqlCommand.ExecuteNonQuery();
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddWaysMarginByConfiguration_V2500() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        //[pramod.misal][GEOS2-5378][27-03-2024]
        public Connectors GetConnectorProperties_V2500(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorPropertiesByRef_V2500", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                Connectors.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                Connectors.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                Connectors.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["IdStatus"] != DBNull.Value)
                            {
                                Connectors.IdStatus = Convert.ToInt32(reader["IdStatus"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                Connectors.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                Connectors.IdFamily = Convert.ToInt32(reader["IdFamily"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                Connectors.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["IdSubFamily"] != DBNull.Value)
                            {
                                Connectors.IdSubFamily = Convert.ToInt32(reader["IdSubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                Connectors.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["IsSelaed"] != DBNull.Value)
                            {
                                Connectors.IsSealingEnabled = Convert.ToBoolean(reader["IsSelaed"]);
                            }
                            if (reader["Movable"] != DBNull.Value)
                            {
                                Connectors.Movable = Convert.ToInt32(reader["Movable"]);
                            }
                            if (reader["InternalDiameter"] != DBNull.Value)
                            {
                                Connectors.InternalDiameter = Convert.ToDouble(reader["InternalDiameter"]);
                            }
                            if (reader["ExternalDiameter"] != DBNull.Value)
                            {
                                Connectors.ExternalDiameter = Convert.ToDouble(reader["ExternalDiameter"]);
                            }
                            if (reader["Height"] != DBNull.Value)
                            {
                                Connectors.Sheight = Convert.ToDouble(reader["Height"]);
                            }
                            if (reader["Length"] != DBNull.Value)
                            {
                                Connectors.Slength = Convert.ToDouble(reader["Length"]);
                            }
                            if (reader["Width"] != DBNull.Value)
                            {
                                Connectors.SWidth = Convert.ToDouble(reader["Width"]);
                            }
                            if (reader["IdColor"] != DBNull.Value)
                            {
                                Connectors.IdColor = Convert.ToInt32(reader["IdColor"]);
                            }
                            if (reader["IdGender"] != DBNull.Value)
                            {
                                Connectors.IdGender = Convert.ToInt32(reader["IdGender"]);
                            }

                            if (reader["Terminal"] != DBNull.Value)
                            {
                                Connectors.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                Connectors.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                Connectors.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            if (reader["IdType"] != DBNull.Value)
                            {
                                Connectors.IdType = Convert.ToInt32(reader["IdType"]);
                            }
                            if (reader["Status"] != DBNull.Value)
                            {
                                Connectors.Status = Convert.ToString(reader["Status"]);
                            }
                            if (reader["HtmlColor"] != DBNull.Value)
                            {
                                Connectors.HtmlColor = Convert.ToString(reader["HtmlColor"]);
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2490(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return Connectors;
        }

        //[pramod.misal][GEOS2-5378][27-03-2024]
        public List<ConnectorProperties> GetConnectorCustomPropertiesByFamily_V2500(string MainServerConnectionString, UInt32 familyId)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorCustomPropertiesByFamily", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", familyId);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();


                            if (rdr["IdConnectorProperty"] != DBNull.Value)
                            {
                                property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                            }
                            if (rdr["IdFamily"] != DBNull.Value)
                            {
                                property.IdFamily = Convert.ToUInt32(rdr["IdFamily"]);
                            }
                            if (rdr["IsEnabled"] != DBNull.Value)
                            {
                                property.IsEnabled = Convert.ToBoolean(rdr["IsEnabled"]);
                            }
                            if (rdr["Min_Value"] != DBNull.Value)
                            {
                                property.MinValueNew = Convert.ToString(rdr["Min_Value"]);
                            }
                            if (rdr["Max_Value"] != DBNull.Value)
                            {
                                property.MaxValueNew = Convert.ToString(rdr["Max_Value"]);
                            }
                            if (rdr["CustomFamily"] != DBNull.Value)
                            {
                                property.CustomFamily = Convert.ToString(rdr["CustomFamily"]);
                            }
                            if (rdr["DefaultValue"] != DBNull.Value)
                            {
                                property.DefaultValue = Convert.ToString(rdr["DefaultValue"]);
                            }
                            if (rdr["isCustProperty"] != DBNull.Value)
                            {
                                property.IsCustomProperty = Convert.ToInt32(rdr["isCustProperty"]) == 1 ? true : false;
                            }
                            if (rdr["IdConnectorType"] != DBNull.Value)
                            {
                                property.IdConnectorType = Convert.ToInt32(rdr["IdConnectorType"]);
                            }
                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorCustomPropertiesByFamily_V2500().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }

        //[rdixit][29.03.2024][GEOS2-5380]
        public List<SCMConnectorImage> GetAllConnectorImages_V2500(string SCMConnectionString, Connectors Connectors)
        {
            List<SCMConnectorImage> ConnectorImages = new List<Common.SCM.SCMConnectorImage>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectorImages_V2500", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SCMConnectorImage connector = new SCMConnectorImage();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                connector.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                            }
                            if (Connectors.Ref != null)
                            {
                                connector.Ref = Convert.ToString(Connectors.Ref);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.SavedFileName = Convert.ToString(reader["FileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                connector.Position = Convert.ToUInt64(reader["Position"]);
                            }
                            if (reader["CreatedBy"] != DBNull.Value)
                            {
                                connector.CreatedBy = Convert.ToUInt32(reader["CreatedBy"]);
                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                connector.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["IdSite"] != DBNull.Value)
                            {
                                connector.IdSite = Convert.ToInt32(reader["IdSite"]);
                            }
                            if (reader["creator"] != DBNull.Value)
                            {
                                connector.Creator = Convert.ToString(reader["creator"]);
                            }
                            if (reader["ModifiedBy"] != DBNull.Value)
                            {
                                connector.ModifiedBy = Convert.ToUInt32(reader["ModifiedBy"]);
                            }
                            if (reader["ModifiedIn"] != DBNull.Value)
                            {
                                connector.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                            }
                            ConnectorImages.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImages_V2500(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            try
            {
                foreach (SCMConnectorImage itemConnectors in ConnectorImages)
                {
                    // itemConnectors.ImagePath = string.Format(@"{0}\{1}", ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);                                    
                    // itemConnectors.ConnectorsImageInBytes = GetConnectorsImages(ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);
                    itemConnectors.ImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + itemConnectors.Ref + "/" + itemConnectors.SavedFileName;

                    if (!string.IsNullOrEmpty(itemConnectors.ImagePath))
                    {
                        //using (WebClient webClient = new WebClient())
                        //{
                        //    itemConnectors.ConnectorsImageInBytes = webClient.DownloadData(itemConnectors.ImagePath);
                        //}
                        itemConnectors.ConnectorsImageInBytes = Utility.ImageUtil.GetImageByWebClient(itemConnectors.ImagePath);
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImages_V2500(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ConnectorImages;
        }

        //[pramod.misal][GEOS2-5379][29-03-2024]
        public List<ConnectorReference> GetConnectorReferencesByRef_V2500(string localGeosConnectionString, String ConnectorRef)
        {
            List<ConnectorReference> lstConnectorReference = new List<ConnectorReference>();
            List<Common.SCM.Company> CustomerList = new List<Common.SCM.Company>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetAllCustomers", mySqlConnection);
                    cmd.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            Common.SCM.Company comp = new Common.SCM.Company();
                            if (rdr["IdCustomer"] != DBNull.Value)
                            {
                                comp.Id = Convert.ToUInt32(rdr["IdCustomer"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                comp.Name = Convert.ToString(rdr["Name"]);
                            }
                            CustomerList.Add(comp);
                        }
                    }
                    mySqlConnection.Close();
                }
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorRefrerence", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorReference Reference = new ConnectorReference();

                            if (rdr["Ref"] != DBNull.Value)
                            {
                                Reference.Reference = Convert.ToString(rdr["Ref"]);
                            }
                            if (rdr["IdCustomer"] != DBNull.Value)
                            {
                                Reference.IdCustomer = Convert.ToInt32(rdr["IdCustomer"]);
                            }
                            if (rdr["NameC"] != DBNull.Value)
                            {
                                Reference.CreatorName = Convert.ToString(rdr["NameC"]);
                            }
                            if (rdr["SurnameC"] != DBNull.Value)
                            {
                                Reference.CreatorSurname = Convert.ToString(rdr["SurnameC"]);
                            }
                            if (rdr["NameSiteC"] != DBNull.Value)
                            {
                                Reference.CreatorSitename = Convert.ToString(rdr["NameSiteC"]);
                            }
                            if (rdr["CreatedIn"] != DBNull.Value)
                            {
                                if (!string.IsNullOrEmpty(Convert.ToString(rdr["CreatedIn"])))
                                    Reference.CreatedIn = Convert.ToDateTime(rdr["CreatedIn"]);
                            }
                            if (rdr["NameM"] != DBNull.Value)
                            {
                                Reference.ModifierName = Convert.ToString(rdr["NameM"]);
                            }
                            if (rdr["SurnameM"] != DBNull.Value)
                            {
                                Reference.ModifierSurname = Convert.ToString(rdr["SurnameM"]);
                            }
                            if (rdr["NameSiteM"] != DBNull.Value)
                            {
                                Reference.ModifierSitename = Convert.ToString(rdr["NameSiteM"]);
                            }
                            if (rdr["ModifiedIn"] != DBNull.Value)
                            {
                                if (!string.IsNullOrEmpty(Convert.ToString(rdr["ModifiedIn"])))
                                    Reference.ModifiedIn = Convert.ToDateTime(rdr["ModifiedIn"]);
                            }
                            if (rdr["Debugged"] != DBNull.Value)
                            {
                                Reference.Debugged = Convert.ToUInt32(rdr["Debugged"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                Reference.CustomerName = Convert.ToString(rdr["Name"]);
                            }
                            Reference.CompanyList = new List<Common.SCM.Company>(CustomerList);
                            lstConnectorReference.Add(Reference);

                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorReferencesByRef_V2500().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return lstConnectorReference;

        }

        //[rdixit][GEOS2-5380][02.04.2024]
        public List<ConnectorWorkflowStatus> GetAllConnectorStatus(string connectionString)
        {

            List<ConnectorWorkflowStatus> TravelExpenseStatusList = new List<ConnectorWorkflowStatus>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorAllWorkflowStatus", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader mySqlDataReader = mySqlCommand.ExecuteReader())
                    {
                        while (mySqlDataReader.Read())
                        {
                            ConnectorWorkflowStatus TravelExpenseStatus = new ConnectorWorkflowStatus();

                            TravelExpenseStatus.IdWorkflowStatus = Convert.ToByte(mySqlDataReader["IdWorkflowStatus"]);

                            if (mySqlDataReader["IdWorkflow"] != DBNull.Value)
                                TravelExpenseStatus.IdWorkflow = Convert.ToUInt32(mySqlDataReader["IdWorkflow"].ToString());

                            if (mySqlDataReader["Name"] != DBNull.Value)
                                TravelExpenseStatus.Name = mySqlDataReader["Name"].ToString();

                            if (mySqlDataReader["HtmlColor"] != DBNull.Value)
                                TravelExpenseStatus.HtmlColor = mySqlDataReader["HtmlColor"].ToString();

                            if (mySqlDataReader["IdWorkflowScope"] != DBNull.Value)
                                TravelExpenseStatus.IdWorkflowScope = Convert.ToUInt32(mySqlDataReader["IdWorkflowScope"].ToString());

                            TravelExpenseStatusList.Add(TravelExpenseStatus);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorStatus(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return TravelExpenseStatusList;
        }

        //[rdixit][GEOS2-5380][02.04.2024]
        public List<ConnectorWorkflowTransitions> GetAllWorkflowTransitions(string connectionString)
        {

            List<ConnectorWorkflowTransitions> workflowTransitionList = new List<ConnectorWorkflowTransitions>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorworkflowtransitions", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader mySqlDataReader = mySqlCommand.ExecuteReader())
                    {
                        while (mySqlDataReader.Read())
                        {
                            ConnectorWorkflowTransitions workflowTransition = new ConnectorWorkflowTransitions();

                            workflowTransition.IdWorkflowTransition = Convert.ToUInt32(mySqlDataReader["IdWorkflowTransition"]);

                            if (mySqlDataReader["IdWorkflow"] != DBNull.Value)
                                workflowTransition.IdWorkflow = Convert.ToUInt32(mySqlDataReader["IdWorkflow"]);

                            if (mySqlDataReader["Name"] != DBNull.Value)
                                workflowTransition.Name = mySqlDataReader["Name"].ToString();

                            if (mySqlDataReader["IdWorkflowStatusFrom"] != DBNull.Value)
                                workflowTransition.IdWorkflowStatusFrom = Convert.ToByte(mySqlDataReader["IdWorkflowStatusFrom"]);

                            if (mySqlDataReader["IdWorkflowStatusTo"] != DBNull.Value)
                                workflowTransition.IdWorkflowStatusTo = Convert.ToByte(mySqlDataReader["IdWorkflowStatusTo"]);

                            if (mySqlDataReader["IsCommentRequired"] != DBNull.Value)
                                workflowTransition.IsCommentRequired = Convert.ToByte(mySqlDataReader["IsCommentRequired"]);

                            if (mySqlDataReader["IdWorkflowScope"] != DBNull.Value)
                                workflowTransition.IdWorkflowScope = Convert.ToUInt32(mySqlDataReader["IdWorkflowScope"]);

                            if (mySqlDataReader["IsNotificationRaised"] != DBNull.Value)
                                workflowTransition.IsNotificationRaised = Convert.ToUInt32(mySqlDataReader["IsNotificationRaised"]);

                            workflowTransitionList.Add(workflowTransition);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllWorkflowTransitions(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return workflowTransitionList;
        }

        //[pramod.misal][GEOS2-5379][29-03-2024]
        public List<ConnectorComponents> GetConnectorComponentsByRef_V2500(string localGeosConnectionString, String ConnectorRef)
        {
            List<ConnectorComponents> lstConnectorComponents = new List<ConnectorComponents>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorComponentsByRef", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorComponents Component = new ConnectorComponents();
                            if (rdr["IdConnector"] != DBNull.Value)
                            {
                                Component.IdConnector = Convert.ToInt32(rdr["IdConnector"]);
                            }
                            if (rdr["ConnectorRef"] != DBNull.Value)
                            {
                                Component.ConnectorRef = Convert.ToString(rdr["ConnectorRef"]);
                            }
                            if (rdr["componentIdType"] != DBNull.Value)
                            {
                                Component.ComponentIdType = Convert.ToInt32(rdr["componentIdType"]);

                            }
                            if (rdr["componentIdColor"] != DBNull.Value)
                            {
                                Component.ComponentIdColor = Convert.ToUInt16(rdr["componentIdColor"]);
                            }
                            if (rdr["componentRef"] != DBNull.Value)
                            {
                                Component.ComponentRef = Convert.ToString(rdr["componentRef"]);
                            }

                            if (rdr["IdColor"] != DBNull.Value)
                            {
                                Component.Color = new Color();
                                Component.Color.Id = Convert.ToUInt16(rdr["IdColor"]);
                                if (rdr["colour"] != DBNull.Value)
                                {
                                    Component.Color.Name = Convert.ToString(rdr["colour"]);
                                }
                            }

                            if (rdr["ImageName"] != DBNull.Value)
                            {
                                Component.ImageName = Convert.ToString(rdr["ImageName"]);
                                Component.ComponentImagesUrl = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + Component.ConnectorRef + "/" + Component.ImageName;
                            }

                            lstConnectorComponents.Add(Component);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorReferencesByRef_V2500().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorComponents;
        }

        //[GEOS2-5383][rdixit][11.04.2024]
        public List<Connectors> GetAllLinkedConnectorByRef(string localGeosConnectionString, long idConnector)
        {
            List<Connectors> lstConnector = new List<Connectors>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetAllLinkedConnectorsByRef", connActivity);
                    cmd.Parameters.AddWithValue("_Refid", idConnector);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            Connectors linkedConn = new Connectors();
                            if (rdr["IdConnector"] != DBNull.Value)
                            {
                                linkedConn.IdConnector = Convert.ToInt32(rdr["IdConnector"]);
                            }
                            if (rdr["Ref"] != DBNull.Value)
                            {
                                linkedConn.Ref = Convert.ToString(rdr["Ref"]);
                            }
                            if (rdr["LinkTypeName"] != DBNull.Value)
                            {
                                linkedConn.LinkdTypeName = Convert.ToString(rdr["LinkTypeName"]);
                            }
                            if (rdr["FileName"] != DBNull.Value)
                            {
                                linkedConn.FileName = Convert.ToString(rdr["FileName"]);
                                linkedConn.ImagesUrl = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + linkedConn.Ref + "/" + linkedConn.FileName;
                            }

                            lstConnector.Add(linkedConn);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllLinkedConnectorByRef().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnector;
        }

        //[pramod.misal][GEOS2-5379][29-03-2024]
        public List<ConnectorAttachements> GetConnectorAttachementsByRef_V2510(string localGeosConnectionString, String ConnectorRef, string ConnectorAttachedDocPath)
        {
            List<ConnectorAttachements> lstConnectorAttachements = new List<ConnectorAttachements>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorAttachementsByRef", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorAttachements Attachement = new ConnectorAttachements();


                            if (rdr["IdConnector"] != DBNull.Value)
                            {
                                Attachement.Idconnector = Convert.ToInt32(rdr["IdConnector"]);
                            }
                            if (rdr["Ref"] != DBNull.Value)
                            {
                                Attachement.Reference = Convert.ToString(rdr["Ref"]);
                            }
                            if (rdr["Idconnectordoc"] != DBNull.Value)
                            {
                                Attachement.Idconnectordoc = Convert.ToInt32(rdr["Idconnectordoc"]);
                            }
                            if (rdr["OriginalFileName"] != DBNull.Value)
                            {
                                Attachement.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);
                            }
                            if (rdr["SavedFileName"] != DBNull.Value)
                            {
                                Attachement.SavedFileName = Convert.ToString(rdr["SavedFileName"]);
                            }
                            if (rdr["DateCreated"] != DBNull.Value)
                            {
                                Attachement.CreatedDate = Convert.ToDateTime(rdr["DateCreated"]);
                            }
                            if (rdr["DateModified"] != DBNull.Value)
                            {
                                Attachement.ModifiedDate = Convert.ToDateTime(rdr["DateModified"]);
                            }
                            if (rdr["CreatedBy"] != DBNull.Value)
                            {
                                Attachement.CreatedBy = Convert.ToUInt32(rdr["CreatedBy"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                Attachement.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["ModifiedBy"] != DBNull.Value)
                            {
                                Attachement.ModifiedBy = Convert.ToUInt32(rdr["ModifiedBy"]);
                            }
                            if (rdr["idCustomer"] != DBNull.Value)
                            {
                                Attachement.IdCustomer = Convert.ToInt32(rdr["idCustomer"]);
                            }
                            if (rdr["idDocType"] != DBNull.Value)
                            {
                                Attachement.IdDocType = Convert.ToUInt32(rdr["IdDocType"]);
                                Attachement.DocumentType = new DocumentType();
                                Attachement.DocumentType.IdDocumentType = Convert.ToByte(rdr["IdDocType"]);
                                if (rdr["DocumentType"] != DBNull.Value)
                                {
                                    Attachement.DocumentType.Name = Convert.ToString(rdr["DocumentType"]);
                                }

                            }

                            Attachement.ConnectorAttachementsDocInBytes = GetConnectorAttachedDoc(Convert.ToString(Attachement.Reference), ConnectorAttachedDocPath, Attachement.SavedFileName);

                            lstConnectorAttachements.Add(Attachement);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorAttachementsByRef_V2510().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorAttachements;
        }

        //[pramod.misal][GEOS2-5379][29-03-2024]
        public byte[] GetConnectorAttachedDoc(string Reference, string ConnectorAttachedDocPath, string SavedFileName)
        {
            byte[] bytes = null;


            string fileUploadPath = string.Format(@"{0}\{1}\{2}", ConnectorAttachedDocPath, Reference, SavedFileName);

            //System.IO.Directory.GetFiles(fileUploadPath, "*.xml");


            try
            {
                if (File.Exists(fileUploadPath))
                {
                    using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                    {
                        bytes = new byte[stream.Length];
                        int numBytesToRead = (int)stream.Length;
                        int numBytesRead = 0;

                        while (numBytesToRead > 0)
                        {
                            // Read may return anything from 0 to numBytesToRead.
                            int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                            // Break when the end of the file is reached.
                            if (n == 0)
                                break;

                            numBytesRead += n;
                            numBytesToRead -= n;
                        }
                    }
                }

                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetDetectionAttachedDoc(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        //[Sudhir.Jangra][GEOS2-5384]
        public List<SCMConnectorImage> GetAllConnectorImagesForImageSection_V2510(string SCMConnectionString, Connectors Connectors)
        {
            List<SCMConnectorImage> ConnectorImages = new List<Common.SCM.SCMConnectorImage>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectorImagesForImageSection_V2510", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SCMConnectorImage connector = new SCMConnectorImage();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                connector.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                            }
                            if (reader["IdPictureType"] != DBNull.Value)
                            {
                                connector.IdPictureType = Convert.ToInt16(reader["IdPictureType"]);
                            }
                            if (Connectors.Ref != null)
                            {
                                connector.Ref = Convert.ToString(Connectors.Ref);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.SavedFileName = Convert.ToString(reader["FileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                connector.Position = Convert.ToUInt64(reader["Position"]);
                            }
                            if (reader["CreatedBy"] != DBNull.Value)
                            {
                                connector.CreatedBy = Convert.ToUInt32(reader["CreatedBy"]);
                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                connector.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["IdSite"] != DBNull.Value)
                            {
                                connector.IdSite = Convert.ToInt32(reader["IdSite"]);
                            }
                            if (reader["creator"] != DBNull.Value)
                            {
                                connector.Creator = Convert.ToString(reader["creator"]);
                            }
                            if (reader["ModifiedBy"] != DBNull.Value)
                            {
                                connector.ModifiedBy = Convert.ToUInt32(reader["ModifiedBy"]);
                            }
                            if (reader["ModifiedIn"] != DBNull.Value)
                            {
                                connector.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                            }
                            ConnectorImages.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImagesForImageSection_V2510(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            try
            {
                foreach (SCMConnectorImage itemConnectors in ConnectorImages)
                {
                    // itemConnectors.ImagePath = string.Format(@"{0}\{1}", ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);                                    
                    // itemConnectors.ConnectorsImageInBytes = GetConnectorsImages(ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);
                    itemConnectors.ImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + itemConnectors.Ref + "/" + itemConnectors.SavedFileName;

                    if (!string.IsNullOrEmpty(itemConnectors.ImagePath))
                    {
                        //using (WebClient webClient = new WebClient())
                        //{
                        //    itemConnectors.ConnectorsImageInBytes = webClient.DownloadData(itemConnectors.ImagePath);
                        //}
                        itemConnectors.ConnectorsImageInBytes = Utility.ImageUtil.GetImageByWebClient(itemConnectors.ImagePath);
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImagesForImageSection_V2510(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ConnectorImages;
        }

        //[GEOS2-5382][rdixit][19.04.2024]
        public List<ConnectorLocation> GetConnectorLocationsByRef(string localGeosConnectionString, String ConnectorRef)
        {
            List<ConnectorLocation> lstConnectorLocations = new List<ConnectorLocation>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetAllLocationsByRef", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorLocation ConLocation = new ConnectorLocation();
                            if (rdr["Quantity"] != DBNull.Value)
                            {
                                ConLocation.Quantity = Convert.ToInt32(rdr["Quantity"]);
                            }
                            if (rdr["Location"] != DBNull.Value)
                            {
                                ConLocation.Location = Convert.ToString(rdr["Location"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                ConLocation.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Status"] != DBNull.Value)
                            {
                                ConLocation.IsDamaged = (Convert.ToInt32(rdr["Status"]) == 1 ? true : false);
                            }
                            if (rdr["RefSolidWorks"] != DBNull.Value)
                            {
                                ConLocation.RefSolidWorks = Convert.ToString(rdr["RefSolidWorks"]);
                            }
                            if (rdr["NameC"] != DBNull.Value)
                            {
                                ConLocation.CreatorName = Convert.ToString(rdr["NameC"]);
                            }
                            if (rdr["NameSiteC"] != DBNull.Value)
                            {
                                ConLocation.CreatorSitename = Convert.ToString(rdr["NameSiteC"]);
                            }
                            if (rdr["CreatedIn"] != DBNull.Value)
                            {
                                ConLocation.CreatedIn = Convert.ToDateTime(rdr["CreatedIn"]);
                            }
                            if (rdr["NameM"] != DBNull.Value)
                            {
                                ConLocation.ModifierName = Convert.ToString(rdr["NameM"]);
                            }
                            if (rdr["NameSiteM"] != DBNull.Value)
                            {
                                ConLocation.ModifierSitename = Convert.ToString(rdr["NameSiteM"]);
                            }
                            if (rdr["ModifiedIn"] != DBNull.Value)
                            {
                                ConLocation.ModifiedIn = Convert.ToDateTime(rdr["ModifiedIn"]);
                            }
                            if (rdr["ShortName"] != DBNull.Value)
                            {
                                ConLocation.ShortName = Convert.ToString(rdr["ShortName"]);
                            }
                            if (rdr["Idsite"] != DBNull.Value)
                            {
                                ConLocation.Idsite = Convert.ToInt32(rdr["Idsite"]);
                            }
                            if (rdr["IdLocationByConnector"] != DBNull.Value)
                            {
                                ConLocation.IdLocationByConnector = Convert.ToInt32(rdr["IdLocationByConnector"]);
                            }
                            if (rdr["QuantityModified"] != DBNull.Value)
                            {
                                ConLocation.QuantityModified = Convert.ToInt32(rdr["QuantityModified"]);
                            }
                            if (rdr["QuantityWithoutWires"] != DBNull.Value)
                            {
                                ConLocation.QuantityWithoutWires = Convert.ToInt32(rdr["QuantityWithoutWires"]);
                            }
                            if (rdr["QuantityWithoutWiresModified"] != DBNull.Value)
                            {
                                ConLocation.QuantityWithoutWiresModified = Convert.ToInt32(rdr["QuantityWithoutWiresModified"]);
                            }
                            if (rdr["CountryName"] != DBNull.Value)
                            {
                                ConLocation.CountryName = Convert.ToString(rdr["CountryName"]);
                            }
                            if (rdr["iso"] != DBNull.Value)
                            {
                                string iso = Convert.ToString(rdr["iso"]);
                                ConLocation.CountryIconUrl = "https://api.emdep.com/GEOS/Images?FilePath=/Images/Countries/" + iso + ".png";
                            }

                            lstConnectorLocations.Add(ConLocation);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorLocationsByRef().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorLocations;
        }

        //[rdixit][GEOS2-5390][22.04.2024]
        public List<ConnectorLogEntry> GetConnectorLogEntries(string localGeosConnectionString, long idConnector)
        {
            List<ConnectorLogEntry> ConnectorLogEntries = new List<ConnectorLogEntry>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorLogs", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdConnector", idConnector);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            ConnectorLogEntry ConnectorLogEntry = new ConnectorLogEntry();

                            ConnectorLogEntry.IdLogEntryByConnector = Convert.ToUInt32(reader["IdLogEntry"]);

                            ConnectorLogEntry.IdConnector = Convert.ToUInt64(reader["IdConnector"]);

                            if (reader["IdUser"] != DBNull.Value)
                            {
                                ConnectorLogEntry.IdUser = Convert.ToUInt32(reader["IdUser"]);
                            }
                            if (reader["UserName"] != DBNull.Value)
                            {
                                ConnectorLogEntry.UserName = Convert.ToString(reader["UserName"]);
                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                ConnectorLogEntry.Datetime = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["Comments"] != DBNull.Value)
                            {
                                ConnectorLogEntry.Comments = Convert.ToString(reader["Comments"])?.Trim();
                            }
                            if (reader["IdLogEntryType"] != DBNull.Value)
                            {
                                ConnectorLogEntry.IdLogEntryType = Convert.ToUInt32(reader["IdLogEntryType"]);
                            }
                            ConnectorLogEntries.Add(ConnectorLogEntry);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorLogEntries(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return ConnectorLogEntries;
        }

        //[pramod.misal][GEOS2-5379][29-03-2024]
        public List<ConnectorLogEntry> GetConnectorCommentsByRef_V2510(string localGeosConnectionString, Int64 IdConnector)
        {
            List<ConnectorLogEntry> lstConnectorComments = new List<ConnectorLogEntry>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorCommentsByRef", connActivity);
                    cmd.Parameters.AddWithValue("_IdConnector", IdConnector);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorLogEntry Comment = new ConnectorLogEntry();
                            if (rdr["CreatedIn"] != DBNull.Value)
                            {
                                Comment.Datetime = Convert.ToDateTime(rdr["CreatedIn"].ToString());
                            }
                            if (rdr["UserName"] != DBNull.Value)
                            {
                                Comment.UserName = (rdr["UserName"].ToString());
                            }
                            if (rdr["IdPerson"] != DBNull.Value)
                            {
                                Comment.People = new People();
                                Comment.People.IdPerson = Convert.ToInt32(rdr["IdPerson"].ToString());
                                Comment.People.Name = rdr["Name"].ToString();
                                Comment.People.Surname = rdr["Surname"].ToString();
                            }
                            if (rdr["Comments"] != DBNull.Value)
                            {
                                Comment.Comments = (rdr["Comments"].ToString());
                            }
                            if (rdr["IdUser"] != DBNull.Value)
                            {
                                Comment.IdUser = Convert.ToUInt32(rdr["IdUser"]);
                            }
                            if (rdr["IdLogEntry"] != DBNull.Value)
                            {
                                Comment.IdLogEntryByConnector = Convert.ToUInt32(rdr["IdLogEntry"]);
                            }
                            if (rdr["IdLogEntryType"] != DBNull.Value)
                            {
                                Comment.IdLogEntryType = Convert.ToUInt32(rdr["IdLogEntryType"]);
                            }

                            lstConnectorComments.Add(Comment);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorCommentsByRef_V2510().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorComments;
        }

        //[rdixit][GEOS2-5389][26.04.2024]
        public List<ScmDrawing> GetDrawingsByConnectorRef(string localGeosConnectionString, long idConnector)
        {
            List<ScmDrawing> DrawingListByRef = new List<ScmDrawing>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetDrawingsByIdConnector", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdConnector", idConnector);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.HasRows)
                        {
                            while (reader.Read())
                            {
                                ScmDrawing drawing = new ScmDrawing();

                                if (reader["iddrawing"] != DBNull.Value)
                                {
                                    drawing.IdDrawing = Convert.ToUInt32(reader["iddrawing"]);
                                }
                                if (reader["Path"] != DBNull.Value)
                                {
                                    drawing.Path = Convert.ToString(reader["Path"]);
                                }
                                if (reader["SiteName"] != DBNull.Value)
                                {
                                    drawing.SiteName = Convert.ToString(reader["SiteName"]);
                                }
                                if (reader["NameSiteC"] != DBNull.Value)
                                {
                                    drawing.SiteNameC = Convert.ToString(reader["NameSiteC"]);
                                }
                                if (reader["NameSiteM"] != DBNull.Value)
                                {
                                    drawing.SiteNameM = Convert.ToString(reader["NameSiteM"]);
                                }
                                if (reader["NameC"] != DBNull.Value)
                                {
                                    drawing.CreatedBy = Convert.ToString(reader["NameC"])?.Trim();
                                }
                                if (reader["NameM"] != DBNull.Value)
                                {
                                    drawing.ModifiedBy = Convert.ToString(reader["NameM"])?.Trim();
                                }
                                if (reader["CreatedIn"] != DBNull.Value)
                                {
                                    drawing.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                                }
                                if (reader["ModifiedIn"] != DBNull.Value)
                                {
                                    drawing.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                                }
                                if (reader["Debugged"] != DBNull.Value)
                                {
                                    drawing.Debugged = Convert.ToBoolean(reader["Debugged"]);
                                }
                                if (reader["Comments"] != DBNull.Value)
                                {
                                    drawing.Comments = Convert.ToString(reader["Comments"])?.Trim();
                                }

                                if (reader["idcptype"] != DBNull.Value)
                                {
                                    drawing.IdCPType = Convert.ToByte(reader["idcptype"]);
                                }



                                if (reader["CptypeName"] != DBNull.Value)
                                {
                                    drawing.CptypeName = Convert.ToString(reader["CptypeName"]);
                                }
                                if (reader["TemplateName"] != DBNull.Value)
                                {
                                    drawing.TemplateName = Convert.ToString(reader["TemplateName"]);
                                }
                                if (reader["IdTemplate"] != DBNull.Value)
                                {
                                    drawing.IdTemplate = Convert.ToByte(reader["IdTemplate"]);
                                }
                                DrawingListByRef.Add(drawing);
                            }
                        }
                        if (reader.NextResult())
                        {
                            while (reader.Read())
                            {
                                ScmDrawing scmDrawing = DrawingListByRef.Where(t => t.IdDrawing == Convert.ToUInt32(reader["IdDrawing"])).FirstOrDefault();

                                if (scmDrawing != null)
                                {
                                    if (scmDrawing.DetectionList == null)
                                        scmDrawing.DetectionList = new List<SCMDetection>();
                                    SCMDetection sCMDetection = new SCMDetection();
                                    if (reader["IdDetection"] != DBNull.Value)
                                    {
                                        sCMDetection.IdDetection = Convert.ToUInt16(reader["IdDetection"]);
                                    }
                                    if (reader["Name"] != DBNull.Value)
                                    {
                                        sCMDetection.Name = Convert.ToString(reader["Name"]);
                                    }
                                    if (reader["Quantity"] != DBNull.Value)
                                    {
                                        sCMDetection.Quantity = Convert.ToInt32(reader["Quantity"]);
                                    }
                                    scmDrawing.DetectionList.Add(sCMDetection);
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetDrawingsByConnectorRef(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return DrawingListByRef;
        }

        //[rdixit][GEOS2-5389][26.04.2024]
        public List<ArticlesbyDrawing> GetArticlesByDrawing(string MainServerConnectionString, uint idDrawing)
        {
            int maxWeldOrder = 0;
            List<ArticlesbyDrawing> articleByDrawingList = new List<ArticlesbyDrawing>();
            try
            {
                int i = 1;
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetArticlesByDrawing_ByIddrawing", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_idDrawing", idDrawing);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ArticlesbyDrawing articleByDrawing = new ArticlesbyDrawing();
                            articleByDrawing.KeyName = Convert.ToString(i);
                            if (rdr["IdArticle"] != DBNull.Value)
                            {
                                articleByDrawing.IdArticle = Convert.ToInt32(rdr["IdArticle"]);
                            }
                            if (rdr["position"] != DBNull.Value)
                            {
                                articleByDrawing.Position = Convert.ToUInt32(rdr["position"]);
                                articleByDrawing.KeyName = "Group_" + articleByDrawing.Position;
                            }
                            if (rdr["UnlinkFromTechnicalTemplate"] != DBNull.Value)
                            {
                                articleByDrawing.UnlinkFromTechnicalTemplate = Convert.ToBoolean(rdr["UnlinkFromTechnicalTemplate"]);
                            }
                            if (rdr["InverseLink"] != DBNull.Value)
                            {
                                articleByDrawing.InverseLink = Convert.ToBoolean(rdr["InverseLink"]);
                            }
                            if (rdr["reference"] != DBNull.Value)
                            {
                                articleByDrawing.Reference = Convert.ToString(rdr["reference"]);
                            }
                            if (rdr["isobsolete"] != DBNull.Value)
                            {
                                articleByDrawing.IsObsolete = Convert.ToByte(rdr["isobsolete"]);
                            }
                            if (rdr["idarticlesubfamily"] != DBNull.Value)
                            {
                                articleByDrawing.IdArticleSubfamily = Convert.ToUInt32(rdr["idarticlesubfamily"]);
                            }
                            if (rdr["detcode"] != DBNull.Value)
                            {
                                articleByDrawing.Detcode = Convert.ToString(rdr["detcode"]);
                            }
                            //if (rdr["description"] != DBNull.Value)
                            //{
                            //    articleByDrawing.Description = Convert.ToString(rdr["description"]);
                            //}
                            //SECCIÓN
                            if (articleByDrawing.IdArticleSubfamily == 54)
                            {
                                if (rdr["comments"].ToString() != "")
                                    articleByDrawing.Description = rdr["subfamilyname"].ToString() + " " + rdr["comments"].ToString();
                                else
                                    articleByDrawing.Description = rdr["subfamilyname"].ToString();
                            }
                            else
                            {
                                //TORNILLO                                                          
                                if (articleByDrawing.IdArticleSubfamily == 16)
                                {
                                    articleByDrawing.Description = rdr["description"].ToString();
                                }
                                else
                                {
                                    if (!rdr.IsDBNull(rdr.GetOrdinal("subfamilyname")))
                                    {
                                        articleByDrawing.Description = rdr["subfamilyname"].ToString().ToUpper();
                                    }
                                }

                                if (!rdr.IsDBNull(rdr.GetOrdinal("subfamliytypename")))
                                {
                                    articleByDrawing.Description += " " + rdr["subfamliytypename"].ToString().ToUpper();
                                }

                                if (!rdr.IsDBNull(rdr.GetOrdinal("purpose")))
                                {
                                    articleByDrawing.Description += " [" + articleByDrawing.Detcode + ".- " + rdr["detectionname"].ToString() + "]";
                                }

                                articleByDrawing.Description += " " + rdr["comments"].ToString();

                                if (rdr["ways"].ToString() != "")
                                {
                                    articleByDrawing.Description += " (" + rdr["ways"].ToString() + ")";
                                }
                            }
                            if (rdr["subfamilyname"] != DBNull.Value)
                            {
                                articleByDrawing.Subfamilyname = Convert.ToString(rdr["subfamilyname"]);
                            }
                            if (rdr["quantity"] != DBNull.Value)
                            {
                                articleByDrawing.Quantity = Convert.ToUInt32(rdr["quantity"]);
                            }
                            if (rdr["purpose"] != DBNull.Value)
                            {
                                articleByDrawing.Purpose = Convert.ToUInt32(rdr["purpose"]);
                            }
                            if (rdr["idarticlesubfamilytype"] != DBNull.Value)
                            {
                                articleByDrawing.IdArticleSubfamilyType = Convert.ToUInt16(rdr["idarticlesubfamilytype"]);
                            }
                            if (rdr["comments"] != DBNull.Value)
                            {
                                articleByDrawing.Comments = Convert.ToString(rdr["comments"]);
                            }
                            if (rdr["parent"] != DBNull.Value)
                            {
                                articleByDrawing.Parent = Convert.ToByte(rdr["parent"]);
                                articleByDrawing.ParentName = "Group_" + articleByDrawing.Parent;
                            }
                            if (rdr["weldorder"] != DBNull.Value)
                            {
                                articleByDrawing.WeldOrder = Convert.ToUInt32(rdr["weldorder"]);
                            }
                            if (rdr["connectInSerial"] != DBNull.Value)
                            {
                                articleByDrawing.ConnectInSerial = Convert.ToBoolean(rdr["connectInSerial"]);
                            }
                            if (rdr["ways"] != DBNull.Value)
                            {
                                articleByDrawing.Ways = Convert.ToString(rdr["ways"]);
                            }
                            if (rdr["subfamliytypename"] != DBNull.Value)
                            {
                                articleByDrawing.Subfamliytypename = Convert.ToString(rdr["subfamliytypename"]);
                            }
                            if (rdr["detectionname"] != DBNull.Value)
                            {
                                articleByDrawing.Detectionname = Convert.ToString(rdr["detectionname"]);
                            }
                            if (rdr["detectionname_es"] != DBNull.Value)
                            {
                                articleByDrawing.Detectionname_es = Convert.ToString(rdr["detectionname_es"]);
                            }
                            if (rdr["detectionname_fr"] != DBNull.Value)
                            {
                                articleByDrawing.Detectionname_fr = Convert.ToString(rdr["detectionname_fr"]);
                            }
                            if (rdr["Downloadable"] != DBNull.Value)
                            {
                                articleByDrawing.Downloadable = Convert.ToInt32(rdr["Downloadable"]);
                            }
                            if (maxWeldOrder < articleByDrawing.WeldOrder)
                            {
                                maxWeldOrder = Convert.ToInt32(articleByDrawing.WeldOrder);
                            }
                            articleByDrawingList.Add(articleByDrawing);
                            i++;
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetArticlesByDrawing().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            List<ArticlesbyDrawing> DrawingList = new List<ArticlesbyDrawing>(articleByDrawingList);
            if (articleByDrawingList.Count > 0)
                DrawingList = new List<ArticlesbyDrawing>(getWeldOrders(maxWeldOrder, articleByDrawingList));
            return DrawingList;
            return articleByDrawingList;
        }

        private List<ArticlesbyDrawing> getWeldOrders(int maxWeldOrder, List<ArticlesbyDrawing> DrawingList)
        {
            try
            {
                if (maxWeldOrder > 0)
                {
                    int weldOrder = 1;

                    for (int i = 1; i <= maxWeldOrder; i++)
                    {
                        foreach (ArticlesbyDrawing a in DrawingList)
                        {
                            if (a.WeldOrder == i)
                            {
                                if (a.ConnectInSerial)
                                {
                                    a.Description += " [" + weldOrder + "]";
                                }
                                else
                                {
                                    if (a.Quantity == 1)
                                    {
                                        a.Description += " [" + weldOrder + "]";
                                        weldOrder++;
                                    }
                                    else
                                    {
                                        for (int j = 0; j < a.Quantity; j++)
                                        {
                                            if (j == 0)
                                            {
                                                a.Description += " [" + weldOrder.ToString();
                                            }
                                            else if (j == a.Quantity - 1)
                                            {
                                                a.Description += ", " + weldOrder.ToString() + "]";
                                            }
                                            else
                                            {
                                                a.Description += ", " + weldOrder.ToString();
                                            }

                                            weldOrder++;
                                        }
                                    }
                                }
                            }
                            //Added in GDM but ObsoleteArticle value is NotFiniteNumberException there
                            //if (i == maxWeldOrder)
                            //{
                            //    if (a.IsObsolete == 1)
                            //    {
                            //        a.Description += " " + rm.GetString("ObsoleteArticle", culture);
                            //    }
                            //}
                        }
                        if (i == weldOrder)
                        {
                            weldOrder++;
                        }
                    }
                }
            }
            catch (Exception ex)
            {

            }
            return DrawingList;
        }

        //[rdixit][02.05.2024][GEOS2-5476]
        public List<Common.Company> GetAuthorizedPlants(string workbenchConnectionString, Int32 idUser)
        {
            List<Common.Company> companies = new List<Common.Company>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAuthorizedPlants", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_idUser", idUser);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Common.Company company = new Common.Company();
                            if (reader["idSite"] != DBNull.Value)
                            {
                                company.IdCompany = Convert.ToInt32(reader["idSite"]);
                                if (reader["IP"] != DBNull.Value)
                                {
                                    company.IP = Convert.ToString(reader["IP"]);
                                }
                                if (reader["Code"] != DBNull.Value)
                                {
                                    company.Code = Convert.ToString(reader["Code"]);
                                }
                                if (reader["DatabaseIP"] != DBNull.Value)
                                {
                                    company.DatabaseIP = Convert.ToString(reader["DatabaseIP"]);
                                }
                                if (reader["ShortName"] != DBNull.Value)
                                {
                                    company.ShortName = Convert.ToString(reader["ShortName"]);
                                    company.Alias = Convert.ToString(reader["ShortName"]);
                                }
                                if (reader["Name"] != DBNull.Value)
                                {
                                    company.Name = Convert.ToString(reader["Name"]);
                                }
                                if (reader["ServiceProviderUrl"] != DBNull.Value)
                                {
                                    company.ServiceProviderUrl = Convert.ToString(reader["ServiceProviderUrl"]);
                                }
                            }
                            companies.Add(company);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAuthorizedPlants(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return companies;
        }

        //[pramod.misal][GEOS2-5479][30-04-2024]
        public bool UpdateConnectorStatus_V2510(string MainServerConnectionString, ConnectorSearch connectorSearch)
        {
            try
            {
                if (connectorSearch != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorStatus_V2510", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_idConnector", connectorSearch.IdConnector);
                        mySqlCommand.Parameters.AddWithValue("_idWorkflowStatus", connectorSearch.SelectedReferenceStatus.IdWorkflowStatus);
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();
                    }

                    AddConnectorLogEntry(MainServerConnectionString, connectorSearch.IdConnector, connectorSearch.ConnectorChangeLogList?.Where(i => i.TransactionOperation == ModelBase.TransactionOperations.Modify).ToList());
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateConnectorStatus_V2510().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return true;
        }

        //[rdixit][GEOS2-5479][30-04-2024]
        public void AddConnectorLogEntry(string MainServerConnectionString, long IdCPType, List<ConnectorLogEntry> LogList)
        {
            try
            {
                if (LogList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (ConnectorLogEntry logList in LogList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("InsertConnectorLogs", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;

                            mySqlCommand.Parameters.AddWithValue("_IdConnector", IdCPType);
                            mySqlCommand.Parameters.AddWithValue("_IdUser", logList.IdUser);
                            mySqlCommand.Parameters.AddWithValue("_CreatedIn", logList.Datetime);
                            mySqlCommand.Parameters.AddWithValue("_Comments", logList.Comments);
                            mySqlCommand.Parameters.AddWithValue("_IdLogEntryType", logList.IdLogEntryType);
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddConnectorLogEntry(). IdCPType- {0} ErrorMessage- {1}", IdCPType, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        //[rdixit][14.05.2024][GEOS2-5477]
        public bool UpdateConnectorStatus_V2520(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorAttachedDocPath)
        {
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    if (connectorSearch != null)
                    {
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorStatus_V2520", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_idConnector", connectorSearch.IdConnector);
                            mySqlCommand.Parameters.AddWithValue("_idWorkflowStatus", connectorSearch.SelectedReferenceStatus?.IdWorkflowStatus);
                            mySqlCommand.Parameters.AddWithValue("_IdColor", connectorSearch.SelectedColor?.Id);
                            mySqlCommand.Parameters.AddWithValue("_NumWays", connectorSearch.NumWays);
                            mySqlCommand.Parameters.AddWithValue("_IdGender", connectorSearch.SelectedGender?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Description", connectorSearch.Description);
                            mySqlCommand.Parameters.AddWithValue("_Sealed", connectorSearch.IsSealed ? 1 : 0);
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", connectorSearch.SelectedFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", connectorSearch.SelectedSubFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Height", connectorSearch.Height);
                            mySqlCommand.Parameters.AddWithValue("_Length", connectorSearch.Length);
                            mySqlCommand.Parameters.AddWithValue("_Width", connectorSearch.Width);
                            mySqlCommand.Parameters.AddWithValue("_InternalDiameter", connectorSearch.InternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ExternalDiameter", connectorSearch.ExternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedBy", connectorSearch.ModifiedBy);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedIn", connectorSearch.ModifiedIn);
                            mySqlCommand.ExecuteNonQuery();
                            mySqlConnection.Close();
                        }

                        //[Pramod.misal] [15.05.2024]
                        if (connectorSearch.ConnectorCommentsList != null)
                            AddUpdateDeleteConnectorComments_V2520(MainServerConnectionString, connectorSearch.ConnectorCommentsList.ToList());
                        AddUpdateDeleteConnectorReferences_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][16.05.2024][GEOS2-5477]
                        AddUpdateDeleteConnectorComponent_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][22.05.2024][GEOS2-5751]
                        AddDeleteLinkedConnector_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][28.05.2024][GEOS2-5753]
                        //[Pramod.misal] [21.05.2024][GEOS2-5755]
                        if (connectorSearch.ConnectorAttachementFilesList?.Count > 0)
                        {
                            AddUpdateDeleteConnectorAttachementFiles_V2520(MainServerConnectionString, connectorSearch.ConnectorAttachementFilesList.ToList(), ConnectorAttachedDocPath);
                        }
                        AddConnectorLogEntry(MainServerConnectionString, connectorSearch.IdConnector, connectorSearch.UpdatedChangeLogList);
                        transactionScope.Complete();
                        transactionScope.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error UpdateConnectorStatus_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    throw;
                }
            }
            return true;
        }

        //[pramod.misal][15.05.2024][]
        public void AddUpdateDeleteConnectorComments_V2520(string MainServerConnectionString, List<ConnectorLogEntry> connectorCommentList)
        {
            try
            {
                if (connectorCommentList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (ConnectorLogEntry ConnectorComments in connectorCommentList)
                        {

                            if (ConnectorComments.TransactionOperation == ModelBase.TransactionOperations.Add)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorCommentsByIdLogEntry_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", ConnectorComments.IdConnector);
                                mySqlCommand.Parameters.AddWithValue("_IdUser", ConnectorComments.IdUser);
                                mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                mySqlCommand.Parameters.AddWithValue("_Comments", ConnectorComments.Comments);
                                mySqlCommand.Parameters.AddWithValue("_IdLogEntryType", 1);
                                mySqlCommand.ExecuteNonQuery();
                            }
                            else if (ConnectorComments.TransactionOperation == ModelBase.TransactionOperations.Delete)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeletConnectorCommentsByIdLogEntry_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdLogEntry", ConnectorComments.IdLogEntryByConnector);
                                mySqlCommand.ExecuteNonQuery();
                            }
                            else if (ConnectorComments.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorCommentsByIdLogEntry_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdLogEntry", ConnectorComments.IdLogEntryByConnector);
                                mySqlCommand.Parameters.AddWithValue("_CreatedIn", ConnectorComments.Datetime);
                                mySqlCommand.Parameters.AddWithValue("_Comments", ConnectorComments.Comments);
                                mySqlCommand.ExecuteNonQuery();

                            }

                        }
                        mySqlConnection.Close();
                    }
                }




            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateConnectorStatus_V2510().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[pramod.misal][GEOS2-5477][15.05.2024]
        public List<ConnectorAttachements> GetAllConnectorAttachmentTypes(string connectionString)
        {

            List<ConnectorAttachements> ConnectorAttachementsList = new List<ConnectorAttachements>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorAttachementTypes", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader mySqlDataReader = mySqlCommand.ExecuteReader())
                    {
                        while (mySqlDataReader.Read())
                        {
                            ConnectorAttachements ConnectorAttachement = new ConnectorAttachements();
                            if (mySqlDataReader["idDocType"] != DBNull.Value)
                            {
                                ConnectorAttachement.IdDocType = Convert.ToUInt32(mySqlDataReader["idDocType"]);
                                ConnectorAttachement.DocumentType = new DocumentType();
                                if (mySqlDataReader["DocumentType"] != DBNull.Value)
                                {
                                    ConnectorAttachement.DocumentType.Name = Convert.ToString(mySqlDataReader["DocumentType"]);
                                }

                            }

                            ConnectorAttachementsList.Add(ConnectorAttachement);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorAttachmentTypes(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorAttachementsList;
        }

        //[pramod.misal][GEOS2-5477][16-05-2024]
        public List<ConnectorAttachements> GetConnectorAttachementsByRef_V2520(string localGeosConnectionString, String ConnectorRef, string ConnectorAttachedDocPath)
        {
            List<ConnectorAttachements> lstConnectorAttachements = new List<ConnectorAttachements>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorAttachementsByRef_V2520", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorAttachements Attachement = new ConnectorAttachements();


                            if (rdr["IdConnector"] != DBNull.Value)
                            {
                                Attachement.Idconnector = Convert.ToInt32(rdr["IdConnector"]);
                            }
                            if (rdr["Ref"] != DBNull.Value)
                            {
                                Attachement.Reference = Convert.ToString(rdr["Ref"]);
                            }
                            if (rdr["Idconnectordoc"] != DBNull.Value)
                            {
                                Attachement.Idconnectordoc = Convert.ToInt32(rdr["Idconnectordoc"]);
                            }
                            if (rdr["OriginalFileName"] != DBNull.Value)
                            {
                                Attachement.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);
                            }
                            if (rdr["SavedFileName"] != DBNull.Value)
                            {
                                Attachement.SavedFileName = Convert.ToString(rdr["SavedFileName"]);
                            }
                            if (rdr["DateCreated"] != DBNull.Value)
                            {
                                Attachement.CreatedDate = Convert.ToDateTime(rdr["DateCreated"]);
                            }
                            if (rdr["DateModified"] != DBNull.Value)
                            {
                                Attachement.ModifiedDate = Convert.ToDateTime(rdr["DateModified"]);
                            }
                            if (rdr["CreatedBy"] != DBNull.Value)
                            {
                                Attachement.CreatedBy = Convert.ToUInt32(rdr["CreatedBy"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                Attachement.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["ModifiedBy"] != DBNull.Value)
                            {
                                Attachement.ModifiedBy = Convert.ToUInt32(rdr["ModifiedBy"]);
                            }
                            if (rdr["idCustomer"] != DBNull.Value)
                            {
                                Attachement.IdCustomer = Convert.ToInt32(rdr["idCustomer"]);
                            }
                            if (rdr["CustomerName"] != DBNull.Value)
                            {
                                Attachement.CustomerName = Convert.ToString(rdr["CustomerName"]);
                            }
                            if (rdr["idDocType"] != DBNull.Value)
                            {
                                Attachement.IdDocType = Convert.ToUInt32(rdr["IdDocType"]);
                                Attachement.DocumentType = new DocumentType();
                                Attachement.DocumentType.IdDocumentType = Convert.ToByte(rdr["IdDocType"]);
                                if (rdr["DocumentType"] != DBNull.Value)
                                {
                                    Attachement.DocumentType.Name = Convert.ToString(rdr["DocumentType"]);
                                }

                            }

                            Attachement.ConnectorAttachementsDocInBytes = GetConnectorAttachedDoc(Convert.ToString(Attachement.Reference), ConnectorAttachedDocPath, Attachement.SavedFileName);

                            lstConnectorAttachements.Add(Attachement);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorAttachementsByRef_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorAttachements;
        }

        //[rdixit][14.05.2024][GEOS2-5477]
        public List<ConnectorReference> GetConnectorReferencesByRef_V2520(string localGeosConnectionString, String ConnectorRef)
        {
            List<ConnectorReference> lstConnectorReference = new List<ConnectorReference>();
            List<Common.SCM.Company> CustomerList = new List<Common.SCM.Company>();
            try
            {
                #region All Customers
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetAllCustomers_V2520", mySqlConnection);
                    cmd.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            Common.SCM.Company comp = new Common.SCM.Company();
                            if (rdr["IdCustomer"] != DBNull.Value)
                            {
                                comp.Id = Convert.ToUInt32(rdr["IdCustomer"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                comp.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["PatternForConnectorReferences"] != DBNull.Value)
                            {
                                comp.PatternForConnectorReferences = Convert.ToString(rdr["PatternForConnectorReferences"]);
                            }
                            CustomerList.Add(comp);
                        }
                    }
                    mySqlConnection.Close();
                }
                #endregion
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorRefrerence_V2520", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorReference Reference = new ConnectorReference();

                            if (rdr["Ref"] != DBNull.Value)
                            {
                                Reference.Reference = Convert.ToString(rdr["Ref"]);
                                Reference.OldReference = Reference.Reference;
                            }
                            if (rdr["IdCustomer"] != DBNull.Value)
                            {
                                Reference.IdCustomer = Convert.ToInt32(rdr["IdCustomer"]);
                            }
                            if (rdr["NameC"] != DBNull.Value)
                            {
                                Reference.CreatorName = Convert.ToString(rdr["NameC"]);
                            }
                            if (rdr["IdCreator"] != DBNull.Value)
                            {
                                Reference.CreatorId = Convert.ToInt32(rdr["IdCreator"]);
                            }
                            if (rdr["SurnameC"] != DBNull.Value)
                            {
                                Reference.CreatorSurname = Convert.ToString(rdr["SurnameC"]);
                            }
                            if (rdr["NameSiteC"] != DBNull.Value)
                            {
                                Reference.CreatorSitename = Convert.ToString(rdr["NameSiteC"]);
                            }
                            if (rdr["CreatedIn"] != DBNull.Value)
                            {
                                if (!string.IsNullOrEmpty(Convert.ToString(rdr["CreatedIn"])))
                                    Reference.CreatedIn = Convert.ToDateTime(rdr["CreatedIn"]);
                            }
                            if (rdr["NameM"] != DBNull.Value)
                            {
                                Reference.ModifierName = Convert.ToString(rdr["NameM"]);
                            }
                            if (rdr["SurnameM"] != DBNull.Value)
                            {
                                Reference.ModifierSurname = Convert.ToString(rdr["SurnameM"]);
                            }
                            if (rdr["NameSiteM"] != DBNull.Value)
                            {
                                Reference.ModifierSitename = Convert.ToString(rdr["NameSiteM"]);
                            }
                            if (rdr["ModifiedIn"] != DBNull.Value)
                            {
                                if (!string.IsNullOrEmpty(Convert.ToString(rdr["ModifiedIn"])))
                                    Reference.ModifiedIn = Convert.ToDateTime(rdr["ModifiedIn"]);
                            }
                            if (rdr["Debugged"] != DBNull.Value)
                            {
                                Reference.Debugged = Convert.ToUInt32(rdr["Debugged"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                Reference.CustomerName = Convert.ToString(rdr["Name"]);
                            }
                            Reference.CompanyList = new List<Common.SCM.Company>(CustomerList);
                            lstConnectorReference.Add(Reference);

                        }
                    }
                    connActivity.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorReferencesByRef_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorReference;
        }

        //[rdixit][14.05.2024][GEOS2-5477]
        public void AddUpdateDeleteConnectorReferences_V2520(string MainServerConnectionString, ConnectorSearch connectorSearch)
        {
            try
            {
                if (connectorSearch.ReferencesList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (ConnectorReference Connectorref in connectorSearch.ReferencesList.Where(i => i.TransactionOperation == ModelBase.TransactionOperations.Modify ||
                        i.TransactionOperation == ModelBase.TransactionOperations.Update).ToList())
                        {

                            if (Connectorref.TransactionOperation == ModelBase.TransactionOperations.Modify)//Add new
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorReference_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_Ref", Connectorref.Reference);
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                mySqlCommand.Parameters.AddWithValue("_IdCustomer", Connectorref.Company?.Id);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", Connectorref.CreatorId);
                                mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                mySqlCommand.ExecuteNonQuery();
                            }
                            else if (Connectorref.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorReference_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_Ref", Connectorref.Reference);
                                mySqlCommand.Parameters.AddWithValue("_OldRef", Connectorref.OldReference);
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                mySqlCommand.Parameters.AddWithValue("_IdCustomer", Connectorref.Company?.Id);
                                mySqlCommand.Parameters.AddWithValue("_ModifiedBy", Connectorref.CreatorId);
                                mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                mySqlCommand.ExecuteNonQuery();
                            }
                        }
                        mySqlConnection.Close();
                    }
                }
                if (connectorSearch.DeletedReferencesList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (ConnectorReference Connectorref in connectorSearch.DeletedReferencesList)
                        {

                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteConnectorReference_V2520", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_Ref", Connectorref.Reference);
                            mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                            mySqlCommand.Parameters.AddWithValue("_IdCustomer", Connectorref.Company?.Id);
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateConnectorStatus_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[rdixit][14.05.2024][GEOS2-5477]
        public List<Common.SCM.Company> GetAllCompanyList_V2520(string localGeosConnectionString)
        {
            List<Common.SCM.Company> CustomerList = new List<Common.SCM.Company>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetAllCustomers_V2520", mySqlConnection);
                    cmd.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            Common.SCM.Company comp = new Common.SCM.Company();
                            if (rdr["IdCustomer"] != DBNull.Value)
                            {
                                comp.Id = Convert.ToUInt32(rdr["IdCustomer"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                comp.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["PatternForConnectorReferences"] != DBNull.Value)
                            {
                                comp.PatternForConnectorReferences = Convert.ToString(rdr["PatternForConnectorReferences"]);
                            }
                            CustomerList.Add(comp);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllCompanyList_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return CustomerList;

        }

        //[pramod.misal][GEOS2-5379][29-03-2024]
        public List<ConnectorLogEntry> GetConnectorCommentsByRef_V2520(string localGeosConnectionString, Int64 IdConnector)
        {
            List<ConnectorLogEntry> lstConnectorComments = new List<ConnectorLogEntry>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorCommentsByRef_V2520", connActivity);
                    cmd.Parameters.AddWithValue("_IdConnector", IdConnector);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorLogEntry Comment = new ConnectorLogEntry();
                            if (rdr["CreatedIn"] != DBNull.Value)
                            {
                                Comment.Datetime = Convert.ToDateTime(rdr["CreatedIn"].ToString());
                            }
                            if (rdr["UserName"] != DBNull.Value)
                            {
                                Comment.UserName = (rdr["UserName"].ToString());
                            }
                            if (rdr["IdPerson"] != DBNull.Value)
                            {
                                Comment.People = new People();
                                Comment.People.IdPerson = Convert.ToInt32(rdr["IdPerson"].ToString());
                                if (rdr["IdPersonGender"] != DBNull.Value)
                                {
                                    Comment.People.IdPersonGender = Convert.ToByte(rdr["IdPersonGender"].ToString());
                                }
                                Comment.People.Name = rdr["Name"].ToString();
                                Comment.People.Surname = rdr["Surname"].ToString();
                                Comment.People.Login = (rdr["Login"].ToString());
                            }
                            if (rdr["Comments"] != DBNull.Value)
                            {
                                Comment.Comments = (rdr["Comments"].ToString());
                            }
                            if (rdr["IdUser"] != DBNull.Value)
                            {
                                Comment.IdUser = Convert.ToUInt32(rdr["IdUser"]);
                            }
                            if (rdr["IdLogEntry"] != DBNull.Value)
                            {
                                Comment.IdLogEntryByConnector = Convert.ToUInt32(rdr["IdLogEntry"]);
                            }
                            if (rdr["IdLogEntryType"] != DBNull.Value)
                            {
                                Comment.IdLogEntryType = Convert.ToUInt32(rdr["IdLogEntryType"]);
                            }

                            lstConnectorComments.Add(Comment);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorCommentsByRef_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorComments;
        }

        //[rdiixt][22.05.2024][GEOS2-5751]
        public List<ConnectorComponents> GetConnectorComponentsByRef_V2520(string localGeosConnectionString, String ConnectorRef)
        {
            List<ConnectorComponents> lstConnectorComponents = new List<ConnectorComponents>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorComponentsByRef_V2520", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorComponents Component = new ConnectorComponents();
                            if (rdr["IdConnector"] != DBNull.Value)
                            {
                                Component.IdConnector = Convert.ToInt32(rdr["IdConnector"]);
                            }
                            if (rdr["IdComponentsByConnector"] != DBNull.Value)
                            {
                                Component.IdComponentsByConnector = Convert.ToInt32(rdr["IdComponentsByConnector"]);
                            }
                            if (rdr["IdCreater"] != DBNull.Value)
                            {
                                Component.CreatorId = Convert.ToInt32(rdr["IdCreater"]);
                            }
                            if (rdr["ConnectorRef"] != DBNull.Value)
                            {
                                Component.ConnectorRef = Convert.ToString(rdr["ConnectorRef"]);
                            }
                            if (rdr["componentIdType"] != DBNull.Value)
                            {
                                Component.ComponentIdType = Convert.ToInt32(rdr["componentIdType"]);

                            }
                            if (rdr["componentIdColor"] != DBNull.Value)
                            {
                                Component.ComponentIdColor = Convert.ToUInt16(rdr["componentIdColor"]);
                            }
                            if (rdr["componentRef"] != DBNull.Value)
                            {
                                Component.ComponentRef = Convert.ToString(rdr["componentRef"]);
                            }

                            if (rdr["IdColor"] != DBNull.Value)
                            {
                                Component.Color = new Color();
                                Component.Color.Id = Convert.ToUInt16(rdr["IdColor"]);
                                if (rdr["colour"] != DBNull.Value)
                                {
                                    Component.Color.Name = Convert.ToString(rdr["colour"]);
                                }
                            }

                            if (rdr["ImageName"] != DBNull.Value)
                            {
                                Component.ImageName = Convert.ToString(rdr["ImageName"]);
                                Component.ComponentImagesUrl = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + Component.ComponentRef + "/" + Component.ImageName;
                            }

                            lstConnectorComponents.Add(Component);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorComponentsByRef_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorComponents;
        }

        //[rdiixt][22.05.2024][GEOS2-5751]
        public void AddUpdateDeleteConnectorComponent_V2520(string MainServerConnectionString, ConnectorSearch connectorSearch)
        {
            try
            {
                if (connectorSearch.ComponentsList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (ConnectorComponents Connectorcomp in connectorSearch.ComponentsList.Where(i => i.TransactionOperation == ModelBase.TransactionOperations.Modify ||
                        i.TransactionOperation == ModelBase.TransactionOperations.Update).ToList())
                        {

                            if (Connectorcomp.TransactionOperation == ModelBase.TransactionOperations.Modify)//Add new
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorComponents_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                mySqlCommand.Parameters.AddWithValue("_Ref", Connectorcomp.ComponentRef);
                                mySqlCommand.Parameters.AddWithValue("_IdColor", Connectorcomp.Color?.Id);
                                mySqlCommand.Parameters.AddWithValue("_IdType", Connectorcomp.Type?.IdType);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", Connectorcomp.CreatorId);
                                mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                Connectorcomp.IdComponentsByConnector = Convert.ToInt64(mySqlCommand.ExecuteScalar());
                            }
                            else if (Connectorcomp.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorComponent_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdComponentsByConnector", Connectorcomp.IdComponentsByConnector);
                                mySqlCommand.Parameters.AddWithValue("_Ref", Connectorcomp.ComponentRef);
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                mySqlCommand.Parameters.AddWithValue("_IdColor", Connectorcomp.Color?.Id);
                                mySqlCommand.Parameters.AddWithValue("_IdType", Connectorcomp.Type?.IdType);
                                mySqlCommand.Parameters.AddWithValue("_ModifiedBy", Connectorcomp.CreatorId);
                                mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                mySqlCommand.ExecuteNonQuery();
                            }
                        }
                        mySqlConnection.Close();
                    }
                }
                if (connectorSearch.DeletedComponentList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (ConnectorComponents Connectorcomp in connectorSearch.DeletedComponentList)
                        {

                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteConnectorComponent_V2520", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdComponentsByConnector", Connectorcomp.IdComponentsByConnector);
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddUpdateDeleteConnectorComponent_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[pramod.misal][15.05.2024][GEOS2-5755]
        public void AddUpdateDeleteConnectorAttachementFiles_V2520(string MainServerConnectionString, List<ConnectorAttachements> connectorAttachementList, string ConnectorAttachedDocPath)
        {
            try
            {
                if (connectorAttachementList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConnectorAttachements connectorAttachemen in connectorAttachementList)
                        {
                            if (connectorAttachemen.TransactionOperation == ModelBase.TransactionOperations.Modify)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorAttachementByIdconnectordoc_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorAttachemen.Idconnector);
                                mySqlCommand.Parameters.AddWithValue("_OriginalFileName", connectorAttachemen.OriginalFileName);
                                mySqlCommand.Parameters.AddWithValue("_SavedFileName", connectorAttachemen.SavedFileName);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", connectorAttachemen.CreatedBy);
                                mySqlCommand.Parameters.AddWithValue("_Description", connectorAttachemen.Description);
                                mySqlCommand.Parameters.AddWithValue("_idCustomer", connectorAttachemen.IdCustomer);
                                mySqlCommand.Parameters.AddWithValue("_idDocType", connectorAttachemen.IdDocType);
                                connectorAttachemen.Idconnectordoc = Convert.ToInt32(mySqlCommand.ExecuteScalar());

                                if (connectorAttachemen.Idconnectordoc > 0)
                                    InsertConnectorAttachedDoc(connectorAttachemen, ConnectorAttachedDocPath);
                            }
                            else if (connectorAttachemen.TransactionOperation == ModelBase.TransactionOperations.Delete)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeletConnectorAttachementByIdconnectordoc_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_Idconnectordoc", connectorAttachemen.Idconnectordoc);
                                mySqlCommand.ExecuteNonQuery();

                                DeleteConnectorAttachedDoc(connectorAttachemen, ConnectorAttachedDocPath);
                            }
                            else if (connectorAttachemen.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorAttachementByIdconnectordoc_V2520", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_Idconnectordoc", connectorAttachemen.Idconnectordoc);
                                mySqlCommand.Parameters.AddWithValue("_OriginalFileName", connectorAttachemen.OriginalFileName);
                                mySqlCommand.Parameters.AddWithValue("_SavedFileName", connectorAttachemen.SavedFileName);
                                mySqlCommand.Parameters.AddWithValue("_Description", connectorAttachemen.Description);
                                mySqlCommand.Parameters.AddWithValue("_idCustomer", connectorAttachemen.IdCustomer);
                                mySqlCommand.Parameters.AddWithValue("_idDocType", connectorAttachemen.IdDocType);
                                mySqlCommand.Parameters.AddWithValue("_ModifiedBy", connectorAttachemen.CreatedBy);
                                mySqlCommand.ExecuteNonQuery();

                                UpdateConnectorAttachedDoc(connectorAttachemen, ConnectorAttachedDocPath);
                            }

                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddUpdateDeleteConnectorAttachementFiles_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        public string CheckOtherRefIsValid(string localGeosConnectionString, string _ref)
        {
            List<string> ExistRef = new List<string>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_CheckOtherRefIsExist", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", _ref);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            if (rdr["Ref"] != DBNull.Value)
                            {
                                ExistRef.Add(Convert.ToString(rdr["Ref"]));
                            }
                        }
                    }
                    connActivity.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error CheckOtherRefIsValid().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return string.Join(",", ExistRef);
        }

        //[rdiixt][27.05.2024][GEOS2-5753]
        public List<Connectors> GetAllLinkedConnectorByRef_V2520(string localGeosConnectionString, long idConnector)
        {
            List<Connectors> lstConnector = new List<Connectors>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetAllLinkedConnectorsByRef_V2520", connActivity);
                    cmd.Parameters.AddWithValue("_Refid", idConnector);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            Connectors linkedConn = new Connectors();
                            if (rdr["IdConnector"] != DBNull.Value)
                            {
                                linkedConn.IdConnector = Convert.ToInt32(rdr["IdConnector"]);
                            }
                            if (rdr["Ref"] != DBNull.Value)
                            {
                                linkedConn.Ref = Convert.ToString(rdr["Ref"]);
                            }
                            if (rdr["CreatedBy"] != DBNull.Value)
                            {
                                linkedConn.CreatorId = Convert.ToInt32(rdr["CreatedBy"]);
                            }
                            if (rdr["FileName"] != DBNull.Value)
                            {
                                linkedConn.FileName = Convert.ToString(rdr["FileName"]);
                                linkedConn.ImagesUrl = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + linkedConn.Ref + "/" + linkedConn.FileName;
                            }
                            if (rdr["IsConnector"] != DBNull.Value)
                            {
                                Connectors conn = (Connectors)linkedConn.Clone();
                                conn.LinkdTypeName = Convert.ToString(rdr["ConnectorName"]);
                                conn.IdLinkdType = 1;
                                lstConnector.Add(conn);
                            }
                            if (rdr["IsComponent"] != DBNull.Value)
                            {
                                Connectors conn = (Connectors)linkedConn.Clone();
                                conn.LinkdTypeName = Convert.ToString(rdr["ComponentName"]);
                                conn.IdLinkdType = 2;
                                lstConnector.Add(conn);
                            }
                            if (rdr["IsTerminal"] != DBNull.Value)
                            {
                                Connectors conn = (Connectors)linkedConn.Clone();
                                conn.LinkdTypeName = Convert.ToString(rdr["TerminalName"]);
                                conn.IdLinkdType = 3;
                                lstConnector.Add(conn);
                            }
                            if (rdr["IsOther"] != DBNull.Value)
                            {
                                Connectors conn = (Connectors)linkedConn.Clone();
                                conn.LinkdTypeName = Convert.ToString(rdr["OtherName"]);
                                conn.IdLinkdType = 4;
                                lstConnector.Add(conn);
                            }
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllLinkedConnectorByRef_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnector;
        }

        //[rdiixt][27.05.2024][GEOS2-5753]
        public List<LinkType> GetAllLinkTypes(string localGeosConnectionString)
        {
            List<LinkType> lstConnector = new List<LinkType>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetAllLinkTypes", connActivity);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            LinkType linkedConn = new LinkType();
                            if (rdr["IdLinkType"] != DBNull.Value)
                            {
                                linkedConn.IdLinkType = Convert.ToInt32(rdr["IdLinkType"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                linkedConn.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["IdPartnerLinkType"] != DBNull.Value)
                            {
                                linkedConn.IdPartnerLinkType = Convert.ToInt32(rdr["IdPartnerLinkType"]);
                            }
                            if (rdr["IdLinkTypeScope"] != DBNull.Value)
                            {
                                linkedConn.IdLinkTypeScope = Convert.ToInt32(rdr["IdLinkTypeScope"]);
                            }
                            lstConnector.Add(linkedConn);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllLinkTypes().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnector;
        }

        //[rdiixt][27.05.2024][GEOS2-5753]
        public Connectors CheckLinkedRefIsValid(string localGeosConnectionString, string _ref)
        {
            Connectors linkedConn = new Connectors();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_CheckLinkedRefIsValid", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", _ref);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            if (rdr["IdConnector"] != DBNull.Value)
                            {
                                linkedConn.IdConnector = Convert.ToInt32(rdr["IdConnector"]);
                            }
                            if (rdr["Ref"] != DBNull.Value)
                            {
                                linkedConn.Ref = Convert.ToString(rdr["Ref"]);
                            }
                            if (rdr["CreatedBy"] != DBNull.Value)
                            {
                                linkedConn.CreatorId = Convert.ToInt32(rdr["CreatedBy"]);
                            }
                            if (rdr["FileName"] != DBNull.Value)
                            {
                                linkedConn.FileName = Convert.ToString(rdr["FileName"]);
                                linkedConn.ImagesUrl = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + linkedConn.Ref + "/" + linkedConn.FileName;
                            }
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error CheckLinkedRefIsValid().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return linkedConn;
        }

        //[rdiixt][27.05.2024][GEOS2-5753]
        public void AddDeleteLinkedConnector_V2520(string MainServerConnectionString, ConnectorSearch connectorSearch)
        {
            try
            {
                if (connectorSearch.LinkedConnectorList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (Connectors Conn in connectorSearch.LinkedConnectorList.Where(i => i.TransactionOperation ==
                        ModelBase.TransactionOperations.Modify))
                        {
                            if (Conn != null)
                            {
                                if (Conn.TransactionOperation == ModelBase.TransactionOperations.Modify)//Add new
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_associatedconnectors_Insert", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_idConnectorA", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_idConnectorB", Conn.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", Conn.CreatorId);
                                    if (Conn.IdLinkdType == 1)
                                    {
                                        mySqlCommand.Parameters.AddWithValue("_IsConnector", 1);
                                        mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                                    }
                                    else if (Conn.IdLinkdType == 2)
                                    {
                                        mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsComponent", 1);
                                        mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                                    }
                                    else if (Conn.IdLinkdType == 3)
                                    {
                                        mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsTerminal", 1);
                                        mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                                    }
                                    else
                                    {
                                        mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                        mySqlCommand.Parameters.AddWithValue("_IsOther", 1);
                                    }
                                    mySqlCommand.ExecuteNonQuery();
                                }
                            }
                        }
                        mySqlConnection.Close();
                    }
                }
                if (connectorSearch.DeletedLinkedConnectorList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (Connectors Conn in connectorSearch.DeletedLinkedConnectorList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteLinkedConnector", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_idConnectorA", connectorSearch.IdConnector);
                            mySqlCommand.Parameters.AddWithValue("_idConnectorB", Conn.IdConnector);
                            if (Conn.IdLinkdType == 1)
                            {
                                mySqlCommand.Parameters.AddWithValue("_IsConnector", 1);
                                mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                            }
                            else if (Conn.IdLinkdType == 2)
                            {
                                mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                mySqlCommand.Parameters.AddWithValue("_IsComponent", 1);
                                mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                            }
                            else if (Conn.IdLinkdType == 3)
                            {
                                mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                mySqlCommand.Parameters.AddWithValue("_IsTerminal", 1);
                                mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                            }
                            else
                            {
                                mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                mySqlCommand.Parameters.AddWithValue("_IsOther", 1);
                            }
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddDeleteLinkedConnector_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[rdixit][GEOS2-5477][28-05-2024]
        public bool InsertConnectorAttachedDoc(ConnectorAttachements attachment, string ConnectorAttachedDocPath)
        {
            string completePath = string.Format(@"{0}\{1}", ConnectorAttachedDocPath, attachment.Reference);
            string filePath = completePath + "\\" + attachment.SavedFileName;
            try
            {

                if (!Directory.Exists(completePath))
                {
                    Directory.CreateDirectory(completePath);
                }
                else
                {
                    if (File.Exists(filePath))
                    {
                        File.Delete(filePath);
                    }
                }
                File.WriteAllBytes(filePath, attachment.ConnectorAttachementsDocInBytes);
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error InsertConnectorAttachedDoc(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return true;
        }
        //[rdixit][GEOS2-5477][28-05-2024]
        public bool UpdateConnectorAttachedDoc(ConnectorAttachements attachment, string ConnectorAttachedDocPath)
        {
            if (attachment.ConnectorAttachementsDocInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\{1}", ConnectorAttachedDocPath, attachment.Reference);
                    string filePath = completePath + "\\" + attachment.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    else
                    {
                        //DirectoryInfo di = new DirectoryInfo(completePath);
                        //foreach (FileInfo file in di.GetFiles())
                        //{
                        //    file.Delete();
                        //}

                        if (File.Exists(filePath))
                        {
                            File.Delete(filePath);
                        }
                    }

                    File.WriteAllBytes(filePath, attachment.ConnectorAttachementsDocInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error UpdateConnectorAttachedDoc()- Filename - {0}. ErrorMessage- {1}", attachment.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }
        //[rdixit][GEOS2-5477][28-05-2024]
        public bool DeleteConnectorAttachedDoc(ConnectorAttachements attachment, string ConnectorAttachedDocPath)
        {
            try
            {
                if (ConnectorAttachedDocPath != null)
                {
                    string completePath = string.Format(@"{0}\{1}", ConnectorAttachedDocPath, attachment.Reference);
                    string filePath = completePath + "\\" + attachment.SavedFileName;

                    if (!File.Exists(filePath))
                    {
                        return false;
                    }
                    else
                    {
                        File.Delete(filePath);
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error DeleteConnectorAttachedDoc()- Filename - {0}. ErrorMessage- {1}", attachment.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return true;
        }

        //[rushikesh.gaikwad][18.06.2024]
        public List<ScmDrawing> GetDrawingsByConnectorRef_V2530(string localGeosConnectionString, long idConnector)
        {
            List<ScmDrawing> DrawingListByRef = new List<ScmDrawing>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetDrawingsByIdConnector", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdConnector", idConnector);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.HasRows)
                        {
                            while (reader.Read())
                            {
                                ScmDrawing drawing = new ScmDrawing();

                                if (reader["iddrawing"] != DBNull.Value)
                                {
                                    drawing.IdDrawing = Convert.ToUInt32(reader["iddrawing"]);
                                }
                                if (reader["Path"] != DBNull.Value)
                                {
                                    drawing.Path = Convert.ToString(reader["Path"]);
                                }
                                if (reader["SiteName"] != DBNull.Value)
                                {
                                    drawing.SiteName = Convert.ToString(reader["SiteName"]);
                                }
                                if (reader["NameSiteC"] != DBNull.Value)
                                {
                                    drawing.SiteNameC = Convert.ToString(reader["NameSiteC"]);
                                }
                                if (reader["NameSiteM"] != DBNull.Value)
                                {
                                    drawing.SiteNameM = Convert.ToString(reader["NameSiteM"]);
                                }
                                if (reader["NameC"] != DBNull.Value)
                                {
                                    drawing.CreatedBy = Convert.ToString(reader["NameC"])?.Trim();
                                }
                                if (reader["NameM"] != DBNull.Value)
                                {
                                    drawing.ModifiedBy = Convert.ToString(reader["NameM"])?.Trim();
                                }
                                if (reader["CreatedIn"] != DBNull.Value)
                                {
                                    drawing.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                                }
                                if (reader["ModifiedIn"] != DBNull.Value)
                                {
                                    drawing.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                                }
                                if (reader["Debugged"] != DBNull.Value)
                                {
                                    drawing.Debugged = Convert.ToBoolean(reader["Debugged"]);
                                }
                                if (reader["Comments"] != DBNull.Value)
                                {
                                    drawing.Comments = Convert.ToString(reader["Comments"])?.Trim();
                                }

                                //if (reader["idcptype"] != DBNull.Value)
                                //{
                                //    drawing.IdCPType = Convert.ToByte(reader["idcptype"]);
                                //}

                                if (reader["idcptype"] != DBNull.Value)
                                {
                                    drawing.IdCPTypenew = Convert.ToInt64(reader["idcptype"]);
                                }

                                if (reader["CptypeName"] != DBNull.Value)
                                {
                                    drawing.CptypeName = Convert.ToString(reader["CptypeName"]);
                                }
                                if (reader["TemplateName"] != DBNull.Value)
                                {
                                    drawing.TemplateName = Convert.ToString(reader["TemplateName"]);
                                }
                                if (reader["IdTemplate"] != DBNull.Value)
                                {
                                    drawing.IdTemplate = Convert.ToByte(reader["IdTemplate"]);
                                }
                                DrawingListByRef.Add(drawing);
                            }
                        }
                        if (reader.NextResult())
                        {
                            while (reader.Read())
                            {
                                ScmDrawing scmDrawing = DrawingListByRef.Where(t => t.IdDrawing == Convert.ToUInt32(reader["IdDrawing"])).FirstOrDefault();

                                if (scmDrawing != null)
                                {
                                    if (scmDrawing.DetectionList == null)
                                        scmDrawing.DetectionList = new List<SCMDetection>();
                                    SCMDetection sCMDetection = new SCMDetection();
                                    if (reader["IdDetection"] != DBNull.Value)
                                    {
                                        sCMDetection.IdDetection = Convert.ToUInt16(reader["IdDetection"]);
                                    }
                                    if (reader["Name"] != DBNull.Value)
                                    {
                                        sCMDetection.Name = Convert.ToString(reader["Name"]);
                                    }
                                    if (reader["Quantity"] != DBNull.Value)
                                    {
                                        sCMDetection.Quantity = Convert.ToInt32(reader["Quantity"]);
                                    }
                                    scmDrawing.DetectionList.Add(sCMDetection);
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetDrawingsByConnectorRef(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return DrawingListByRef;
        }


        //[pramod.misal][GEOS2-5524][06.08.2024]
        public List<SCMLocationsManager> GetSCMLocationsManagerByIdSCM_V2550(string WorkbenchConnectionString, Data.Common.Company selectedPlant)
        {

            List<SCMLocationsManager> scmLocationsManager = new List<SCMLocationsManager>();

            try
            {
                using (MySqlConnection con = new MySqlConnection(WorkbenchConnectionString))
                {
                    con.Open();
                    MySqlCommand concommand = new MySqlCommand("GetSCMLocationsManagerByIdSCM_V2540", con);
                    concommand.CommandType = CommandType.StoredProcedure;
                    concommand.Parameters.AddWithValue("_IdSite", selectedPlant.IdCompany);
                    using (MySqlDataReader reader = concommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SCMLocationsManager scmLocation = new SCMLocationsManager();

                            if (reader["IdSampleLocation"] != DBNull.Value)
                            {
                                scmLocation.IdSampleLocation = Convert.ToInt64(reader["IdSampleLocation"]);
                            }
                            if (reader["IdSite"] != DBNull.Value)
                            {
                                scmLocation.IdSite = Convert.ToInt64(reader["IdSite"]);
                            }
                            if (reader["Name"] != DBNull.Value)
                            {
                                scmLocation.Name = Convert.ToString(reader["Name"]);
                            }
                            if (reader["Parent"] != DBNull.Value)
                            {
                                scmLocation.Parent = Convert.ToInt64(reader["Parent"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                scmLocation.Position = Convert.ToInt64(reader["Position"]);
                            }
                            if (reader["FullName"] != DBNull.Value)
                            {
                                scmLocation.FullName = Convert.ToString(reader["FullName"]);
                            }
                            if (reader["IsLeaf"] != DBNull.Value)
                            {
                                scmLocation.IsLeaf = Convert.ToSByte(reader["IsLeaf"]);
                            }
                            if (reader["HtmlColor"] != DBNull.Value)
                            {
                                scmLocation.HtmlColor = Convert.ToString(reader["HtmlColor"]);
                            }
                            if (reader["InUse"] != DBNull.Value)
                            {
                                scmLocation.InUse = Convert.ToBoolean(reader["InUse"]);
                            }
                            if (reader["Title"] != DBNull.Value)
                            {
                                scmLocation.Title = Convert.ToString(reader["Title"]);

                            }
                            scmLocationsManager.Add(scmLocation);
                        }
                    }
                }

                return scmLocationsManager;

            }
            catch (Exception ex)
            {

                Log4NetLogger.Logger.Log(string.Format("Error GetSCMLocationsManagerByIdSCM_V2550(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[pramod.misal] [GEOS2-5525] [08.08.2024]
        public Int64 GetMaxPosition(Int64 idParent, Int64 idCompany, string connectionString)
        {
            Int64 Pos = 0;
            try
            {

                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    //MySqlCommand mySqlCommand = new MySqlCommand("WMS_warehouselocationsGetMaxPosition", mySqlConnection);
                    MySqlCommand mySqlCommand = new MySqlCommand("SampleLocation_GetMaxPosition_V2550", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_Parent", idParent);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idCompany);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.Read())
                        {
                            if (reader["pos"] != DBNull.Value)
                                Pos = Convert.ToInt64(reader["pos"]);
                        }

                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetMaxPosition(Parent-{0}, idCompany-{1}). ErrorMessage- {2}", idParent, idCompany, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return Pos;
        }

        //[pramod.misal] [GEOS2-5525] [09.08.2024]
        public SCMLocationsManager AddSCMLocation(string mainServerConnectionString, SCMLocationsManager scmLocationsManager)
        {
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(mainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        //MySqlCommand mySqlCommand = new MySqlCommand("WMS_warehouselocationsInsert_V2220", mySqlConnection);
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertSampleLocationsById_V2550", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_Position", scmLocationsManager.Position);
                        mySqlCommand.Parameters.AddWithValue("_FullName", scmLocationsManager.FullName);
                        mySqlCommand.Parameters.AddWithValue("_Idsite", scmLocationsManager.IdSite);
                        mySqlCommand.Parameters.AddWithValue("_Parent", scmLocationsManager.Parent);
                        mySqlCommand.Parameters.AddWithValue("_Name", scmLocationsManager.Name);
                        mySqlCommand.Parameters.AddWithValue("_IsLeaf", scmLocationsManager.IsLeaf);
                        mySqlCommand.Parameters.AddWithValue("_InUse", scmLocationsManager.InUse);
                        mySqlCommand.Parameters.AddWithValue("_HtmlColor", scmLocationsManager.HtmlColor);
                        mySqlCommand.Parameters.AddWithValue("_Title", scmLocationsManager.Title);


                        scmLocationsManager.IdSampleLocation = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                        mySqlConnection.Close();
                    }

                    transactionScope.Complete();
                    transactionScope.Dispose();
                    bool isupdateReIndex = UpdateReIndexSampleLocation(scmLocationsManager.IdSampleLocation, scmLocationsManager.IdSite, scmLocationsManager.Parent, mainServerConnectionString);
                    scmLocationsManager = GetSampleLocationsByIdsite(mainServerConnectionString, scmLocationsManager.IdSampleLocation);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddSCMLocation(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }

            return scmLocationsManager;
        }

        //[pramod.misal][GEOS2-5525][09.08.2024]
        public bool UpdateReIndexSampleLocation(Int64 idSampleLocation, Int64 idSite, Int64 idParent, string mainConnectionString)
        {
            List<SCMLocationsManager> sampleLocationLst = new List<SCMLocationsManager>();
            Int64 position = 0;
            bool isUpdated = false;


            try
            {

                using (MySqlConnection mySqlConnection = new MySqlConnection(mainConnectionString))
                {
                    mySqlConnection.Open();

                    //MySqlCommand mySqlCommand = new MySqlCommand("warehouselocation_GetWarehouseLocationByParent", mySqlConnection);
                    MySqlCommand mySqlCommand = new MySqlCommand("Sample_Locations_GetSampleLocationsByParent_V2550", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_Parent", idParent);
                    mySqlCommand.Parameters.AddWithValue("_Idsite", idSite);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SCMLocationsManager scmLocationsManager = new SCMLocationsManager();
                            if (reader["IdSampleLocation"] != DBNull.Value)
                                scmLocationsManager.IdSampleLocation = Convert.ToInt64(reader["IdSampleLocation"]);
                            if (reader["idsite"] != DBNull.Value)
                                scmLocationsManager.IdSite = Convert.ToInt64(reader["idsite"]);
                            if (reader["Parent"] != DBNull.Value)
                                scmLocationsManager.Parent = Convert.ToInt64(reader["Parent"]);
                            if (reader["Position"] != DBNull.Value)
                                scmLocationsManager.Position = Convert.ToInt64(reader["Position"]);
                            if (reader["FullName"] != DBNull.Value)
                                scmLocationsManager.FullName = Convert.ToString(reader["FullName"]);
                            sampleLocationLst.Add(scmLocationsManager);

                        }

                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllWarehouselocation(idParent-{0}, idWarehouse-{1}). ErrorMessage- {2}", idParent, idSite, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            Int64 AddedPosition = sampleLocationLst.Where(i => i.IdSampleLocation == idSampleLocation).FirstOrDefault().Position;


            position = 1;
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {


                    using (MySqlConnection mySqlConnection = new MySqlConnection(mainConnectionString))
                    {
                        mySqlConnection.Open();

                        //MySqlCommand mySqlCommand = new MySqlCommand("warehouselocations_UpdatePosition", mySqlConnection);
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_SampleLocation_UpdatePosition_V2550", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;

                        bool IsChecked = false;
                        foreach (SCMLocationsManager item in sampleLocationLst.Where(i => i.Position > 0 && i.IdSampleLocation != idSampleLocation).OrderBy(wl => wl.Position))
                        {

                            if (position == AddedPosition)
                            {
                                position = position + 1;
                            }

                            mySqlCommand.Parameters.Clear();
                            mySqlCommand.Parameters.AddWithValue("_IdSampleLocation", item.IdSampleLocation);
                            mySqlCommand.Parameters.AddWithValue("_Position", position);
                            mySqlCommand.ExecuteNonQuery();
                            item.Position = position;
                            position = position + 1;
                        }


                        Dictionary<Int64, Int64> dict = new Dictionary<Int64, Int64>();
                        foreach (SCMLocationsManager item in sampleLocationLst.Where(i => i.Position > 0).OrderBy(wl => wl.Position))
                        {
                            dict.Add(item.IdSampleLocation, item.Position);
                        }

                        position = 0;
                        //  position = warehouseLocationLst.Where(i => i.Position > 0).Count();
                        foreach (SCMLocationsManager item in sampleLocationLst.Where(i => i.Position == 0).OrderBy(wl => wl.IdSampleLocation))
                        {
                            isCheckedPosition = false;
                            //if(dict.Any(i=>i.Value==position))
                            //{
                            if (position == 0)
                            {
                                position = position + 1;
                            }

                            checkPosition(position, dict);
                            position = addedPosition;
                            //position = position + 1;
                            //  }

                            mySqlCommand.Parameters.Clear();
                            mySqlCommand.Parameters.AddWithValue("_IdSampleLocation", item.IdSampleLocation);
                            mySqlCommand.Parameters.AddWithValue("_Position", position);
                            mySqlCommand.ExecuteNonQuery();
                            item.Position = position;
                            position = position + 1;


                        }

                        mySqlConnection.Close();
                    }

                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error UpdateReIndexSampleLocation(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return isUpdated;
        }
        //[pramod.misal][GEOS2-5525][09.08.2024]
        private void checkPosition(Int64 position, Dictionary<Int64, Int64> dict)
        {
            if (isCheckedPosition == false)
            {
                if (!dict.Any(i => i.Value == position))
                {
                    isCheckedPosition = true;
                    addedPosition = position;
                    return;
                }
                else
                {
                    position = position + 1;
                    if (isCheckedPosition == false)
                    {
                        checkPosition(position, dict);
                    }
                    else
                    {
                        return;
                    }


                }
            }
            else
            {
                return;
            }

        }
        //[pramod.misal][GEOS2-5525][09.08.2024]
        public SCMLocationsManager GetSampleLocationsByIdsite(string connectionString, Int64 idSampleLocation)
        {

            SCMLocationsManager samplelocation = new SCMLocationsManager();
            using (MySqlConnection con = new MySqlConnection(connectionString))
            {
                con.Open();
                //MySqlCommand concommand = new MySqlCommand("warehouselocations_GetWarehouselocationById", con);
                MySqlCommand concommand = new MySqlCommand("samplelocation_GetSampleLocationById_V2550", con);
                concommand.CommandType = CommandType.StoredProcedure;
                concommand.Parameters.AddWithValue("_IdSampleLocation", idSampleLocation);
                using (MySqlDataReader reader = concommand.ExecuteReader())
                {
                    while (reader.Read())
                    {

                        if (reader["IdSampleLocation"] != DBNull.Value)
                            samplelocation.IdSampleLocation = Convert.ToInt64(reader["IdSampleLocation"]);

                        if (reader["idsite"] != DBNull.Value)
                            samplelocation.IdSite = Convert.ToInt64(reader["idsite"]);

                        samplelocation.Name = Convert.ToString(reader["Name"]);

                        if (reader["Title"] != DBNull.Value)
                            samplelocation.Title = Convert.ToString(reader["Title"]);

                        if (reader["Parent"] != DBNull.Value)
                            samplelocation.Parent = Convert.ToInt64(reader["Parent"]);

                        if (reader["Position"] != DBNull.Value)
                            samplelocation.Position = Convert.ToInt64(reader["Position"]);

                        if (reader["FullName"] != DBNull.Value)
                            samplelocation.FullName = Convert.ToString(reader["FullName"]);

                        if (reader["IsLeaf"] != DBNull.Value)
                            samplelocation.IsLeaf = Convert.ToSByte(reader["IsLeaf"]);

                        if (reader["HtmlColor"] != DBNull.Value)
                            samplelocation.HtmlColor = Convert.ToString(reader["HtmlColor"]);

                        if (reader["InUse"] != DBNull.Value)
                            samplelocation.InUse = Convert.ToBoolean(reader["InUse"]);

                    }
                }
            }

            return samplelocation;
        }

        //[pramod.misal] [GEOS2-5525] [09.08.2024]
        public SCMLocationsManager UpdateSCMLocation(string mainServerConnectionString, SCMLocationsManager scmLocationsManager)
        {

            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(mainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        //MySqlCommand mySqlCommand = new MySqlCommand("WMS_warehouselocationsUpdate_V2220", mySqlConnection);
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_samplelocationsUpdate_V2550", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdSampleLocation", scmLocationsManager.IdSampleLocation);
                        mySqlCommand.Parameters.AddWithValue("_Position", scmLocationsManager.Position);
                        mySqlCommand.Parameters.AddWithValue("_Parent", scmLocationsManager.Parent);
                        mySqlCommand.Parameters.AddWithValue("_Name", scmLocationsManager.Name);
                        mySqlCommand.Parameters.AddWithValue("_IsLeaf", scmLocationsManager.IsLeaf);
                        mySqlCommand.Parameters.AddWithValue("_InUse", scmLocationsManager.InUse);
                        mySqlCommand.Parameters.AddWithValue("_IdSite", scmLocationsManager.IdSite);
                        mySqlCommand.Parameters.AddWithValue("_HtmlColor", scmLocationsManager.HtmlColor);
                        mySqlCommand.Parameters.AddWithValue("_FullName", scmLocationsManager.FullName);
                        mySqlCommand.Parameters.AddWithValue("_Title", scmLocationsManager.Title);

                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();
                    }

                    transactionScope.Complete();
                    transactionScope.Dispose();
                    bool isupdateReIndex = UpdateReIndexSampleLocation(scmLocationsManager.IdSampleLocation, scmLocationsManager.IdSite, scmLocationsManager.Parent, mainServerConnectionString);
                    scmLocationsManager = GetSampleLocationsByIdsite(mainServerConnectionString, scmLocationsManager.IdSampleLocation);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error UpdateSCMLocation(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }

            return scmLocationsManager;
        }

        //[pramod.misal] [GEOS2-5525] [10.07.2024]
        public bool IsInUSESCMLocation(string connectionString, Int64 idSampleLocation, Int64 idCompany)
        {
            bool isInUSENo = false;
            try
            {
                using (MySqlConnection connWarehouse = new MySqlConnection(connectionString))
                {
                    connWarehouse.Open();

                    //MySqlCommand warehouseCommand = new MySqlCommand("WMS_IsInUSENoWarehouseLocation", connWarehouse);
                    MySqlCommand warehouseCommand = new MySqlCommand("SCM_IsInUSENoSampleLocation_V2550", connWarehouse);
                    warehouseCommand.CommandType = CommandType.StoredProcedure;
                    warehouseCommand.Parameters.AddWithValue("_IdSampleLocation", idSampleLocation);
                    warehouseCommand.Parameters.AddWithValue("_IdSite", idCompany);

                    using (MySqlDataReader warehouseReader = warehouseCommand.ExecuteReader())
                    {
                        while (warehouseReader.Read())
                        {
                            try
                            {
                                if (warehouseReader["IsInUseNo"] != DBNull.Value)
                                    isInUSENo = Convert.ToBoolean(warehouseReader["IsInUseNo"]);

                            }
                            catch (Exception ex)
                            {
                                Log4NetLogger.Logger.Log(string.Format("Error IsInUSESCMLocation(). ErrorMessage-" + ex.Message), category: Category.Exception, priority: Priority.Low);
                                throw;
                            }
                        }
                    }
                }

            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error IsInUSESCMLocation().", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return isInUSENo;

        }

        //[pramod.misal][GEOS2-5524][05.08.2024]
        public List<SCMLocationsManager> GetIsLeafSCMLocationsManager_V2550(string connectionString, Data.Common.Company selectedPlant)
        {
            List<SCMLocationsManager> scmLocations = new List<SCMLocationsManager>();

            using (MySqlConnection con = new MySqlConnection(connectionString))
            {
                con.Open();

                using (MySqlCommand concommand = new MySqlCommand("SCM_GetIsLeafSCMLocationsManager_V2550", con))
                {
                    concommand.CommandType = CommandType.StoredProcedure;
                    concommand.Parameters.AddWithValue("_IdSite", selectedPlant.IdCompany);

                    using (MySqlDataReader reader = concommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            try
                            {
                                SCMLocationsManager scmlocation = new SCMLocationsManager();

                                if (reader["IdSampleLocation"] != DBNull.Value)
                                {
                                    scmlocation.IdSampleLocation = Convert.ToInt64(reader["IdSampleLocation"]);
                                }
                                if (reader["IdSite"] != DBNull.Value)
                                {
                                    scmlocation.IdSite = Convert.ToInt64(reader["IdSite"]);
                                }
                                if (reader["Name"] != DBNull.Value)
                                {
                                    scmlocation.Name = Convert.ToString(reader["Name"]);
                                }
                                if (reader["Title"] != DBNull.Value)
                                {
                                    scmlocation.Title = Convert.ToString(reader["Title"]);
                                }
                                if (reader["Parent"] != DBNull.Value)
                                {
                                    scmlocation.Parent = Convert.ToInt64(reader["Parent"]);
                                }
                                if (reader["Position"] != DBNull.Value)
                                {
                                    scmlocation.Position = Convert.ToInt64(reader["Position"]);
                                }
                                if (reader["FullName"] != DBNull.Value)
                                {
                                    scmlocation.FullName = Convert.ToString(reader["FullName"]);
                                }
                                if (reader["IsLeaf"] != DBNull.Value)
                                {
                                    scmlocation.IsLeaf = Convert.ToSByte(reader["IsLeaf"]);
                                }
                                if (reader["HtmlColor"] != DBNull.Value)
                                {
                                    scmlocation.HtmlColor = Convert.ToString(reader["HtmlColor"]);
                                }
                                if (reader["InUse"] != DBNull.Value)
                                {
                                    scmlocation.InUse = Convert.ToBoolean(reader["InUse"]);
                                }

                                scmLocations.Add(scmlocation);
                            }
                            catch (Exception ex)
                            {
                                Log4NetLogger.Logger.Log(string.Format("Error GetIsLeafSCMLocationsManager_V2550(IdSite-{0}). ErrorMessage-{1}", selectedPlant.IdCompany, ex.Message), category: Category.Exception, priority: Priority.Low);
                                throw;
                            }
                        }
                    }
                }
            }

            return scmLocations;
        }



        //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]
        public List<ConnectorLocation> GetConnectorLocationsByRef_V2550(string localGeosConnectionString, String ConnectorRef)
        {
            List<ConnectorLocation> lstConnectorLocations = new List<ConnectorLocation>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetAllLocationsByRef_V2550", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorLocation ConLocation = new ConnectorLocation();
                            if (rdr["Quantity"] != DBNull.Value)
                            {
                                ConLocation.Quantity = Convert.ToInt32(rdr["Quantity"]);
                            }
                            if (rdr["Location"] != DBNull.Value)
                            {
                                ConLocation.Location = Convert.ToString(rdr["Location"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                ConLocation.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Status"] != DBNull.Value)
                            {
                                ConLocation.IsDamaged = (Convert.ToInt32(rdr["Status"]) == 1 ? true : false);
                            }
                            if (rdr["RefSolidWorks"] != DBNull.Value)
                            {
                                ConLocation.RefSolidWorks = Convert.ToString(rdr["RefSolidWorks"]);
                            }
                            if (rdr["NameC"] != DBNull.Value)
                            {
                                ConLocation.CreatorName = Convert.ToString(rdr["NameC"]);
                            }
                            if (rdr["NameSiteC"] != DBNull.Value)
                            {
                                ConLocation.CreatorSitename = Convert.ToString(rdr["NameSiteC"]);
                            }
                            if (rdr["CreatedIn"] != DBNull.Value)
                            {
                                ConLocation.CreatedIn = Convert.ToDateTime(rdr["CreatedIn"]);
                            }
                            if (rdr["NameM"] != DBNull.Value)
                            {
                                ConLocation.ModifierName = Convert.ToString(rdr["NameM"]);
                            }
                            if (rdr["NameSiteM"] != DBNull.Value)
                            {
                                ConLocation.ModifierSitename = Convert.ToString(rdr["NameSiteM"]);
                            }
                            if (rdr["ModifiedIn"] != DBNull.Value)
                            {
                                ConLocation.ModifiedIn = Convert.ToDateTime(rdr["ModifiedIn"]);
                            }
                            if (rdr["ShortName"] != DBNull.Value)
                            {
                                ConLocation.ShortName = Convert.ToString(rdr["ShortName"]);
                            }
                            if (rdr["Idsite"] != DBNull.Value)
                            {
                                ConLocation.Idsite = Convert.ToInt32(rdr["Idsite"]);
                            }
                            if (rdr["IdLocationByConnector"] != DBNull.Value)
                            {
                                ConLocation.IdLocationByConnector = Convert.ToInt32(rdr["IdLocationByConnector"]);
                            }
                            if (rdr["QuantityModified"] != DBNull.Value)
                            {
                                ConLocation.QuantityModified = Convert.ToInt32(rdr["QuantityModified"]);
                            }
                            if (rdr["QuantityWithoutWires"] != DBNull.Value)
                            {
                                ConLocation.QuantityWithoutWires = Convert.ToInt32(rdr["QuantityWithoutWires"]);
                            }
                            if (rdr["QuantityWithoutWiresModified"] != DBNull.Value)
                            {
                                ConLocation.QuantityWithoutWiresModified = Convert.ToInt32(rdr["QuantityWithoutWiresModified"]);
                            }
                            if (rdr["CountryName"] != DBNull.Value)
                            {
                                ConLocation.CountryName = Convert.ToString(rdr["CountryName"]);
                            }
                            if (rdr["iso"] != DBNull.Value)
                            {
                                string iso = Convert.ToString(rdr["iso"]);
                                ConLocation.CountryIconUrl = "https://api.emdep.com/GEOS/Images?FilePath=/Images/Countries/" + iso + ".png";
                            }
                            if (rdr["CreatedBy"] != DBNull.Value)
                            {
                                ConLocation.CreatorId = Convert.ToInt32(rdr["CreatedBy"]);
                            }
                            lstConnectorLocations.Add(ConLocation);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorLocationsByRef().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorLocations;
        }
        //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]
        public bool UpdateConnectorStatus_V2550(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorAttachedDocPath)
        {
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    if (connectorSearch != null)
                    {
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorStatus_V2520", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_idConnector", connectorSearch.IdConnector);
                            mySqlCommand.Parameters.AddWithValue("_idWorkflowStatus", connectorSearch.SelectedReferenceStatus?.IdWorkflowStatus);
                            mySqlCommand.Parameters.AddWithValue("_IdColor", connectorSearch.SelectedColor?.Id);
                            mySqlCommand.Parameters.AddWithValue("_NumWays", connectorSearch.NumWays);
                            mySqlCommand.Parameters.AddWithValue("_IdGender", connectorSearch.SelectedGender?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Description", connectorSearch.Description);
                            mySqlCommand.Parameters.AddWithValue("_Sealed", connectorSearch.IsSealed ? 1 : 0);
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", connectorSearch.SelectedFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", connectorSearch.SelectedSubFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Height", connectorSearch.Height);
                            mySqlCommand.Parameters.AddWithValue("_Length", connectorSearch.Length);
                            mySqlCommand.Parameters.AddWithValue("_Width", connectorSearch.Width);
                            mySqlCommand.Parameters.AddWithValue("_InternalDiameter", connectorSearch.InternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ExternalDiameter", connectorSearch.ExternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedBy", connectorSearch.ModifiedBy);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedIn", connectorSearch.ModifiedIn);
                            mySqlCommand.ExecuteNonQuery();
                            mySqlConnection.Close();
                        }

                        //[Pramod.misal] [15.05.2024]
                        if (connectorSearch.ConnectorCommentsList != null)
                            AddUpdateDeleteConnectorComments_V2520(MainServerConnectionString, connectorSearch.ConnectorCommentsList.ToList());
                        AddUpdateDeleteConnectorReferences_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][16.05.2024][GEOS2-5477]
                        AddUpdateDeleteConnectorComponent_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][22.05.2024][GEOS2-5751]
                        AddDeleteLinkedConnector_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][28.05.2024][GEOS2-5753]

                        //[dixit][09.08.2024][GEOS2-5752]
                        AddUpdateDeleteConnectorLocation(MainServerConnectionString, connectorSearch);
                        //DeleteConnectorLocation(MainServerConnectionString, connectorSearch); //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]
                        DeleteConnectorImage(MainServerConnectionString, connectorSearch); //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]

                        //[Pramod.misal] [21.05.2024][GEOS2-5755]
                        if (connectorSearch.ConnectorAttachementFilesList?.Count > 0)
                        {
                            AddUpdateDeleteConnectorAttachementFiles_V2520(MainServerConnectionString, connectorSearch.ConnectorAttachementFilesList.ToList(), ConnectorAttachedDocPath);
                        }
                        AddConnectorLogEntry(MainServerConnectionString, connectorSearch.IdConnector, connectorSearch.UpdatedChangeLogList);
                        transactionScope.Complete();
                        transactionScope.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error UpdateConnectorStatus_V2520().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    throw;
                }
            }
            return true;
        }
        //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]
        public void DeleteConnectorLocation(string MainServerConnectionString, ConnectorSearch connectorSearch)
        {
            try
            {
                if (connectorSearch.DeletedLocationList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (ConnectorLocation Connectorcomp in connectorSearch.DeletedLocationList)
                        {

                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteConnectorLocation_V2550", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdLocationByConnector", Connectorcomp.IdLocationByConnector);
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error DeleteConnectorLocation().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }
        public void DeleteConnectorImage(string MainServerConnectionString, ConnectorSearch connectorSearch)
        {
            try
            {
                if (connectorSearch.DeletedImageList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (SCMConnectorImage Connectorcomp in connectorSearch.DeletedImageList)
                        {

                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteConnectorImage_V2550", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdConnectorImage", Connectorcomp.IdConnectorImage);
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error DeleteConnectorLocation().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[pramod.misal] [GEOS2-5525] [08.08.2024]
        public Int64 GetMaxPosition_V2550(Int64 idParent, Int64 idCompany, string fullName, string connectionString)
        {
            Int64 Pos = 0;
            try
            {

                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();

                    //MySqlCommand mySqlCommand = new MySqlCommand("WMS_warehouselocationsGetMaxPosition", mySqlConnection);
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_SampleLocations_GetMaxPosition_V2550", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_Parent", idParent);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idCompany);
                    mySqlCommand.Parameters.AddWithValue("_FullName", fullName);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.Read())
                        {
                            if (reader["pos"] != DBNull.Value)
                                Pos = Convert.ToInt64(reader["pos"]);
                        }

                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetMaxPosition_V2550(Parent-{0}, idWarehouse-{1}). ErrorMessage- {2}", idParent, idCompany, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return Pos;
        }

        //[pramod.misal] [GEOS2-5525] [08.08.2024]
        public bool IsExistSCMLocationsManagerName(string connectionString, string name, Int64 parent, Int64 idCompany)
        {

            bool isexist = false;
            using (MySqlConnection con = new MySqlConnection(connectionString))
            {
                con.Open();
                //MySqlCommand concommand = new MySqlCommand("warehouselocations_IsExistWarehouseLocationName", con);
                MySqlCommand concommand = new MySqlCommand("SCM_sampleoction_IsExistSampleLocationName_V2550", con);
                concommand.CommandType = CommandType.StoredProcedure;
                concommand.Parameters.AddWithValue("_Name", name);
                concommand.Parameters.AddWithValue("_Parent", parent);
                concommand.Parameters.AddWithValue("_IdSite", idCompany);
                using (MySqlDataReader reader = concommand.ExecuteReader())
                {
                    if (reader.Read())
                    {

                        if (reader["result"].ToString() == "1")
                            isexist = true;
                        else
                            isexist = false;

                    }
                }
            }

            return isexist;
        }

        public List<Common.Company> GetAuthorizedPlants_V2550(string workbenchConnectionString, Int32 idUser)
        {
            List<Common.Company> companies = new List<Common.Company>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAuthorizedPlants_V2550", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_idUser", idUser);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Common.Company company = new Common.Company();
                            if (reader["idSite"] != DBNull.Value)
                            {
                                company.IdCompany = Convert.ToInt32(reader["idSite"]);
                                if (reader["IP"] != DBNull.Value)
                                {
                                    company.IP = Convert.ToString(reader["IP"]);
                                }
                                if (reader["Code"] != DBNull.Value)
                                {
                                    company.Code = Convert.ToString(reader["Code"]);
                                }
                                if (reader["DatabaseIP"] != DBNull.Value)
                                {
                                    company.DatabaseIP = Convert.ToString(reader["DatabaseIP"]);
                                }
                                if (reader["ShortName"] != DBNull.Value)
                                {
                                    company.ShortName = Convert.ToString(reader["ShortName"]);
                                    company.Alias = Convert.ToString(reader["ShortName"]);
                                }
                                if (reader["Name"] != DBNull.Value)
                                {
                                    company.Name = Convert.ToString(reader["Name"]);
                                }
                                if (reader["ServiceProviderUrl"] != DBNull.Value)
                                {
                                    company.ServiceProviderUrl = Convert.ToString(reader["ServiceProviderUrl"]);
                                }
                                if (reader["idCountry"] != DBNull.Value)
                                {
                                    company.Country = new Country();
                                    company.Country.IdCountry = Convert.ToByte(reader["idCountry"]);

                                    if (reader["CountryName"] != DBNull.Value)
                                    {
                                        company.Country.Name = Convert.ToString(reader["CountryName"]);
                                    }
                                    if (reader["iso"] != DBNull.Value)
                                    {
                                        company.Country.Iso = Convert.ToString(reader["iso"]);
                                    }
                                }
                            }
                            companies.Add(company);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAuthorizedPlants(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return companies;
        }

        public void AddUpdateDeleteConnectorLocation(string MainServerConnectionString, ConnectorSearch connectorSearch)
        {
            try
            {
                if (connectorSearch.DeletedLocationList?.Count > 0)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConnectorLocation loc in connectorSearch.DeletedLocationList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteConnectorLocation", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdLocationByConnector", loc.IdLocationByConnector);
                            mySqlCommand.ExecuteNonQuery();
                        }
                        mySqlConnection.Close();
                    }
                }
                if (connectorSearch.LocationList?.Count > 0)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConnectorLocation loc in connectorSearch.LocationList)
                        {
                            if (loc.TransactionOperation == ModelBase.TransactionOperations.Modify)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_AddConnectorLocation", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                mySqlCommand.Parameters.AddWithValue("_IdSite", loc.Idsite);
                                mySqlCommand.Parameters.AddWithValue("_Location", loc.Location);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", loc.CreatorId);
                                mySqlCommand.Parameters.AddWithValue("_Status", loc.IsDamaged ? 1 : 0);
                                mySqlCommand.Parameters.AddWithValue("_Quantity", loc.Quantity);
                                mySqlCommand.Parameters.AddWithValue("_QuantityWithoutWires", loc.QuantityWithoutWires);
                                loc.IdLocationByConnector = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                            }
                            else if (loc.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorLocation", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdLocationByConnector", loc.IdLocationByConnector);
                                mySqlCommand.Parameters.AddWithValue("_IdSite", loc.Idsite);
                                mySqlCommand.Parameters.AddWithValue("_Location", loc.Location);
                                mySqlCommand.Parameters.AddWithValue("_ModifiedBy", loc.CreatorId);
                                mySqlCommand.Parameters.AddWithValue("_Status", loc.IsDamaged ? 1 : 0);
                                mySqlCommand.Parameters.AddWithValue("_Quantity", loc.Quantity);
                                mySqlCommand.Parameters.AddWithValue("_QuantityWithoutWires", loc.QuantityWithoutWires);
                                mySqlCommand.ExecuteNonQuery();
                            }

                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddUpdateDeleteConnectorLocation().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        //[Rahul.Gadhave][GEOS2-5779][Date-09/08/2024]
        public List<SCMConnectorImage> GetAllConnectorImagesForImageSection_V2550(string SCMConnectionString, Connectors Connectors, string ConnectorWtgImagesPath)
        {
            List<SCMConnectorImage> ConnectorImages = new List<Common.SCM.SCMConnectorImage>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectorImagesForImageSection_V2510", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SCMConnectorImage connector = new SCMConnectorImage();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                connector.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                            }
                            if (reader["IdPictureType"] != DBNull.Value)
                            {
                                connector.IdPictureType = Convert.ToInt16(reader["IdPictureType"]);
                            }
                            if (Connectors.Ref != null)
                            {
                                connector.Ref = Convert.ToString(Connectors.Ref);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.SavedFileName = Convert.ToString(reader["FileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                connector.Position = Convert.ToUInt64(reader["Position"]);
                            }
                            if (reader["CreatedBy"] != DBNull.Value)
                            {
                                connector.CreatedBy = Convert.ToUInt32(reader["CreatedBy"]);
                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                connector.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["IdSite"] != DBNull.Value)
                            {
                                connector.IdSite = Convert.ToInt32(reader["IdSite"]);
                            }
                            if (reader["creator"] != DBNull.Value)
                            {
                                connector.Creator = Convert.ToString(reader["creator"]);
                            }
                            if (reader["ModifiedBy"] != DBNull.Value)
                            {
                                connector.ModifiedBy = Convert.ToUInt32(reader["ModifiedBy"]);
                            }
                            if (reader["ModifiedIn"] != DBNull.Value)
                            {
                                connector.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                            }
                            ConnectorImages.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImagesForImageSection_V2550(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            try
            {
                foreach (SCMConnectorImage itemConnectors in ConnectorImages)
                {
                    // itemConnectors.ImagePath = string.Format(@"{0}\{1}", ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);                                    
                    // itemConnectors.ConnectorsImageInBytes = GetConnectorsImages(ConnectorsImagesImagePath + itemConnectors.Ref, itemConnectors.SavedFileName);
                    if (itemConnectors.SavedFileName.EndsWith(".wtg", StringComparison.OrdinalIgnoreCase) ||
                        itemConnectors.SavedFileName.EndsWith(".bmp", StringComparison.OrdinalIgnoreCase))
                    {
                        string wtgImagePath = Path.Combine(ConnectorWtgImagesPath, itemConnectors.Ref, itemConnectors.SavedFileName);

                        if (File.Exists(wtgImagePath))
                        {
                            itemConnectors.ConnectorsImageInBytes = File.ReadAllBytes(wtgImagePath);
                        }
                        else
                        {

                            continue;
                        }
                    }
                    else
                    {
                        itemConnectors.ImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + itemConnectors.Ref + "/" + itemConnectors.SavedFileName;

                        if (!string.IsNullOrEmpty(itemConnectors.ImagePath))
                        {
                            //using (WebClient webClient = new WebClient())
                            //{
                            //    itemConnectors.ConnectorsImageInBytes = webClient.DownloadData(itemConnectors.ImagePath);
                            //}
                            itemConnectors.ConnectorsImageInBytes = Utility.ImageUtil.GetImageByWebClient(itemConnectors.ImagePath);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImagesForImageSection_V2550(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ConnectorImages;
        }

        //[pramod.misal][GEOS2-5754][28-08-2024]
        public ConnectorSearch UpdateConnectorStatus_V2560(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorAttachedDocPath, string ConnectorImagePath, string ConnectorWtgImages)
        {
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    if (connectorSearch != null)
                    {
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorStatus_V2520", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_idConnector", connectorSearch.IdConnector);
                            mySqlCommand.Parameters.AddWithValue("_idWorkflowStatus", connectorSearch.SelectedReferenceStatus?.IdWorkflowStatus);
                            mySqlCommand.Parameters.AddWithValue("_IdColor", connectorSearch.SelectedColor?.Id);
                            mySqlCommand.Parameters.AddWithValue("_NumWays", connectorSearch.NumWays);
                            mySqlCommand.Parameters.AddWithValue("_IdGender", connectorSearch.SelectedGender?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Description", connectorSearch.Description);
                            mySqlCommand.Parameters.AddWithValue("_Sealed", connectorSearch.IsSealed ? 1 : 0);
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", connectorSearch.SelectedFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", connectorSearch.SelectedSubFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Height", connectorSearch.Height);
                            mySqlCommand.Parameters.AddWithValue("_Length", connectorSearch.Length);
                            mySqlCommand.Parameters.AddWithValue("_Width", connectorSearch.Width);
                            mySqlCommand.Parameters.AddWithValue("_InternalDiameter", connectorSearch.InternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ExternalDiameter", connectorSearch.ExternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedBy", connectorSearch.ModifiedBy);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedIn", connectorSearch.ModifiedIn);
                            mySqlCommand.ExecuteNonQuery();
                            mySqlConnection.Close();
                        }

                        //[Pramod.misal] [15.05.2024]
                        if (connectorSearch.ConnectorCommentsList != null)
                            AddUpdateDeleteConnectorComments_V2520(MainServerConnectionString, connectorSearch.ConnectorCommentsList.ToList());
                        AddUpdateDeleteConnectorReferences_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][16.05.2024][GEOS2-5477]
                        AddUpdateDeleteConnectorComponent_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][22.05.2024][GEOS2-5751]
                        AddDeleteLinkedConnector_V2520(MainServerConnectionString, connectorSearch);//[rdiixt][28.05.2024][GEOS2-5753]

                        //[dixit][09.08.2024][GEOS2-5752]
                        AddUpdateDeleteConnectorLocation(MainServerConnectionString, connectorSearch);
                        //DeleteConnectorLocation(MainServerConnectionString, connectorSearch); //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]
                        DeleteConnectorImage(MainServerConnectionString, connectorSearch); //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]
                        AddUpdateConnectorImage(MainServerConnectionString, connectorSearch, ConnectorImagePath, ConnectorWtgImages); //[pramod.misal][GEOS2-5754][28-08-2024]
                        //[Pramod.misal] [21.05.2024][GEOS2-5755]
                        if (connectorSearch.ConnectorAttachementFilesList?.Count > 0)
                        {
                            AddUpdateDeleteConnectorAttachementFiles_V2520(MainServerConnectionString, connectorSearch.ConnectorAttachementFilesList.ToList(), ConnectorAttachedDocPath);
                        }
                        AddConnectorLogEntry(MainServerConnectionString, connectorSearch.IdConnector, connectorSearch.UpdatedChangeLogList);
                        transactionScope.Complete();
                        transactionScope.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error UpdateConnectorStatus_V2560().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    throw;
                }
            }
            return connectorSearch;
        }

        //[pramod.misal][GEOS2-5754][28-08-2024]
        public void AddUpdateConnectorImage(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorImagePath, string ConnectorWtgImages)
        {
            try
            {
                if (connectorSearch.ConnectorsImageList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (SCMConnectorImage SCMConnectorImage in connectorSearch.ConnectorsImageList)
                        {
                            if (SCMConnectorImage.TransactionOperation == ModelBase.TransactionOperations.Modify)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorImage_V2560", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                mySqlCommand.Parameters.AddWithValue("_IdPictureType", SCMConnectorImage.IdPictureType);
                                mySqlCommand.Parameters.AddWithValue("_ConnectorFileName", SCMConnectorImage.OriginalFileName);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", SCMConnectorImage.CreatedBy);
                                //mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                mySqlCommand.Parameters.AddWithValue("_Position", SCMConnectorImage.Position);
                                mySqlCommand.Parameters.AddWithValue("_Description", SCMConnectorImage.Description);

                                SCMConnectorImage.IdConnectorImage = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                                if (SCMConnectorImage.IdConnectorImage > 0)
                                {
                                    if (SCMConnectorImage.IdPictureType == 1)
                                    {

                                        AddConnectorImageToPath(SCMConnectorImage, ConnectorWtgImages);
                                    }
                                    else
                                    {
                                        AddConnectorImageToPath(SCMConnectorImage, ConnectorImagePath);
                                    }

                                }
                            }
                            else if (SCMConnectorImage.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                if (SCMConnectorImage.IdConnectorImage > 0)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorImage_V2560", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                                    mySqlCommand.Parameters.AddWithValue("_IdConnectorImage", SCMConnectorImage.IdConnectorImage);
                                    mySqlCommand.Parameters.AddWithValue("_ConnectorFileName", SCMConnectorImage.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_Description", SCMConnectorImage.Description);
                                    mySqlCommand.Parameters.AddWithValue("_ModifiedBy", SCMConnectorImage.ModifiedBy);
                                    //mySqlCommand.Parameters.AddWithValue("_ModifiedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                    mySqlCommand.Parameters.AddWithValue("_Position", SCMConnectorImage.Position);

                                    SCMConnectorImage.IdConnectorImage = Convert.ToUInt32(mySqlCommand.ExecuteScalar());

                                    //AddConnectorImageToPath(SCMConnectorImageList, ConnectorImagePath);
                                    if (SCMConnectorImage.IdPictureType == 1)
                                    {

                                        UpdateConnectorImageToPath(SCMConnectorImage, ConnectorWtgImages);
                                    }
                                    else
                                    {
                                        UpdateConnectorImageToPath(SCMConnectorImage, ConnectorImagePath);
                                    }


                                }
                            }

                        }

                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddUpdateConnectorImage().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[pramod.misal][GEOS2-5754][28-08-2024]
        public bool AddConnectorImageToPath(SCMConnectorImage ConnectorImage, string ConnectorImagePath)
        {
            if (ConnectorImage.ConnectorsImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\{1}", ConnectorImagePath, ConnectorImage.Ref);
                    string filePath = completePath + "\\" + ConnectorImage.OriginalFileName;


                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    else
                    {
                        if (File.Exists(filePath))
                        {
                            File.Delete(filePath);
                        }
                    }

                    File.WriteAllBytes(filePath, ConnectorImage.ConnectorsImageInBytes);


                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddConnectorImageToPath()- Filename - {0}. ErrorMessage- {1}", ConnectorImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }

        //[pramod.misal][GEOS2-5754][28-08-2024]
        public bool UpdateConnectorImageToPath(SCMConnectorImage ConnectorImage, string ConnectorImagePath)
        {
            if (ConnectorImage.ConnectorsImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\{1}", ConnectorImagePath, ConnectorImage.Ref);
                    string filePath = completePath + "\\" + ConnectorImage.OriginalFileName;
                    string oldfilePath = string.Empty;

                    if (ConnectorImage.OldFileName != null)
                    {
                        oldfilePath = completePath + "\\" + ConnectorImage.OldFileName;
                    }

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    else
                    {
                        if (File.Exists(filePath))
                        {
                            File.Delete(filePath);
                        }

                    }
                    if (oldfilePath != null)
                    {
                        if (File.Exists(oldfilePath))
                        {
                            File.Delete(oldfilePath);
                        }

                    }
                    File.WriteAllBytes(filePath, ConnectorImage.ConnectorsImageInBytes);


                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddConnectorImageToPath()- Filename - {0}. ErrorMessage- {1}", ConnectorImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }

        #region [rdixit][GEOS2-5802][05.09.2024]
        public List<Connectors> GetSampleRegistrationAllConnectors_V2560(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSampleRegistrationAllConnectors_V2560", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;

                    #region Paramters
                    if (Connectors.SelectedFamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", Connectors.SelectedFamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", Connectors.SelectedSubfamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColor != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", Connectors.SelectedColor.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGender != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", Connectors.SelectedGender.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);

                    if (!string.IsNullOrEmpty(Connectors.Ways))
                        mySqlCommand.Parameters.AddWithValue("_Cavities", Connectors.Ways);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Cavities", null);

                    if (!string.IsNullOrEmpty(Connectors.DiameterInternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", Connectors.DiameterInternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", null);

                    if (!string.IsNullOrEmpty(Connectors.DiameterExternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", Connectors.DiameterExternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", null);

                    if (!string.IsNullOrEmpty(Connectors.Height))
                        mySqlCommand.Parameters.AddWithValue("_height", Connectors.Height);
                    else
                        mySqlCommand.Parameters.AddWithValue("_height", null);

                    if (!string.IsNullOrEmpty(Connectors.Length))
                        mySqlCommand.Parameters.AddWithValue("_length", Connectors.Length);
                    else
                        mySqlCommand.Parameters.AddWithValue("_length", null);

                    if (!string.IsNullOrEmpty(Connectors.Width))
                        mySqlCommand.Parameters.AddWithValue("_width", Connectors.Width);
                    else
                        mySqlCommand.Parameters.AddWithValue("_width", null);

                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            ConnectorsList.Add(connector);
                        }
                        if (reader.NextResult())
                        {
                            while (reader.Read())
                            {

                                if (reader["IdConnector"] != DBNull.Value)
                                {
                                    Connectors connector = ConnectorsList.FirstOrDefault(i => i.IdConnector == Convert.ToInt64(reader["IdConnector"]));
                                    if (connector != null)
                                    {
                                        if (connector.Componentlist == null)
                                            connector.Componentlist = new List<Components>();

                                        Components comp = new Components();
                                        comp.IdConnector = Convert.ToInt32(reader["IdConnector"]);

                                        if (reader["Ref"] != DBNull.Value)
                                        {
                                            comp.Reference = Convert.ToString(reader["Ref"]);
                                        }
                                        if (reader["IdType"] != DBNull.Value)
                                        {
                                            comp.IdType = Convert.ToInt32(reader["IdType"]);
                                        }
                                        if (reader["IdColor"] != DBNull.Value)
                                        {
                                            comp.IdColor = Convert.ToInt32(reader["IdColor"]);
                                        }
                                        if (reader["Type"] != DBNull.Value)
                                        {
                                            comp.SelectedComponentType = Convert.ToString(reader["Type"]);
                                        }
                                        if (reader["Color"] != DBNull.Value)
                                        {
                                            comp.SelectedColor = Convert.ToString(reader["Color"]);
                                        }
                                        connector.Componentlist.Add(comp);
                                    }
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSampleRegistrationAllConnectors(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }
        public List<Connectors> GetConnectorsBySearchConfiguration_V2560(string SCMConnectionString, Connectors Connectors, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorsBySearchConfiguration_2560", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;

                    if (Connectors.SelectedFamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", Connectors.SelectedFamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", Connectors.SelectedSubfamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColorList != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", string.Join(",", Connectors.SelectedColorList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGender != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", Connectors.SelectedGender.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);
                    #region[GEOS2-5296][rdixit][29.02.2024]
                    #region Ways
                    if (Connectors.WaysProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", Connectors.WaysProp.MinValue);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", Connectors.WaysProp.MaxValue);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", null);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", null);
                    }
                    #endregion

                    #region DiameterInternal
                    if (Connectors.DiameterInternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", Connectors.DiameterInternalProp.MinValue);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", Connectors.DiameterInternalProp.MaxValue);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", null);
                    }
                    #endregion

                    #region DiameterExternal
                    if (Connectors.DiameterExternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", Connectors.DiameterExternalProp.MinValue);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", Connectors.DiameterExternalProp.MaxValue);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", null);
                    }
                    #endregion

                    #region Height
                    if (Connectors.HeightProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", Connectors.HeightProp.MinValue);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", Connectors.HeightProp.MaxValue);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", null);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", null);
                    }
                    #endregion

                    #region Length
                    if (Connectors.LengthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", Connectors.LengthProp.MinValue);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", Connectors.LengthProp.MaxValue);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", null);
                    }
                    #endregion

                    #region Width
                    if (Connectors.WidthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", Connectors.WidthProp.MinValue);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", Connectors.WidthProp.MaxValue);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", null);
                    }
                    #endregion
                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            ConnectorsList.Add(connector);
                        }
                        if (reader.NextResult())
                        {
                            while (reader.Read())
                            {

                                if (reader["IdConnector"] != DBNull.Value)
                                {
                                    Connectors connector = ConnectorsList.FirstOrDefault(i => i.IdConnector == Convert.ToInt64(reader["IdConnector"]));
                                    if (connector != null)
                                    {
                                        if (connector.Componentlist == null)
                                            connector.Componentlist = new List<Components>();

                                        Components comp = new Components();
                                        comp.IdConnector = Convert.ToInt32(reader["IdConnector"]);

                                        if (reader["Ref"] != DBNull.Value)
                                        {
                                            comp.Reference = Convert.ToString(reader["Ref"]);
                                        }
                                        if (reader["IdType"] != DBNull.Value)
                                        {
                                            comp.IdType = Convert.ToInt32(reader["IdType"]);
                                        }
                                        if (reader["IdColor"] != DBNull.Value)
                                        {
                                            comp.IdColor = Convert.ToInt32(reader["IdColor"]);
                                        }
                                        if (reader["Type"] != DBNull.Value)
                                        {
                                            comp.SelectedComponentType = Convert.ToString(reader["Type"]);
                                        }
                                        if (reader["Color"] != DBNull.Value)
                                        {
                                            comp.SelectedColor = Convert.ToString(reader["Color"]);
                                        }
                                        connector.Componentlist.Add(comp);
                                    }
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorsBySearchConfiguration_V2560(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }
        public List<ConnectorProperties> GetAllConnectorCustomProperties_V2560(string localConnectionString, string workbenchContext)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectorCustomProperties_2560", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();


                            if (rdr["IdConnectorProperty"] != DBNull.Value)
                            {
                                property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                            }
                            //if (rdr["IdFamily"] != DBNull.Value)
                            //{
                            //    property.IdFamily = Convert.ToUInt32(rdr["IdFamily"]);
                            //}
                            if (rdr["IsEnabled"] != DBNull.Value)
                            {
                                property.IsEnabled = Convert.ToBoolean(rdr["IsEnabled"]);
                            }
                            if (rdr["Min_Value"] != DBNull.Value)
                            {
                                property.MinValueNew = Convert.ToString(rdr["Min_Value"]);
                            }
                            if (rdr["Max_Value"] != DBNull.Value)
                            {
                                property.MaxValueNew = Convert.ToString(rdr["Max_Value"]);
                            }
                            if (rdr["CustomFamily"] != DBNull.Value)
                            {
                                property.CustomFamily = Convert.ToString(rdr["CustomFamily"]);
                            }
                            //if (rdr["DefaultValue"] != DBNull.Value)
                            //{
                            //    property.DefaultValue = Convert.ToString(rdr["DefaultValue"]);
                            //}
                            if (rdr["isCustProperty"] != DBNull.Value)
                            {
                                property.IsCustomProperty = Convert.ToInt32(rdr["isCustProperty"]) == 1 ? true : false;
                            }
                            if (rdr["IdConnectorType"] != DBNull.Value)
                            {
                                property.IdConnectorType = Convert.ToInt32(rdr["IdConnectorType"]);
                                if (property.IdConnectorType == 1826)
                                    property.CustomFieldComboboxList = new ObservableCollection<LookUpValues>(GetAllLookUpValuesRecordByIDLookupkey(workbenchContext, property.IdConnectorType));
                            }
                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorCustomProperties_V2560().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }

        //[rushikesh.gaikwad][GEOS2-5801][12.09.2024]

        public List<UserRoles> GetUserRoles_V2560(string localGeosConnectionString)
        {
            List<UserRoles> lstroles = new List<UserRoles>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetUserRoles_V2560", connActivity);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            UserRoles role = new UserRoles();
                            if (rdr["Name"] != DBNull.Value)
                            {
                                role.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["IdRole"] != DBNull.Value)
                            {
                                role.IdRole = Convert.ToInt32(rdr["IdRole"]);
                            }
                            if (rdr["IdUser"] != DBNull.Value)
                            {
                                role.IdUser = Convert.ToInt32(rdr["IdUser"]);
                            }
                            if (rdr["IdModule"] != DBNull.Value)
                            {
                                role.IdModule = Convert.ToInt32(rdr["IdModule"]);
                            }
                            lstroles.Add(role);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetUserRoles_V2560().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstroles;
        }


        #endregion

        //[GEOS2-5803][rdixit][13.09.2024]
        public string GetLatestConnectorReference(string year, string connectionString)
        {
            string Ref = string.Empty;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetLatestConnectorReference", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_year1", year);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.Read())
                        {
                            if (reader["Ref"] != DBNull.Value)
                                Ref = Convert.ToString(reader["Ref"]);
                        }

                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetLatestConnectorReference(year-{0}). ErrorMessage- {1}", year, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return Ref;
        }

        //[GEOS2-5803][rdixit][13.09.2024]
        public bool AddConnector_V2560(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorAttachedDocPath, string ConnectorImagePath, string ConnectorWtgImages)
        {
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    if (connectorSearch != null)
                    {
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_AddConnector_V2560", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_Ref", connectorSearch.Reference);
                            mySqlCommand.Parameters.AddWithValue("_IdColor", connectorSearch.SelectedColor?.Id);
                            mySqlCommand.Parameters.AddWithValue("_year", DateTime.Now.Year);
                            mySqlCommand.Parameters.AddWithValue("_NumWays", connectorSearch.NumWays);
                            mySqlCommand.Parameters.AddWithValue("_IdGender", connectorSearch.SelectedGender?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Description", connectorSearch.Description);
                            mySqlCommand.Parameters.AddWithValue("_Sealed", connectorSearch.IsSealed ? 1 : 0);
                            mySqlCommand.Parameters.AddWithValue("_CreatedBy", connectorSearch.ModifiedBy);
                            mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", connectorSearch.SelectedFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", connectorSearch.SelectedSubFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Height", connectorSearch.Height);
                            mySqlCommand.Parameters.AddWithValue("_Length", connectorSearch.Length);
                            mySqlCommand.Parameters.AddWithValue("_Width", connectorSearch.Width);
                            mySqlCommand.Parameters.AddWithValue("_InternalDiameter", connectorSearch.InternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ExternalDiameter", connectorSearch.ExternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_idWorkflowStatus", connectorSearch.SelectedReferenceStatus?.IdWorkflowStatus);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedBy", connectorSearch.ModifiedBy);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedIn", connectorSearch.ModifiedIn);
                            connectorSearch.IdConnector = (long)Convert.ToDouble(mySqlCommand.ExecuteScalar());
                            mySqlConnection.Close();
                        }
                        #region Comments
                        if (connectorSearch.ConnectorCommentsList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();
                                foreach (ConnectorLogEntry ConnectorComments in connectorSearch.ConnectorCommentsList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorCommentsByIdLogEntry_V2520", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_IdUser", ConnectorComments.IdUser);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                                    mySqlCommand.Parameters.AddWithValue("_Comments", ConnectorComments.Comments);
                                    mySqlCommand.Parameters.AddWithValue("_IdLogEntryType", 1);
                                    mySqlCommand.ExecuteNonQuery();
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        #region ReferencesList
                        if (connectorSearch.ReferencesList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();

                                foreach (ConnectorReference Connectorref in connectorSearch.ReferencesList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorReference_V2520", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_Ref", Connectorref.Reference);
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_IdCustomer", Connectorref.Company?.Id);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", Connectorref.CreatorId);
                                    mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                    mySqlCommand.ExecuteNonQuery();
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        #region ComponentsList
                        if (connectorSearch.ComponentsList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();

                                foreach (ConnectorComponents Connectorcomp in connectorSearch.ComponentsList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorComponents_V2520", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_Ref", Connectorcomp.ComponentRef);
                                    mySqlCommand.Parameters.AddWithValue("_IdColor", Connectorcomp.Color?.Id);
                                    mySqlCommand.Parameters.AddWithValue("_IdType", Connectorcomp.Type?.IdType);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", Connectorcomp.CreatorId);
                                    mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                    Connectorcomp.IdComponentsByConnector = Convert.ToInt64(mySqlCommand.ExecuteScalar());
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        #region LinkedConnector
                        if (connectorSearch.LinkedConnectorList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();
                                foreach (Connectors Conn in connectorSearch.LinkedConnectorList)
                                {
                                    if (Conn != null)
                                    {

                                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_associatedconnectors_Insert", mySqlConnection);
                                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                                        mySqlCommand.Parameters.AddWithValue("_idConnectorA", connectorSearch.IdConnector);
                                        mySqlCommand.Parameters.AddWithValue("_idConnectorB", Conn.IdConnector);
                                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", Conn.CreatorId);
                                        if (Conn.IdLinkdType == 1)
                                        {
                                            mySqlCommand.Parameters.AddWithValue("_IsConnector", 1);
                                            mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                                        }
                                        else if (Conn.IdLinkdType == 2)
                                        {
                                            mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsComponent", 1);
                                            mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                                        }
                                        else if (Conn.IdLinkdType == 3)
                                        {
                                            mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsTerminal", 1);
                                            mySqlCommand.Parameters.AddWithValue("_IsOther", null);
                                        }
                                        else
                                        {
                                            mySqlCommand.Parameters.AddWithValue("_IsConnector", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsComponent", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsTerminal", null);
                                            mySqlCommand.Parameters.AddWithValue("_IsOther", 1);
                                        }
                                        mySqlCommand.ExecuteNonQuery();
                                    }
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        #region Location
                        if (connectorSearch.LocationList?.Count > 0)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();
                                foreach (ConnectorLocation loc in connectorSearch.LocationList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_AddConnectorLocation", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_IdSite", loc.Idsite);
                                    mySqlCommand.Parameters.AddWithValue("_Location", loc.Location);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", connectorSearch.ModifiedBy);
                                    mySqlCommand.Parameters.AddWithValue("_Status", loc.IsDamaged ? 1 : 0);
                                    mySqlCommand.Parameters.AddWithValue("_Quantity", loc.Quantity);
                                    mySqlCommand.Parameters.AddWithValue("_QuantityWithoutWires", loc.QuantityWithoutWires);
                                    loc.IdLocationByConnector = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        #region Images
                        if (connectorSearch.ConnectorsImageList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();

                                foreach (SCMConnectorImage SCMConnectorImageList in connectorSearch.ConnectorsImageList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorImage_V2560", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_IdPictureType", SCMConnectorImageList.IdPictureType);
                                    mySqlCommand.Parameters.AddWithValue("_ConnectorFileName", SCMConnectorImageList.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", SCMConnectorImageList.CreatedBy);
                                    mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                    mySqlCommand.Parameters.AddWithValue("_Position", SCMConnectorImageList.Position);
                                    mySqlCommand.Parameters.AddWithValue("_Description", SCMConnectorImageList.Description);

                                    SCMConnectorImageList.IdConnectorImage = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                                    SCMConnectorImageList.Ref = connectorSearch.Reference;
                                    if (SCMConnectorImageList.IdConnectorImage > 0)
                                    {
                                        if (SCMConnectorImageList.IdPictureType == 1)
                                        {
                                            AddConnectorImageToPath(SCMConnectorImageList, ConnectorWtgImages);
                                        }
                                        else
                                        {
                                            AddConnectorImageToPath(SCMConnectorImageList, ConnectorImagePath);
                                        }
                                    }
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        #region Attachment
                        if (connectorSearch.ConnectorAttachementFilesList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();
                                foreach (ConnectorAttachements connectorAttachemen in connectorSearch.ConnectorAttachementFilesList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorAttachementByIdconnectordoc_V2520", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_OriginalFileName", connectorAttachemen.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_SavedFileName", connectorAttachemen.SavedFileName);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", connectorAttachemen.CreatedBy);
                                    mySqlCommand.Parameters.AddWithValue("_Description", connectorAttachemen.Description);
                                    mySqlCommand.Parameters.AddWithValue("_idCustomer", connectorAttachemen.IdCustomer);
                                    mySqlCommand.Parameters.AddWithValue("_idDocType", connectorAttachemen.IdDocType);
                                    connectorAttachemen.Idconnectordoc = Convert.ToInt32(mySqlCommand.ExecuteScalar());

                                    if (connectorAttachemen.Idconnectordoc > 0)
                                        InsertConnectorAttachedDoc(connectorAttachemen, ConnectorAttachedDocPath);
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion
                        AddConnectorLogEntry(MainServerConnectionString, connectorSearch.IdConnector, connectorSearch.UpdatedChangeLogList);
                        transactionScope.Complete();
                        transactionScope.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddConnector_V2560().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    throw;
                }
            }
            return true;
        }

        //[GEOS2-6601][14.11.2024][rdixit]
        public List<Connectors> GetAllConnectors_V2580(string SCMConnectionString, Connectors Connectors, string componentQuery, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2580", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    #region Parameters
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompanyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", string.Join(",", Connectors.SelectedCompanyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", string.Join(",", Connectors.SelectedFamilyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", string.Join(",", Connectors.SelectedSubfamilyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColorList != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", string.Join(",", Connectors.SelectedColorList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGenderList != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", string.Join(",", Connectors.SelectedGenderList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);
                    #region[GEOS2-5296][rdixit][29.02.2024]
                    #region Ways
                    if (Connectors.WaysProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", (Connectors.WaysProp.MinValueNew == string.Empty) ? null : Connectors.WaysProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", (Connectors.WaysProp.MaxValueNew == string.Empty) ? null : Connectors.WaysProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", null);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", null);
                    }
                    #endregion

                    #region DiameterInternal
                    if (Connectors.DiameterInternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", (Connectors.DiameterInternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", (Connectors.DiameterInternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", null);
                    }
                    #endregion

                    #region DiameterExternal
                    if (Connectors.DiameterExternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", (Connectors.DiameterExternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", (Connectors.DiameterExternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", null);
                    }
                    #endregion

                    #region Height
                    if (Connectors.HeightProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", (Connectors.HeightProp.MinValueNew == string.Empty) ? null : Connectors.HeightProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", (Connectors.HeightProp.MaxValueNew == string.Empty) ? null : Connectors.HeightProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", null);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", null);
                    }
                    #endregion

                    #region Length
                    if (Connectors.LengthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", (Connectors.LengthProp.MinValueNew == string.Empty) ? null : Connectors.LengthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", (Connectors.LengthProp.MaxValueNew == string.Empty) ? null : Connectors.LengthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", null);
                    }
                    #endregion

                    #region Width
                    if (Connectors.WidthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", (Connectors.WidthProp.MinValueNew == string.Empty) ? null : Connectors.WidthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", (Connectors.WidthProp.MaxValueNew == string.Empty) ? null : Connectors.WidthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", null);
                    }
                    #endregion
                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion                  

                    if (string.IsNullOrEmpty(Connectors.ConnectorType))
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", null);
                    else
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", Connectors.ConnectorType);

                    mySqlCommand.Parameters.AddWithValue("_ComponentQuery", componentQuery);// Added code to reduce time to load data
                    #endregion
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }

                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2580(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }

        //[GEOS2-6080][05.12.2024][rdixit]
        public List<ScmDrawing> GetDrawingsByConnectorRef_V2590(string localGeosConnectionString, long idConnector)
        {
            List<ScmDrawing> DrawingListByRef = new List<ScmDrawing>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetDrawingsByIdConnector_V2590", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdConnector", idConnector);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.HasRows)
                        {
                            while (reader.Read())
                            {
                                ScmDrawing drawing = new ScmDrawing();

                                if (reader["iddrawing"] != DBNull.Value)
                                {
                                    drawing.IdDrawing = Convert.ToUInt32(reader["iddrawing"]);
                                }
                                if (reader["Path"] != DBNull.Value)
                                {
                                    drawing.Path = Convert.ToString(reader["Path"]);
                                }
                                if (reader["SiteName"] != DBNull.Value)
                                {
                                    drawing.SiteName = Convert.ToString(reader["SiteName"]);
                                }
                                if (reader["NameSiteC"] != DBNull.Value)
                                {
                                    drawing.SiteNameC = Convert.ToString(reader["NameSiteC"]);
                                }
                                if (reader["NameSiteM"] != DBNull.Value)
                                {
                                    drawing.SiteNameM = Convert.ToString(reader["NameSiteM"]);
                                }
                                if (reader["NameC"] != DBNull.Value)
                                {
                                    drawing.CreatedBy = Convert.ToString(reader["NameC"])?.Trim();
                                }
                                if (reader["NameM"] != DBNull.Value)
                                {
                                    drawing.ModifiedBy = Convert.ToString(reader["NameM"])?.Trim();
                                }
                                if (reader["CreatedIn"] != DBNull.Value)
                                {
                                    drawing.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                                }
                                if (reader["ModifiedIn"] != DBNull.Value)
                                {
                                    drawing.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                                }
                                if (reader["Debugged"] != DBNull.Value)
                                {
                                    drawing.Debugged = Convert.ToBoolean(reader["Debugged"]);
                                }
                                if (reader["Comments"] != DBNull.Value)
                                {
                                    drawing.Comments = Convert.ToString(reader["Comments"])?.Trim();
                                }
                                if (reader["idcptype"] != DBNull.Value)
                                {
                                    drawing.IdCPTypenew = Convert.ToInt64(reader["idcptype"]);
                                }
                                if (reader["CptypeName"] != DBNull.Value)
                                {
                                    drawing.CptypeName = Convert.ToString(reader["CptypeName"]);
                                }
                                if (reader["TemplateName"] != DBNull.Value)
                                {
                                    drawing.TemplateName = Convert.ToString(reader["TemplateName"]);
                                }
                                if (reader["IdTemplate"] != DBNull.Value)
                                {
                                    drawing.IdTemplate = Convert.ToByte(reader["IdTemplate"]);
                                }
                                DrawingListByRef.Add(drawing);
                            }
                        }
                        if (reader.NextResult())
                        {
                            while (reader.Read())
                            {
                                ScmDrawing scmDrawing = DrawingListByRef.Where(t => t.IdDrawing == Convert.ToUInt32(reader["IdDrawing"])).FirstOrDefault();

                                if (scmDrawing != null)
                                {
                                    if (scmDrawing.DetectionList == null)
                                        scmDrawing.DetectionList = new List<SCMDetection>();
                                    SCMDetection sCMDetection = new SCMDetection();
                                    if (reader["IdDetection"] != DBNull.Value)
                                    {
                                        sCMDetection.IdDetection = Convert.ToUInt16(reader["IdDetection"]);
                                    }
                                    if (reader["Name"] != DBNull.Value)
                                    {
                                        sCMDetection.Name = Convert.ToString(reader["Name"]);
                                    }
                                    if (reader["Quantity"] != DBNull.Value)
                                    {
                                        sCMDetection.Quantity = Convert.ToInt32(reader["Quantity"]);
                                    }
                                    if (reader["IdDetectionType"] != DBNull.Value)
                                    {
                                        sCMDetection.IdDetectionType = Convert.ToInt32(reader["IdDetectionType"]);
                                    }
                                    if (reader["DetectionType"] != DBNull.Value)
                                    {
                                        sCMDetection.DetectionType = Convert.ToString(reader["DetectionType"]);
                                    }
                                    scmDrawing.DetectionList.Add(sCMDetection);
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetDrawingsByConnectorRef_V2590(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return DrawingListByRef;
        }

        //[rdixit][GEOS2-6654][03.01.2025]
        public List<Samples> GetReferenceByCustomer_V2600(string workbenchConnectionString, DateTime startDate, DateTime endDate, string idCustomerList)
        {
            List<Samples> SamplesList = new List<Samples>();
            DataTable dt = new DataTable();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorsByCustomer_V2600", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_StartDate", startDate);
                    mySqlCommand.Parameters.AddWithValue("_EndDate", endDate);
                    mySqlCommand.Parameters.AddWithValue("_IdCustomer", idCustomerList);

                    MySqlDataAdapter da = new MySqlDataAdapter(mySqlCommand);
                    da.Fill(dt);
                    foreach (DataRow reader in dt.Rows)
                    {
                        Samples samples = new Samples();
                        if (reader["IdConnector"] != DBNull.Value)
                        {
                            samples.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                        }
                        if (reader["EmdepReference"] != DBNull.Value)
                        {
                            samples.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                        }
                        if (reader["Reference"] != DBNull.Value)
                        {
                            samples.Reference = Convert.ToString(reader["Reference"]);
                        }
                        if (reader["IdConnectorImage"] != DBNull.Value)
                        {
                            samples.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                            if (reader["FileName"] != DBNull.Value)
                            {
                                samples.SavedFileName = Convert.ToString(reader["FileName"]);
                                samples.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + samples.EmdepReference + "/" + samples.SavedFileName;
                            }
                        }

                        if (reader["IdFamily"] != DBNull.Value)
                        {
                            samples.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                            if (reader["FamilyName"] != DBNull.Value)
                            {
                                samples.FamilyName = Convert.ToString(reader["FamilyName"]);
                            }

                        }
                        if (reader["idConnectorSubfamily"] != DBNull.Value)
                        {
                            samples.IdConnectorSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                            if (reader["SubFamilyName"] != DBNull.Value)
                            {
                                samples.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                            }

                        }
                        if (reader["CreatedIn"] != DBNull.Value)
                        {
                            samples.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                        }
                        if (reader["ModifiedIn"] != DBNull.Value)
                        {
                            samples.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                        }
                        if (reader["CreatedBy"] != DBNull.Value)
                        {
                            samples.CreatedBy = Convert.ToUInt32(reader["CreatedBy"]);
                            if (reader["FirstName"] != DBNull.Value)
                            {
                                samples.FirstName = Convert.ToString(reader["FirstName"]);
                            }
                            if (reader["LastName"] != DBNull.Value)
                            {
                                samples.LastName = Convert.ToString(reader["LastName"]);
                            }
                        }
                        if (reader["IdCompany"] != DBNull.Value)
                        {
                            samples.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                            if (reader["PlantName"] != DBNull.Value)
                            {
                                samples.PlantName = Convert.ToString(reader["PlantName"]);
                            }
                        }
                        if (reader["Description"] != DBNull.Value)
                        {
                            samples.Description = Convert.ToString(reader["Description"]);
                        }
                        if (reader["IdLookupValue"] != DBNull.Value)
                        {
                            samples.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                            samples.TypeName = Convert.ToString(reader["TypeName"]);
                        }
                        SamplesList.Add(samples);
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetNewSamplesByIdSite_V2490(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return SamplesList;
        }

        //[rdixit][14.01.2025][GEOS2-6857]
        public string GetLatestConnectorReference_V2600(string year, string connectionString)
        {
            string Ref = string.Empty;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetLatestConnectorReference_V2600", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_year1", year);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.HasRows == false)
                        {
                            Ref = year + "0001";
                        }
                        else
                        {
                            while (reader.Read())
                            {
                                if (reader["Ref"] != DBNull.Value)
                                {
                                    int aux = Convert.ToInt32(reader["Ref"]);
                                    aux++;
                                    Ref = aux.ToString();
                                    if (Ref.Length < 6)
                                    {
                                        Ref = "0" + Ref;
                                    }
                                }
                                else
                                    Ref = year + "0001";
                            }
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetLatestConnectorReference_V2600(year-{0}). ErrorMessage- {1}", year, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return Ref;
        }

        //[rdixit][GEOS2-6987][03.03.2025]
        public List<Samples> GetModifiedSamplesByIdSite_V2620(string workbenchConnectionString, DateTime startDate, DateTime endDate, Int32 idSite)
        {
            List<Samples> SamplesList = new List<Samples>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetModifiedSamplesConnectionList_V2620", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_StartDate", startDate);
                    mySqlCommand.Parameters.AddWithValue("_EndDate", endDate);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idSite);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Samples samples = new Samples();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                samples.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["EmdepReference"] != DBNull.Value)
                            {
                                samples.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                samples.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    samples.SavedFileName = Convert.ToString(reader["FileName"]);
                                    samples.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + samples.EmdepReference + "/" + samples.SavedFileName;
                                }
                            }
                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                samples.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                                if (reader["FamilyName"] != DBNull.Value)
                                {
                                    samples.FamilyName = Convert.ToString(reader["FamilyName"]);
                                }
                            }
                            if (reader["idConnectorSubfamily"] != DBNull.Value)
                            {
                                samples.IdConnectorSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                                if (reader["SubFamilyName"] != DBNull.Value)
                                {
                                    samples.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                                }
                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                samples.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["ModifiedIn"] != DBNull.Value)
                            {
                                samples.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                            }
                            if (reader["ModifiedBy"] != DBNull.Value)
                            {
                                samples.ModifiedBy = Convert.ToUInt32(reader["ModifiedBy"]);
                                if (reader["FirstName"] != DBNull.Value)
                                {
                                    samples.FirstName = Convert.ToString(reader["FirstName"]);
                                }
                                if (reader["LastName"] != DBNull.Value)
                                {
                                    samples.LastName = Convert.ToString(reader["LastName"]);
                                }
                            }
                            if (reader["IdCompany"] != DBNull.Value)
                            {
                                samples.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                                if (reader["PlantName"] != DBNull.Value)
                                {
                                    samples.PlantName = Convert.ToString(reader["PlantName"]);
                                }
                            }
                            if (reader["IdLogEntry"] != DBNull.Value)
                            {
                                samples.IdLogEntry = Convert.ToUInt32(reader["IdLogEntry"]);
                                if (reader["Comments"] != DBNull.Value)
                                {
                                    samples.LogComment = Convert.ToString(reader["Comments"]);
                                }
                            }
                            if (reader["IdLookupValue"] != DBNull.Value)
                            {
                                samples.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                                samples.TypeName = Convert.ToString(reader["TypeName"]);
                            }

                            SamplesList.Add(samples);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetModifiedSamplesByIdSite_V2620(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return SamplesList;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public bool UpdateSubFamily_V2620(string connectionString, ConnectorSubFamily subFamily, string ConnectorFamilyImagePath)
        {
            try
            {
                string SubFamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.IdFamily + "\\" + subFamily.Id;
                if (subFamily != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();
                        string selectedfilename = subFamily.Name;
                        string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.IdFamily + "\\" + subFamily.Id;
                        string destinationDirectory = ConnectorFamilyImagePath + FilePath;
                        string sourceDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.IdFamily + "\\" + subFamily.Id;

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Update_Subfamily_V2420", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", subFamily.Id);
                        mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", subFamily.IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_Name", subFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", subFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", subFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", subFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", subFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", subFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", subFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", subFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", subFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", subFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", subFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", subFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", subFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", subFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", subFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();

                        if (subFamily.Id > 0)
                        {
                            if (subFamily.ImageList != null)
                            {
                                UpdateConnectorSubFamilyImages_V2430(connectionString, Convert.ToInt32(subFamily.Id), subFamily.ImageList.ToList(), ConnectorFamilyImagePath + FilePath);
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error UpdateSubFamily_V2620().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return true;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public bool InsertSubFamily_V2620(string connectionString, ConnectorSubFamily subFamily, string ConnectorFamilyImagePath)
        {
            try
            {
                if (subFamily != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionString))
                    {
                        mySqlConnection.Open();
                        string subfilePath = "\\EXTRAS\\Familiy&Subfamily\\" + subFamily.IdFamily.ToString() + "\\";
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_SubFamily_Insert_V2620", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_Name", subFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", subFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", subFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", subFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", subFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", subFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", subFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", subFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", subFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", subFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", subFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", subFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", subFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", subFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", subFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", subfilePath);
                        mySqlCommand.Parameters.AddWithValue("_idConnectorFamily", subFamily.IdFamily);
                        subFamily.Id = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                        subfilePath = subfilePath + subFamily.Id;
                        mySqlConnection.Close();

                        if (subFamily.Id > 0)
                        {
                            if (subFamily.ImageList?.Count > 0)
                            {
                                AddSubFamilyImageBySubFamily_V2620(connectionString, subFamily.Id, subFamily.ImageList, subfilePath, ConnectorFamilyImagePath);
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error InsertSubFamily_V2450().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return true;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public void AddSubFamilyImageBySubFamily_V2620(string connectionstring, UInt32 IdSubFamily, ObservableCollection<SubFamilyImage> SubFamilyImageList, string SubFamilyImagePath, string ConnectorFamilyImagePath)
        {
            try
            {
                if (SubFamilyImageList.Count > 0)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(connectionstring))
                    {
                        mySqlConnection.Open();
                        foreach (SubFamilyImage item in SubFamilyImageList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_SubFamilyImage_Insert", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", IdSubFamily);
                            mySqlCommand.Parameters.AddWithValue("_SavedFileName", item.SavedFileName);
                            mySqlCommand.Parameters.AddWithValue("_Description", item.Description);
                            mySqlCommand.Parameters.AddWithValue("_OriginalFileName", item.OriginalFileName);
                            mySqlCommand.Parameters.AddWithValue("_CreatedBy", item.CreatedBy);
                            mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                            mySqlCommand.Parameters.AddWithValue("_Position", item.Position);
                            mySqlCommand.ExecuteNonQuery();
                            AddSubFamilyImageToPath_V2620(item, SubFamilyImagePath, ConnectorFamilyImagePath);
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddSubFamilyImageBySubFamily_V2620(). IdDetection- {0} ErrorMessage- {1}", IdSubFamily, ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public bool AddSubFamilyImageToPath_V2620(SubFamilyImage subFamilyImage, string subFamilyImagePath, string ConnectorFamilyImagePath)
        {
            if (subFamilyImage.SubFamilyImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\{1}", ConnectorFamilyImagePath, subFamilyImagePath);
                    string filePath = completePath + "\\" + subFamilyImage.SavedFileName;

                    if (!Directory.Exists(completePath))
                    {
                        Directory.CreateDirectory(completePath);
                    }
                    File.WriteAllBytes(filePath, subFamilyImage.SubFamilyImageInBytes);
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddSubFamilyImageToPath_V2620()- Filename - {0}. ErrorMessage- {1}", subFamilyImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public ConnectorFamily AddConnectorFamilies_V2620(string MainServerConnectionString, ConnectorFamily ConnectorFamily, string ConnectorFamilyImagePath)
        {
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    string FamiliesImagePath = string.Empty;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\";
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Insert_V2620", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_CreatedBy", ConnectorFamily.CreatedBy);
                        mySqlCommand.Parameters.AddWithValue("_CreatedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.Parameters.AddWithValue("_IdType", ConnectorFamily.ConnectorType.IdLookupValue);
                        ConnectorFamily.IdFamily = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                        FamiliesImagePath = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.IdFamily;
                        mySqlConnection.Close();
                    }
                    if (ConnectorFamily.FamilyImagesList?.Count > 0)
                    {
                        AddConnectorFamilyImages_V2430(MainServerConnectionString, Convert.ToUInt16(ConnectorFamily.IdFamily), ConnectorFamily.FamilyImagesList, FamiliesImagePath);
                    }
                    if (ConnectorFamily.SubFamilyList?.Count > 0)
                    {
                        foreach (var item in ConnectorFamily.SubFamilyList)
                        {
                            item.IdFamily = (uint)ConnectorFamily.IdFamily;
                            if (item.TransactionOperation == ModelBase.TransactionOperations.Add)
                                InsertSubFamily_V2620(MainServerConnectionString, item, ConnectorFamilyImagePath);
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in AddConnectorFamilies_V2620(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }

            return ConnectorFamily;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public ConnectorFamily UpdateConnectorFamilies_V2620(string MainServerConnectionString, ConnectorFamily ConnectorFamily, string ConnectorFamilyImagePath)
        {
            bool IsUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope())
            {
                try
                {
                    string destinationDirectory = string.Empty;
                    destinationDirectory = ConnectorFamilyImagePath + "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.IdFamily;
                    string FilePath = "\\EXTRAS\\Familiy&Subfamily\\" + ConnectorFamily.IdFamily;
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_ConnectorFamilies_Update_V2480", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdFamily", ConnectorFamily.IdFamily);
                        mySqlCommand.Parameters.AddWithValue("_Name", ConnectorFamily.Name);
                        mySqlCommand.Parameters.AddWithValue("_Name_es", ConnectorFamily.Name_es);
                        mySqlCommand.Parameters.AddWithValue("_Name_fr", ConnectorFamily.Name_fr);
                        mySqlCommand.Parameters.AddWithValue("_Name_ro", ConnectorFamily.Name_ro);
                        mySqlCommand.Parameters.AddWithValue("_Name_zh", ConnectorFamily.Name_zh);
                        mySqlCommand.Parameters.AddWithValue("_Name_pt", ConnectorFamily.Name_pt);
                        mySqlCommand.Parameters.AddWithValue("_Name_ru", ConnectorFamily.Name_ru);
                        mySqlCommand.Parameters.AddWithValue("_Description", ConnectorFamily.Description);
                        mySqlCommand.Parameters.AddWithValue("_Description_es", ConnectorFamily.Description_es);
                        mySqlCommand.Parameters.AddWithValue("_Description_fr", ConnectorFamily.Description_fr);
                        mySqlCommand.Parameters.AddWithValue("_Description_ro", ConnectorFamily.Description_ro);
                        mySqlCommand.Parameters.AddWithValue("_Description_zh", ConnectorFamily.Description_zh);
                        mySqlCommand.Parameters.AddWithValue("_Description_pt", ConnectorFamily.Description_pt);
                        mySqlCommand.Parameters.AddWithValue("_Description_ru", ConnectorFamily.Description_ru);
                        mySqlCommand.Parameters.AddWithValue("_InUse", ConnectorFamily.IsInUse);
                        mySqlCommand.Parameters.AddWithValue("_ModifiedBy", ConnectorFamily.ModifiedBy);
                        mySqlCommand.Parameters.AddWithValue("_ModifiedIn", DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss"));
                        mySqlCommand.Parameters.AddWithValue("_VisualAidPATH", FilePath);
                        mySqlCommand.Parameters.AddWithValue("_IdType", ConnectorFamily.ConnectorType.IdLookupValue);
                        mySqlCommand.ExecuteNonQuery();
                        IsUpdated = true;
                        mySqlConnection.Close();

                        if (ConnectorFamily.IdFamily > 0 && ConnectorFamily.FamilyImagesList?.Count > 0)
                        {
                            if (ConnectorFamily.FamilyImagesList.Any(i => i.TransactionOperation == ModelBase.TransactionOperations.Add || i.TransactionOperation == ModelBase.TransactionOperations.Delete || i.TransactionOperation == ModelBase.TransactionOperations.Update))
                                UpdateConnectorFamilyImages_V2430(MainServerConnectionString, ConnectorFamily.IdFamily, ConnectorFamily.FamilyImagesList, destinationDirectory);
                        }
                        //if (ConnectorFamily.SubFamilyList?.Count > 0)
                        //{
                        //    foreach (var item in ConnectorFamily.SubFamilyList)
                        //    {
                        //        if (item.TransactionOperation == ModelBase.TransactionOperations.Update)
                        //            UpdateSubFamily_V2620(MainServerConnectionString, item, ConnectorFamilyImagePath);
                        //        else if (item.TransactionOperation == ModelBase.TransactionOperations.Add)
                        //            InsertSubFamily_V2620(MainServerConnectionString, item, ConnectorFamilyImagePath);
                        //    }
                        //}
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error in UpdateConnectorFamilies_V2620(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();

                    throw;
                }
            }
            return ConnectorFamily;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public List<ConnectorFamily> GetConnectorFamilies_V2620(string MainServerConnectionString, string ConnectorFamiliesImagePath)
        {
            List<ConnectorFamily> connector = new List<ConnectorFamily>();
            List<int> IntList = new List<int>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GETConnectorFamilies_V2480", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorFamily connectorFamilies = new ConnectorFamily();
                            if (rdr["KeyName"] != DBNull.Value)
                                connectorFamilies.Key = Convert.ToString(rdr["KeyName"]);
                            if (rdr["SubfamilyID"] != DBNull.Value)
                                connectorFamilies.IdSubFamilyConnector = Convert.ToInt32(rdr["SubfamilyID"]);
                            if (rdr["ParentFamilyID"] != DBNull.Value)
                                connectorFamilies.IdFamily = Convert.ToInt32(rdr["ParentFamilyID"]);
                            if (rdr["Parent_Category"] != DBNull.Value)
                                connectorFamilies.Parent = Convert.ToString(rdr["Parent_Category"]);
                            if (rdr["Name"] != DBNull.Value)
                                connectorFamilies.Name = Convert.ToString(rdr["Name"]);
                            if (rdr["Name_es"] != DBNull.Value)
                                connectorFamilies.Name_es = Convert.ToString(rdr["Name_es"]);
                            if (rdr["Name_fr"] != DBNull.Value)
                                connectorFamilies.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            if (rdr["Name_pt"] != DBNull.Value)
                                connectorFamilies.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            if (rdr["Name_ro"] != DBNull.Value)
                                connectorFamilies.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            if (rdr["Name_ru"] != DBNull.Value)
                                connectorFamilies.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            if (rdr["Name_zh"] != DBNull.Value)
                                connectorFamilies.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            if (rdr["Description"] != DBNull.Value)
                                connectorFamilies.Description = Convert.ToString(rdr["Description"]);
                            if (rdr["Description_es"] != DBNull.Value)
                                connectorFamilies.Description_es = Convert.ToString(rdr["Description_es"]);
                            if (rdr["Description_fr"] != DBNull.Value)
                                connectorFamilies.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            if (rdr["Description_pt"] != DBNull.Value)
                                connectorFamilies.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            if (rdr["Description_ro"] != DBNull.Value)
                                connectorFamilies.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            if (rdr["Description_ru"] != DBNull.Value)
                                connectorFamilies.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            if (rdr["Description_zh"] != DBNull.Value)
                                connectorFamilies.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                                connectorFamilies.FilePath = Convert.ToString(rdr["VisualAidPATH"]);
                            if (rdr["IdType"] != DBNull.Value)
                            {
                                connectorFamilies.ConnectorType = new LookUpValues();
                                connectorFamilies.ConnectorType.IdLookupValue = Convert.ToInt32(rdr["IdType"]);
                                if (rdr["Value"] != DBNull.Value)
                                    connectorFamilies.ConnectorType.Value_en = Convert.ToString(rdr["Value"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                sbyte InUseYesNoParent = Convert.ToSByte(rdr["InUse"]);
                                if (InUseYesNoParent == 1)
                                    connectorFamilies.IsInUse = "Yes";
                                else
                                    connectorFamilies.IsInUse = "No";
                            }
                            connector.Add(connectorFamilies);
                        }
                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamily selectedConnectorFamily = new ConnectorFamily();
                                if (Convert.ToUInt64(rdr["Position"]) == 1)
                                {
                                    List<ConnectorFamily> connectorFamiliesimageList = new List<ConnectorFamily>();
                                    selectedConnectorFamily = connector.FirstOrDefault(i => i.IdFamily == Convert.ToInt32(rdr["familyimageIdFamily"]) && i.IdSubFamilyConnector == 0);
                                    if (selectedConnectorFamily != null)
                                    {
                                        if (rdr["familyimageIdFamily"] != DBNull.Value)
                                            selectedConnectorFamily.IdFamilyimageIdFamily = Convert.ToInt32(rdr["familyimageIdFamily"]);
                                        if (rdr["IdSCMFamilyImage"] != DBNull.Value)
                                            selectedConnectorFamily.IdSCMFamilyImage = Convert.ToUInt64(rdr["IdSCMFamilyImage"]);
                                        if (rdr["SavedFileNameParent"] != DBNull.Value)
                                            selectedConnectorFamily.SavedFileNameParent = Convert.ToString(rdr["SavedFileNameParent"]);
                                        if (rdr["Position"] != DBNull.Value)
                                            selectedConnectorFamily.Position = Convert.ToUInt64(rdr["Position"]);
                                        string path = ConnectorFamiliesImagePath + selectedConnectorFamily.FilePath;

                                        selectedConnectorFamily.ConnectorFamilyImageInBytes = GetImage_V2620(path, selectedConnectorFamily.SavedFileNameParent);
                                    }
                                }
                            }
                        }

                        if (rdr.NextResult())
                        {
                            while (rdr.Read())
                            {
                                ConnectorFamily selectedConnectorSubFamily = new ConnectorFamily();

                                if (Convert.ToUInt64(rdr["subfamilyPosition"]) == 1)
                                {
                                    string SubFolderPath = string.Empty;
                                    selectedConnectorSubFamily = connector.FirstOrDefault(i => i.IdSubFamilyConnector == Convert.ToInt64(rdr["IdSubFamily"]));
                                    if (selectedConnectorSubFamily != null)
                                    {
                                        if (rdr["subfamilyPosition"] != DBNull.Value)
                                            selectedConnectorSubFamily.Position = Convert.ToUInt64(rdr["subfamilyPosition"]);

                                        if (rdr["IdSubFamily"] != DBNull.Value)
                                            selectedConnectorSubFamily.IdSubFamilyConnector = Convert.ToInt32(rdr["IdSubFamily"]);

                                        if (rdr["IdSCMSubFamilyImage"] != DBNull.Value)
                                            selectedConnectorSubFamily.IdSCMSubFamilyImage = Convert.ToUInt64(rdr["IdSCMSubFamilyImage"]);

                                        if (rdr["SavedFileName"] != DBNull.Value)
                                            selectedConnectorSubFamily.SavedFileName = Convert.ToString(rdr["SavedFileName"]);

                                        if (rdr["OriginalFileName"] != DBNull.Value)
                                            selectedConnectorSubFamily.OriginalFileName = Convert.ToString(rdr["OriginalFileName"]);

                                        if (rdr["VisualAidPATH"] != DBNull.Value)
                                            SubFolderPath = Convert.ToString(rdr["VisualAidPATH"]);

                                        string subPath = ConnectorFamiliesImagePath + SubFolderPath;
                                        selectedConnectorSubFamily.ConnectorFamilyImageInBytes = GetImage_V2620(subPath, selectedConnectorSubFamily.SavedFileName);
                                    }
                                }
                            }
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorFamilies_V2620().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connector;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public byte[] GetImage_V2620(string imagePath, string savedFileName)
        {
            byte[] bytes = null;
            string fileUploadPath = string.Empty;
            try
            {

                fileUploadPath = Path.Combine(imagePath, savedFileName);

                if (File.Exists(fileUploadPath))
                {
                    using (System.IO.FileStream stream = new System.IO.FileStream(fileUploadPath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
                    {
                        bytes = new byte[stream.Length];
                        int numBytesToRead = (int)stream.Length;
                        int numBytesRead = 0;

                        while (numBytesToRead > 0)
                        {
                            // Read may return anything from 0 to numBytesToRead.
                            int n = stream.Read(bytes, numBytesRead, numBytesToRead);

                            // Break when the end of the file is reached.
                            if (n == 0)
                                break;

                            numBytesRead += n;
                            numBytesToRead -= n;
                        }
                    }
                }
                //}
                return bytes;
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetImage_V2620(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public ConnectorSubFamily GetSubFamilyDetails_V2620(string localGeosConnectionString, int idSubFamily, string FamilyName, string FamiliesImagePath)
        {
            ConnectorSubFamily subFamily = new ConnectorSubFamily();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSubFamilyDetailsByIdSubFamily", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", idSubFamily);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            if (rdr["idConnectorSubfamily"] != DBNull.Value)
                            {
                                subFamily.Id = Convert.ToUInt16(rdr["idConnectorSubfamily"]);
                            }
                            if (rdr["idConnectorFamily"] != DBNull.Value)
                            {
                                subFamily.IdFamily = Convert.ToUInt16(rdr["idConnectorFamily"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                subFamily.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                subFamily.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                subFamily.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                subFamily.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                subFamily.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                subFamily.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                subFamily.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                subFamily.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["Description_fr"] != DBNull.Value)
                            {
                                subFamily.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            }
                            if (rdr["Description_es"] != DBNull.Value)
                            {
                                subFamily.Description_es = Convert.ToString(rdr["Description_es"]);
                            }
                            if (rdr["Description_pt"] != DBNull.Value)
                            {
                                subFamily.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            }
                            if (rdr["Description_ro"] != DBNull.Value)
                            {
                                subFamily.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            }
                            if (rdr["Description_zh"] != DBNull.Value)
                            {
                                subFamily.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            }
                            if (rdr["Description_ru"] != DBNull.Value)
                            {
                                subFamily.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                bool InUse = Convert.ToBoolean(rdr["InUse"]);
                                if (InUse)
                                    subFamily.IsInUse = "1";
                                else
                                    subFamily.IsInUse = "0";
                            }
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                            {
                                subFamily.Path = Convert.ToString(rdr["VisualAidPATH"]);
                            }
                            string subPath = FamiliesImagePath + subFamily.Path;

                            subFamily.ImageList = new ObservableCollection<SubFamilyImage>(GetSubFamilyImageImagesByIdSubFamily_V2620(localGeosConnectionString, subFamily.Id, subPath));
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamilyDetails_V2620().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return subFamily;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public List<SubFamilyImage> GetSubFamilyImageImagesByIdSubFamily_V2620(string SCMConnectionString, uint IdSubFamily, string FamiliesImagePath)
        {
            List<SubFamilyImage> FamilyImage = new List<SubFamilyImage>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyImagesByIdSubFamily", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdSubFamily", IdSubFamily);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SubFamilyImage familyImage = new SubFamilyImage();

                            familyImage.IdSubFamilyImage = Convert.ToUInt32(reader["IdSCMSubFamilyImage"]);
                            familyImage.IdSubFamily = Convert.ToUInt16(reader["IdSubFamily"]);

                            if (reader["SavedFileName"] != DBNull.Value)
                            {
                                familyImage.SavedFileName = Convert.ToString(reader["SavedFileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                familyImage.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["OriginalFileName"] != DBNull.Value)
                            {
                                familyImage.OriginalFileName = Convert.ToString(reader["OriginalFileName"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                familyImage.Position = Convert.ToUInt64(reader["Position"]);
                            }
                            familyImage.TransactionOperation = ModelBase.TransactionOperations.Modify;
                            familyImage.SubFamilyImageInBytes = GetImage_V2620(FamiliesImagePath, familyImage.SavedFileName);
                            FamilyImage.Add(familyImage);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamilyImageImagesByIdSubFamily_V2620(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return FamilyImage;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public List<ConnectorSubFamily> GetSubFamiliesListByIdFamily_V2620(string localGeosConnectionString, int idFamily, string imagePath)
        {
            List<ConnectorSubFamily> subFamily = new List<ConnectorSubFamily>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSubFamilies_V2430", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", idFamily);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorSubFamily family = new ConnectorSubFamily();
                            if (rdr["idConnectorSubfamily"] != DBNull.Value)
                            {
                                family.Id = Convert.ToUInt16(rdr["idConnectorSubfamily"]);
                            }
                            if (rdr["idConnectorFamily"] != DBNull.Value)
                            {
                                family.IdFamily = Convert.ToUInt16(rdr["idConnectorFamily"]);
                            }
                            if (rdr["Name"] != DBNull.Value)
                            {
                                family.Name = Convert.ToString(rdr["Name"]);
                            }
                            if (rdr["Name_es"] != DBNull.Value)
                            {
                                family.Name_es = Convert.ToString(rdr["Name_es"]);
                            }
                            if (rdr["Name_fr"] != DBNull.Value)
                            {
                                family.Name_fr = Convert.ToString(rdr["Name_fr"]);
                            }
                            if (rdr["Name_pt"] != DBNull.Value)
                            {
                                family.Name_pt = Convert.ToString(rdr["Name_pt"]);
                            }
                            if (rdr["Name_ro"] != DBNull.Value)
                            {
                                family.Name_ro = Convert.ToString(rdr["Name_ro"]);
                            }
                            if (rdr["Name_ru"] != DBNull.Value)
                            {
                                family.Name_ru = Convert.ToString(rdr["Name_ru"]);
                            }
                            if (rdr["Name_zh"] != DBNull.Value)
                            {
                                family.Name_zh = Convert.ToString(rdr["Name_zh"]);
                            }
                            if (rdr["Description"] != DBNull.Value)
                            {
                                family.Description = Convert.ToString(rdr["Description"]);
                            }
                            if (rdr["Description_fr"] != DBNull.Value)
                            {
                                family.Description_fr = Convert.ToString(rdr["Description_fr"]);
                            }
                            if (rdr["Description_es"] != DBNull.Value)
                            {
                                family.Description_es = Convert.ToString(rdr["Description_es"]);
                            }
                            if (rdr["Description_pt"] != DBNull.Value)
                            {
                                family.Description_pt = Convert.ToString(rdr["Description_pt"]);
                            }
                            if (rdr["Description_ro"] != DBNull.Value)
                            {
                                family.Description_ro = Convert.ToString(rdr["Description_ro"]);
                            }
                            if (rdr["Description_zh"] != DBNull.Value)
                            {
                                family.Description_zh = Convert.ToString(rdr["Description_zh"]);
                            }
                            if (rdr["Description_ru"] != DBNull.Value)
                            {
                                family.Description_ru = Convert.ToString(rdr["Description_ru"]);
                            }
                            if (rdr["InUse"] != DBNull.Value)
                            {
                                bool InUse = Convert.ToBoolean(rdr["InUse"]);
                                if (InUse)
                                    family.IsInUse = "1";
                                else
                                    family.IsInUse = "0";
                            }
                            if (rdr["VisualAidPATH"] != DBNull.Value)
                            {
                                family.Path = Convert.ToString(rdr["VisualAidPATH"]);
                            }
                            family.TransactionOperation = ModelBase.TransactionOperations.Modify;
                            string subPath = imagePath + family.Path;

                            family.ImageList = new ObservableCollection<SubFamilyImage>(GetSubFamilyImageImagesByIdSubFamily_V2620(localGeosConnectionString, family.Id, subPath));

                            subFamily.Add(family)
;
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSubFamiliesListByIdFamily_V2620().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return subFamily;
        }

        //[rdixit][05.03.2025][GEOS2-7026] 
        public List<FamilyImage> GetFamilyImagesByIdFamily_V2620(string SCMConnectionString, int idFamily, string FamiliesImagePath)
        {
            List<FamilyImage> FamilyImage = new List<FamilyImage>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetFamilyImagesByIdFamily_V2620", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", idFamily);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            FamilyImage familyImage = new FamilyImage();

                            familyImage.IdSCMFamilyImage = Convert.ToUInt32(reader["IdSCMFamilyImage"]);
                            familyImage.IdFamily = Convert.ToUInt16(reader["IdFamily"]);

                            if (reader["SavedFileName"] != DBNull.Value)
                            {
                                familyImage.SavedFileName = Convert.ToString(reader["SavedFileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                familyImage.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["OriginalFileName"] != DBNull.Value)
                            {
                                familyImage.OriginalFileName = Convert.ToString(reader["OriginalFileName"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                familyImage.Position = Convert.ToUInt64(reader["Position"]);
                            }
                            if (reader["VisualAidPATH"] != DBNull.Value)
                            {
                                string path = FamiliesImagePath + Convert.ToString(reader["VisualAidPATH"]);
                                familyImage.ConnectorFamilyImageInBytes = GetImage_V2620(path, familyImage.SavedFileName);
                            }
                            familyImage.TransactionOperation = ModelBase.TransactionOperations.Modify;
                            FamilyImage.Add(familyImage);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetFamilyImagesByIdFamily_V2620(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return FamilyImage;
        }

        //[rdixit][GEOS2-6984][27.03.2025]
        public List<Connectors> GetAllConnectors_V2630(string SCMConnectionString, Connectors Connectors, string componentQuery, string ConnectorsImagesImagePath)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2630", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    #region Parameters
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompanyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", string.Join(",", Connectors.SelectedCompanyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", string.Join(",", Connectors.SelectedFamilyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", string.Join(",", Connectors.SelectedSubfamilyList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColorList != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", string.Join(",", Connectors.SelectedColorList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGenderList != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", string.Join(",", Connectors.SelectedGenderList.Select(i => i.Id)));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape?.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);
                    #region[GEOS2-5296][rdixit][29.02.2024]
                    #region Ways
                    if (Connectors.WaysProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", (Connectors.WaysProp.MinValueNew == string.Empty) ? null : Connectors.WaysProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", (Connectors.WaysProp.MaxValueNew == string.Empty) ? null : Connectors.WaysProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", null);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", null);
                    }
                    #endregion

                    #region DiameterInternal
                    if (Connectors.DiameterInternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", (Connectors.DiameterInternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", (Connectors.DiameterInternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", null);
                    }
                    #endregion

                    #region DiameterExternal
                    if (Connectors.DiameterExternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", (Connectors.DiameterExternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", (Connectors.DiameterExternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", null);
                    }
                    #endregion

                    #region Height
                    if (Connectors.HeightProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", (Connectors.HeightProp.MinValueNew == string.Empty) ? null : Connectors.HeightProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", (Connectors.HeightProp.MaxValueNew == string.Empty) ? null : Connectors.HeightProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", null);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", null);
                    }
                    #endregion

                    #region Length
                    if (Connectors.LengthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", (Connectors.LengthProp.MinValueNew == string.Empty) ? null : Connectors.LengthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", (Connectors.LengthProp.MaxValueNew == string.Empty) ? null : Connectors.LengthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", null);
                    }
                    #endregion

                    #region Width
                    if (Connectors.WidthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", (Connectors.WidthProp.MinValueNew == string.Empty) ? null : Connectors.WidthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", (Connectors.WidthProp.MaxValueNew == string.Empty) ? null : Connectors.WidthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", null);
                    }
                    #endregion
                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion                  

                    if (string.IsNullOrEmpty(Connectors.ConnectorType))
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", null);
                    else
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", Connectors.ConnectorType);

                    mySqlCommand.Parameters.AddWithValue("_ComponentQuery", componentQuery);// Added code to reduce time to load data
                    #endregion
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (!string.IsNullOrEmpty(Connectors.Ref))
                        {
                            if (reader.NextResult())
                            {
                                while (reader.Read())
                                {
                                    Connectors connector = new Connectors();
                                    if (reader["IdConnector"] != DBNull.Value)
                                    {
                                        connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                                    }
                                    if (reader["Ref"] != DBNull.Value)
                                    {
                                        connector.Ref = Convert.ToString(reader["Ref"]);
                                    }
                                    if (reader["numWays"] != DBNull.Value)
                                    {
                                        connector.NumWays = Convert.ToInt32(reader["numWays"]);
                                    }
                                    if (reader["numWays"] != DBNull.Value)
                                    {
                                        connector.Ways = Convert.ToString(reader["numWays"]);
                                    }
                                    if (reader["Family"] != DBNull.Value)
                                    {
                                        connector.Family = Convert.ToString(reader["Family"]);
                                    }
                                    if (reader["SubFamily"] != DBNull.Value)
                                    {
                                        connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                                    }
                                    if (reader["Color"] != DBNull.Value)
                                    {
                                        connector.Color = Convert.ToString(reader["Color"]);
                                    }
                                    if (reader["Terminal"] != DBNull.Value)
                                    {
                                        connector.Terminal = Convert.ToString(reader["Terminal"]);
                                    }
                                    if (reader["FileName"] != DBNull.Value)
                                    {
                                        connector.FileName = Convert.ToString(reader["FileName"]);
                                        connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                                    }
                                    if (reader["Location"] != DBNull.Value)
                                    {
                                        connector.Location = Convert.ToString(reader["Location"]);
                                    }
                                    if (reader["Description"] != DBNull.Value)
                                    {
                                        connector.Description = Convert.ToString(reader["Description"]);
                                    }
                                    if (reader["Duplicated"] != DBNull.Value)
                                    {
                                        connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                                    }

                                    ConnectorsList.Add(connector);
                                }
                            }
                        }
                        else
                        {
                            while (reader.Read())
                            {
                                Connectors connector = new Connectors();
                                if (reader["IdConnector"] != DBNull.Value)
                                {
                                    connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                                }
                                if (reader["Ref"] != DBNull.Value)
                                {
                                    connector.Ref = Convert.ToString(reader["Ref"]);
                                }
                                if (reader["numWays"] != DBNull.Value)
                                {
                                    connector.NumWays = Convert.ToInt32(reader["numWays"]);
                                }
                                if (reader["numWays"] != DBNull.Value)
                                {
                                    connector.Ways = Convert.ToString(reader["numWays"]);
                                }
                                if (reader["Family"] != DBNull.Value)
                                {
                                    connector.Family = Convert.ToString(reader["Family"]);
                                }
                                if (reader["SubFamily"] != DBNull.Value)
                                {
                                    connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                                }
                                if (reader["Color"] != DBNull.Value)
                                {
                                    connector.Color = Convert.ToString(reader["Color"]);
                                }
                                if (reader["Terminal"] != DBNull.Value)
                                {
                                    connector.Terminal = Convert.ToString(reader["Terminal"]);
                                }
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    connector.FileName = Convert.ToString(reader["FileName"]);
                                    connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                                }
                                if (reader["Location"] != DBNull.Value)
                                {
                                    connector.Location = Convert.ToString(reader["Location"]);
                                }
                                if (reader["Description"] != DBNull.Value)
                                {
                                    connector.Description = Convert.ToString(reader["Description"]);
                                }
                                if (reader["Duplicated"] != DBNull.Value)
                                {
                                    connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                                }

                                ConnectorsList.Add(connector);
                            }
                        }


                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2630(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }

        //[rdixit][GEOS2-7859][14.05.2025]
        public List<Samples> GetNewSamplesByIdSite_V2640(string emdep_GeosConnectionString, string geosConnectionString, DateTime startDate, DateTime endDate, Int32 idSite)
        {
            List<WorkflowStatus> StatusList = GetStatusForNewSamples_V2490(emdep_GeosConnectionString);
            List<Samples> SamplesList = new List<Samples>();
            DataTable dt = new DataTable();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(geosConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetNewSamplesConnectionList_V2640", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_StartDate", startDate);
                    mySqlCommand.Parameters.AddWithValue("_EndDate", endDate);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idSite);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Samples samples = new Samples();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                samples.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["EmdepReference"] != DBNull.Value)
                            {
                                samples.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                            }
                            if (reader["Reference"] != DBNull.Value)
                            {
                                samples.Reference = Convert.ToString(reader["Reference"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                samples.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    samples.SavedFileName = Convert.ToString(reader["FileName"]);
                                    samples.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + samples.EmdepReference + "/" + samples.SavedFileName;
                                }

                            }
                            if (reader["IdWorkflowStatus"] != DBNull.Value)
                            {
                                samples.IdWorkflowStatus = Convert.ToInt64(reader["IdWorkflowStatus"]);
                                samples.Status = new WorkflowStatus();
                                samples.Status.IdWorkflowStatus = (Int32)samples.IdWorkflowStatus;
                                samples.Status.Name = Convert.ToString(reader["StatusName"]);
                                samples.Status.HTMLColor = Convert.ToString(reader["StatusHTMLColor"]);
                                if (reader["StatusName"] != DBNull.Value)
                                {
                                    samples.StatusName = Convert.ToString(reader["StatusName"]);
                                }
                                if (reader["StatusHTMLColor"] != DBNull.Value)
                                {
                                    samples.StatusHTMLColor = Convert.ToString(reader["StatusHTMLColor"]);
                                }
                            }
                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                samples.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                                if (reader["FamilyName"] != DBNull.Value)
                                {
                                    samples.FamilyName = Convert.ToString(reader["FamilyName"]);
                                }

                            }
                            if (reader["idConnectorSubfamily"] != DBNull.Value)
                            {
                                samples.IdConnectorSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                                if (reader["SubFamilyName"] != DBNull.Value)
                                {
                                    samples.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                                }

                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                samples.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["ModifiedIn"] != DBNull.Value)
                            {
                                samples.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                            }
                            if (reader["CreatedBy"] != DBNull.Value)
                            {
                                samples.CreatedBy = Convert.ToUInt32(reader["CreatedBy"]);
                                if (reader["FirstName"] != DBNull.Value)
                                {
                                    samples.FirstName = Convert.ToString(reader["FirstName"]);
                                }
                                if (reader["LastName"] != DBNull.Value)
                                {
                                    samples.LastName = Convert.ToString(reader["LastName"]);
                                }
                            }
                            if (reader["IdCompany"] != DBNull.Value)
                            {
                                samples.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                                if (reader["PlantName"] != DBNull.Value)
                                {
                                    samples.PlantName = Convert.ToString(reader["PlantName"]);
                                }
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                samples.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["IdLookupValue"] != DBNull.Value)
                            {
                                samples.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                                samples.TypeName = Convert.ToString(reader["TypeName"]);
                            }
                            if (reader["DrawingName"] != DBNull.Value)
                            {
                                samples.DrawingName = Convert.ToString(reader["DrawingName"]);
                            }
                            samples.StatusList = StatusList;
                            SamplesList.Add(samples);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetNewSamplesByIdSite_V2640(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return SamplesList;
        }

        #region [GEOS2-7863][rani dhamankar][12-05-2025]
        public List<ThreeDConnectorItems> Get3dConnectorByIdSite_V2640(string workbenchConnectionString, DateTime startDate, DateTime endDate, Int32 idSite)
        {
            List<ThreeDConnectorItems> threedConnectorList = new List<ThreeDConnectorItems>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_Get3dConnectionList_V2640", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_StartDate", startDate);
                    mySqlCommand.Parameters.AddWithValue("_EndDate", endDate);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idSite);
                    mySqlCommand.CommandTimeout = 8000;
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            ThreeDConnectorItems threedConnector = new ThreeDConnectorItems();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                threedConnector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["EmdepReference"] != DBNull.Value)
                            {
                                threedConnector.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                            }
                            if (reader["Reference"] != DBNull.Value)
                            {
                                threedConnector.Reference = Convert.ToString(reader["Reference"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                threedConnector.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    threedConnector.SavedFileName = Convert.ToString(reader["FileName"]);
                                    threedConnector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + threedConnector.EmdepReference + "/" + threedConnector.SavedFileName;
                                }
                            }
                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                threedConnector.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                            }
                            if (reader["FamilyName"] != DBNull.Value)
                            {
                                threedConnector.FamilyName = Convert.ToString(reader["FamilyName"]);
                            }
                            if (reader["idConnectorSubfamily"] != DBNull.Value)
                            {
                                threedConnector.IdConnectorsSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                            }
                            if (reader["SubFamilyName"] != DBNull.Value)
                            {
                                threedConnector.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                            }
                            if (reader["CreationDate"] != DBNull.Value)
                            {
                                threedConnector.CreationDate = Convert.ToDateTime(reader["CreationDate"]);
                            }
                            if (reader["IdCompany"] != DBNull.Value)
                            {
                                threedConnector.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                            }
                            if (reader["PlantName"] != DBNull.Value)
                            {
                                threedConnector.PlantName = Convert.ToString(reader["PlantName"]);
                            }
                            if (reader["OTCode"] != DBNull.Value)
                            {
                                threedConnector.OTCode = Convert.ToString(reader["OTCode"]);
                            }
                            if (reader["ItemNumber"] != DBNull.Value)
                            {
                                threedConnector.ItemNumber = Convert.ToUInt32(reader["ItemNumber"]);
                            }
                            if (reader["IdItemOtStatus"] != DBNull.Value)
                            {
                                threedConnector.IdItemOTStatus = Convert.ToUInt32(reader["IdItemOtStatus"]);
                            }
                            if (reader["ItemStatus"] != DBNull.Value)
                            {
                                threedConnector.ItemStatus = Convert.ToString(reader["ItemStatus"]);
                            }
                            if (reader["IdDrawing"] != DBNull.Value)
                            {
                                threedConnector.IdDrawing = Convert.ToUInt32(reader["IdDrawing"]);
                            }
                            if (reader["Revision"] != DBNull.Value)
                            {
                                threedConnector.Revision = Convert.ToString(reader["Revision"]);
                            }
                            if (reader["Reworks"] != DBNull.Value)
                            {
                                threedConnector.Reworks = Convert.ToInt32(reader["Reworks"]);
                            }
                            if (reader["ReworkComment"] != DBNull.Value)
                            {
                                threedConnector.ReworkComment = Convert.ToString(reader["ReworkComment"]);
                            }
                            if (reader["IdLookupValue"] != DBNull.Value)
                            {
                                threedConnector.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                                threedConnector.TypeName = Convert.ToString(reader["TypeName"]);
                            }
                            if (reader["IdPerson"] != DBNull.Value)
                            {
                                threedConnector.IdPerson = Convert.ToUInt32(reader["IdPerson"]);
                                threedConnector.DesignerFullName = Convert.ToString(reader["DesignerFullName"]);
                            }
                            else
                            {
                                threedConnector.DesignerFullName = "-";
                            }
                            if (reader["ReworkStage"] != DBNull.Value)
                            {
                                threedConnector.ReworkStage = Convert.ToString(reader["ReworkStage"]);
                            }
                            else
                            {
                                threedConnector.ReworkStage = "-";
                            }
                            if (reader["DrawingCreatedIN"] != DBNull.Value)
                            {
                                threedConnector.DrawingCreatedIn = Convert.ToDateTime(reader["DrawingCreatedIN"]);
                            }
                            threedConnectorList.Add(threedConnector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error Get3dConnectorByIdSite_V2640(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return threedConnectorList;
        }

        #endregion

        //[rdixit][GEOS2-7861][14.05.2025]
        public List<Samples> GetModifiedSamplesByIdSite_V2640(string workbenchConnectionString, DateTime startDate, DateTime endDate, Int32 idSite)
        {
            List<Samples> SamplesList = new List<Samples>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetModifiedSamplesConnectionList_V2640", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_StartDate", startDate);
                    mySqlCommand.Parameters.AddWithValue("_EndDate", endDate);
                    mySqlCommand.Parameters.AddWithValue("_IdSite", idSite);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Samples samples = new Samples();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                samples.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["EmdepReference"] != DBNull.Value)
                            {
                                samples.EmdepReference = Convert.ToString(reader["EmdepReference"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                samples.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    samples.SavedFileName = Convert.ToString(reader["FileName"]);
                                    samples.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + samples.EmdepReference + "/" + samples.SavedFileName;
                                }
                            }
                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                samples.IdFamily = Convert.ToInt64(reader["IdFamily"]);
                                if (reader["FamilyName"] != DBNull.Value)
                                {
                                    samples.FamilyName = Convert.ToString(reader["FamilyName"]);
                                }
                            }
                            if (reader["idConnectorSubfamily"] != DBNull.Value)
                            {
                                samples.IdConnectorSubFamily = Convert.ToInt64(reader["idConnectorSubfamily"]);
                                if (reader["SubFamilyName"] != DBNull.Value)
                                {
                                    samples.SubFamilyName = Convert.ToString(reader["SubFamilyName"]);
                                }
                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                samples.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["ModifiedIn"] != DBNull.Value)
                            {
                                samples.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                            }
                            if (reader["ModifiedBy"] != DBNull.Value)
                            {
                                samples.ModifiedBy = Convert.ToUInt32(reader["ModifiedBy"]);
                                if (reader["FirstName"] != DBNull.Value)
                                {
                                    samples.FirstName = Convert.ToString(reader["FirstName"]);
                                }
                                if (reader["LastName"] != DBNull.Value)
                                {
                                    samples.LastName = Convert.ToString(reader["LastName"]);
                                }
                            }
                            if (reader["IdCompany"] != DBNull.Value)
                            {
                                samples.IdCompany = Convert.ToUInt32(reader["IdCompany"]);
                                if (reader["PlantName"] != DBNull.Value)
                                {
                                    samples.PlantName = Convert.ToString(reader["PlantName"]);
                                }
                            }
                            if (reader["IdLogEntry"] != DBNull.Value)
                            {
                                samples.IdLogEntry = Convert.ToUInt32(reader["IdLogEntry"]);
                                if (reader["Comments"] != DBNull.Value)
                                {
                                    samples.LogComment = Convert.ToString(reader["Comments"]);
                                }
                            }
                            if (reader["IdLookupValue"] != DBNull.Value)
                            {
                                samples.IdType = Convert.ToUInt32(reader["IdLookupValue"]);
                                samples.TypeName = Convert.ToString(reader["TypeName"]);
                            }

                            SamplesList.Add(samples);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetModifiedSamplesByIdSite_V2640(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return SamplesList;
        }

        #region [GEOS2-7855][rani dhamankar][15-05-2025]
        public List<ConnectorProperties> GetPropertyManagerByFamily_V2640(string localGeosConnectionString, String familyId)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorPropertiesByFamily_V2640", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_IdFamily", familyId);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();
                            property.IdConnectorProperty = Convert.ToInt32(rdr["IdConnectorProperty"]);
                            property.IdFamily = Convert.ToUInt32(rdr["IdFamily"]);
                            property.IsEnabled = Convert.ToBoolean(rdr["IsEnabled"]);
                            if (rdr["StanderdFamily"] != DBNull.Value)
                            {
                                property.PropertyName = Convert.ToString(rdr["StanderdFamily"]);
                            }
                            else if (rdr["CustomFamily"] != DBNull.Value)
                            {
                                property.PropertyName = Convert.ToString(rdr["CustomFamily"]);
                            }
                            if (rdr["DefaultValue"] != DBNull.Value)
                            {
                                property.DefaultValue = Convert.ToString(rdr["DefaultValue"]);
                            }
                            if (rdr["Min_Value"] != DBNull.Value)
                            {
                                property.MinValueNew = Convert.ToString(rdr["Min_Value"]);
                            }
                            if (rdr["Max_Value"] != DBNull.Value)
                            {
                                property.MaxValueNew = Convert.ToString(rdr["Max_Value"]);
                            }
                            if (rdr["isCustProperty"] != DBNull.Value)
                            {
                                property.IsCustomProperty = Convert.ToInt32(rdr["isCustProperty"]) == 1 ? true : false;
                            }
                            if (rdr["IdConnectorType"] != DBNull.Value)
                            {
                                property.IdConnectorType = Convert.ToInt32(rdr["IdConnectorType"]);
                            }
                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetPropertyManagerByFamily_V2640().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }

        //[nsatpute][23-05-2025][GEOS2-7996]
        public List<Connectors> GetAllConnectors_V2640(string SCMConnectionString, Connectors Connectors, string componentQuery, string ConnectorsImagesImagePath, bool getAllRecords)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2640", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    #region Parameters

                    // Added pagination parameters                    
                    mySqlCommand.Parameters.AddWithValue("_GetAllRecords", getAllRecords);

                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompanyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", string.Join(",", Connectors.SelectedCompanyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", string.Join(",", Connectors.SelectedFamilyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", string.Join(",", Connectors.SelectedSubfamilyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColorList != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", string.Join(",", Connectors.SelectedColorList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGenderList != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", string.Join(",", Connectors.SelectedGenderList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape?.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);
                    #region[GEOS2-5296][rdixit][29.02.2024]
                    #region Ways
                    if (Connectors.WaysProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", (Connectors.WaysProp.MinValueNew == string.Empty) ? null : Connectors.WaysProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", (Connectors.WaysProp.MaxValueNew == string.Empty) ? null : Connectors.WaysProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", null);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", null);
                    }
                    #endregion

                    #region DiameterInternal
                    if (Connectors.DiameterInternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", (Connectors.DiameterInternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", (Connectors.DiameterInternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", null);
                    }
                    #endregion

                    #region DiameterExternal
                    if (Connectors.DiameterExternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", (Connectors.DiameterExternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", (Connectors.DiameterExternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", null);
                    }
                    #endregion

                    #region Height
                    if (Connectors.HeightProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", (Connectors.HeightProp.MinValueNew == string.Empty) ? null : Connectors.HeightProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", (Connectors.HeightProp.MaxValueNew == string.Empty) ? null : Connectors.HeightProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", null);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", null);
                    }
                    #endregion

                    #region Length
                    if (Connectors.LengthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", (Connectors.LengthProp.MinValueNew == string.Empty) ? null : Connectors.LengthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", (Connectors.LengthProp.MaxValueNew == string.Empty) ? null : Connectors.LengthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", null);
                    }
                    #endregion

                    #region Width
                    if (Connectors.WidthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", (Connectors.WidthProp.MinValueNew == string.Empty) ? null : Connectors.WidthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", (Connectors.WidthProp.MaxValueNew == string.Empty) ? null : Connectors.WidthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", null);
                    }
                    #endregion
                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion                  

                    if (string.IsNullOrEmpty(Connectors.ConnectorType))
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", null);
                    else
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", Connectors.ConnectorType);

                    mySqlCommand.Parameters.AddWithValue("_ComponentQuery", componentQuery);// Added code to reduce time to load data

                    #endregion
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (!string.IsNullOrEmpty(Connectors.Ref))
                        {
                            while (reader.Read())
                            {
                                if (ConnectorsList.Any(x => x.IdConnector == Convert.ToInt64(reader["IdConnector"])))
                                    continue;

                                Connectors connector = new Connectors();
                                if (reader["IdConnector"] != DBNull.Value)
                                {
                                    connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                                }
                                if (reader["Ref"] != DBNull.Value)
                                {
                                    connector.Ref = Convert.ToString(reader["Ref"]);
                                }
                                if (reader["numWays"] != DBNull.Value)
                                {
                                    connector.NumWays = Convert.ToInt32(reader["numWays"]);
                                }
                                if (reader["numWays"] != DBNull.Value)
                                {
                                    connector.Ways = Convert.ToString(reader["numWays"]);
                                }
                                if (reader["Family"] != DBNull.Value)
                                {
                                    connector.Family = Convert.ToString(reader["Family"]);
                                }
                                if (reader["SubFamily"] != DBNull.Value)
                                {
                                    connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                                }
                                if (reader["Color"] != DBNull.Value)
                                {
                                    connector.Color = Convert.ToString(reader["Color"]);
                                }
                                if (reader["Terminal"] != DBNull.Value)
                                {
                                    connector.Terminal = Convert.ToString(reader["Terminal"]);
                                }
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    connector.FileName = Convert.ToString(reader["FileName"]);
                                    connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                                }
                                if (reader["Location"] != DBNull.Value)
                                {
                                    connector.Location = Convert.ToString(reader["Location"]);
                                }
                                if (reader["Description"] != DBNull.Value)
                                {
                                    connector.Description = Convert.ToString(reader["Description"]);
                                }
                                if (reader["Duplicated"] != DBNull.Value)
                                {
                                    connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                                }

                                ConnectorsList.Add(connector);
                            }
                        }
                        else
                        {
                            while (reader.Read())
                            {
                                if (ConnectorsList.Any(x => x.IdConnector == Convert.ToInt64(reader["IdConnector"])))
                                    continue;

                                Connectors connector = new Connectors();
                                if (reader["IdConnector"] != DBNull.Value)
                                {
                                    connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                                }
                                if (reader["Ref"] != DBNull.Value)
                                {
                                    connector.Ref = Convert.ToString(reader["Ref"]);
                                }
                                if (reader["numWays"] != DBNull.Value)
                                {
                                    connector.NumWays = Convert.ToInt32(reader["numWays"]);
                                }
                                if (reader["numWays"] != DBNull.Value)
                                {
                                    connector.Ways = Convert.ToString(reader["numWays"]);
                                }
                                if (reader["Family"] != DBNull.Value)
                                {
                                    connector.Family = Convert.ToString(reader["Family"]);
                                }
                                if (reader["SubFamily"] != DBNull.Value)
                                {
                                    connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                                }
                                if (reader["Color"] != DBNull.Value)
                                {
                                    connector.Color = Convert.ToString(reader["Color"]);
                                }
                                if (reader["Terminal"] != DBNull.Value)
                                {
                                    connector.Terminal = Convert.ToString(reader["Terminal"]);
                                }
                                if (reader["FileName"] != DBNull.Value)
                                {
                                    connector.FileName = Convert.ToString(reader["FileName"]);
                                    connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                                }
                                if (reader["Location"] != DBNull.Value)
                                {
                                    connector.Location = Convert.ToString(reader["Location"]);
                                }
                                if (reader["Description"] != DBNull.Value)
                                {
                                    connector.Description = Convert.ToString(reader["Description"]);
                                }
                                if (reader["Duplicated"] != DBNull.Value)
                                {
                                    connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                                }

                                ConnectorsList.Add(connector);
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2640(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }
        #endregion

        //[rdixit][GEOS2-8133][26.05.2025]
        public List<Connectors> GetSampleRegistrationAllConnectors_V2640(string SCMConnectionString, Connectors Connectors,
           string ConnectorsImagesImagePath, bool isLoadAll)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSampleRegistrationConnectors_V2640", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;

                    #region Paramters
                    if (Connectors.SelectedFamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", Connectors.SelectedFamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamily != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", Connectors.SelectedSubfamily.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColor != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", Connectors.SelectedColor.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGender != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", Connectors.SelectedGender.Id);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);

                    if (!string.IsNullOrEmpty(Connectors.Ways))
                        mySqlCommand.Parameters.AddWithValue("_Cavities", Connectors.Ways);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Cavities", null);

                    if (!string.IsNullOrEmpty(Connectors.DiameterInternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", Connectors.DiameterInternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterInternal", null);

                    if (!string.IsNullOrEmpty(Connectors.DiameterExternal))
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", Connectors.DiameterExternal);
                    else
                        mySqlCommand.Parameters.AddWithValue("_diameterExternal", null);

                    if (!string.IsNullOrEmpty(Connectors.Height))
                        mySqlCommand.Parameters.AddWithValue("_height", Connectors.Height);
                    else
                        mySqlCommand.Parameters.AddWithValue("_height", null);

                    if (!string.IsNullOrEmpty(Connectors.Length))
                        mySqlCommand.Parameters.AddWithValue("_length", Connectors.Length);
                    else
                        mySqlCommand.Parameters.AddWithValue("_length", null);

                    if (!string.IsNullOrEmpty(Connectors.Width))
                        mySqlCommand.Parameters.AddWithValue("_width", Connectors.Width);
                    else
                        mySqlCommand.Parameters.AddWithValue("_width", null);

                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);

                    mySqlCommand.Parameters.AddWithValue("_IsLoadAll", isLoadAll);

                    #endregion
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            ConnectorsList.Add(connector);
                        }
                        if (reader.NextResult())
                        {
                            while (reader.Read())
                            {

                                if (reader["IdConnector"] != DBNull.Value)
                                {
                                    Connectors connector = ConnectorsList.FirstOrDefault(i => i.IdConnector == Convert.ToInt64(reader["IdConnector"]));
                                    if (connector != null)
                                    {
                                        if (connector.Componentlist == null)
                                            connector.Componentlist = new List<Components>();

                                        Components comp = new Components();
                                        comp.IdConnector = Convert.ToInt32(reader["IdConnector"]);

                                        if (reader["Ref"] != DBNull.Value)
                                        {
                                            comp.Reference = Convert.ToString(reader["Ref"]);
                                        }
                                        if (reader["IdType"] != DBNull.Value)
                                        {
                                            comp.IdType = Convert.ToInt32(reader["IdType"]);
                                        }
                                        if (reader["IdColor"] != DBNull.Value)
                                        {
                                            comp.IdColor = Convert.ToInt32(reader["IdColor"]);
                                        }
                                        if (reader["Type"] != DBNull.Value)
                                        {
                                            comp.SelectedComponentType = Convert.ToString(reader["Type"]);
                                        }
                                        if (reader["Color"] != DBNull.Value)
                                        {
                                            comp.SelectedColor = Convert.ToString(reader["Color"]);
                                        }
                                        connector.Componentlist.Add(comp);
                                    }
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSampleRegistrationAllConnectors_V2640(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }

        //[GEOS2-8088][rdixit][29.05.2025]
        public string AddConnector_V2650(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorAttachedDocPath, string ConnectorImagePath, string ConnectorWtgImages)
        {
            string reference = GetLatestConnectorReference_V2600(DateTime.Now.Year.ToString().Substring(2, 2), MainServerConnectionString);

            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    if (connectorSearch != null)
                    {
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_AddConnector_V2560", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_Ref", reference);
                            mySqlCommand.Parameters.AddWithValue("_IdColor", connectorSearch.SelectedColor?.Id);
                            mySqlCommand.Parameters.AddWithValue("_year", DateTime.Now.Year);
                            mySqlCommand.Parameters.AddWithValue("_NumWays", connectorSearch.NumWays);
                            mySqlCommand.Parameters.AddWithValue("_IdGender", connectorSearch.SelectedGender?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Description", connectorSearch.Description);
                            mySqlCommand.Parameters.AddWithValue("_Sealed", connectorSearch.IsSealed ? 1 : 0);
                            mySqlCommand.Parameters.AddWithValue("_CreatedBy", connectorSearch.ModifiedBy);//
                            mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite); //
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", connectorSearch.SelectedFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", connectorSearch.SelectedSubFamily?.Id);//
                            mySqlCommand.Parameters.AddWithValue("_Height", connectorSearch.Height);
                            mySqlCommand.Parameters.AddWithValue("_Length", connectorSearch.Length);
                            mySqlCommand.Parameters.AddWithValue("_Width", connectorSearch.Width);
                            mySqlCommand.Parameters.AddWithValue("_InternalDiameter", connectorSearch.InternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ExternalDiameter", connectorSearch.ExternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_idWorkflowStatus", connectorSearch.SelectedReferenceStatus?.IdWorkflowStatus);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedBy", connectorSearch.ModifiedBy);//
                            mySqlCommand.Parameters.AddWithValue("_ModifiedIn", connectorSearch.ModifiedIn);//
                            connectorSearch.IdConnector = (long)Convert.ToDouble(mySqlCommand.ExecuteScalar());
                            mySqlConnection.Close();
                        }

                        #region ReferencesList
                        if (connectorSearch.ReferencesList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();

                                foreach (ConnectorReference Connectorref in connectorSearch.ReferencesList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorReference_V2520", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_Ref", Connectorref.Reference);
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_IdCustomer", Connectorref.Company?.Id);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", Connectorref.CreatorId);
                                    mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                    mySqlCommand.ExecuteNonQuery();
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        #region Images
                        if (connectorSearch.ConnectorsImageList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();

                                foreach (SCMConnectorImage SCMConnectorImageList in connectorSearch.ConnectorsImageList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorImage_V2560", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_IdPictureType", SCMConnectorImageList.IdPictureType);
                                    mySqlCommand.Parameters.AddWithValue("_ConnectorFileName", SCMConnectorImageList.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", SCMConnectorImageList.CreatedBy);
                                    mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                    mySqlCommand.Parameters.AddWithValue("_Position", SCMConnectorImageList.Position);
                                    mySqlCommand.Parameters.AddWithValue("_Description", SCMConnectorImageList.Description);

                                    SCMConnectorImageList.IdConnectorImage = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                                    SCMConnectorImageList.Ref = connectorSearch.Reference;
                                    if (SCMConnectorImageList.IdConnectorImage > 0)
                                    {
                                        if (SCMConnectorImageList.IdPictureType == 1)
                                        {
                                            AddConnectorImageToPath(SCMConnectorImageList, ConnectorWtgImages);
                                        }
                                        else
                                        {
                                            AddConnectorImageToPath(SCMConnectorImageList, ConnectorImagePath);
                                        }
                                    }
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        AddConnectorLogEntry(MainServerConnectionString, connectorSearch.IdConnector, connectorSearch.UpdatedChangeLogList);
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("select ref from connectors where idconnector = " + connectorSearch.IdConnector, mySqlConnection);
                            MySqlDataReader rd = mySqlCommand.ExecuteReader();
                            if (rd.Read())
                            {
                                reference = rd["ref"].ToString();
                            }
                        }
                        transactionScope.Complete();
                        transactionScope.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddConnector_V2650().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    throw;
                }
            }
            return reference;
        }

        //[rdixit][11.06.2025][GEOS2-6644]
        public bool SaveConfigurationsForSearchFilters_V2650(List<ConfigurationFamily> configurationList, string mainServerConnectionString)
        {
            bool isUpdated = false;
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(mainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        foreach (ConfigurationFamily item in configurationList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertSearchConfiguration_V2490", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("p_IdFamily", item.IdFamily);
                            mySqlCommand.Parameters.AddWithValue("p_NumberOfPages", item.NoOfPages);
                            mySqlCommand.Parameters.AddWithValue("p_ReferencePages", item.RefPages);
                            mySqlCommand.Parameters.AddWithValue("p_ColorPages", item.ColorPages);
                            mySqlCommand.Parameters.AddWithValue("p_SizePages", item.SizePages);
                            mySqlCommand.Parameters.AddWithValue("p_ComponentsPages", item.CompPages);
                            mySqlCommand.Parameters.AddWithValue("p_WaysPages", item.SizePages);
                            mySqlCommand.Parameters.AddWithValue("p_IdColorA", item.IdColor);
                            item.IdSearchConfiguration = Convert.ToInt32(mySqlCommand.ExecuteScalar());
                            mySqlCommand.ExecuteNonQuery();
                            mySqlConnection.Close();

                            if (item.SimilarCharactersList != null)
                            {
                                item.SimilarCharactersList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddCharactersByConfiguration(mainServerConnectionString, item.SimilarCharactersList, item.IdSearchConfiguration);
                            }

                            if (item.ComponentsList != null)
                            {
                                item.ComponentsList.ForEach(i => i.IdSearchConfiguration = item.IdSearchConfiguration);
                                AddComponentsByConfiguration(mainServerConnectionString, item.ComponentsList, item.IdSearchConfiguration);
                            }
                            AddWaysMarginByConfiguration(mainServerConnectionString, item);
                            AddSizeDiameterByConfiguration(mainServerConnectionString, item);
                        }
                    }
                    transactionScope.Complete();
                    transactionScope.Dispose();
                    isUpdated = true;
                }
                catch (Exception ex)
                {
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    Log4NetLogger.Logger.Log(string.Format("Error SaveConfigurationsForSearchFilters_V2490() {0}", ex.Message), category: Category.Exception, priority: Priority.Low);

                    throw;
                }
            }
            return isUpdated;
        }

        //[rdixit][11.06.2025][GEOS2-6644]
        public List<SimilarCharactersByConfiguration> GetSimilarCharactersByConfiguration(string workbenchConnectionString)
        {
            List<SimilarCharactersByConfiguration> charachtersimilarityList = new List<SimilarCharactersByConfiguration>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(workbenchConnectionString))
                {
                    List<Color> ColorList = GetAllColors(workbenchConnectionString, "");
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetSimilarCharactersByConfiguration_V2650", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {

                        while (rdr.Read())
                        {
                            SimilarCharactersByConfiguration color = new SimilarCharactersByConfiguration();

                            if (rdr["IdSearchConfiguration"] != DBNull.Value)
                                color.IdSearchConfiguration = Convert.ToUInt16(rdr["IdSearchConfiguration"]);
                            if (rdr["CharacterA"] != DBNull.Value)
                                color.CharacterA = Convert.ToString(rdr["CharacterA"]);
                            if (rdr["CharacterB"] != DBNull.Value)
                                color.CharacterB = Convert.ToString(rdr["CharacterB"]);
                            if (rdr["Description"] != DBNull.Value)
                                color.Description = Convert.ToString(rdr["Description"]);

                            charachtersimilarityList.Add(color);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetSimilarColorsByConfiguration(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

            return charachtersimilarityList;
        }


        //[rdixit][19.06.2025][GEOS2-6645]
        public List<Connectors> GetAllConnectors_V2650(string SCMConnectionString, Connectors Connectors, string componentQuery, string ConnectorsImagesImagePath, bool getAllRecords)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2650", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 80000;
                    DataSet ds = new DataSet();
                    #region Parameters

                    // Added pagination parameters                    
                    mySqlCommand.Parameters.AddWithValue("_GetAllRecords", getAllRecords);

                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompanyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", string.Join(",", Connectors.SelectedCompanyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", string.Join(",", Connectors.SelectedFamilyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", string.Join(",", Connectors.SelectedSubfamilyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColorList != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", string.Join(",", Connectors.SelectedColorList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGenderList != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", string.Join(",", Connectors.SelectedGenderList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape?.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);
                    #region[GEOS2-5296][rdixit][29.02.2024]
                    #region Ways
                    if (Connectors.WaysProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", (Connectors.WaysProp.MinValueNew == string.Empty) ? null : Connectors.WaysProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", (Connectors.WaysProp.MaxValueNew == string.Empty) ? null : Connectors.WaysProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", null);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", null);
                    }
                    #endregion

                    #region DiameterInternal
                    if (Connectors.DiameterInternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", (Connectors.DiameterInternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", (Connectors.DiameterInternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", null);
                    }
                    #endregion

                    #region DiameterExternal
                    if (Connectors.DiameterExternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", (Connectors.DiameterExternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", (Connectors.DiameterExternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", null);
                    }
                    #endregion

                    #region Height
                    if (Connectors.HeightProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", (Connectors.HeightProp.MinValueNew == string.Empty) ? null : Connectors.HeightProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", (Connectors.HeightProp.MaxValueNew == string.Empty) ? null : Connectors.HeightProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", null);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", null);
                    }
                    #endregion

                    #region Length
                    if (Connectors.LengthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", (Connectors.LengthProp.MinValueNew == string.Empty) ? null : Connectors.LengthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", (Connectors.LengthProp.MaxValueNew == string.Empty) ? null : Connectors.LengthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", null);
                    }
                    #endregion

                    #region Width
                    if (Connectors.WidthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", (Connectors.WidthProp.MinValueNew == string.Empty) ? null : Connectors.WidthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", (Connectors.WidthProp.MaxValueNew == string.Empty) ? null : Connectors.WidthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", null);
                    }
                    #endregion
                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion                  

                    if (string.IsNullOrEmpty(Connectors.ConnectorType))
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", null);
                    else
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", Connectors.ConnectorType);

                    mySqlCommand.Parameters.AddWithValue("_ComponentQuery", componentQuery);// Added code to reduce time to load data

                    #endregion
                    using (MySqlDataAdapter adap = new MySqlDataAdapter(mySqlCommand))
                    {
                        adap.Fill(ds);
                        foreach (DataRow reader in ds.Tables[0].Rows)
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }

                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2650(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }
        //[nsatpute][16.07.2025][GEOS2-8090]
        public bool IsConnectorExists(string SCMConnectionString, string connectorRerence)
        {
            bool result = false;
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_IsConnectorExists_V2660", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 80000;                
                    mySqlCommand.Parameters.AddWithValue("_ConnectorRef", connectorRerence);
                    result = Convert.ToBoolean(mySqlCommand.ExecuteScalar());
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2650(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return result;
        }
        //[nsatpute][22.07.2025][GEOS2-8090]
        public List<ScmDrawing> GetDrawingsByCustomerRef_V2660(string localGeosConnectionString, string customerRef)
        {
            List<ScmDrawing> DrawingListByRef = new List<ScmDrawing>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetDrawingsByReference_V2660", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.Parameters.AddWithValue("_Reference", customerRef);
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.HasRows)
                        {
                            while (reader.Read())
                            {
                                ScmDrawing drawing = new ScmDrawing();

                                if (reader["iddrawing"] != DBNull.Value)
                                {
                                    drawing.IdDrawing = Convert.ToUInt32(reader["iddrawing"]);
                                }
                                if (reader["Path"] != DBNull.Value)
                                {
                                    drawing.Path = Convert.ToString(reader["Path"]);
                                }
                                if (reader["SiteName"] != DBNull.Value)
                                {
                                    drawing.SiteName = Convert.ToString(reader["SiteName"]);
                                }
                                if (reader["NameSiteC"] != DBNull.Value)
                                {
                                    drawing.SiteNameC = Convert.ToString(reader["NameSiteC"]);
                                }
                                if (reader["NameSiteM"] != DBNull.Value)
                                {
                                    drawing.SiteNameM = Convert.ToString(reader["NameSiteM"]);
                                }
                                if (reader["NameC"] != DBNull.Value)
                                {
                                    drawing.CreatedBy = Convert.ToString(reader["NameC"])?.Trim();
                                }
                                if (reader["NameM"] != DBNull.Value)
                                {
                                    drawing.ModifiedBy = Convert.ToString(reader["NameM"])?.Trim();
                                }
                                if (reader["CreatedIn"] != DBNull.Value)
                                {
                                    drawing.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                                }
                                if (reader["ModifiedIn"] != DBNull.Value)
                                {
                                    drawing.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                                }
                                if (reader["Debugged"] != DBNull.Value)
                                {
                                    drawing.Debugged = Convert.ToBoolean(reader["Debugged"]);
                                }
                                if (reader["Comments"] != DBNull.Value)
                                {
                                    drawing.Comments = Convert.ToString(reader["Comments"])?.Trim();
                                }
                                if (reader["idcptype"] != DBNull.Value)
                                {
                                    drawing.IdCPTypenew = Convert.ToInt64(reader["idcptype"]);
                                }
                                if (reader["CptypeName"] != DBNull.Value)
                                {
                                    drawing.CptypeName = Convert.ToString(reader["CptypeName"]);
                                }
                                if (reader["TemplateName"] != DBNull.Value)
                                {
                                    drawing.TemplateName = Convert.ToString(reader["TemplateName"]);
                                }
                                if (reader["IdTemplate"] != DBNull.Value)
                                {
                                    drawing.IdTemplate = Convert.ToByte(reader["IdTemplate"]);
                                }
                                DrawingListByRef.Add(drawing);
                            }
                        }
                        if (reader.NextResult())
                        {
                            while (reader.Read())
                            {
                                ScmDrawing scmDrawing = DrawingListByRef.Where(t => t.IdDrawing == Convert.ToUInt32(reader["IdDrawing"])).FirstOrDefault();

                                if (scmDrawing != null)
                                {
                                    if (scmDrawing.DetectionList == null)
                                        scmDrawing.DetectionList = new List<SCMDetection>();
                                    SCMDetection sCMDetection = new SCMDetection();
                                    if (reader["IdDetection"] != DBNull.Value)
                                    {
                                        sCMDetection.IdDetection = Convert.ToUInt16(reader["IdDetection"]);
                                    }
                                    if (reader["Name"] != DBNull.Value)
                                    {
                                        sCMDetection.Name = Convert.ToString(reader["Name"]);
                                    }
                                    if (reader["Quantity"] != DBNull.Value)
                                    {
                                        sCMDetection.Quantity = Convert.ToInt32(reader["Quantity"]);
                                    }
                                    if (reader["IdDetectionType"] != DBNull.Value)
                                    {
                                        sCMDetection.IdDetectionType = Convert.ToInt32(reader["IdDetectionType"]);
                                    }
                                    if (reader["DetectionType"] != DBNull.Value)
                                    {
                                        sCMDetection.DetectionType = Convert.ToString(reader["DetectionType"]);
                                    }
                                    scmDrawing.DetectionList.Add(sCMDetection);
                                }
                            }
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetDrawingsByCustomerRef_V2660(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return DrawingListByRef;
        }

        //[nsatpute][22.07.2025][GEOS2-8090]
        public List<Common.Company> GetAllCompaniesWithServiceProvider_V2660(string localGeosConnectionString)
        {
            List<Common.Company> lstCompanies = new List<Common.Company>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(localGeosConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllCompaniesWithServiceProvider_V2660", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        if (reader.HasRows)
                        {
                            while (reader.Read())
                            {
                                Common.Company comp = new Common.Company();
                                comp.IdCompany = Convert.ToInt32(reader["IdSite"]);
                                comp.ShortName = Convert.ToString(reader["ShortName"]);
                                comp.ServiceProviderUrl = Convert.ToString(reader["ServiceProviderUrl"]);
                                if (reader["iso"] != DBNull.Value)
                                {
                                    comp.Iso = Convert.ToString(reader["iso"]);
                                    comp.CountryIconUrl = "https://api.emdep.com/GEOS/Images?FilePath=/Images/Countries/" + comp.Iso + ".png";
                                }
                                lstCompanies.Add(comp);
                            }
                        }
                       
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetDrawingsByCustomerRef_V2660(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstCompanies;
        }


        //[rdixit][GEOS2-9199][11.09.2025]
        public ConnectorSearch UpdateConnectorStatus_V2670(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorAttachedDocPath, string ConnectorImagePath, string ConnectorWtgImages)
        {
            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    if (connectorSearch != null)
                    {
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorStatus_V2520", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_idConnector", connectorSearch.IdConnector);
                            mySqlCommand.Parameters.AddWithValue("_idWorkflowStatus", connectorSearch.SelectedReferenceStatus?.IdWorkflowStatus);
                            mySqlCommand.Parameters.AddWithValue("_IdColor", connectorSearch.SelectedColor?.Id);
                            mySqlCommand.Parameters.AddWithValue("_NumWays", connectorSearch.NumWays);
                            mySqlCommand.Parameters.AddWithValue("_IdGender", connectorSearch.SelectedGender?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Description", connectorSearch.Description);
                            mySqlCommand.Parameters.AddWithValue("_Sealed", connectorSearch.IsSealed ? 1 : 0);
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", connectorSearch.SelectedFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", connectorSearch.SelectedSubFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Height", connectorSearch.Height);
                            mySqlCommand.Parameters.AddWithValue("_Length", connectorSearch.Length);
                            mySqlCommand.Parameters.AddWithValue("_Width", connectorSearch.Width);
                            mySqlCommand.Parameters.AddWithValue("_InternalDiameter", connectorSearch.InternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ExternalDiameter", connectorSearch.ExternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedBy", connectorSearch.ModifiedBy);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedIn", connectorSearch.ModifiedIn);
                            mySqlCommand.ExecuteNonQuery();
                            mySqlConnection.Close();
                        }

                        //[Pramod.misal] [15.05.2024]
                        if (connectorSearch.ConnectorCommentsList != null)
                            AddUpdateDeleteConnectorComments_V2520(MainServerConnectionString, connectorSearch.ConnectorCommentsList.ToList());
                        AddUpdateDeleteConnectorReferences_V2520(MainServerConnectionString, connectorSearch);//[rdixit][16.05.2024][GEOS2-5477]
                        AddUpdateDeleteConnectorComponent_V2520(MainServerConnectionString, connectorSearch);//[rdixit][22.05.2024][GEOS2-5751]
                        AddDeleteLinkedConnector_V2520(MainServerConnectionString, connectorSearch);//[rdixit][28.05.2024][GEOS2-5753]
                        //[dixit][09.08.2024][GEOS2-5752]
                        AddUpdateDeleteConnectorLocation(MainServerConnectionString, connectorSearch);
                        //DeleteConnectorLocation(MainServerConnectionString, connectorSearch); //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]
                        //[rdixit][GEOS2-9199][22.09.2025]
                        DeleteConnectorImage_V2670(MainServerConnectionString, connectorSearch, ConnectorWtgImages); //[Rahul.Gadhave][GEOS2-5804][Date-5/08/2024]
                        AddUpdateConnectorImage_V2670(MainServerConnectionString, connectorSearch, ConnectorImagePath, ConnectorWtgImages); //[pramod.misal][GEOS2-5754][28-08-2024]
                        //[Pramod.misal] [21.05.2024][GEOS2-5755]
                        if (connectorSearch.ConnectorAttachementFilesList?.Count > 0)
                        {
                            AddUpdateDeleteConnectorAttachementFiles_V2520(MainServerConnectionString, connectorSearch.ConnectorAttachementFilesList.ToList(), ConnectorAttachedDocPath);
                        }
                        AddConnectorLogEntry(MainServerConnectionString, connectorSearch.IdConnector, connectorSearch.UpdatedChangeLogList);
                        transactionScope.Complete();
                        transactionScope.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error UpdateConnectorStatus_V2670().  ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    throw;
                }
            }
            return connectorSearch;
        }

        //[rdixit][GEOS2-9199][11.09.2025]
        public void AddUpdateConnectorImage_V2670(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorImagePath, string ConnectorWtgImages)
        {
            try
            {
                if (connectorSearch.ConnectorsImageList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (SCMConnectorImage SCMConnectorImage in connectorSearch.ConnectorsImageList)
                        {
                            SCMConnectorImage.Ref = connectorSearch.Reference;
                            if (SCMConnectorImage.TransactionOperation == ModelBase.TransactionOperations.Modify)
                            {
                                MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorImage_V2560", mySqlConnection);
                                mySqlCommand.CommandType = CommandType.StoredProcedure;
                                mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                mySqlCommand.Parameters.AddWithValue("_IdPictureType", SCMConnectorImage.IdPictureType);
                                mySqlCommand.Parameters.AddWithValue("_ConnectorFileName", SCMConnectorImage.OriginalFileName);
                                mySqlCommand.Parameters.AddWithValue("_CreatedBy", SCMConnectorImage.CreatedBy);
                                mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                mySqlCommand.Parameters.AddWithValue("_Position", SCMConnectorImage.Position);
                                mySqlCommand.Parameters.AddWithValue("_Description", SCMConnectorImage.Description);
                                SCMConnectorImage.IdConnectorImage = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                                if (SCMConnectorImage.IdConnectorImage > 0)
                                {
                                    if (SCMConnectorImage.IdPictureType == 1)
                                    {

                                        AddConnectorImageToPath(SCMConnectorImage, ConnectorWtgImages);
                                    }
                                    else
                                    {
                                        AddConnectorImageToPath(SCMConnectorImage, ConnectorImagePath);
                                    }
                                }
                            }
                            else if (SCMConnectorImage.TransactionOperation == ModelBase.TransactionOperations.Update)
                            {
                                if (SCMConnectorImage.IdConnectorImage > 0)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_UpdateConnectorImage_V2670", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdConnectorImage", SCMConnectorImage.IdConnectorImage);
                                    mySqlCommand.Parameters.AddWithValue("_ConnectorFileName", SCMConnectorImage.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_Description", SCMConnectorImage.Description);
                                    mySqlCommand.Parameters.AddWithValue("_IdPictureType", SCMConnectorImage.IdPictureType);
                                    mySqlCommand.Parameters.AddWithValue("_ModifiedBy", SCMConnectorImage.ModifiedBy);
                                    mySqlCommand.Parameters.AddWithValue("_Position", SCMConnectorImage.Position);
                                    SCMConnectorImage.IdConnectorImage = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                                    if (SCMConnectorImage.IdPictureType == 1)
                                    {
                                        UpdateConnectorImageToPath(SCMConnectorImage, ConnectorWtgImages);
                                    }
                                    else
                                    {
                                        UpdateConnectorImageToPath(SCMConnectorImage, ConnectorImagePath);
                                    }
                                }
                            }
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error AddUpdateConnectorImage_V2670().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[rdixit][18.09.2025][GEOS2-9552]
        public Connectors GetConnectorProperties_V2670(string SCMConnectionString, Connectors Connectors, string wtgImagePath, string attachmentImagePath)
        {
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();
                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorPropertiesByRef_V2500", mySqlConnection);
                    mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                Connectors.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                Connectors.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                Connectors.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["IdStatus"] != DBNull.Value)
                            {
                                Connectors.SelectedReferenceStatus = new ConnectorWorkflowStatus();
                                Connectors.IdStatus = Convert.ToInt32(reader["IdStatus"]);
                                Connectors.SelectedReferenceStatus.IdWorkflowStatus = Convert.ToByte(reader["IdStatus"]);
                                Connectors.SelectedReferenceStatus.Name = Convert.ToString(reader["Status"]);
                                Connectors.SelectedReferenceStatus.HtmlColor = Convert.ToString(reader["HtmlColor"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                Connectors.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["IdFamily"] != DBNull.Value)
                            {
                                Connectors.SelectedFamily = new Family();
                                Connectors.SelectedFamily.Id = Convert.ToUInt32(reader["IdFamily"]);
                                Connectors.SelectedFamily.Name = Convert.ToString(reader["Family"]);
                                Connectors.IdFamily = Convert.ToInt32(reader["IdFamily"]);
                                Connectors.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                Connectors.SelectedSubFamily = new ConnectorSubFamily();
                                Connectors.SelectedSubFamily.Id = Convert.ToUInt32(reader["IdSubFamily"]);
                                Connectors.SelectedSubFamily.Name = Convert.ToString(reader["SubFamily"]);
                                Connectors.IdSubFamily = Convert.ToInt32(reader["IdSubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                Connectors.SelectedColor = new Color();
                                Connectors.SelectedColor.Name = Convert.ToString(reader["Color"]);
                                Connectors.SelectedColor.Id = Convert.ToUInt16(reader["IdColor"]);
                                Connectors.IdColor = Convert.ToInt32(reader["IdColor"]);
                            }
                            if (reader["IsSelaed"] != DBNull.Value)
                            {
                                Connectors.IsSealingEnabled = Convert.ToBoolean(reader["IsSelaed"]);
                            }
                            if (reader["Movable"] != DBNull.Value)
                            {
                                Connectors.Movable = Convert.ToInt32(reader["Movable"]);
                            }
                            if (reader["InternalDiameter"] != DBNull.Value)
                            {
                                Connectors.InternalDiameter = Convert.ToDouble(reader["InternalDiameter"]);
                            }
                            if (reader["ExternalDiameter"] != DBNull.Value)
                            {
                                Connectors.ExternalDiameter = Convert.ToDouble(reader["ExternalDiameter"]);
                            }
                            if (reader["Height"] != DBNull.Value)
                            {
                                Connectors.Sheight = Convert.ToDouble(reader["Height"]);
                            }
                            if (reader["Length"] != DBNull.Value)
                            {
                                Connectors.Slength = Convert.ToDouble(reader["Length"]);
                            }
                            if (reader["Width"] != DBNull.Value)
                            {
                                Connectors.SWidth = Convert.ToDouble(reader["Width"]);
                            }
                            if (reader["IdGender"] != DBNull.Value)
                            {
                                Connectors.SelectedGender = new Gender();
                                Connectors.Terminal = Convert.ToString(reader["Terminal"]);
                                Connectors.IdGender = Convert.ToInt32(reader["IdGender"]);
                                Connectors.SelectedGender.Name = Convert.ToString(reader["Terminal"]);
                                Connectors.SelectedGender.Id = Convert.ToUInt32(reader["IdGender"]);
                            }

                            if (reader["Description"] != DBNull.Value)
                            {
                                Connectors.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                Connectors.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }
                            if (reader["IdType"] != DBNull.Value)
                            {
                                Connectors.IdType = Convert.ToInt32(reader["IdType"]);
                            }
                        }
                    }
                }

                var tasks = new List<Task>();
                tasks.Add(Task.Run(() => Connectors.ConnectorReferenceList = GetConnectorReferencesByRef_V2520(SCMConnectionString, Connectors.Ref)));
                tasks.Add(Task.Run(() => Connectors.ConnectorComponentslist = GetConnectorComponentsByRef_V2670(SCMConnectionString, Connectors.Ref)));
                tasks.Add(Task.Run(() => Connectors.LinkedConnectorList = GetAllLinkedConnectorByRef_V2520(SCMConnectionString, Connectors.IdConnector)));
                tasks.Add(Task.Run(() => Connectors.LocationList = GetConnectorLocationsByRef_V2550(SCMConnectionString, Connectors.Ref)));
                tasks.Add(Task.Run(() => Connectors.AttachementFilesList = GetConnectorAttachementsByRef_V2520(SCMConnectionString, Connectors.Ref, attachmentImagePath)));
                tasks.Add(Task.Run(() => Connectors.ChangeLogList = GetConnectorLogEntries(SCMConnectionString, Connectors.IdConnector)));
                tasks.Add(Task.Run(() => Connectors.ConnectorImageList = GetAllConnectorImagesForImageSection_V2670(SCMConnectionString, Connectors, wtgImagePath)));
                tasks.Add(Task.Run(() => Connectors.CommentsList = GetConnectorCommentsByRef_V2520(SCMConnectionString, Connectors.IdConnector)));
                Task.WaitAll(tasks.ToArray());
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2670(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return Connectors;
        }

        //[rdixit][18.09.2025][GEOS2-9552]
        public List<ConnectorProperties> GetCustomeProperties_V2670(string LocalGeosContext, string WorkbenchContext)
        {
            List<ConnectorProperties> connectorProperty = new List<ConnectorProperties>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(LocalGeosContext))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetConnectorProperties_V2670", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    using (MySqlDataReader rdr = mySqlCommand.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorProperties property = new ConnectorProperties();

                            if (rdr["Name"] != DBNull.Value)
                                property.PropertyName = Convert.ToString(rdr["Name"]);

                            if (rdr["IdConnectorCategory"] != DBNull.Value)
                                property.IdConnectorCategory = Convert.ToInt32(rdr["IdConnectorCategory"]);

                            if (rdr["IdConnectorType"] != DBNull.Value)
                            {
                                property.IdConnectorType = Convert.ToInt32(rdr["IdConnectorType"]);
                                if (property.IdConnectorType == 1826)
                                    property.CustomFieldComboboxList = new ObservableCollection<LookUpValues>(GetAllLookUpValuesRecordByIDLookupkey(WorkbenchContext, property.IdConnectorType));
                            }
                            connectorProperty.Add(property);
                        }
                    }
                    mySqlConnection.Close();
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetCustomeProperties_V2670().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return connectorProperty;
        }


        //[rdixit][GEOS2-9199][22.09.2025]
        public void DeleteConnectorImage_V2670(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorwtgImagePath)
        {
            try
            {
                if (connectorSearch.DeletedImageList != null)
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();

                        foreach (SCMConnectorImage Connectorcomp in connectorSearch.DeletedImageList)
                        {
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_DeleteConnectorImage_V2550", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_IdConnectorImage", Connectorcomp.IdConnectorImage);
                            mySqlCommand.ExecuteNonQuery();
                            if(Connectorcomp.IdPictureType==1)
                            {
                                DeleteConnectorWtgImageToPath(Connectorcomp, ConnectorwtgImagePath);
                            }
                        }
                        mySqlConnection.Close();
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error DeleteConnectorImage_V2670().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }

        }

        //[rdixit][GEOS2-9199][22.09.2025]//https://helpdesk.emdep.com/browse/GEOS2-9567 [rdixit][22.09.2025]
        public bool DeleteConnectorWtgImageToPath(SCMConnectorImage ConnectorImage, string ConnectorwtgImagePath)
        {
            if (ConnectorImage.ConnectorsImageInBytes != null)
            {
                try
                {
                    string completePath = string.Format(@"{0}\{1}", ConnectorwtgImagePath, ConnectorImage.Ref);
                    string filePath = completePath + "\\" + ConnectorImage.SavedFileName;

                    if (Directory.Exists(completePath))
                    {
                        if (filePath != null)
                        {
                            if (File.Exists(filePath))
                            {
                                File.Delete(filePath);
                            }
                        }
                    }                 
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error DeleteConnectorWtgImageToPath()- Filename - {0}. ErrorMessage- {1}", ConnectorImage.SavedFileName, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }

            return true;
        }

        //[rdixit][GEOS2-9199][22.09.2025]
        public List<SCMConnectorImage> GetAllConnectorImagesForImageSection_V2670(string SCMConnectionString, Connectors Connectors, string ConnectorWtgImagesPath)
        {
            List<SCMConnectorImage> ConnectorImages = new List<Common.SCM.SCMConnectorImage>();

            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectorImagesForImageSection_V2510", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 8000;
                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    using (MySqlDataReader reader = mySqlCommand.ExecuteReader())
                    {
                        while (reader.Read())
                        {
                            SCMConnectorImage connector = new SCMConnectorImage();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["IdConnectorImage"] != DBNull.Value)
                            {
                                connector.IdConnectorImage = Convert.ToInt64(reader["IdConnectorImage"]);
                            }
                            if (reader["IdPictureType"] != DBNull.Value)
                            {
                                connector.IdPictureType = Convert.ToInt16(reader["IdPictureType"]);
                            }
                            if (Connectors.Ref != null)
                            {
                                connector.Ref = Convert.ToString(Connectors.Ref);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.SavedFileName = Convert.ToString(reader["FileName"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Position"] != DBNull.Value)
                            {
                                connector.Position = Convert.ToUInt64(reader["Position"]);
                            }
                            if (reader["CreatedBy"] != DBNull.Value)
                            {
                                connector.CreatedBy = Convert.ToUInt32(reader["CreatedBy"]);
                            }
                            if (reader["CreatedIn"] != DBNull.Value)
                            {
                                connector.CreatedIn = Convert.ToDateTime(reader["CreatedIn"]);
                            }
                            if (reader["IdSite"] != DBNull.Value)
                            {
                                connector.IdSite = Convert.ToInt32(reader["IdSite"]);
                            }
                            if (reader["creator"] != DBNull.Value)
                            {
                                connector.Creator = Convert.ToString(reader["creator"]);
                            }
                            if (reader["ModifiedBy"] != DBNull.Value)
                            {
                                connector.ModifiedBy = Convert.ToUInt32(reader["ModifiedBy"]);
                            }
                            if (reader["ModifiedIn"] != DBNull.Value)
                            {
                                connector.ModifiedIn = Convert.ToDateTime(reader["ModifiedIn"]);
                            }
                            ConnectorImages.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImagesForImageSection_V2670(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            try
            {
                foreach (SCMConnectorImage itemConnectors in ConnectorImages)
                {
                    if (itemConnectors.SavedFileName.EndsWith(".wtg", StringComparison.OrdinalIgnoreCase) || itemConnectors.SavedFileName.EndsWith(".bmp", StringComparison.OrdinalIgnoreCase)
                        || itemConnectors.IdPictureType == 1)
                    {
                        string wtgImagePath = Path.Combine(ConnectorWtgImagesPath, itemConnectors.Ref, itemConnectors.SavedFileName);

                        if (File.Exists(wtgImagePath))
                        {
                            itemConnectors.ConnectorsImageInBytes = File.ReadAllBytes(wtgImagePath);
                        }
                        else
                        {
                            continue;
                        }
                    }
                    else
                    {
                        itemConnectors.ImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + itemConnectors.Ref + "/" + itemConnectors.SavedFileName;

                        if (!string.IsNullOrEmpty(itemConnectors.ImagePath))
                        {
                            itemConnectors.ConnectorsImageInBytes = Utility.ImageUtil.GetImageByWebClient(itemConnectors.ImagePath);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectorImagesForImageSection_V2670(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
            }
            return ConnectorImages;
        }

        //[rdixit][GEOS2-9552][01.10.2025]
        public List<Connectors> GetAllConnectors_V2670(string SCMConnectionString, Connectors Connectors, string componentQuery, string ConnectorsImagesImagePath, bool getAllRecords)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2670", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 80000;
                    DataSet ds = new DataSet();
                    #region Parameters

                    // Added pagination parameters                    
                    mySqlCommand.Parameters.AddWithValue("_GetAllRecords", getAllRecords);

                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompanyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", string.Join(",", Connectors.SelectedCompanyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", string.Join(",", Connectors.SelectedFamilyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", string.Join(",", Connectors.SelectedSubfamilyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColorList != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", string.Join(",", Connectors.SelectedColorList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGenderList != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", string.Join(",", Connectors.SelectedGenderList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape?.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);
                    #region[GEOS2-5296][rdixit][29.02.2024]
                    #region Ways
                    if (Connectors.WaysProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", (Connectors.WaysProp.MinValueNew == string.Empty) ? null : Connectors.WaysProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", (Connectors.WaysProp.MaxValueNew == string.Empty) ? null : Connectors.WaysProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", null);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", null);
                    }
                    #endregion

                    #region DiameterInternal
                    if (Connectors.DiameterInternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", (Connectors.DiameterInternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", (Connectors.DiameterInternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", null);
                    }
                    #endregion

                    #region DiameterExternal
                    if (Connectors.DiameterExternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", (Connectors.DiameterExternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", (Connectors.DiameterExternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", null);
                    }
                    #endregion

                    #region Height
                    if (Connectors.HeightProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", (Connectors.HeightProp.MinValueNew == string.Empty) ? null : Connectors.HeightProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", (Connectors.HeightProp.MaxValueNew == string.Empty) ? null : Connectors.HeightProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", null);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", null);
                    }
                    #endregion

                    #region Length
                    if (Connectors.LengthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", (Connectors.LengthProp.MinValueNew == string.Empty) ? null : Connectors.LengthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", (Connectors.LengthProp.MaxValueNew == string.Empty) ? null : Connectors.LengthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", null);
                    }
                    #endregion

                    #region Width
                    if (Connectors.WidthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", (Connectors.WidthProp.MinValueNew == string.Empty) ? null : Connectors.WidthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", (Connectors.WidthProp.MaxValueNew == string.Empty) ? null : Connectors.WidthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", null);
                    }
                    #endregion
                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion                  

                    if (string.IsNullOrEmpty(Connectors.ConnectorType))
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", null);
                    else
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", Connectors.ConnectorType);

                    mySqlCommand.Parameters.AddWithValue("_ComponentQuery", componentQuery);// Added code to reduce time to load data

                    #endregion
                    using (MySqlDataAdapter adap = new MySqlDataAdapter(mySqlCommand))
                    {
                        adap.Fill(ds);
                        foreach (DataRow reader in ds.Tables[0].Rows)
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }

                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2670(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }

        //[rdixit][08.10.2025][GEOS2-9798]
        public List<ConnectorComponents> GetConnectorComponentsByRef_V2670(string localGeosConnectionString, String ConnectorRef)
        {
            List<ConnectorComponents> lstConnectorComponents = new List<ConnectorComponents>();

            try
            {
                using (MySqlConnection connActivity = new MySqlConnection(localGeosConnectionString))
                {
                    connActivity.Open();
                    MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorComponentsByRef_V2520", connActivity);
                    cmd.Parameters.AddWithValue("_Ref", ConnectorRef);
                    cmd.CommandType = CommandType.StoredProcedure;

                    using (MySqlDataReader rdr = cmd.ExecuteReader())
                    {
                        while (rdr.Read())
                        {
                            ConnectorComponents Component = new ConnectorComponents();
                            if (rdr["IdConnector"] != DBNull.Value)
                            {
                                Component.IdConnector = Convert.ToInt32(rdr["IdConnector"]);
                            }
                            if (rdr["IdComponentsByConnector"] != DBNull.Value)
                            {
                                Component.IdComponentsByConnector = Convert.ToInt32(rdr["IdComponentsByConnector"]);
                            }
                            if (rdr["IdCreater"] != DBNull.Value)
                            {
                                Component.CreatorId = Convert.ToInt32(rdr["IdCreater"]);
                            }
                            if (rdr["ConnectorRef"] != DBNull.Value)
                            {
                                Component.ConnectorRef = Convert.ToString(rdr["ConnectorRef"]);
                            }
                            if (rdr["componentIdType"] != DBNull.Value)
                            {
                                Component.ComponentIdType = Convert.ToInt32(rdr["componentIdType"]);
                            }
                            if (rdr["componentIdColor"] != DBNull.Value)
                            {
                                Component.ComponentIdColor = Convert.ToUInt16(rdr["componentIdColor"]);
                            }
                            if (rdr["componentRef"] != DBNull.Value)
                            {
                                Component.ComponentRef = Convert.ToString(rdr["componentRef"]);
                            }

                            if (rdr["IdColor"] != DBNull.Value)
                            {
                                Component.Color = new Color();
                                Component.Color.Id = Convert.ToUInt16(rdr["IdColor"]);
                                if (rdr["colour"] != DBNull.Value)
                                {
                                    Component.Color.Name = Convert.ToString(rdr["colour"]);
                                }
                            }

                            if (rdr["ImageName"] != DBNull.Value)
                            {
                                Component.ImageName = Convert.ToString(rdr["ImageName"]);
                                Component.ComponentImagesUrl = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + ConnectorRef + "/" + Component.ImageName;
                            }

                            lstConnectorComponents.Add(Component);
                        }
                    }
                    connActivity.Close();

                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetConnectorComponentsByRef_V2670().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return lstConnectorComponents;
        }

        //[rdixit][14.10.2025][GEOS2-8895]
        public string AddConnector_V2680(string MainServerConnectionString, ConnectorSearch connectorSearch, string ConnectorAttachedDocPath, string ConnectorImagePath, string ConnectorWtgImages)
        {
            connectorSearch.Reference = GetLatestConnectorReference_V2600(DateTime.Now.Year.ToString().Substring(2, 2), MainServerConnectionString);

            using (TransactionScope transactionScope = new TransactionScope(TransactionScopeOption.Required, TimeSpan.FromMinutes(10)))
            {
                try
                {
                    if (connectorSearch != null)
                    {
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("SCM_AddConnector_V2560", mySqlConnection);
                            mySqlCommand.CommandType = CommandType.StoredProcedure;
                            mySqlCommand.Parameters.AddWithValue("_Ref", connectorSearch.Reference);
                            mySqlCommand.Parameters.AddWithValue("_IdColor", connectorSearch.SelectedColor?.Id);
                            mySqlCommand.Parameters.AddWithValue("_year", DateTime.Now.Year);
                            mySqlCommand.Parameters.AddWithValue("_NumWays", connectorSearch.NumWays);
                            mySqlCommand.Parameters.AddWithValue("_IdGender", connectorSearch.SelectedGender?.Id);
                            mySqlCommand.Parameters.AddWithValue("_Description", connectorSearch.Description);
                            mySqlCommand.Parameters.AddWithValue("_Sealed", connectorSearch.IsSealed ? 1 : 0);
                            mySqlCommand.Parameters.AddWithValue("_CreatedBy", connectorSearch.ModifiedBy);//
                            mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite); //
                            mySqlCommand.Parameters.AddWithValue("_IdFamily", connectorSearch.SelectedFamily?.Id);
                            mySqlCommand.Parameters.AddWithValue("_IdSubFamily", connectorSearch.SelectedSubFamily?.Id);//
                            mySqlCommand.Parameters.AddWithValue("_Height", connectorSearch.Height);
                            mySqlCommand.Parameters.AddWithValue("_Length", connectorSearch.Length);
                            mySqlCommand.Parameters.AddWithValue("_Width", connectorSearch.Width);
                            mySqlCommand.Parameters.AddWithValue("_InternalDiameter", connectorSearch.InternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_ExternalDiameter", connectorSearch.ExternalDiameter);
                            mySqlCommand.Parameters.AddWithValue("_idWorkflowStatus", connectorSearch.SelectedReferenceStatus?.IdWorkflowStatus);
                            mySqlCommand.Parameters.AddWithValue("_ModifiedBy", connectorSearch.ModifiedBy);//
                            mySqlCommand.Parameters.AddWithValue("_ModifiedIn", connectorSearch.ModifiedIn);//
                            connectorSearch.IdConnector = (long)Convert.ToDouble(mySqlCommand.ExecuteScalar());
                            mySqlConnection.Close();
                        }

                        #region ReferencesList
                        if (connectorSearch.ReferencesList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();

                                foreach (ConnectorReference Connectorref in connectorSearch.ReferencesList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorReference_V2520", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_Ref", Connectorref.Reference);
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_IdCustomer", Connectorref.Company?.Id);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", Connectorref.CreatorId);
                                    mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                    mySqlCommand.ExecuteNonQuery();
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        #region Images
                        if (connectorSearch.ConnectorsImageList != null)
                        {
                            using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                            {
                                mySqlConnection.Open();

                                foreach (SCMConnectorImage SCMConnectorImageList in connectorSearch.ConnectorsImageList)
                                {
                                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_InsertConnectorImage_V2560", mySqlConnection);
                                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                                    mySqlCommand.Parameters.AddWithValue("_IdConnector", connectorSearch.IdConnector);
                                    mySqlCommand.Parameters.AddWithValue("_IdPictureType", SCMConnectorImageList.IdPictureType);
                                    mySqlCommand.Parameters.AddWithValue("_ConnectorFileName", SCMConnectorImageList.OriginalFileName);
                                    mySqlCommand.Parameters.AddWithValue("_CreatedBy", SCMConnectorImageList.CreatedBy);
                                    mySqlCommand.Parameters.AddWithValue("_IdSite", connectorSearch.IdSite);
                                    mySqlCommand.Parameters.AddWithValue("_Position", SCMConnectorImageList.Position);
                                    mySqlCommand.Parameters.AddWithValue("_Description", SCMConnectorImageList.Description);

                                    SCMConnectorImageList.IdConnectorImage = Convert.ToUInt32(mySqlCommand.ExecuteScalar());
                                    SCMConnectorImageList.Ref = connectorSearch.Reference;
                                    if (SCMConnectorImageList.IdConnectorImage > 0)
                                    {
                                        if (SCMConnectorImageList.IdPictureType == 1)
                                        {
                                            AddConnectorImageToPath(SCMConnectorImageList, ConnectorWtgImages);
                                        }
                                        else
                                        {
                                            AddConnectorImageToPath(SCMConnectorImageList, ConnectorImagePath);
                                        }
                                    }
                                }
                                mySqlConnection.Close();
                            }
                        }
                        #endregion

                        AddConnectorLogEntry(MainServerConnectionString, connectorSearch.IdConnector, connectorSearch.UpdatedChangeLogList);
                        using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                        {
                            mySqlConnection.Open();
                            MySqlCommand mySqlCommand = new MySqlCommand("select ref from connectors where idconnector = " + connectorSearch.IdConnector, mySqlConnection);
                            MySqlDataReader rd = mySqlCommand.ExecuteReader();
                            if (rd.Read())
                            {
                                connectorSearch.Reference = rd["ref"].ToString();
                            }
                        }
                        transactionScope.Complete();
                        transactionScope.Dispose();
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error AddConnector_V2680().  ErrorMessage- {1}", ex.Message), category: Category.Exception, priority: Priority.Low);
                    if (Transaction.Current != null)
                        Transaction.Current.Rollback();

                    if (transactionScope != null)
                        transactionScope.Dispose();
                    throw;
                }
            }
            return connectorSearch.Reference;
        }
        //[Rahul.Gadhave][GEOS2-9556][Date:04/11/2025]
        public bool DeleteReference_V2680(string Reference, Int64 IdConnector, Int32 IdUser, string MainServerConnectionString)
        {
            bool isDeleted = false;
            if (IdConnector > 0)
            {
                try
                {
                    using (MySqlConnection mySqlConnection = new MySqlConnection(MainServerConnectionString))
                    {
                        mySqlConnection.Open();
                        MySqlCommand mySqlCommand = new MySqlCommand("SCM_Delete_Connector_V2680", mySqlConnection);
                        mySqlCommand.CommandType = CommandType.StoredProcedure;
                        mySqlCommand.Parameters.AddWithValue("_IdConnector", IdConnector);
                        mySqlCommand.Parameters.AddWithValue("_DeleteUser", IdUser);
                        mySqlCommand.ExecuteNonQuery();
                        mySqlConnection.Close();
                        isDeleted = true;
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error DeleteReference_V2680(). IdProductType- {0} ErrorMessage- {1}", IdConnector, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }
            return isDeleted;
        }


        public bool GetConnectorCreatorEmailAndSendMail_V2680(Int64 IdConnector, string MailServerName, string MailServerPort, string MainServerConnectionString)
        {
            bool isSendMail = false;
            if (IdConnector > 0)
            {
                string MailTo = GetConnectorCreator_V2680(IdConnector, MainServerConnectionString);
                if (!string.IsNullOrEmpty(MailTo))
                {
                    try
                    {
                        string emailSubject = string.Empty;
                        string emailBody = $"Dear,\n\nThe connector {IdConnector}, has been deleted.\n\nRegards";

                        // Send the email using Utility.MailControl.SendMail
                        Utility.MailControl.SendMail(
                            title: emailSubject,
                            description: emailBody,
                            mailTo: MailTo,
                            mailFrom: "noreply@emdep.com",
                            mailServerName: MailServerName,
                            mailServerPort: MailServerPort
                        );

                        isSendMail = true;
                    }
                    catch (Exception ex)
                    {
                        Log4NetLogger.Logger.Log(
                            $"Error in GetConnectorCreatorEmailAndSendMail_V2680(). IdConnector: {IdConnector}, Error: {ex}",
                            category: Category.Exception,
                            priority: Priority.Low
                        );
                        throw;
                    }
                }
            }
            return isSendMail;
        }
        public string GetConnectorCreator_V2680(Int64 IdConnector, string MainServerConnectionString)
        {
            string MailTo = string.Empty;
            if (IdConnector > 0)
            {
                try
                {
                    using (MySqlConnection connActivity = new MySqlConnection(MainServerConnectionString))
                    {
                        connActivity.Open();
                        MySqlCommand cmd = new MySqlCommand("SCM_GetConnectorCreator_V2680", connActivity);
                        cmd.Parameters.AddWithValue("_IdConnector", IdConnector);
                        cmd.CommandType = CommandType.StoredProcedure;
                        using (MySqlDataReader rdr = cmd.ExecuteReader())
                        {
                            while (rdr.Read())
                            {
                                if (rdr["Email"] != DBNull.Value)
                                {
                                    MailTo = Convert.ToString(rdr["Email"]);
                                }
                            }
                        }
                        connActivity.Close();
                    }
                }
                catch (Exception ex)
                {
                    Log4NetLogger.Logger.Log(string.Format("Error GetConnectorCreator_V2680()", IdConnector, ex.Message), category: Category.Exception, priority: Priority.Low);
                    throw;
                }
            }
            return MailTo;
        }

        //[Rahul.Gadhave][GEOS2-9556][Date:04/11/2025]
        public List<Connectors> GetAllConnectors_V2680(string SCMConnectionString, Connectors Connectors, string componentQuery, string ConnectorsImagesImagePath, bool getAllRecords)
        {
            List<Connectors> ConnectorsList = new List<Connectors>();
            try
            {
                using (MySqlConnection mySqlConnection = new MySqlConnection(SCMConnectionString))
                {
                    mySqlConnection.Open();

                    MySqlCommand mySqlCommand = new MySqlCommand("SCM_GetAllConnectors_V2680", mySqlConnection);
                    mySqlCommand.CommandType = CommandType.StoredProcedure;
                    mySqlCommand.CommandTimeout = 80000;
                    DataSet ds = new DataSet();
                    #region Parameters

                    // Added pagination parameters                    
                    mySqlCommand.Parameters.AddWithValue("_GetAllRecords", getAllRecords);

                    if (!string.IsNullOrEmpty(Connectors.Ref))
                        mySqlCommand.Parameters.AddWithValue("_Ref", Connectors.Ref);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Ref", null);

                    if (Connectors.SelectedCompanyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idCompany", string.Join(",", Connectors.SelectedCompanyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idCompany", null);

                    if (Connectors.SelectedFamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idFamily", string.Join(",", Connectors.SelectedFamilyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idFamily", null);

                    if (Connectors.SelectedSubfamilyList != null)
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", string.Join(",", Connectors.SelectedSubfamilyList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idConnectorSubFamily", null);

                    if (Connectors.SelectedColorList != null)
                        mySqlCommand.Parameters.AddWithValue("_idColor", string.Join(",", Connectors.SelectedColorList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idColor", null);

                    if (Connectors.SelectedGenderList != null)
                        mySqlCommand.Parameters.AddWithValue("_idGender", string.Join(",", Connectors.SelectedGenderList.Select(i => $"'{i.Id}'")));
                    else
                        mySqlCommand.Parameters.AddWithValue("_idGender", null);

                    if (Connectors.SelectedShape != null)
                        mySqlCommand.Parameters.AddWithValue("_idShape", Connectors.SelectedShape?.IdLookupValue);
                    else
                        mySqlCommand.Parameters.AddWithValue("_idShape", null);
                    #region[GEOS2-5296][rdixit][29.02.2024]
                    #region Ways
                    if (Connectors.WaysProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", (Connectors.WaysProp.MinValueNew == string.Empty) ? null : Connectors.WaysProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", (Connectors.WaysProp.MaxValueNew == string.Empty) ? null : Connectors.WaysProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMin", null);
                        mySqlCommand.Parameters.AddWithValue("_CavitiesMax", null);
                    }
                    #endregion

                    #region DiameterInternal
                    if (Connectors.DiameterInternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", (Connectors.DiameterInternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", (Connectors.DiameterInternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterInternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterIntMax", null);
                    }
                    #endregion

                    #region DiameterExternal
                    if (Connectors.DiameterExternalProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", (Connectors.DiameterExternalProp.MinValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", (Connectors.DiameterExternalProp.MaxValueNew == string.Empty) ? null : Connectors.DiameterExternalProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMin", null);
                        mySqlCommand.Parameters.AddWithValue("_diameterExtMax", null);
                    }
                    #endregion

                    #region Height
                    if (Connectors.HeightProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", (Connectors.HeightProp.MinValueNew == string.Empty) ? null : Connectors.HeightProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", (Connectors.HeightProp.MaxValueNew == string.Empty) ? null : Connectors.HeightProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_heightMin", null);
                        mySqlCommand.Parameters.AddWithValue("_heightMax", null);
                    }
                    #endregion

                    #region Length
                    if (Connectors.LengthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", (Connectors.LengthProp.MinValueNew == string.Empty) ? null : Connectors.LengthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", (Connectors.LengthProp.MaxValueNew == string.Empty) ? null : Connectors.LengthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_lengthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_lengthMax", null);
                    }
                    #endregion

                    #region Width
                    if (Connectors.WidthProp != null)
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", (Connectors.WidthProp.MinValueNew == string.Empty) ? null : Connectors.WidthProp.MinValueNew);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", (Connectors.WidthProp.MaxValueNew == string.Empty) ? null : Connectors.WidthProp.MaxValueNew);
                    }
                    else
                    {
                        mySqlCommand.Parameters.AddWithValue("_widthMin", null);
                        mySqlCommand.Parameters.AddWithValue("_widthMax", null);
                    }
                    #endregion
                    if (Connectors.SealingSearch == 1 || Connectors.SealingSearch == 0)
                        mySqlCommand.Parameters.AddWithValue("_Sealed", Connectors.SealingSearch);
                    else
                        mySqlCommand.Parameters.AddWithValue("_Sealed", null);
                    #endregion                  

                    if (string.IsNullOrEmpty(Connectors.ConnectorType))
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", null);
                    else
                        mySqlCommand.Parameters.AddWithValue("_ConnectorType", Connectors.ConnectorType);

                    mySqlCommand.Parameters.AddWithValue("_ComponentQuery", componentQuery);// Added code to reduce time to load data
                    mySqlCommand.Parameters.AddWithValue("_idDeleted", Connectors.ShowDeleted);//[Rahul.Gadhave][GEOS2-9556][Date:04/11/2025]
                    #endregion
                    using (MySqlDataAdapter adap = new MySqlDataAdapter(mySqlCommand))
                    {
                        adap.Fill(ds);
                        foreach (DataRow reader in ds.Tables[0].Rows)
                        {
                            Connectors connector = new Connectors();
                            if (reader["IdConnector"] != DBNull.Value)
                            {
                                connector.IdConnector = Convert.ToInt64(reader["IdConnector"]);
                            }
                            if (reader["Ref"] != DBNull.Value)
                            {
                                connector.Ref = Convert.ToString(reader["Ref"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.NumWays = Convert.ToInt32(reader["numWays"]);
                            }
                            if (reader["numWays"] != DBNull.Value)
                            {
                                connector.Ways = Convert.ToString(reader["numWays"]);
                            }
                            if (reader["Family"] != DBNull.Value)
                            {
                                connector.Family = Convert.ToString(reader["Family"]);
                            }
                            if (reader["SubFamily"] != DBNull.Value)
                            {
                                connector.SubFamily = Convert.ToString(reader["SubFamily"]);
                            }
                            if (reader["Color"] != DBNull.Value)
                            {
                                connector.Color = Convert.ToString(reader["Color"]);
                            }
                            if (reader["Terminal"] != DBNull.Value)
                            {
                                connector.Terminal = Convert.ToString(reader["Terminal"]);
                            }
                            if (reader["FileName"] != DBNull.Value)
                            {
                                connector.FileName = Convert.ToString(reader["FileName"]);
                                connector.ConnectorsImagePath = "https://api.emdep.com/GEOS/Images.aspx?FilePath=/CONNECTOR VISUAL AIDS/CONNECTORS/COMMERCIAL/" + connector.Ref + "/" + connector.FileName;
                            }
                            if (reader["Location"] != DBNull.Value)
                            {
                                connector.Location = Convert.ToString(reader["Location"]);
                            }
                            if (reader["Description"] != DBNull.Value)
                            {
                                connector.Description = Convert.ToString(reader["Description"]);
                            }
                            if (reader["Duplicated"] != DBNull.Value)
                            {
                                connector.Duplicated = Convert.ToInt32(reader["Duplicated"]);
                            }

                            ConnectorsList.Add(connector);
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Log4NetLogger.Logger.Log(string.Format("Error GetAllConnectors_V2680(). ErrorMessage- {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                throw;
            }
            return ConnectorsList;
        }

    }
}
