<dxwui:WinUIDialogWindow xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"  x:Class="Emdep.Geos.Modules.Crm.Views.EditPlantQuotaView"
                        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                        xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
                        xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                        xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                        xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
                         xmlns:CrmApplication="clr-namespace:Emdep.Geos.Modules.Crm"
                        xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
                    
                         xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
                          xmlns:Converter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
                        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
                        mc:Ignorable="d" 
                         xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
                         xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
                        Title="{Binding WindowHeader,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"            
                        TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}" 
                        Style="{DynamicResource WinUIDialogWindowStyle}"
                        xmlns:local="clr-namespace:Emdep.Geos.Modules.Crm.Views"
                        
                        >

    <dxwui:WinUIDialogWindow.Resources>
        <!--<DataTemplate x:Key="DefaultColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName}" Header="{Binding HeaderText}" AllowCellMerge="{Binding AllowCellMerge}"  FixedWidth="{Binding FixedWidth}"   AllowBestFit="true" Width="{Binding  Width}" AllowEditing="False" AllowAutoFilter="False"  Visible="{Binding Visible}"  AllowMoving="False" ShowInColumnChooser="False" />
            </ContentControl>
        </DataTemplate>
        <Style x:Key="ColumnStyle" TargetType="dxg:GridColumn">
            <Setter Property="FilterPopupMode" Value="CheckedList"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=IsVertical}" Value="True">
                    <Setter Property="HeaderTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <ContentControl Content="{Binding}">
                                    <ContentControl.LayoutTransform>
                                        <RotateTransform Angle="-90"/>
                                    </ContentControl.LayoutTransform>
                                </ContentControl>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <DataTemplate x:Key="AmountColumnTemplate">
            <ContentControl>
                <dxg:GridColumn  FieldName="{Binding Path=FieldName}" Tag="{Binding}"  Header="{Binding HeaderText}" AllowCellMerge="{Binding AllowCellMerge}"  FixedWidth="{Binding FixedWidth}"  AllowBestFit="true" Width="{Binding  Width}" HorizontalHeaderContentAlignment="Right"  Visible="{Binding Visible}" AllowMoving="False" ShowInColumnChooser="False"  >
                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings DisplayFormat="C" MaskType="Numeric"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>
        <UIHelper:ColumnTemplateSelector x:Key="ColumnTemplateSelector"/>
        <UIHelper:CellTemplateSelector x:Key="templateSelector" />-->




    </dxwui:WinUIDialogWindow.Resources>
    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape"  Command="{Binding EditPlantQuotaViewCancelButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>
    <Grid>
        <Grid.Resources>
            <Style TargetType="GroupBox">
                <Setter Property="Margin" Value="4 2"/>
                <Setter Property="HeaderTemplate">
                    <Setter.Value>
                        <DataTemplate>
                            <TextBlock Text="{Binding}" FontWeight="Medium"/>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <Style x:Key="TabItemStyle" TargetType="dx:DXTabItem">
                <Setter Property="Header" Value="{Binding Year}"/>
                <Setter Property="Content" Value="{Binding}"/>
            </Style>
            <DataTemplate x:Key="TabItemHeaderTemplate">
                <TextBlock Text="{Binding}" FontWeight="Medium"/>
            </DataTemplate>
            <DataTemplate x:Key="TabItemContentTemplate">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="50"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="1*"/>
                        <RowDefinition Height="5*"/>
                    </Grid.RowDefinitions>
                    <Label Content="{DynamicResource EditPlantQuotaCurrency}" Grid.Row="0" Grid.Column="0"  Height="30" FontSize="16" Margin="5" Width="70"/>
                    <dxe:ComboBoxEdit  Grid.Row="0" Grid.Column="1"   HorizontalAlignment="Stretch" VerticalAlignment="Center" Height="30" Width="70"
                                       DisplayMember="Name" Margin="5" ItemsSource="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=Currencies,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                        SelectedIndex="{Binding IdSalesQuotaCurrency}" IsReadOnly="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=IsPermissionReadOnly}" >

                        <dxmvvm:Interaction.Behaviors>
                            <dxmvvm:EventToCommand EventName="EditValueChanged" Command="{Binding DataContext.CurrencyTypeSelectedIndexChangedCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                        </dxmvvm:Interaction.Behaviors>
                    </dxe:ComboBoxEdit>
                    <Label Grid.Row="0" Grid.Column="3" Content="{DynamicResource EditPlantQuotaCurrencyDate}" FontSize="16" Width="145" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                    <dxe:DateEdit Grid.Row="0"  Grid.Column="4" Height="30" Width="145" HorizontalAlignment="Left" VerticalAlignment="Center" IsTextEditable="False" ShowClearButton="False"
                                 EditValue="{Binding ExchangeRateDate}" Margin="5,0,0,0" IsReadOnly="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=IsPermissionReadOnly}">
                        <dxmvvm:Interaction.Behaviors>
                            <dxmvvm:EventToCommand EventName="EditValueChanged" Command="{Binding DataContext.CurrencyRateDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                        </dxmvvm:Interaction.Behaviors>
                    </dxe:DateEdit>
                    <dxg:GridControl VerticalAlignment="Stretch" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="5" Margin="0,20,0,0" 
                                     ItemsSource="{Binding LookupValue,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"   ImplyNullLikeEmptyStringWhenFiltering="True"
                                     SelectedItem="{Binding SelectedLookupValue}" >
                        <dxg:GridColumn Header="{DynamicResource EditPlantQuotaBU}" FieldName="Value" Width="200"  AllowEditing="false">

                        </dxg:GridColumn >

                        <dxg:GridColumn Header="{Binding AmountHeader}" FieldName="SalesQuotaAmount"   Width="150"   >
                            <dxg:GridColumn.CellTemplate>
                                <DataTemplate>
                                    <dxe:TextEdit x:Name="PART_Editor"  HorizontalAlignment="Stretch"  IsReadOnly="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=IsPermissionReadOnly}"
                                      Text="{Binding RowData.Row.SalesQuotaAmount}" DisplayFormatString="C"  MaskType="Numeric" Mask="n2" MaskUseAsDisplayFormat="True"  VerticalAlignment="Stretch" 
                                        Padding="3" >
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="LostFocus">
                                                <i:InvokeCommandAction Command="{Binding DataContext.SalesQuotaAmountLostFocusCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"/>
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                        <dxmvvm:Interaction.Behaviors>
                                            <dxmvvm:EventToCommand EventName="EditValueChanged" Command="{Binding DataContext.SalesQuotaAmountChangedCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                                        </dxmvvm:Interaction.Behaviors>

                                    </dxe:TextEdit>
                                </DataTemplate>
                            </dxg:GridColumn.CellTemplate>

                        </dxg:GridColumn>

                        <dxg:GridColumn  Header="{Binding AmountHeaderApplicationPrefer}"  Width="160" FieldName="SalesQuotaAmountWithExchangeRate"  AllowEditing="false" >
                            <dxg:GridColumn.EditSettings>
                                <dxe:TextEditSettings   MaskType="Numeric" Mask="n2" MaskUseAsDisplayFormat="True" HorizontalContentAlignment="Left"/>
                            </dxg:GridColumn.EditSettings>
                        </dxg:GridColumn>

                        <dxg:GridControl.View>
                            <dxg:TableView AllowFilterEditor="False"
                                               AllowColumnFiltering="False"
                                               ShowHorizontalLines="True"
                                               AllowPerPixelScrolling="False"
                                               AllowGrouping="False"
                                               ShowGroupPanel="False" 
                                               ShowVerticalLines="True" 
                                               ShowIndicator="False"
                                               HorizontalScrollbarVisibility="Auto" 
                                               VerticalScrollbarVisibility="Auto"
                                               HorizontalContentAlignment="Center"
                                               RowMinHeight="20"
                                               AllowScrollHeaders="False"
                                               AllowEditing="True"
                                               AllowColumnMoving="True"
                                               AutoMoveRowFocus="False"
                                               AllowScrollAnimation="True" 
                                               AllowBestFit="True"
                                               AllowResizing="True"
                                               SearchPanelHorizontalAlignment="Stretch"
                                               ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly"/>
                        </dxg:GridControl.View>

                    </dxg:GridControl>
                </Grid>
            </DataTemplate>
        </Grid.Resources>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*"/>
            <ColumnDefinition Width="1*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="79*"/>
            <RowDefinition Height="5*"/>
        </Grid.RowDefinitions>
        <dx:DXTabControl Grid.Row="0" Grid.ColumnSpan="2"
            ItemsSource="{Binding PlantBusinessUnitSalesQuota}" 
            ItemContainerStyle="{StaticResource TabItemStyle}"
            ItemHeaderTemplate="{StaticResource TabItemHeaderTemplate}"
            ItemTemplate="{StaticResource TabItemContentTemplate}"   SelectedItem="{Binding Path=SelectedPlantBusinessUnitSalesQuota,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">
            <dx:DXTabControl.View>
                <dx:TabControlStretchView  SingleTabItemHideMode="HideAndShowNewItem"/>
            </dx:DXTabControl.View>

        </dx:DXTabControl>

        <Button Content="{DynamicResource EditPlantQuotsViewAccept}"  FontSize="16" Height="30" Grid.Column="0" Grid.Row="1"
                            Width="100"   Command="{Binding EditPlantQuotaViewAcceptButtonCommand}"
                            HorizontalAlignment="Right" Margin="0,10,30,0"   >
            <Button.Style>

                <Style TargetType="{x:Type Button}">
                    <Setter Property="FontSize" Value="16" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=IsPermissionReadOnly}" Value="True">
                            <Setter Property="IsEnabled" Value="False"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=IsPermissionReadOnly}" Value="False">
                            <Setter Property="IsEnabled" Value="True"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>
        <Button Content="{DynamicResource EditPlantQuotsViewCancel}" Grid.Column="1" Grid.Row="1"
                     HorizontalAlignment="Left"
                     FontSize="16" Command="{Binding EditPlantQuotaViewCancelButtonCommand}"
                     Height="30" Grid.ColumnSpan="3" Margin="0,10,30,0" 
                     Width="100"
                     Style="{DynamicResource Button16Style}"/>

    </Grid>

    <!--<DockPanel LastChildFill="True">
            <Grid DockPanel.Dock="Top" HorizontalAlignment="Left" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="15*" />
                </Grid.ColumnDefinitions>
                <Label Content="Edit Plant Quota" HorizontalAlignment="Left"
                       VerticalAlignment="Top" Margin="0,0,0,0" Style="{DynamicResource LabelTitleStyle}" Grid.Column="0"/>
            </Grid>

            <Grid DockPanel.Dock="Bottom">
                <Grid.Resources>
                    <DataTemplate x:Key="FieldValueTemplate">
                        <Label Content="{Binding DisplayText, Mode=OneWay}" Foreground="Black"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                    </DataTemplate >
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions >
                    <RowDefinition Height="90"/>
                    <RowDefinition Height="40"/>
                </Grid.RowDefinitions>

                <Label Grid.Row="0" Grid.Column="0" Content="{Binding Description1,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>
                <GroupBox DockPanel.Dock="Right" Grid.Row="0" Width="auto" Height="Auto" Grid.Column="0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="150"/>
                        </Grid.ColumnDefinitions>
                        <dxg:GridControl AutoGenerateColumns="None" x:Name="grid"
                                     ItemsSource="{Binding DtPlant,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" SelectedItem="{Binding SelectedObject, Mode=TwoWay}"
                                     ColumnsSource="{Binding Columns,UpdateSourceTrigger=PropertyChanged}" ScrollViewer.HorizontalScrollBarVisibility="Visible"
                                     ColumnGeneratorStyle="{StaticResource ColumnStyle}" 
                             ColumnGeneratorTemplateSelector="{StaticResource ColumnTemplateSelector}">
                            <dxg:GridControl.View>
                                <dxg:TableView AllowFilterEditor="False"
                                               AllowColumnFiltering="False"
                                               ShowHorizontalLines="True"
                                               AllowPerPixelScrolling="False"
                                               AllowGrouping="False"
                                               ShowGroupPanel="False" 
                                               ShowVerticalLines="True" 
                                               ShowIndicator="False"
                                               AutoWidth="True" 
                                               HorizontalScrollbarVisibility="Auto" 
                                               VerticalScrollbarVisibility="Auto"
                                               HorizontalContentAlignment="Center"
                                               RowMinHeight="20"
                                               AllowScrollHeaders="False"
                                               AllowEditing="True"
                                               AllowColumnMoving="True"
                                               AutoMoveRowFocus="False"
                                               AllowScrollAnimation="True" 
                                               AllowBestFit="True"
                                               AllowResizing="True"
                                               SearchPanelHorizontalAlignment="Stretch"
                                               ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                </dxg:TableView>
                            </dxg:GridControl.View>
                        </dxg:GridControl>
                        <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Vertical">
                            <Label Grid.Row="0" Grid.Column="1" Content="Currency" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0 -3 0 0"/>
                           
                        </StackPanel>
                    </Grid>

                </GroupBox>
                <StackPanel HorizontalAlignment="Center" Orientation="Horizontal"  Grid.Row="1" Grid.ColumnSpan="2"
                    Margin="20,0,0,0"
                    Width="290">

                    <Button Content="{DynamicResource EditTargetAndForecastViewAccept}"
                    Command="{Binding EditPlantQuotaViewAcceptButtonCommand}"
                    Height="30"
                    Width="100"
                    Margin="15,0,30,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" />

                    <Button Content="{DynamicResource EditTargetAndForecastViewCancel}"
                    Command="{Binding EditPlantQuotaViewCancelButtonCommand}" 
                    Height="30"
                    Width="100"
                    Margin="30,0,0,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" />

                </StackPanel>
            </Grid>
        </DockPanel>-->
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>

</dxwui:WinUIDialogWindow>
