<UserControl x:Class="Emdep.Geos.Modules.Crm.Views.ReportDashboard2"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Emdep.Geos.Modules.Crm.Views"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
             xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
             xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:Behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.Crm.ViewModels"
             xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing"
             xmlns:dxet="http://schemas.devexpress.com/winfx/2008/xaml/editors/themekeys"
             xmlns:dxci="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"
             xmlns:dxgt="clr-namespace:DevExpress.Xpf.Grid.Themes;assembly=DevExpress.Xpf.Grid.v19.2"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" 
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
             xmlns:gif="http://wpfanimatedgif.codeplex.com"
             mc:Ignorable="d"  
             d:DesignHeight="300" d:DesignWidth="300"
             Style="{DynamicResource UserControlStyle}">

    <!--<UserControl.DataContext>
        <ViewModels:ReportDashboardViewModel />
    </UserControl.DataContext>-->

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
        <!--<Style TargetType="dxg:GridColumn">
            <Setter Property="MinWidth" Value="100" />
        </Style>
        <Style TargetType="dxg:GridControlBand">
            <Setter Property="MinWidth" Value="100" />
        </Style>-->

        <DataTemplate x:Key="DefaultColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding ColumnFieldName}" Header="{Binding HeaderText}" 
                                AllowBestFit="true" 
                                Width="{Binding Width}" AllowEditing="False" AllowAutoFilter="False" Visible="True"
                                HorizontalHeaderContentAlignment="Stretch" FilterPopupMode="CheckedList">

                    <dxg:GridColumn.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Vertical">
                                <TextBlock Text="{Binding Path=DataContext.TotalSummaryText,StringFormat='{}{0:C}', ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}, RelativeSource={RelativeSource AncestorType=dxg:GridColumnHeader}}"
                                           HorizontalAlignment="Left" VerticalAlignment="Center" />
                                <Separator Margin="-5,0,-500,0" VerticalAlignment="Center" />
                                <TextBlock Text="{Binding}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </StackPanel>
                        </DataTemplate>
                    </dxg:GridColumn.HeaderTemplate>

                    <!--<dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Path=Value, StringFormat='{}{0:C}', ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture} }" HorizontalAlignment="Right" Margin="0,0,5,0" />
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>-->

                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings DisplayFormat="c" />
                    </dxg:GridColumn.EditSettings>

                    <dxg:GridColumn.PrintColumnHeaderStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintHeaderStyle}}">
                            <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                            <Setter Property="TextWrapping" Value="Wrap" />
                            <Setter Property="Height" Value="Auto" />
                            <Setter Property="Padding" Value="10" />
                            <Setter Property="DisplayTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <StackPanel HorizontalAlignment="Left">
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.TotalSummaryText, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" Height="Auto" BorderThickness="0,0,0,1" BorderBrush="Black" />
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.HeaderCaption, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" TextWrapping="Wrap" Height="Auto" />
                                        </StackPanel>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </dxg:GridColumn.PrintColumnHeaderStyle>

                    <dxg:GridColumn.PrintCellStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
                            <Style.Setters>
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Text" />
                                <!--<Setter Property="dxp:TextExportSettings.Text" Value="{Binding Path=Value,StringFormat='{}{0:C}', ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" />-->
                                <Setter Property="dxp:TextExportSettings.HorizontalAlignment" Value="Center" />
                            </Style.Setters>
                        </Style>
                    </dxg:GridColumn.PrintCellStyle>

                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="TotalColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding ColumnFieldName}" Header="{Binding HeaderText}" 
                                AllowBestFit="true" 
                                Width="{Binding Width}" AllowEditing="False" AllowAutoFilter="False" Visible="True"
                                HorizontalHeaderContentAlignment="Stretch" FilterPopupMode="CheckedList">
                    <dxg:GridColumn.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="{Binding Path=DataContext.TotalSummaryText, RelativeSource={RelativeSource AncestorType=dxg:GridColumnHeader}}"
                                           HorizontalAlignment="Left" VerticalAlignment="Center" />
                                <Separator Margin="-5,0,-500,0" VerticalAlignment="Center" />
                                <TextBlock Text="{Binding}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </StackPanel>
                        </DataTemplate>
                    </dxg:GridColumn.HeaderTemplate>

                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings DisplayFormat="C" />
                    </dxg:GridColumn.EditSettings>

                    <dxg:GridColumn.CellStyle>
                        <Style TargetType="{x:Type dxg:LightweightCellEditor}">
                            <Setter Property="Background" Value="#FFDDEAF5" />
                            <Setter Property="Foreground" Value="Black" />
                            <Setter Property="HorizontalAlignment" Value="Right" />
                            <!--<Setter Property="Margin" Value="0,0,5,0"/>-->
                            <!--<Setter Property="Padding" Value="0,0,15,0" />-->
                            <Setter Property="TextBlock.FontWeight" Value="Bold" />
                        </Style>
                    </dxg:GridColumn.CellStyle>

                    <!--<dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <Border Background="#FFDDEAF5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <dxe:TextEdit EditValue="{Binding Path=Value,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                          DisplayFormatString="C" x:Name="PART_Editor"
                                          HorizontalAlignment="Right" Margin="0,0,5,0" IsReadOnly="True"
                                          Foreground="Black" FontWeight="Bold" Background="#FFDDEAF5" ShowBorder="False"/>
                            </Border>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>-->
                    <!--<dxg:GridColumn.DisplayTemplate >
                        <ControlTemplate>
                            <Border Background="#FFDDEAF5" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"> 
                            <dxe:TextEdit EditValue="{Binding Path=Value,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                          DisplayFormatString="C" x:Name="PART_Editor"
                                          HorizontalAlignment="Right" Margin="0,0,5,0" IsReadOnly="True"
                                          Foreground="Black" FontWeight="Bold" Background="#FFDDEAF5" ShowBorder="False"/></Border>
                           
                        </ControlTemplate>
                    </dxg:GridColumn.DisplayTemplate>-->

                    <dxg:GridColumn.PrintColumnHeaderStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintHeaderStyle}}">
                            <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                            <Setter Property="TextWrapping" Value="Wrap" />
                            <Setter Property="Height" Value="Auto" />
                            <Setter Property="Padding" Value="10" />
                            <Setter Property="DisplayTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <StackPanel HorizontalAlignment="Left">
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.TotalSummaryText, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" Height="Auto" BorderThickness="0,0,0,1" BorderBrush="Black" />
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.HeaderCaption, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" TextWrapping="Wrap" Height="Auto" />
                                        </StackPanel>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </dxg:GridColumn.PrintColumnHeaderStyle>

                    <dxg:GridColumn.PrintCellStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
                            <Style.Setters>
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Text" />
                                <!--<Setter Property="dxp:TextExportSettings.Text" Value="{Binding Path=Value,StringFormat='{}{0:C}', ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" />-->
                                <Setter Property="dxp:TextExportSettings.HorizontalAlignment" Value="Center" />
                            </Style.Setters>
                        </Style>
                    </dxg:GridColumn.PrintCellStyle>
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="TotalColumnTemplate1">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding ColumnFieldName}" Header="{Binding HeaderText}" 
                                AllowBestFit="true" 
                                Width="{Binding Width}" AllowEditing="False" AllowAutoFilter="False" Visible="True"
                                HorizontalHeaderContentAlignment="Stretch" FilterPopupMode="CheckedList">
                    <dxg:GridColumn.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="{Binding Path=DataContext.TotalSummaryText, RelativeSource={RelativeSource AncestorType=dxg:GridColumnHeader}}"
                                           HorizontalAlignment="Left" VerticalAlignment="Center" />
                                <Separator Margin="-5,0,-500,0" VerticalAlignment="Center" />
                                <TextBlock Text="{Binding}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </StackPanel>
                        </DataTemplate>
                    </dxg:GridColumn.HeaderTemplate>

                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings DisplayFormat="C" />
                    </dxg:GridColumn.EditSettings>

                    <dxg:GridColumn.CellStyle>
                        <Style TargetType="{x:Type dxg:LightweightCellEditor}">
                            <Setter Property="Background" Value="#FFE4EEDC" />
                            <Setter Property="Foreground" Value="Black" />
                            <Setter Property="HorizontalAlignment" Value="Right" />
                            <!--<Setter Property="Margin" Value="0,0,5,0"/>-->
                            <!--<Setter Property="Padding" Value="0,0,15,0" />-->
                            <Setter Property="TextBlock.FontWeight" Value="Bold" />
                        </Style>
                    </dxg:GridColumn.CellStyle>

                    <!--<dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <Border Background="#FFE4EEDC" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <dxe:TextEdit EditValue="{Binding Path=Value,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                          DisplayFormatString="C" x:Name="PART_Editor"
                                          HorizontalAlignment="Right" Margin="0,0,5,0" IsReadOnly="True"
                                          Foreground="Black" FontWeight="Bold" Background="#FFE4EEDC" ShowBorder="False"/>
                            </Border>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>-->

                    <dxg:GridColumn.PrintColumnHeaderStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintHeaderStyle}}">
                            <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                            <Setter Property="TextWrapping" Value="Wrap" />
                            <Setter Property="Height" Value="Auto" />
                            <Setter Property="Padding" Value="10" />
                            <Setter Property="DisplayTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <StackPanel HorizontalAlignment="Left">
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.TotalSummaryText, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" Height="Auto" BorderThickness="0,0,0,1" BorderBrush="Black" />
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.HeaderCaption, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" TextWrapping="Wrap" Height="Auto" />
                                        </StackPanel>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </dxg:GridColumn.PrintColumnHeaderStyle>

                    <dxg:GridColumn.PrintCellStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
                            <Style.Setters>
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Text" />
                                <!--<Setter Property="dxp:TextExportSettings.Text" Value="{Binding Path=Value,StringFormat='{}{0:C}', ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" />-->
                                <Setter Property="dxp:TextExportSettings.HorizontalAlignment" Value="Center" />
                            </Style.Setters>
                        </Style>
                    </dxg:GridColumn.PrintCellStyle>

                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="TotalColumnTemplate2">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding ColumnFieldName}" Header="{Binding HeaderText}" 
                                AllowBestFit="true" 
                                Width="{Binding Width}" AllowEditing="False" AllowAutoFilter="False" Visible="True"
                                HorizontalHeaderContentAlignment="Stretch">
                    <dxg:GridColumn.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel VerticalAlignment="Center">

                                <TextBlock Text="{Binding Path=DataContext.TotalSummaryText, RelativeSource={RelativeSource AncestorType=dxg:GridColumnHeader}}"
                                           HorizontalAlignment="Left" VerticalAlignment="Center" />
                                <Separator Margin="-5,0,-500,0" VerticalAlignment="Center" />
                                <TextBlock Text="{Binding}" HorizontalAlignment="Center" VerticalAlignment="Center" />

                            </StackPanel>
                        </DataTemplate>
                    </dxg:GridColumn.HeaderTemplate>

                    <!--<dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <Border Background="#FFFFE3DA" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <dxe:TextEdit EditValue="{Binding Path=Value,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                          DisplayFormatString="C" x:Name="PART_Editor"
                                          HorizontalAlignment="Right" Margin="0,0,5,0" IsReadOnly="True"
                                          Foreground="Black" FontWeight="Bold" Background="#FFFFE3DA" ShowBorder="False"/>
                            </Border>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>-->

                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings DisplayFormat="C" />
                    </dxg:GridColumn.EditSettings>

                    <dxg:GridColumn.CellStyle>
                        <Style TargetType="{x:Type dxg:LightweightCellEditor}">
                            <Setter Property="Background" Value="#FFFFE3DA" />
                            <Setter Property="Foreground" Value="Black" />
                            <Setter Property="HorizontalAlignment" Value="Right" />
                            <!--<Setter Property="Margin" Value="0,0,5,0"/>-->
                            <!--<Setter Property="TextBlock.Padding" Value="15" />-->
                            <Setter Property="TextBlock.FontWeight" Value="Bold" />
                        </Style>
                    </dxg:GridColumn.CellStyle>

                    <dxg:GridColumn.PrintColumnHeaderStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintHeaderStyle}}">
                            <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                            <Setter Property="TextWrapping" Value="Wrap" />
                            <Setter Property="Height" Value="Auto" />
                            <Setter Property="Padding" Value="10" />
                            <Setter Property="DisplayTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <StackPanel HorizontalAlignment="Left">
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.TotalSummaryText, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" Height="Auto" BorderThickness="0,0,0,1" BorderBrush="Black" />
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.HeaderCaption, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" TextWrapping="Wrap" Height="Auto" />
                                        </StackPanel>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </dxg:GridColumn.PrintColumnHeaderStyle>

                    <dxg:GridColumn.PrintCellStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
                            <Style.Setters>
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Text" />
                                <!--<Setter Property="dxp:TextExportSettings.Text" Value="{Binding Path=Value,StringFormat='{}{0:C}', ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" />-->
                                <Setter Property="dxp:TextExportSettings.HorizontalAlignment" Value="Center" />
                            </Style.Setters>
                        </Style>
                    </dxg:GridColumn.PrintCellStyle>
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="PercentageColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding ColumnFieldName}" Header="{Binding HeaderText}" 
                                AllowBestFit="true" 
                                Width="{Binding Width}" AllowEditing="False" AllowAutoFilter="False" Visible="True"
                                HorizontalHeaderContentAlignment="Stretch" FilterPopupMode="CheckedList">
                    <dxg:GridColumn.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                                <dxe:ProgressBarEdit HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                                     Minimum="0" Maximum="100" BorderBrush="Transparent"
                                                     HorizontalContentAlignment="Center" IsPrintingMode="True"
                                                     Foreground="Black" ContentDisplayMode="Value" ShowBorder="False"
                                                     DisplayFormatString="{}{0}%" 
                                                     Value="{Binding Path=DataContext.TotalSummaryText,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}, RelativeSource={RelativeSource AncestorType=dxg:GridColumnHeader}}" />

                                <Separator Margin="-5,0,-500,0" VerticalAlignment="Stretch" />
                                <TextBlock Text="{Binding}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                            </StackPanel>
                        </DataTemplate>
                    </dxg:GridColumn.HeaderTemplate>

                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <Border Padding="0" Margin="0">
                                <dxe:ProgressBarEdit HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                                     Minimum="0" Maximum="100" BorderBrush="Transparent"
                                                     HorizontalContentAlignment="Center" IsPrintingMode="True"
                                                     Foreground="Black" ContentDisplayMode="Value" ShowBorder="False"
                                                     DisplayFormatString="{}{0}%" Value="{Binding Path=Value}" />
                            </Border>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>

                    <dxg:GridColumn.PrintColumnHeaderStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintHeaderStyle}}">
                            <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                            <Setter Property="TextWrapping" Value="Wrap" />
                            <Setter Property="Height" Value="Auto" />
                            <Setter Property="Padding" Value="10" />
                            <Setter Property="DisplayTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <StackPanel HorizontalAlignment="Left">
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.TotalSummaryText, Mode=OneWay}" DisplayFormatString="{}{0}%" IsPrintingMode="True" FontWeight="Bold" Height="Auto" BorderThickness="0,0,0,1" BorderBrush="Black" />
                                            <dxe:TextEdit Margin="5,0" EditValue="{Binding Column.HeaderCaption, Mode=OneWay}" IsPrintingMode="True" FontWeight="Bold" TextWrapping="Wrap" Height="Auto" />
                                        </StackPanel>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </dxg:GridColumn.PrintColumnHeaderStyle>

                    <dxg:GridColumn.PrintCellStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
                            <Style.Setters>
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Text" />
                                <Setter Property="dxp:TextExportSettings.Text" Value="{Binding Path=Value,StringFormat='{}{0}%', ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" />
                                <Setter Property="dxp:TextExportSettings.HorizontalAlignment" Value="Center" />
                            </Style.Setters>
                        </Style>
                    </dxg:GridColumn.PrintCellStyle>

                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="AlternateColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding ColumnFieldName}" Header="{Binding HeaderText}" 
                                AllowBestFit="true" 
                                Width="{Binding Width}" AllowEditing="False" AllowAutoFilter="False" Visible="True"
                                HorizontalHeaderContentAlignment="Stretch" FilterPopupMode="CheckedList">

                    <dxg:GridColumn.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="" HorizontalAlignment="Left" VerticalAlignment="Center" />
                                <Separator Margin="-5,0,-500,0" VerticalAlignment="Center" />
                                <TextBlock Text="{Binding}" HorizontalAlignment="Left" VerticalAlignment="Center" />
                            </StackPanel>
                        </DataTemplate>
                    </dxg:GridColumn.HeaderTemplate>

                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <UIHelper:MyColumnTemplateSelector x:Key="newMyColumnTemplateSelector" 
                                           template1="{StaticResource DefaultColumnTemplate}" 
                                           template2="{StaticResource AlternateColumnTemplate}" 
                                           template3="{StaticResource PercentageColumnTemplate}"
                                           totalTemplate="{StaticResource TotalColumnTemplate}"
                                           totalTemplate1="{StaticResource TotalColumnTemplate1}"
                                           totalTemplate2="{StaticResource TotalColumnTemplate2}" />

        <DataTemplate x:Key="BandTemplate">
            <ContentControl>
                <UIHelper:MyGridControlBand Header="{Binding BandHeader}" HorizontalHeaderContentAlignment="Center" 
                                            ColumnsSource="{Binding Columns}" ColumnTemplateSelector="{StaticResource newMyColumnTemplateSelector}" />
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="SummaryTemplate">
            <ContentControl>
                <dxg:GridSummaryItem FieldName="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).FieldName, RelativeSource={RelativeSource Self}}"
                                     SummaryType="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Type, RelativeSource={RelativeSource Self}}"
                                     DisplayFormat="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).DisplayFormat, RelativeSource={RelativeSource Self}}" />
            </ContentControl>
        </DataTemplate>

    </UserControl.Resources>

    <DockPanel LastChildFill="True">
        <Grid DockPanel.Dock="Top" Margin="0,10,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
                <ColumnDefinition />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="{DynamicResource ReportDashboardHeader}" Grid.Column="0" Style="{DynamicResource TextBlock30Style}" FontWeight="Bold" />

            <Image gif:ImageBehavior.RepeatBehavior="Forever" gif:ImageBehavior.AnimatedSource="/Emdep.Geos.Modules.Crm;component/Assets/Images/animatedWarning.gif" Visibility="{Binding IsShowFailedPlantWarning,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,Converter={StaticResource BoolToVis}}" Grid.Column="1" Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5,2,5,0" Height="30" Width="30">
                <Image.ToolTip>
                    <TextBlock Text="{Binding WarningFailedPlants}" />
                </Image.ToolTip>
            </Image>

            <DockPanel Grid.Column="2" Grid.Row="0" Grid.ColumnSpan="3" HorizontalAlignment="Stretch" Margin="0" Height="45">
                <Grid HorizontalAlignment="Right" Width="Auto" Height="30">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="30" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="70*" />
                        <ColumnDefinition Width="150" />
                        <ColumnDefinition Width="30" />

                        <ColumnDefinition Width="70*" />
                        <ColumnDefinition Width="50*" />
                        <ColumnDefinition Width="10" />
                        <ColumnDefinition Width="50*" />

                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="80*" />
                        <ColumnDefinition Width="80*" />
                    </Grid.ColumnDefinitions>

                    <!-- Plant Owner -->
                    <DockPanel Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=CmbPlantOwnerUsers}">
                        <Image Style="{DynamicResource PlantOwnerImageStyle}" Width="24" Height="24" Margin="7,0,3,0" />
                        <TextBlock Text="{DynamicResource CommonPlantOwner}" FontWeight="Bold" Margin="5,2,5,0" />
                    </DockPanel>

                    <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}" Grid.Column="1" 
                                      Visibility="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=CmbPlantOwnerUsers}"
                                      ItemsSource="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=PlantOwnerUsersList}" Margin="5,0,5,0"
                                      DisplayMember="ShortName"
                    EditValue="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=SelectedPlantOwnerUsersList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <dxe:ComboBoxEdit.StyleSettings>
                            <dxe:CheckedComboBoxStyleSettings />
                        </dxe:ComboBoxEdit.StyleSettings>
                        <dxmvvm:Interaction.Triggers>
                            <dxmvvm:EventToCommand EventName="PopupClosed"
                                               Command="{Binding DataContext.PlantOwnerPopupClosedCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                               PassEventArgsToCommand="True" />
                        </dxmvvm:Interaction.Triggers>
                    </dxe:ComboBoxEdit>

                    <!-- Sales Owner -->
                    <DockPanel Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=CmbSalesOwnerUsers}">
                        <Image Style="{DynamicResource OwnerGroupImageStyle}" Width="24" Height="24" Margin="7,0,3,0" />
                        <TextBlock Text="{DynamicResource CommonSalesOwner}" FontWeight="Bold" Margin="5,2,5,0" />
                    </DockPanel>

                    <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}" Grid.Column="1" 
                                      Visibility="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=CmbSalesOwnerUsers}"
                                      ItemsSource="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=SalesOwnerUsersList}" Margin="5,0,0,0"
                                      DisplayMember="User.FullName"
                                      EditValue="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=SelectedSalesOwnerUsersList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <dxe:ComboBoxEdit.StyleSettings>
                            <dxe:CheckedComboBoxStyleSettings />
                        </dxe:ComboBoxEdit.StyleSettings>
                        <dxmvvm:Interaction.Triggers>
                            <dxmvvm:EventToCommand EventName="PopupClosed"
                                               Command="{Binding DataContext.SalesOwnerPopupClosedCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                   PassEventArgsToCommand="True" />
                        </dxmvvm:Interaction.Triggers>
                    </dxe:ComboBoxEdit>

                    <!-- Period -->
                    <DockPanel Grid.Column="3" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Style="{DynamicResource CalendarImageStyle}" Width="16" Height="16" Margin="7,0,3,0" />
                        <TextBlock Text="{DynamicResource AnnualSalesPerformanceViewPeriod}" FontWeight="Bold" Margin="5,0,0,0" />
                    </DockPanel>

                    <TextBlock Text="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=SelectedyearStarDate, StringFormat=d, ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.Column="4" Margin="3,0,0,0" />
                    <TextBlock Text=" - " HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="5" FontWeight="Bold" />
                    <TextBlock Text="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=SelectedyearEndDate, StringFormat=d, ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.Column="6" />

                    <!-- Remaining -->
                    <DockPanel Grid.Column="8" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image Style="{DynamicResource WatchImageStyle}" Width="16" Height="16" Margin="3,0,3,0" />
                        <TextBlock Text="{DynamicResource AnnualSalesPerformanceViewRemaining}" FontWeight="Bold" Margin="5,0,0,0" />
                    </DockPanel>
                    <DockPanel Grid.Column="9" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5,0,0,0">
                        <TextBlock Text="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=RemainingDays}" />
                        <TextBlock Text="{DynamicResource AnnualSalesPerformanceViewDays}" Margin="3,0,5,0" />
                    </DockPanel>
                </Grid>
            </DockPanel>

            <Button Content=" " Height="40" Width="40" Grid.Column="5" Command="{Binding RefreshReportDashboardViewCommand}" HorizontalAlignment="Right" Margin="0,0,5,0">
                <Button.ToolTip>
                    <TextBlock Text="{DynamicResource ButtonRefresh}" />
                </Button.ToolTip>
                <Button.ContentTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image Style="{ DynamicResource RefreshButtonImageStyle}" Grid.Column="0" Height="24" Width="24" Margin="-10" />
                        </Grid>
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>

            <Button Content=" " Height="40" Width="40" HorizontalAlignment="Right" Command="{Binding PrintButtonCommand }" CommandParameter="{Binding ElementName=ReportDashboard2TableView}" Grid.Column="6">
                <Button.ToolTip>
                    <TextBlock Text="{DynamicResource ButtonPrint}" />
                </Button.ToolTip>

                <Button.ContentTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image Style="{ DynamicResource PrinterButtonImageStyle}" Grid.Column="0" Height="24" Width="24" Margin="-10" />
                        </Grid>
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>
        </Grid>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="200*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
            </Grid.ColumnDefinitions>

            <UIHelper:MyGridControl Grid.Row="0" Margin="0" ScrollViewer.HorizontalScrollBarVisibility="Visible" ScrollViewer.VerticalScrollBarVisibility="Visible"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch" AutoGenerateColumns="None" 
                                    ItemsSource="{Binding DataTableReport2, Mode=TwoWay}"
                                    BandsSource="{Binding Bands}" BandTemplate="{StaticResource BandTemplate}"
                                    TotalSummarySource="{Binding TotalSummary}" CustomSummary="MyGridControl_CustomSummary"
                                    TotalSummaryGeneratorTemplate="{StaticResource SummaryTemplate}" FilterString="{Binding MyFilterString,Mode=TwoWay ,UpdateSourceTrigger=PropertyChanged}">

                <dxg:GridControl.View>
                    <dxg:TableView Name="ReportDashboard2TableView"
                                   AutoWidth="False"
                                   AllowPerPixelScrolling="True"
                                   NavigationStyle="Row"
                                   AllowGrouping="False" 
                                   ShowGroupPanel="False" 
                                   ShowIndicator="False"
                                   HorizontalScrollbarVisibility="Visible"
                                   VerticalScrollbarVisibility="Auto"
                                   SearchPanelHorizontalAlignment="Stretch"
                                   ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                        <dxg:TableView.Resources>
                            <DataTemplate x:Key="PageHeader">
                                <Grid Width="{Binding UsablePageWidth}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="50" />
                                        <ColumnDefinition Width="130" />
                                    </Grid.ColumnDefinitions>
                                    <dxe:TextEdit Text=" " Width="{Binding UsablePageWidth}" Grid.ColumnSpan="3" IsPrintingMode="True" Background="#333E5E" HorizontalAlignment="Stretch" 
                                                  VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" FontWeight="Bold" Style="{DynamicResource TextEdit20Style}" Height="50" />
                                    <dxe:TextEdit Text="{DynamicResource ReportDashboardHeader}" IsPrintingMode="True" HorizontalAlignment="Stretch" 
                                                  VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" FontWeight="Bold" Style="{DynamicResource TextEdit20Style}" />
                                    <Image Source="/Emdep.Geos.Modules.Crm;component/Assets/Images/GeosReportLogo.png" Height="50" Width="80" dxp:ExportSettings.TargetType="Image" Grid.Column="2" />
                                </Grid>
                            </DataTemplate>
                            <DataTemplate x:Key="PageFooter">
                                <dxe:TextEdit HorizontalContentAlignment="Center" 
                                              Width="{Binding Path=UsablePageWidth, Mode=OneWay}" 
                                              dxp:ExportSettings.TargetType="PageNumber" 
                                              dxp:PageNumberExportSettings.Kind="NumberOfTotal" 
                                              dxp:PageNumberExportSettings.Format="Page {0} of {1}">
                                </dxe:TextEdit>
                            </DataTemplate>
                        </dxg:TableView.Resources>
                    </dxg:TableView>
                </dxg:GridControl.View>
            </UIHelper:MyGridControl>

        </Grid>
    </DockPanel>
</UserControl>

