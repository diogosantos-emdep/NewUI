<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Crm.Views.AddActivityView"
                         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                         xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                         xmlns:local="clr-namespace:Emdep.Geos.Modules.Crm.Views"
                         xmlns:dxdo="http://schemas.devexpress.com/winfx/2008/xaml/docking"
                         xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
                         xmlns:dxefl="clr-namespace:DevExpress.Xpf.Editors.Flyout.Native;assembly=DevExpress.Xpf.Core.v19.2"
                         xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
                         xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
                         xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
                         xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
                         xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                         xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
                         xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                         xmlns:sys="clr-namespace:System;assembly=mscorlib"
                         xmlns:ve="http://schemas.devexpress.com/winfx/2008/xaml/docking/visualelements"
                         xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
                         xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
                         xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
                         xmlns:Validation="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
                         xmlns:dxre="http://schemas.devexpress.com/winfx/2008/xaml/richedit"
                         xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
                         mc:Ignorable="d" 
                          Height="760" Width="870"  
                         Title="{DynamicResource ActivityAddViewHeader}"
                         TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}"
                         Style="{DynamicResource WinUIDialogWindowStyle}">

    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding AddActivityViewCancelButtonCommand}" />
    </dxwui:WinUIDialogWindow.InputBindings>

    <dxwui:WinUIDialogWindow.Resources>
        <Style TargetType="{x:Type ve:AutoHideTray}">
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <ve:psvStackPanel HorizontalAlignment="Right" />
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ComboBoxEditReadOnlyStyle" TargetType="{x:Type dxe:ComboBoxEdit}">
            <Style.Triggers>
                <Trigger Property="IsReadOnly" Value="False">
                    <!--<Setter Property="BorderTemplate" Value="{StaticResource borderTemplate}" />-->
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="IsHitTestVisible" Value="False" />
                    <!--<Setter Property="Focusable" Value="True" />-->
                </Trigger>
            </Style.Triggers>
        </Style>

        <UIConverter:BytesToKilobytesConverter x:Key="BytesToKilobytesConverter" />
        <UIConverter:InvertedVisibilityConverter x:Key="InvertedVisibilityConverter" />
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
        <UIConverter:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />

        <dxre:PlainTextToContentConverter x:Key="PlainTextToContentConverter" />
        <dxre:RtfToContentConverter x:Key="rtfToContentConverter" />


        <dxmvvm:ObjectToObjectConverter x:Key="NodeLevelValueToBooleanConverter" DefaultTarget="False">
            <dxmvvm:MapItem Source="0" Target="True" />
        </dxmvvm:ObjectToObjectConverter>
        <Style x:Key="myGroupBoxStyle" TargetType="{x:Type dxlc:GroupBox}">
            <Setter Property="MaximizeElementVisibility" Value="Visible" />
            <Setter Property="Width" Value="250" />
            <Setter Property="Height" Value="140" />
        </Style>

        <UIConverter:DateFormatConverter x:Key="DateFormatConverter" />
        <sys:String x:Key="ShortDateTimeFormat">dd/MM/yyyy hh:mm tt</sys:String>
        <sys:String x:Key="ShortTimeFormat">hh:mm tt</sys:String>
        <sys:String x:Key="ShortDateFormat">dd/MM/yyyy</sys:String>
    </dxwui:WinUIDialogWindow.Resources>

    <ScrollViewer>
        <DockPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <Grid Height="{Binding WindowHeight,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="40" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300" />
                    <ColumnDefinition Width="{Binding ColumnMainWidth,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                </Grid.ColumnDefinitions>

                <dxlc:FlowLayoutControl Orientation="Vertical" ItemSpace="12" LayerSpace="12" Background="Transparent"                             
                              AllowMaximizedElementMoving="False" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" 
                                BreakFlowToFit="True" MaximizedElementPosition="Right">
                    <dxmvvm:Interaction.Behaviors>
                        <UIHelper:FlowLayoutControlForMinimiseMaximise />
                    </dxmvvm:Interaction.Behaviors>

                    <!--Information-->
                    <dxlc:GroupBox Style="{StaticResource myGroupBoxStyle}">
                        <dxlc:GroupBox.HeaderTemplate>
                            <DataTemplate>
                                <DockPanel Margin="-5,0,0,0">
                                    <TextBlock Margin="0,0,0,0"
                                    VerticalAlignment="Center"
                                    FontWeight="Bold"
                                    Text="{DynamicResource NewActivityInformation}" />

                                    <dxe:TextEdit Text="{DynamicResource EditActivityInformation}" FontWeight="Bold" HorizontalAlignment="Right" VerticalAlignment="Center" ShowBorder="False" IsReadOnly="True">
                                        <Binding Path="DataContext.AddActivityError" RelativeSource="{RelativeSource FindAncestor, AncestorType=dxlc:GroupBox}" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" ValidatesOnDataErrors="True">
                                            <Binding.ValidationRules>
                                                <Validation:ActivityValidation FieldName="AddActivityError" ValidationStep="UpdatedValue" />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </dxe:TextEdit>
                                </DockPanel>
                            </DataTemplate>
                        </dxlc:GroupBox.HeaderTemplate>


                        <dxlc:GroupBox.ContentTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="0" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="18" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <!--Type-->
                                    <Label Content="{DynamicResource EditActivityType}" FontWeight="Bold" Grid.Column="0" HorizontalAlignment="Left" 
                                       />
                                    <Image Grid.Row="0" Grid.Column="1" Width="15" Height="15" Margin="3,0,0,0">
                                        <Image.Style>
                                            <Style>
                                                <Style.Triggers>
                                                    <!-- Appoinment !-->
                                                    <DataTrigger Binding="{Binding DataContext.SelectedActivityType.IdImage, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Value="1">
                                                        <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeAppointmentImageStyle}" />
                                                    </DataTrigger>
                                                    <!-- Call !-->
                                                    <DataTrigger Binding="{Binding DataContext.SelectedActivityType.IdImage, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Value="2">
                                                        <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeCallImageStyle}" />
                                                    </DataTrigger>
                                                    <!-- Email !-->
                                                    <DataTrigger Binding="{Binding DataContext.SelectedActivityType.IdImage, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Value="3">
                                                        <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeEmailImageStyle}" />
                                                    </DataTrigger>
                                                    <!-- Task !-->
                                                    <DataTrigger Binding="{Binding DataContext.SelectedActivityType.IdImage, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Value="4">
                                                        <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeTaskImageStyle}" />
                                                    </DataTrigger>
                                                    <!-- Information !-->
                                                    <DataTrigger Binding="{Binding DataContext.SelectedActivityType.IdImage, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Value="5">
                                                        <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeInformationImageStyle}" />
                                                    </DataTrigger>
                                                    <!-- Planned Appointment !-->
                                                    <DataTrigger Binding="{Binding DataContext.SelectedActivityType.IdImage, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Value="6">
                                                        <Setter Property="Image.Source" Value="{DynamicResource ActivityTypePlannedAppointmentImageStyle}" />

                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Image.Style>
                                    </Image>

                                    <TextBlock Text="{Binding DataContext.SelectedActivityType.Value, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                           Grid.Column="2" Grid.Row="0" Margin="5,0,0,0" Padding="2"
                                           HorizontalAlignment="Left" VerticalAlignment="Center" />

                                    <!--Subject-->
                                    <Label Content="{DynamicResource EditActivitySubject}" FontWeight="Bold" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Left" 
                                       />
                                    <TextBlock Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Margin="3,0,0,0" Padding="2"
                                           HorizontalAlignment="Left" VerticalAlignment="Stretch" TextWrapping="Wrap"
                                           Text="{Binding DataContext.Subject, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                    <!--From date-->
                                    <!--
                                <Label Content= "{DynamicResource EditActivityFrom}" FontWeight="Bold" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <dxe:TextEdit Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" Margin="3,0,0,0" Padding="2" Text="{Binding DataContext.FromDate, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              Style="{DynamicResource TextEditStyle}"
                                              Mask="{StaticResource ShortDateTimeFormat}" MaskType="DateTime" MaskUseAsDisplayFormat="True" IsPrintingMode="True" 
                                              Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                                -->
                                    <!--To date-->
                                    <!--
                                <Label Content= "{DynamicResource EditActivityTo}" FontWeight="Bold" Grid.Row="3" Grid.Column="0" HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <dxe:TextEdit Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2" Margin="3,0,0,0" Padding="2" Text="{Binding DataContext.ToDate, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              Style="{DynamicResource TextEditStyle}"
                                              Mask="{StaticResource ShortDateTimeFormat}" MaskType="DateTime" MaskUseAsDisplayFormat="True" IsPrintingMode="True"
                                              Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>-->

                                    <!--Due date-->
                                    <Label Content="{DynamicResource ActivityDueDate}" FontWeight="Bold" Grid.Row="4" Grid.Column="0" HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsDueDateVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <dxe:TextEdit Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" Margin="3,0,0,0" Padding="2" 
                                              Text="{Binding DataContext.DueDate, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              Style="{DynamicResource TextEditStyle}"
                                              Mask="{StaticResource ShortDateFormat}" MaskType="DateTime" MaskUseAsDisplayFormat="True" IsPrintingMode="True" 
                                              Visibility="{Binding DataContext.IsDueDateVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                </Grid>

                            </DataTemplate>
                        </dxlc:GroupBox.ContentTemplate>
                        <dxlc:GroupBox.MaximizedContentTemplate>
                            <DataTemplate>
                                <ScrollViewer ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto">
                                    <Grid Margin="0 0 0 0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                            <!--10-->
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="70" />
                                            <ColumnDefinition Width="25" />
                                            <ColumnDefinition Width="130" />
                                            <ColumnDefinition Width="50" />
                                            <ColumnDefinition Width="70" />
                                            <ColumnDefinition Width="160" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <!--Type-->
                                        <Label Content="{DynamicResource NewActivityType}" Grid.Row="0" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        HorizontalAlignment="Left" 
                                       />
                                        <dxe:ComboBoxEdit Grid.Row="0" Grid.Column="2" 
                                                  Grid.ColumnSpan="2"
                                                  Height="26" 
                                                  IsTextEditable="False"
                                                  ApplyItemTemplateToSelectedItem="True" 
                                                  HorizontalAlignment="Stretch"
                                                  ItemsSource="{Binding DataContext.TypeList, Mode=TwoWay, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox},UpdateSourceTrigger=PropertyChanged}" 
                                                  SelectedItem="{Binding DataContext.SelectedActivityType, Mode=TwoWay, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox},UpdateSourceTrigger=PropertyChanged}"
                                                  DisplayMember="Value" ValueMember="IdLookupValue"
                                                  >
                                            <dxe:ComboBoxEdit.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image Margin="5 0" Height="15" Width="15">
                                                            <Image.Style>
                                                                <Style>
                                                                    <Style.Triggers>
                                                                        <!-- Appoinment !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="1">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeAppointmentImageStyle}" />
                                                                        </DataTrigger>
                                                                        <!-- Call !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="2">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeCallImageStyle}" />
                                                                        </DataTrigger>
                                                                        <!-- Email !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="3">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeEmailImageStyle}" />
                                                                        </DataTrigger>
                                                                        <!-- Task !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="4">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeTaskImageStyle}" />
                                                                        </DataTrigger>
                                                                        <!-- Information !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="5">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityTypeInformationImageStyle}" />
                                                                        </DataTrigger>
                                                                        <!-- Planned Appointment !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="6">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityTypePlannedAppointmentImageStyle}" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Image.Style>
                                                        </Image>
                                                        <TextBlock Text="{Binding Value}" Margin="5 0" />
                                                    </StackPanel>
                                                </DataTemplate>

                                            </dxe:ComboBoxEdit.ItemTemplate>
                                            <dxe:ComboBoxEdit.SelectedIndex>
                                                <Binding Path="DataContext.SelectedIndexType" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                    <Binding.ValidationRules>
                                                        <Validation:ActivityValidation FieldName="SelectedIndexType" ValidationStep="UpdatedValue" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:ComboBoxEdit.SelectedIndex>
                                            <dxmvvm:Interaction.Behaviors>
                                                <dxmvvm:EventToCommand Command="{Binding DataContext.TypeSelectedIndexChangedCommand,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                               EventName="SelectedIndexChanged"
                                                               PassEventArgsToCommand="True">
                                                </dxmvvm:EventToCommand>
                                            </dxmvvm:Interaction.Behaviors>
                                        </dxe:ComboBoxEdit>

                                        <!--Internal-->
                                        <Label Grid.Row="0" Grid.Column="4" Margin="5 5 0 0"
                                       Content="{DynamicResource ActivityInternal}" HorizontalAlignment="Left" 
                                       VerticalAlignment="Center" Visibility="{Binding DataContext.IsInternalVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <dxe:ToggleSwitch Grid.Row="0" Grid.Column="5" HorizontalAlignment="Left" VerticalAlignment="Center" ContentPlacement="Inside"  
                                        CheckedStateContent="On" UncheckedStateContent="Off" 
                                        ToggleSwitchWidth="50" ToggleSwitchHeight="22" IsThreeState="False"
                                        IsEnabled="{Binding DataContext.IsInternalEnable,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        IsChecked="{Binding DataContext.IsInternal,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                        Visibility="{Binding DataContext.IsInternalVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                                        <!--<dxe:CheckEdit Grid.Row="0" Grid.Column="5" x:Name="chkInternal" FlowDirection="RightToLeft"
                                               Content="{DynamicResource ActivityInternal}" VerticalAlignment="Center"
                                               HorizontalAlignment="Left" IsEnabled="{Binding DataContext.IsInternalEnable,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                               IsChecked="{Binding DataContext.IsInternal,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                               Visibility="{Binding DataContext.IsInternalVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    </dxe:CheckEdit>-->
                                        <!--Group-->
                                        <Label Grid.Column="0"
                                        Grid.Row="1"
                                        Grid.ColumnSpan="2"
                                        Content="{DynamicResource NewActivityGroup}" 
                                        HorizontalAlignment="Left" 
                                       Margin="0 5 0 0"
                                       Visibility="{Binding DataContext.IsAccountVisible, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox} ,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />


                                        <dxe:ComboBoxEdit x:Name="editorGroup"  
                                                  Grid.Column="2" 
                                                  Grid.Row="1"
                                                  Grid.ColumnSpan="4"
                                                  Margin="0 5 0 0"
                                                  HorizontalAlignment="Stretch"
                                                  VerticalAlignment="Top" 
                                                  ItemsSource="{Binding DataContext.CompanyGroupList, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox} }" 
                                                  Visibility="{Binding DataContext.IsAccountVisible, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox} ,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  DisplayMember="CustomerName" AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True" IsTextEditable="False"
                                                  ValidateOnTextInput="False"
                                                   IsReadOnly="{Binding DataContext.IsAddedFromOutSide, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox} ,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">

                                            <dxe:ComboBoxEdit.SelectedIndex>
                                                <Binding Path="DataContext.SelectedIndexCompanyGroup" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                    <Binding.ValidationRules>
                                                        <Validation:RequiredValidationRule FieldName="SelectedIndexCompanyGroup" ValidationStep="UpdatedValue" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:ComboBoxEdit.SelectedIndex>
                                        </dxe:ComboBoxEdit>
                                        <!--Plant-->
                                        <Label Grid.Column="0"
                                        Grid.Row="2"
                                        Grid.ColumnSpan="2"
                                        Content="{DynamicResource NewActivityPlant}"
                                        HorizontalAlignment="Left" 
                                       Margin="5 5 0 0"
                                       Visibility="{Binding DataContext.IsAccountVisible, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox} ,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />


                                        <dxe:ComboBoxEdit x:Name="cmbSite" 
                                                   Grid.Column="2" 
                                                  Grid.Row="2"
                                                  Grid.ColumnSpan="4"
                                                  Margin="0 5 0 0"
                                                  HorizontalAlignment="Stretch"
                                                  VerticalAlignment="Top" 
                                                  AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True" IsTextEditable="False"
                                                  ValidateOnTextInput="False"
                                                   ItemsSource="{Binding DataContext.CompanyPlantList, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox},UpdateSourceTrigger=PropertyChanged}" 
                                                   Visibility="{Binding DataContext.IsAccountVisible, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox} ,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  DisplayMember="Name" IsSynchronizedWithCurrentItem="True" IsReadOnly="{Binding DataContext.IsAddedFromOutSide, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox} ,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">

                                            <dxe:ComboBoxEdit.SelectedIndex>
                                                <Binding Path="DataContext.SelectedIndexCompanyPlant" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                    <Binding.ValidationRules>
                                                        <Validation:RequiredValidationRule FieldName="SelectedIndexCompanyPlant" ValidationStep="UpdatedValue" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:ComboBoxEdit.SelectedIndex>

                                            <!--<dxmvvm:Interaction.Behaviors>
                                        <dxmvvm:EventToCommand EventName="SelectedIndexChanged"
                                                               Command="{Binding DataContext.SelectedItemChangedCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" CommandParameter="{Binding ElementName=cmbSite, Path=SelectedIndexChanged}" UseDispatcher="True" />
                                    </dxmvvm:Interaction.Behaviors>-->

                                        </dxe:ComboBoxEdit>

                                        <!--Subject-->
                                        <Label Content="{DynamicResource NewActivitySubject}" Grid.Row="3" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        HorizontalAlignment="Left" 
                                       Margin="0 5 0 0"
                                       />
                                        <dxe:TextEdit Text="{Binding DataContext.Subject,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" 
                                              Height="30" Margin="0 5 0 0"
                                              MaxLength="100" TextWrapping="Wrap"
                                              Grid.Row="3" Grid.Column="2" Grid.ColumnSpan="4"
                                              HorizontalAlignment="Stretch">
                                            <dxe:TextEdit.EditValue>
                                                <Binding Path="DataContext.Subject" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                    <Binding.ValidationRules>
                                                        <Validation:ActivityValidation FieldName="Subject" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:TextEdit.EditValue>
                                        </dxe:TextEdit>
                                        <!--Tag-->
                                        <Label Content="{DynamicResource NewActivityTag}" Grid.Row="4" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        HorizontalAlignment="Left" 
                                       Margin="0 5 0 0"
                                       Visibility="{Binding DataContext.IsTagVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                       />
                                        <Grid Height="50" Margin="0 5 0 0" VerticalAlignment="Stretch"
                                              Grid.Row="4" Grid.Column="2" Grid.ColumnSpan="4" HorizontalAlignment="Stretch" Visibility="{Binding DataContext.IsTagVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="auto" />
                                            </Grid.ColumnDefinitions>
                                            <dxe:ComboBoxEdit x:Name="editor" 
                                                      HorizontalAlignment="Stretch"
                                                    EditValue="{Binding DataContext.SelectedTagList,RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}},UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                    ItemsSource="{Binding DataContext.TagList,RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}},UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                    DisplayMember="Name"
                                                    AllowDefaultButton="True" 
                                                    AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"
                                                    Style="{DynamicResource ComboBoxEditStyle}" Visibility="{Binding DataContext.IsTagVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                <dxe:ComboBoxEdit.StyleSettings>
                                                    <dxe:TokenComboBoxStyleSettings NewTokenPosition="Far" EnableTokenWrapping="True" />
                                                </dxe:ComboBoxEdit.StyleSettings>
                                            </dxe:ComboBoxEdit>
                                            <Border Grid.Column="1" Margin="10 0 0 0" VerticalAlignment="Center">
                                                <ContentControl>
                                                    <Image x:Name="AddTag"
                                                Width="20"
                                                Height="20"                                                       
                                                Visibility="{Binding DataContext.AddTagVisibility,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type dxlc:GroupBox}}}"
                                                IsEnabled="{Binding DataContext.IsControlEnable,Mode=OneTime, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Top"
                                                DataContext="{Binding DataContext,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                Style="{DynamicResource AddCustomerButtonImageStyle}">
                                                        <Image.ToolTip>
                                                            <StackPanel>
                                                                <TextBlock HorizontalAlignment="Stretch" Text="{DynamicResource NewActivityNewTag}" />
                                                            </StackPanel>
                                                        </Image.ToolTip>
                                                    </Image>
                                                    <dxmvvm:Interaction.Behaviors>
                                                        <dxmvvm:EventToCommand Command="{Binding DataContext.AddTagButtonCommand ,  RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                    EventName="MouseLeftButtonUp"
                                                    PassEventArgsToCommand="True" />
                                                    </dxmvvm:Interaction.Behaviors>
                                                </ContentControl>
                                            </Border>
                                        </Grid>
                                        <!--Description-->
                                        <Label Content="{DynamicResource NewActivityDescription}" Grid.Row="5" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        HorizontalAlignment="Left" 
                                       Margin="0 5 0 0"
                                       />
                                        <dxe:TextEdit Text="{Binding DataContext.Description, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              Grid.Row="5" Grid.Column="2" Grid.ColumnSpan="4"
                                              HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                              VerticalScrollBarVisibility="Visible"
                                              VerticalContentAlignment="Top"
                                              HorizontalContentAlignment="Stretch" 
                                              Height="65" Margin="0 5 0 0"
                                              AcceptsReturn="True" MaxLength="500" TextWrapping="Wrap"
                                              >
                                            <dxe:TextEdit.EditValue>
                                                <Binding Path="DataContext.Description" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True">
                                                    <Binding.ValidationRules>
                                                        <Validation:ActivityValidation FieldName="Description" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:TextEdit.EditValue>
                                        </dxe:TextEdit>

                                        <!--ToDate,FromDate & StartTime,EndTime Commented-->
                                        <!--FromDate-->
                                        <!--
                                <Label Content= "{DynamicResource NewActivityFrom}" Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Left" Margin="0 5 0 0" 
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <dxe:DateEdit Grid.Row="4" Grid.Column="2" 
                                                Margin="0 5 0 0"
                                                ShowClearButton="False" ShowToday="True"
                                                Mask="{Binding CultureInfo.CurrentCulture.DateTimeFormat.YearMonthPattern}" MaskUseAsDisplayFormat="True"
                                                HorizontalAlignment="Stretch"  VerticalAlignment="Top" IsTextEditable="False" 
                                               
                                                HorizontalContentAlignment="Right" InvalidValueBehavior="AllowLeaveEditor"
                                              Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <dxe:DateEdit.EditValue>
                                        <Binding Path="DataContext.FromDate" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                            <Binding.ValidationRules>
                                                <Validation:ActivityValidation FieldName="FromDate"/>
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </dxe:DateEdit.EditValue>
                                </dxe:DateEdit>
                                -->
                                        <!--FromDates / Start time-->
                                        <!--
                                <Label Content= "{DynamicResource NewActivityStart}" Grid.Row="4" Grid.Column="3" HorizontalAlignment="Center" Margin="0 5 0 0" 
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <dxe:ComboBoxEdit Grid.Row="4" Grid.Column="4" Height="25" VerticalAlignment="Top" Margin="0 5 0 0"
                                                    IsEnabled="{Binding DataContext.InvertIsAllDayEvent,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                    ItemsSource="{Binding DataContext.FromDates, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" 
                                                    MaskType="DateTimeAdvancingCaret" Mask="{Binding DataContext.TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged , RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                  DisplayFormatString="{Binding DataContext.TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged , RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" 
                                                   Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <dxe:ComboBoxEdit.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={StaticResource DateFormatConverter}}"/>
                                        </DataTemplate>
                                    </dxe:ComboBoxEdit.ItemTemplate>
                                    <dxe:ComboBoxEdit.SelectedItem>
                                        <Binding Path="DataContext.StartTime" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                            <Binding.ValidationRules>
                                                <Validation:ActivityValidation FieldName="StartTime" ValidationStep="UpdatedValue" />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </dxe:ComboBoxEdit.SelectedItem>
                                </dxe:ComboBoxEdit>

                                -->
                                        <!--ToDate-->
                                        <!--
                                <Label Content= "{DynamicResource NewActivityTo}" Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Left" Margin="0 5 0 0"
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <dxe:DateEdit Grid.Row="5" Grid.Column="2" 
                                                Margin="0 5 0 0" ShowClearButton="False" ShowToday="True"
                                                Mask="{Binding CultureInfo.CurrentCulture.DateTimeFormat.YearMonthPattern}" MaskUseAsDisplayFormat="True"
                                                HorizontalAlignment="Stretch" VerticalAlignment="Top" IsTextEditable="False" 
                                              
                                                HorizontalContentAlignment="Right" InvalidValueBehavior="AllowLeaveEditor"
                                                ValidateOnEnterKeyPressed="True" ValidateOnTextInput="True"
                                                Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <dxe:DateEdit.EditValue>
                                        <Binding Path="DataContext.ToDate" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay"
                                                 ValidatesOnDataErrors="True" >
                                            <Binding.ValidationRules>
                                                <Validation:ActivityValidation FieldName="ToDate"/>
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </dxe:DateEdit.EditValue>
                                </dxe:DateEdit>

                                -->
                                        <!--ToDates / End time-->
                                        <!--
                                <Label Content= "{DynamicResource NewActivityEnd}" Grid.Row="5" Grid.Column="3" HorizontalAlignment="Center" Margin="0 5 0 0"
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <dxe:ComboBoxEdit Grid.Row="5" Grid.Column="4" 
                                                  Height="25" VerticalAlignment="Top" Margin="0 5 0 0"
                                                  IsEnabled="{Binding DataContext.InvertIsAllDayEvent,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                  ItemsSource="{Binding DataContext.ToDates, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" 
                                                  MaskType="DateTimeAdvancingCaret" Mask="{Binding DataContext.TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged , RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                  DisplayFormatString="{Binding DataContext.TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged , RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" 
                                                  Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <dxe:ComboBoxEdit.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={StaticResource DateFormatConverter}}"/>
                                        </DataTemplate>
                                    </dxe:ComboBoxEdit.ItemTemplate>
                                    <dxe:ComboBoxEdit.SelectedItem>
                                        <Binding Path="DataContext.EndTime" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                            <Binding.ValidationRules>
                                                <Validation:ActivityValidation FieldName="EndTime" ValidationStep="UpdatedValue" />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </dxe:ComboBoxEdit.SelectedItem>
                                </dxe:ComboBoxEdit>

                                -->
                                        <!--All Day Event-->
                                        <!--
                                <dxe:CheckEdit Grid.Row="4" Grid.Column="5" x:Name="chkAllDay" 
                                               Content="{DynamicResource NewActivityAllDayEvent}"
                                               Margin="5 5 0 0" HorizontalAlignment="Left" 
                                               IsChecked="{Binding DataContext.IsAllDayEvent,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                               Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                </dxe:CheckEdit>-->

                                        <!--Activity Address-->
                                        <Label Content="{DynamicResource NewActivityLocation}" Grid.Row="8" Grid.Column="0"
                                        HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <Image Grid.Row="8" Grid.Column="1" Height="24" Width="24" HorizontalAlignment="Right" 
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <Image.Style>
                                                <Style>
                                                    <Setter Property="Image.Source" Value="{DynamicResource MapLocationImageStyle}" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.IsCoordinatesNull, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" Value="True">
                                                            <Setter Property="Image.Source" Value="/Emdep.Geos.Modules.Crm;component/Assets/Images/gMapLocationSelected.png" />
                                                            <Setter Property="Image.ToolTip" Value="{DynamicResource EditContactViewSetLocation}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding DataContext.IsCoordinatesNull, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" Value="False">
                                                            <Setter Property="Image.ToolTip" Value="{DynamicResource EditContactViewSetLocation}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Image.Style>
                                            <Image.InputBindings>
                                                <MouseBinding Gesture="LeftClick" Command="{Binding DataContext.SearchButtonClickCommand, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" />
                                            </Image.InputBindings>
                                        </Image>
                                        <dxe:TextEdit Text="{Binding DataContext.ActivityAddress,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Grid.Row="8" Grid.Column="2" Grid.ColumnSpan="4"
                                              Margin="0 5 0 0"
                                              HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                              AcceptsReturn="True" MaxLength="200"
                                              TextWrapping="Wrap"
                                              Height="80"
                                              VerticalScrollBarVisibility="Visible"
                                              >
                                            <dxe:TextEdit.EditValue>
                                                <Binding Path="DataContext.ActivityAddress" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                    <Binding.ValidationRules>
                                                        <Validation:ActivityValidation FieldName="ActivityAddress" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:TextEdit.EditValue>
                                        </dxe:TextEdit>

                                        <!--Attendies-->
                                        <Label Content="{DynamicResource NewActivityAttendies}" Grid.Row="9" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        Margin="0 5 0 0"
                                       HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <GroupBox Margin="0 5 0 0" Grid.Row="9" Grid.Column="2" Grid.ColumnSpan="4" Height="226" 
                                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                          Visibility="{Binding DataContext.IsAppointmentVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <dxdo:DockLayoutManager Margin="-10" Name="dockManager1">
                                                <dxdo:LayoutGroup x:Name="RootGroup" Orientation="Horizontal">
                                                    <dxdo:LayoutPanel x:Name="ContactList"
                                                              AllowHide="False" AllowClose="False" 
                                                              ShowPinButton="False"
                                                              SnapsToDevicePixels="True">

                                                        <dxe:ListBoxEdit ItemsSource="{Binding DataContext.SelectedAttendiesList,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,ValidatesOnDataErrors=True}" 
                                                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                            <dxe:ListBoxEdit.ItemTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel Orientation="Horizontal" Background="{DynamicResource SelectedItemBackgroud}">
                                                                        <TextBlock HorizontalAlignment="Stretch" Background="{DynamicResource SelectedItemBackgroud}"
                                                                           Style="{DynamicResource TextBlock14Style}"
                                                                           Text="{Binding Path=FullName}" />
                                                                        <dxe:ButtonEdit HorizontalAlignment="Center" VerticalAlignment="Center"
                                                                                HorizontalContentAlignment="Center" VerticalContentAlignment="Center" 
                                                                                ShowText="False" ShowBorder="False"
                                                                                AllowDefaultButton="False"
                                                                                Margin="4 2 2 2">
                                                                            <dxe:ButtonEdit.Buttons>
                                                                                <dxe:ButtonInfo GlyphKind="Cancel">
                                                                                    <dxmvvm:Interaction.Behaviors>
                                                                                        <dxmvvm:EventToCommand Command="{Binding DataContext.AttendeeCancelCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                                       EventName="Click"
                                                                                                       CommandParameter="{Binding Path=.}" />
                                                                                    </dxmvvm:Interaction.Behaviors>
                                                                                </dxe:ButtonInfo>
                                                                            </dxe:ButtonEdit.Buttons>
                                                                        </dxe:ButtonEdit>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </dxe:ListBoxEdit.ItemTemplate>
                                                            <dxe:ListBoxEdit.ItemsPanel>
                                                                <ItemsPanelTemplate>
                                                                    <WrapPanel />
                                                                </ItemsPanelTemplate>
                                                            </dxe:ListBoxEdit.ItemsPanel>
                                                            <dxe:ListBoxEdit.EditValue>
                                                                <Binding Path="DataContext.AttendeesCount" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                                    <Binding.ValidationRules>
                                                                        <Validation:ActivityValidation FieldName="AttendeesCount" />
                                                                    </Binding.ValidationRules>
                                                                </Binding>
                                                            </dxe:ListBoxEdit.EditValue>
                                                        </dxe:ListBoxEdit>
                                                    </dxdo:LayoutPanel>
                                                </dxdo:LayoutGroup>
                                                <dxdo:DockLayoutManager.AutoHideGroups>
                                                    <dxdo:AutoHideGroup DockType="Bottom">
                                                        <dxdo:LayoutPanel x:Name="AddAttendee" AllowClose="False" AllowDrag="False" AllowContextMenu="False" AllowFloat="False" AllowSizing="False" 
                                                                  Caption="{DynamicResource ActivityAddAttendee}">
                                                            <dxg:GridControl x:Name="CustomerContacts"
                                                                     DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                     EnableSmartColumnsGeneration="True" 
                                                                     ItemsSource="{Binding AttendiesList}">
                                                                <dxg:GridColumn AllowEditing="False" FieldName="FullName" FilterPopupMode="CheckedList" />
                                                                <dxg:GridControl.View>
                                                                    <dxg:TableView x:Name="tablePeopleContact"
                                                                            FadeSelectionOnLostFocus="False"
                                                                            AllowBestFit="True"
                                                                            AutoWidth="True"
                                                                            EnableImmediatePosting="True"
                                                                            HorizontalScrollbarVisibility="Auto"
                                                                            IndicatorWidth="25"
                                                                            NavigationStyle="Row"
                                                                            ShowGroupPanel="False"
                                                                            ShowIndicator="False"
                                                                            ShowSearchPanelMode="Default"
                                                                            ShowAutoFilterRow="True"
                                                                            VerticalScrollbarVisibility="Auto"
                                                                            SearchPanelHorizontalAlignment="Stretch"
                                                                            ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                    </dxg:TableView>
                                                                </dxg:GridControl.View>
                                                                <dxmvvm:Interaction.Behaviors>
                                                                    <dxmvvm:EventToCommand Command="{Binding DataContext.AddAttendeeRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                   PassEventArgsToCommand="True">
                                                                        <dxmvvm:EventToCommand.EventArgsConverter>
                                                                            <dx:EventArgsToDataRowConverter />
                                                                        </dxmvvm:EventToCommand.EventArgsConverter>
                                                                    </dxmvvm:EventToCommand>
                                                                </dxmvvm:Interaction.Behaviors>
                                                            </dxg:GridControl>
                                                        </dxdo:LayoutPanel>
                                                    </dxdo:AutoHideGroup>
                                                </dxdo:DockLayoutManager.AutoHideGroups>
                                            </dxdo:DockLayoutManager>
                                        </GroupBox>

                                        <!--Watchers-->
                                        <Label Content="{DynamicResource NewActivityWatchers}" Grid.Row="9" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        Margin="0 5 0 0"
                                       HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsWatcherVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <GroupBox Margin="0 5 0 0" Grid.Row="9" Grid.Column="2" Grid.ColumnSpan="4" Height="226" 
                                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                          Visibility="{Binding DataContext.IsWatcherVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <dxdo:DockLayoutManager Margin="-10" Name="dockManager3">
                                                <dxdo:LayoutGroup x:Name="RootGroup2" Orientation="Horizontal">
                                                    <dxdo:LayoutPanel x:Name="WatchersList"
                                                              AllowHide="False" AllowClose="False" 
                                                              ShowPinButton="False"
                                                              SnapsToDevicePixels="True">

                                                        <dxe:ListBoxEdit ItemsSource="{Binding DataContext.SelectedWatchersList,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,ValidatesOnDataErrors=True}" 
                                                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                                            <dxe:ListBoxEdit.ItemTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel Orientation="Horizontal" Background="{DynamicResource SelectedItemBackgroud}">
                                                                        <TextBlock HorizontalAlignment="Stretch" Background="{DynamicResource SelectedItemBackgroud}"
                                                                           Style="{DynamicResource TextBlock14Style}"
                                                                           Text="{Binding Path=FullName}" />
                                                                        <dxe:ButtonEdit HorizontalAlignment="Center" VerticalAlignment="Center"
                                                                                HorizontalContentAlignment="Center" VerticalContentAlignment="Center" 
                                                                                ShowText="False" ShowBorder="False"
                                                                                AllowDefaultButton="False"
                                                                                Margin="4 2 2 2">
                                                                            <dxe:ButtonEdit.Buttons>
                                                                                <dxe:ButtonInfo GlyphKind="Cancel">
                                                                                    <dxmvvm:Interaction.Behaviors>
                                                                                        <dxmvvm:EventToCommand Command="{Binding DataContext.WatchersCancelCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                                       EventName="Click"
                                                                                                       CommandParameter="{Binding Path=.}" />
                                                                                    </dxmvvm:Interaction.Behaviors>
                                                                                </dxe:ButtonInfo>
                                                                            </dxe:ButtonEdit.Buttons>
                                                                        </dxe:ButtonEdit>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </dxe:ListBoxEdit.ItemTemplate>
                                                            <dxe:ListBoxEdit.ItemsPanel>
                                                                <ItemsPanelTemplate>
                                                                    <WrapPanel />
                                                                </ItemsPanelTemplate>
                                                            </dxe:ListBoxEdit.ItemsPanel>
                                                            <dxe:ListBoxEdit.EditValue>
                                                                <Binding Path="DataContext.WatchersCount" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                                    <!--<Binding.ValidationRules>
                                                                <Validation:ActivityValidation FieldName="WatchersCount"/>
                                                            </Binding.ValidationRules>-->
                                                                </Binding>
                                                            </dxe:ListBoxEdit.EditValue>
                                                        </dxe:ListBoxEdit>
                                                    </dxdo:LayoutPanel>
                                                </dxdo:LayoutGroup>
                                                <dxdo:DockLayoutManager.AutoHideGroups>
                                                    <dxdo:AutoHideGroup DockType="Bottom">
                                                        <dxdo:LayoutPanel x:Name="AddWatchers" AllowClose="False" AllowDrag="False" AllowContextMenu="False" AllowFloat="False" AllowSizing="False" 
                                                                  Caption="{DynamicResource ActivityAddWatcher}" Visibility="{Binding DataContext.IsTaskVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                            <dxg:GridControl x:Name="WatchersContacts"
                                                                     DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                     EnableSmartColumnsGeneration="True" 
                                                                     ItemsSource="{Binding WatchersList}">
                                                                <dxg:GridColumn AllowEditing="False" FieldName="FullName" FilterPopupMode="CheckedList" />
                                                                <dxg:GridControl.View>
                                                                    <dxg:TableView x:Name="tableWatchersContact"
                                                                            FadeSelectionOnLostFocus="False"
                                                                            AllowBestFit="True"
                                                                            AutoWidth="True"
                                                                            EnableImmediatePosting="True"
                                                                            HorizontalScrollbarVisibility="Auto"
                                                                            IndicatorWidth="25"
                                                                            NavigationStyle="Row"
                                                                            ShowGroupPanel="False"
                                                                            ShowIndicator="False"
                                                                            ShowSearchPanelMode="Default"
                                                                            ShowAutoFilterRow="True"
                                                                            VerticalScrollbarVisibility="Auto"
                                                                            SearchPanelHorizontalAlignment="Stretch"
                                                                            ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                    </dxg:TableView>
                                                                </dxg:GridControl.View>
                                                                <dxmvvm:Interaction.Behaviors>
                                                                    <dxmvvm:EventToCommand Command="{Binding DataContext.AddWatchersRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                   PassEventArgsToCommand="True">
                                                                        <dxmvvm:EventToCommand.EventArgsConverter>
                                                                            <dx:EventArgsToDataRowConverter />
                                                                        </dxmvvm:EventToCommand.EventArgsConverter>
                                                                    </dxmvvm:EventToCommand>
                                                                </dxmvvm:Interaction.Behaviors>
                                                            </dxg:GridControl>
                                                        </dxdo:LayoutPanel>
                                                    </dxdo:AutoHideGroup>
                                                    <dxdo:AutoHideGroup DockType="Bottom">
                                                        <dxdo:LayoutPanel x:Name="AddUser" AllowClose="False" AllowDrag="False" AllowContextMenu="False" AllowFloat="False" AllowSizing="False" 
                                                                  Caption="{DynamicResource ActivityAddUser}" Visibility="{Binding DataContext.IsWatcherUserVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                            <dxg:GridControl x:Name="WatchersUsers"
                                                                     DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                     EnableSmartColumnsGeneration="True" 
                                                                     ItemsSource="{Binding WatchersList}">
                                                                <dxg:GridColumn AllowEditing="False" FieldName="FullName" FilterPopupMode="CheckedList" />
                                                                <dxg:GridControl.View>
                                                                    <dxg:TableView x:Name="tableWatchersUser"
                                                                            FadeSelectionOnLostFocus="False"
                                                                            AllowBestFit="True"
                                                                            AutoWidth="True"
                                                                            EnableImmediatePosting="True"
                                                                            HorizontalScrollbarVisibility="Auto"
                                                                            IndicatorWidth="25"
                                                                            NavigationStyle="Row"
                                                                            ShowGroupPanel="False"
                                                                            ShowIndicator="False"
                                                                            ShowSearchPanelMode="Default"
                                                                            ShowAutoFilterRow="True"
                                                                            VerticalScrollbarVisibility="Auto"
                                                                            SearchPanelHorizontalAlignment="Stretch"
                                                                            ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                    </dxg:TableView>
                                                                </dxg:GridControl.View>
                                                                <dxmvvm:Interaction.Behaviors>
                                                                    <dxmvvm:EventToCommand Command="{Binding DataContext.AddWatchersUserRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                   PassEventArgsToCommand="True">
                                                                        <dxmvvm:EventToCommand.EventArgsConverter>
                                                                            <dx:EventArgsToDataRowConverter />
                                                                        </dxmvvm:EventToCommand.EventArgsConverter>
                                                                    </dxmvvm:EventToCommand>
                                                                </dxmvvm:Interaction.Behaviors>
                                                            </dxg:GridControl>
                                                        </dxdo:LayoutPanel>
                                                    </dxdo:AutoHideGroup>
                                                    <dxdo:AutoHideGroup DockType="Bottom">
                                                        <dxdo:LayoutPanel x:Name="AddRegion" AllowClose="False" AllowDrag="False" AllowContextMenu="False" AllowFloat="False" AllowSizing="False" 
                                                                  Caption="{DynamicResource ActivityAddRegion}" Visibility="{Binding DataContext.IsWatcherRegionVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                            <dxg:GridControl x:Name="WatchersRegion"
                                                                     DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                     EnableSmartColumnsGeneration="True" 
                                                                     ItemsSource="{Binding WatchersRegionList}">
                                                                <dxg:GridColumn AllowEditing="False" FieldName="Value" Header="{DynamicResource ActivityAddRegionHeader}" FilterPopupMode="CheckedList" />
                                                                <dxg:GridControl.View>
                                                                    <dxg:TableView x:Name="tableWatchersRegion"
                                                                                FadeSelectionOnLostFocus="False"
                                                                            AllowBestFit="True"
                                                                            AutoWidth="True"
                                                                            EnableImmediatePosting="True"
                                                                            HorizontalScrollbarVisibility="Auto"
                                                                            IndicatorWidth="25"
                                                                            NavigationStyle="Row"
                                                                            ShowGroupPanel="False"
                                                                            ShowIndicator="False"
                                                                            ShowSearchPanelMode="Default"
                                                                            ShowAutoFilterRow="True"
                                                                            VerticalScrollbarVisibility="Auto"
                                                                            SearchPanelHorizontalAlignment="Stretch"
                                                                            ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                    </dxg:TableView>
                                                                </dxg:GridControl.View>
                                                                <dxmvvm:Interaction.Behaviors>
                                                                    <dxmvvm:EventToCommand Command="{Binding DataContext.AddWatchersRegionRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                   PassEventArgsToCommand="True">
                                                                        <dxmvvm:EventToCommand.EventArgsConverter>
                                                                            <dx:EventArgsToDataRowConverter />
                                                                        </dxmvvm:EventToCommand.EventArgsConverter>
                                                                    </dxmvvm:EventToCommand>
                                                                </dxmvvm:Interaction.Behaviors>
                                                            </dxg:GridControl>
                                                        </dxdo:LayoutPanel>
                                                    </dxdo:AutoHideGroup>
                                                </dxdo:DockLayoutManager.AutoHideGroups>
                                            </dxdo:DockLayoutManager>
                                        </GroupBox>
                                        <!--Watchers-->

                                        <!--DueDate for Email, Call, Task -->
                                        <Label Content="{DynamicResource ActivityDueDate}" Grid.Row="10" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        HorizontalAlignment="Left" 
                                       Margin="0 5 0 0"
                                       Visibility="{Binding DataContext.IsDueDateVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <dxe:DateEdit Grid.Row="10" Grid.Column="2"
                                              Margin="0 5 0 0" 
                                              Mask="{Binding CultureInfo.CurrentCulture.DateTimeFormat.YearMonthPattern}" MaskUseAsDisplayFormat="True"
                                              IsTextEditable="False" ShowClearButton="False"
                                              HorizontalAlignment="Stretch" VerticalAlignment="Top"
                                              HorizontalContentAlignment="Right" InvalidValueBehavior="AllowLeaveEditor"
                                              Visibility="{Binding DataContext.IsDueDateVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <dxe:DateEdit.EditValue>
                                                <Binding Path="DataContext.DueDate" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay"
                                                 ValidatesOnDataErrors="True">
                                                    <Binding.ValidationRules>
                                                        <Validation:ActivityValidation FieldName="DueDate" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:DateEdit.EditValue>
                                        </dxe:DateEdit>
                                        <!-- Status - only for Task -->
                                        <Label Content="{DynamicResource ActivityStatus}" Grid.Row="11" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        Margin="0 5 0 0"
                                       HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsTaskVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <dxe:ComboBoxEdit Grid.Row="11" Grid.Column="2" 
                                                  Margin="0 5 0 0"
                                                  Height="26" 
                                                  IsTextEditable="False"
                                                  ApplyItemTemplateToSelectedItem="True" 
                                                  HorizontalAlignment="Stretch"
                                                  ItemsSource="{Binding DataContext.TaskStatusList, Mode=TwoWay, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox},UpdateSourceTrigger=PropertyChanged}" 
                                                  DisplayMember="Value" ValueMember="IdLookupValue"
                                                  Visibility="{Binding DataContext.IsTaskVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <dxe:ComboBoxEdit.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image Margin="5 0" Height="15" Width="15">
                                                            <Image.Style>
                                                                <Style>
                                                                    <Style.Triggers>
                                                                        <!-- Not Started !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="1">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityStatusNotStarted}" />
                                                                        </DataTrigger>
                                                                        <!-- In Progress !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="2">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityStatusInProgress}" />
                                                                        </DataTrigger>
                                                                        <!-- Done !-->
                                                                        <DataTrigger Binding="{Binding IdImage}" Value="3">
                                                                            <Setter Property="Image.Source" Value="{DynamicResource ActivityStatusDone}" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Image.Style>
                                                        </Image>
                                                        <TextBlock Text="{Binding Value}" Margin="5 0" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </dxe:ComboBoxEdit.ItemTemplate>
                                            <dxe:ComboBoxEdit.SelectedIndex>
                                                <Binding Path="DataContext.SelectedIndexTaskStatus" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                    <Binding.ValidationRules>
                                                        <Validation:ActivityValidation FieldName="SelectedIndexTaskStatus" ValidationStep="UpdatedValue" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:ComboBoxEdit.SelectedIndex>
                                        </dxe:ComboBoxEdit>
                                        <!--Completed-->
                                        <Label Content="{DynamicResource ActivityCompleted}" Grid.Row="12" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        Margin="0 5 0 0"
                                       HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsCompletedVisible,  RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <dxe:CheckEdit Grid.Row="12" Grid.Column="2" Height="30" Margin="0 0 0 0" HorizontalAlignment="Left" VerticalAlignment="Top"
                                               IsChecked="{Binding DataContext.IsCompleted, Mode=TwoWay, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox},UpdateSourceTrigger=PropertyChanged}"
                                               
                                               Visibility="{Binding DataContext.IsCompletedVisible, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <dxe:CheckEdit.LayoutTransform>
                                                <ScaleTransform ScaleX="1.2" ScaleY="1.2" />
                                            </dxe:CheckEdit.LayoutTransform>
                                        </dxe:CheckEdit>
                                        <!--Owner-->
                                        <Label Content="{DynamicResource NewActivityOwner}" Grid.Row="13" Grid.Column="0"
                                        Grid.ColumnSpan="2"
                                        Margin="0 5 0 5"
                                       HorizontalAlignment="Left" 
                                       Visibility="{Binding DataContext.IsOwnerVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        <dxe:ComboBoxEdit Grid.Row="13" Grid.Column="2" 
                                                  Grid.ColumnSpan="2"
                                                  Margin="0 5 0 5"
                                                  HorizontalAlignment="Stretch"
                                                  VerticalAlignment="Top" 
                                                  Style="{DynamicResource ComboBoxEditStyle}"
                                                  DisplayMember="User.FullName"
                                                  ItemsSource="{Binding DataContext.ActivityOwnerList, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox},Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Visibility="{Binding DataContext.IsOwnerVisible,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                            <dxe:ComboBoxEdit.EditValue>
                                                <Binding Path="DataContext.SelectedActivityOwnerList" RelativeSource="{RelativeSource AncestorType=dxlc:GroupBox}" ValidatesOnDataErrors="True" 
                                                 UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                    <Binding.ValidationRules>
                                                        <Validation:ActivityValidation FieldName="SelectedActivityOwnerList" ValidationStep="UpdatedValue" />
                                                    </Binding.ValidationRules>
                                                </Binding>
                                            </dxe:ComboBoxEdit.EditValue>
                                            <dxe:ComboBoxEdit.StyleSettings>
                                                <dxe:CheckedComboBoxStyleSettings />
                                            </dxe:ComboBoxEdit.StyleSettings>
                                        </dxe:ComboBoxEdit>
                                        <!--Linked items-->
                                        <Grid Grid.Row="0" Grid.Column="6" Grid.RowSpan="14" VerticalAlignment="Stretch"
                                              >
                                            <dxlc:GroupBox Margin="5 5 0 0" Grid.Row="0" Grid.Column="0" Height="515" Width="{Binding DataContext.ColumnWidth,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                               HorizontalAlignment="Stretch" VerticalAlignment="Top">
                                                <dxlc:GroupBox.HeaderTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <TextBlock Text="{DynamicResource EditActivityLinkeditemsHeader}" FontWeight="Bold" VerticalAlignment="Center" />
                                                            <TextBlock Name="linkeditemCount1" Text="{Binding DataContext.SelectedActivityLinkedItems.Count, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" 
                                                           FontWeight="Bold" Margin="5 0 0 0" HorizontalAlignment="Left" VerticalAlignment="Center" />
                                                            <dxe:TextEdit Margin="5 0 0 0" Foreground="Transparent" ShowBorder="False" IsReadOnly="True">
                                                                <dxe:TextEdit.EditValue>
                                                                    <Binding Path="DataContext.SelectedAccountActivityLinkedItemsCount" RelativeSource="{RelativeSource AncestorType=dxwui:WinUIDialogWindow}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                                                                        <Binding.ValidationRules>
                                                                            <Validation:RequiredValidationRule FieldName="SelectedAccountActivityLinkedItemsCount" />
                                                                        </Binding.ValidationRules>
                                                                    </Binding>
                                                                </dxe:TextEdit.EditValue>
                                                            </dxe:TextEdit>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </dxlc:GroupBox.HeaderTemplate>
                                                <dxdo:DockLayoutManager HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Name="dockManager2">
                                                    <dxdo:LayoutGroup x:Name="RootGroup1" Orientation="Vertical">
                                                        <dxdo:LayoutPanel x:Name="SelectedLinkedItems" Margin="-4 -4 -4 0"
                                                                  AllowHide="False" AllowClose="False"
                                                                  ShowPinButton="False"
                                                                  SnapsToDevicePixels="True">

                                                            <dxe:ListBoxEdit ItemsSource="{Binding DataContext.SelectedActivityLinkedItems,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                                                                     HorizontalContentAlignment="Stretch" VerticalAlignment="Stretch"
                                                                     ScrollViewer.CanContentScroll="False">
                                                                <dxe:ListBoxEdit.ItemTemplate>
                                                                    <DataTemplate>
                                                                        <Border Style="{DynamicResource BorderStyle}">
                                                                            <Grid>
                                                                                <Grid.RowDefinitions>
                                                                                    <RowDefinition Height="Auto" />
                                                                                    <RowDefinition Height="Auto" />
                                                                                </Grid.RowDefinitions>

                                                                                <Grid.ColumnDefinitions>
                                                                                    <ColumnDefinition Width="Auto" />
                                                                                    <ColumnDefinition Width="*" />
                                                                                    <ColumnDefinition Width="20" />
                                                                                </Grid.ColumnDefinitions>

                                                                                <dxe:ImageEdit Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" Margin="2 2 2 2"
                                                                                       Width="50" Height="50"
                                                                                       VerticalAlignment="Center"
                                                                                       Source="{Binding ActivityLinkedItemImage}"
                                                                                       ShowLoadDialogOnClickMode="Never" ShowMenu="False">
                                                                                    <dxe:ImageEdit.Style>
                                                                                        <Style TargetType="{x:Type dxe:ImageEdit}">
                                                                                            <Style.Triggers>
                                                                                                <DataTrigger Binding="{Binding IdLinkedItemType}" Value="42">
                                                                                                    <Setter Property="ToolTip" Value="{Binding Customer.CustomerName}" />
                                                                                                </DataTrigger>
                                                                                                <DataTrigger Binding="{Binding IdLinkedItemType}" Value="43">
                                                                                                    <Setter Property="ToolTip" Value="{Binding People.FullName}" />
                                                                                                </DataTrigger>
                                                                                                <DataTrigger Binding="{Binding IdLinkedItemType}" Value="44">
                                                                                                    <Setter Property="ToolTip" Value="{Binding Name}" />
                                                                                                </DataTrigger>
                                                                                                <DataTrigger Binding="{Binding IdLinkedItemType}" Value="45">
                                                                                                    <Setter Property="ToolTip" Value="{Binding CarProject.CarOEM.Name}" />
                                                                                                </DataTrigger>
                                                                                                <DataTrigger Binding="{Binding IdLinkedItemType}" Value="92">
                                                                                                    <Setter Property="ToolTip" Value="{Binding Competitor.Name}" />
                                                                                                </DataTrigger>
                                                                                            </Style.Triggers>
                                                                                        </Style>
                                                                                    </dxe:ImageEdit.Style>
                                                                                </dxe:ImageEdit>

                                                                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Name}"
                                                                                   FontWeight="Bold" HorizontalAlignment="Left"
                                                                                   TextWrapping="WrapWithOverflow"
                                                                                   Margin="5 0 0 0"
                                                                                   Style="{DynamicResource TextBlock14Style}" />

                                                                                <dxe:ButtonEdit Grid.Row="0" Grid.Column="2"
                                                                                    HorizontalAlignment="Right" VerticalAlignment="Top"
                                                                                    Margin="0 4 4 0" Visibility="{Binding IsVisible,Converter={StaticResource BoolToVisibilityConverter}}"
                                                                                    ShowText="False" Width="15" Height="15" 
                                                                                    Background="Transparent"
                                                                                    AllowDefaultButton="False">
                                                                                    <dxe:ButtonEdit.Buttons>
                                                                                        <dxe:ButtonInfo GlyphKind="Cancel">
                                                                                            <dxmvvm:Interaction.Behaviors>
                                                                                                <dxmvvm:EventToCommand Command="{Binding DataContext.LinkedItemCancelCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                                           EventName="Click"
                                                                                                           CommandParameter="{Binding Path=.}" />
                                                                                            </dxmvvm:Interaction.Behaviors>
                                                                                        </dxe:ButtonInfo>
                                                                                    </dxe:ButtonEdit.Buttons>
                                                                                </dxe:ButtonEdit>

                                                                                <TextBlock Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Text="{Binding LinkedItemType.Value}"
                                                                                   Margin="5 0 0 0"
                                                                                   HorizontalAlignment="Left"
                                                                                   Style="{DynamicResource TextBlock12Style}" />
                                                                            </Grid>
                                                                        </Border>
                                                                    </DataTemplate>
                                                                </dxe:ListBoxEdit.ItemTemplate>
                                                                <dxe:ListBoxEdit.ItemsPanel>
                                                                    <ItemsPanelTemplate>
                                                                        <StackPanel Width="{Binding Path=ActualWidth, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ScrollContentPresenter}}}" />
                                                                    </ItemsPanelTemplate>
                                                                </dxe:ListBoxEdit.ItemsPanel>
                                                                <dxmvvm:Interaction.Behaviors>
                                                                    <dxmvvm:EventToCommand Command="{Binding DataContext.LinkedItemDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                                           EventName="MouseDoubleClick"
                                                                                                           CommandParameter="{Binding Path=.}">
                                                                        <dxmvvm:EventToCommand.EventArgsConverter>
                                                                            <dx:EventArgsToDataRowConverter />
                                                                        </dxmvvm:EventToCommand.EventArgsConverter>
                                                                    </dxmvvm:EventToCommand>
                                                                </dxmvvm:Interaction.Behaviors>
                                                            </dxe:ListBoxEdit>
                                                        </dxdo:LayoutPanel>
                                                    </dxdo:LayoutGroup>

                                                    <!--Add Account in Linked items-->
                                                    <dxdo:DockLayoutManager.AutoHideGroups>
                                                        <!--Add Project-->
                                                        <dxdo:AutoHideGroup DockType="Bottom">
                                                            <dxdo:LayoutPanel x:Name="AddProject" ItemHeight="360" AllowDrag="False" AllowContextMenu="False" AllowFloat="True" AllowSizing="False"
                                                                      AllowClose="False" Caption="{DynamicResource ActivityAddProject}">
                                                                <dxg:GridControl x:Name="linkedItemsAddProject1" 
                                                                         DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         EnableSmartColumnsGeneration="True"
                                                                         ItemsSource="{Binding CarProjectList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         SelectionMode="Row">
                                                                    <dxg:GridColumn FieldName="Name" Header="Name" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                    <dxg:GridColumn FieldName="CarOEM.Name" Header="OEM" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                    <!--<dxg:GridColumn FieldName="CreationDate" Header="Creation Date"/>-->
                                                                    <dxg:GridControl.View>
                                                                        <dxg:TableView x:Name="tableProject1" AllowBestFit="True" AutoWidth="True" EnableImmediatePosting="True"
                                                                               HorizontalScrollbarVisibility="Auto" VerticalScrollbarVisibility="Auto"
                                                                               AllowEditing="True"
                                                                               IndicatorWidth="25" 
                                                                               ShowGroupPanel="False" ShowIndicator="False"
                                                                               FadeSelectionOnLostFocus="False"
                                                                               NavigationStyle="Row"
                                                                               ShowSearchPanelMode="Default"
                                                                               ShowAutoFilterRow="True"
                                                                               SearchPanelHorizontalAlignment="Stretch"
                                                                               ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                            <dxmvvm:Interaction.Behaviors>
                                                                                <dxmvvm:EventToCommand Command="{Binding DataContext.ProjectRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                           EventName="MouseDoubleClick"
                                                                                           PassEventArgsToCommand="True">
                                                                                    <dxmvvm:EventToCommand.EventArgsConverter>
                                                                                        <dx:EventArgsToDataRowConverter />
                                                                                    </dxmvvm:EventToCommand.EventArgsConverter>
                                                                                </dxmvvm:EventToCommand>
                                                                            </dxmvvm:Interaction.Behaviors>
                                                                        </dxg:TableView>
                                                                    </dxg:GridControl.View>
                                                                </dxg:GridControl>
                                                            </dxdo:LayoutPanel>
                                                        </dxdo:AutoHideGroup>
                                                        <!--Add Contact-->
                                                        <dxdo:AutoHideGroup DockType="Bottom" Visibility="{Binding DataContext.IsAccountVisible,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                            <dxdo:LayoutPanel x:Name="AddContact1" ItemHeight="360" AllowDrag="False" AllowContextMenu="False" AllowFloat="True" AllowSizing="False"
                                                                      AllowClose="False" Caption="{DynamicResource ActivityAddContact}">
                                                                <dxg:GridControl x:Name="linkedItemsAddContact"
                                                                DataContext="{Binding DataContext,  RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                EnableSmartColumnsGeneration="True"
                                                                         ItemsSource="{Binding LinkeditemsPeopleList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                SelectionMode="Row">
                                                                    <dxg:GridColumn FieldName="FullName" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                    <dxg:GridColumn Header="Plant" FieldName="Company.Name" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                    <!--<dxg:GridColumn FieldName="Surname" AllowEditing="False" />-->
                                                                    <dxg:GridControl.View>
                                                                        <dxg:TableView x:Name="tablePeopleContact1" AllowBestFit="True" AutoWidth="True" EnableImmediatePosting="True"
                                                                               HorizontalScrollbarVisibility="Auto" VerticalScrollbarVisibility="Auto"
                                                                               AllowEditing="True"
                                                                               IndicatorWidth="25" 
                                                                               ShowGroupPanel="False" ShowIndicator="False"
                                                                               FadeSelectionOnLostFocus="False"
                                                                               NavigationStyle="Row"
                                                                               ShowSearchPanelMode="Default"
                                                                               ShowAutoFilterRow="True"
                                                                               SearchPanelHorizontalAlignment="Stretch"
                                                                               ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                            <dxmvvm:Interaction.Behaviors>
                                                                                <dxmvvm:EventToCommand Command="{Binding DataContext.ContactRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                           PassEventArgsToCommand="True">
                                                                                    <dxmvvm:EventToCommand.EventArgsConverter>
                                                                                        <dx:EventArgsToDataRowConverter />
                                                                                    </dxmvvm:EventToCommand.EventArgsConverter>
                                                                                </dxmvvm:EventToCommand>
                                                                            </dxmvvm:Interaction.Behaviors>
                                                                        </dxg:TableView>
                                                                    </dxg:GridControl.View>
                                                                </dxg:GridControl>
                                                            </dxdo:LayoutPanel>
                                                        </dxdo:AutoHideGroup>
                                                        <!--Offer-->
                                                        <dxdo:AutoHideGroup DockType="Bottom" Visibility="{Binding DataContext.IsAccountVisible,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                            <dxdo:LayoutPanel x:Name="AddOffer" ItemHeight="360" AllowDrag="False" AllowContextMenu="False" AllowFloat="True" AllowSizing="False"
                                                                      AllowClose="False" Caption="{DynamicResource NewActivityAddOffer}">
                                                                <!--<dxg:GridControl x:Name="linkedItemsAddOffer"  
                                                                        DataContext="{Binding DataContext,  RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                        EnableSmartColumnsGeneration="True"
                                                                        ItemsSource="{Binding ListPlantOpportunity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                        SelectionMode="Row">
                                                                <dxg:GridColumn Binding="{Binding Code}"  Header="{DynamicResource NewActivityOfferCode}"  AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                <dxg:GridColumn Binding="{Binding Description}"  Header="{DynamicResource NewActivityOfferDescription}" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                <dxg:GridColumn Binding="{Binding Site.SiteNameWithoutCountry}"  Header="{DynamicResource NewActivityOfferSite}" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                <dxg:GridControl.View>
                                                                    <dxg:TableView x:Name="tableOffer" AllowBestFit="True" AutoWidth="True" EnableImmediatePosting="True"
                                                                               HorizontalScrollbarVisibility="Auto" VerticalScrollbarVisibility="Auto"
                                                                               AllowEditing="True"
                                                                               IndicatorWidth="25" 
                                                                               ShowGroupPanel="False" ShowIndicator="False"
                                                                               NavigationStyle="Row"
                                                                               FadeSelectionOnLostFocus="False"
                                                                               ShowSearchPanelMode="Default"
                                                                               ShowAutoFilterRow="True"
                                                                               SearchPanelHorizontalAlignment="Stretch"
                                                                               ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                        <dxmvvm:Interaction.Behaviors>
                                                                            <dxmvvm:EventToCommand Command="{Binding DataContext.OfferRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                   PassEventArgsToCommand="True">
                                                                                <dxmvvm:EventToCommand.EventArgsConverter>
                                                                                    <dx:EventArgsToDataRowConverter />
                                                                                </dxmvvm:EventToCommand.EventArgsConverter>
                                                                            </dxmvvm:EventToCommand>
                                                                        </dxmvvm:Interaction.Behaviors>
                                                                    </dxg:TableView>
                                                                </dxg:GridControl.View>
                                                            </dxg:GridControl>-->
                                                                <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                                                    <Grid.RowDefinitions>
                                                                        <RowDefinition Height="*" />
                                                                        <RowDefinition Height="30" />
                                                                    </Grid.RowDefinitions>
                                                                    <dxg:GridControl x:Name="linkedItemsAddOffer" Grid.Row="0" DockPanel.Dock="Top" VerticalAlignment="Top" HorizontalAlignment="Stretch"
                                                                        DataContext="{Binding DataContext,  RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                        EnableSmartColumnsGeneration="True"
                                                                             ItemsSource="{Binding ListPlantOpportunity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                        SelectionMode="Row">
                                                                        <dxg:GridColumn Binding="{Binding Code}" Header="{DynamicResource NewActivityOfferCode}" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                        <dxg:GridColumn Binding="{Binding Description}" Header="{DynamicResource NewActivityOfferDescription}" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                        <dxg:GridColumn Binding="{Binding Site.SiteNameWithoutCountry}" Header="{DynamicResource NewActivityOfferSite}" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                        <dxg:GridControl.View>
                                                                            <dxg:TableView x:Name="tableOffer" AllowBestFit="True" AutoWidth="True" EnableImmediatePosting="True"
                                                                                   HorizontalScrollbarVisibility="Auto" VerticalScrollbarVisibility="Auto"
                                                                                   AllowEditing="True"
                                                                                   IndicatorWidth="25" 
                                                                                   ShowGroupPanel="False" ShowIndicator="False"
                                                                                   NavigationStyle="Row"
                                                                                   FadeSelectionOnLostFocus="False"
                                                                                   ShowSearchPanelMode="Default"
                                                                                   ShowAutoFilterRow="True"
                                                                                   SearchPanelHorizontalAlignment="Stretch"
                                                                                   ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                                <dxmvvm:Interaction.Behaviors>
                                                                                    <dxmvvm:EventToCommand Command="{Binding DataContext.OfferRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                   PassEventArgsToCommand="True">
                                                                                        <dxmvvm:EventToCommand.EventArgsConverter>
                                                                                            <dx:EventArgsToDataRowConverter />
                                                                                        </dxmvvm:EventToCommand.EventArgsConverter>
                                                                                    </dxmvvm:EventToCommand>
                                                                                </dxmvvm:Interaction.Behaviors>
                                                                            </dxg:TableView>
                                                                        </dxg:GridControl.View>
                                                                    </dxg:GridControl>
                                                                    <Button Grid.Row="1" Height="30"
                                              Content="{DynamicResource EditActivitysearch}" DockPanel.Dock="Bottom" VerticalAlignment="Bottom" HorizontalAlignment="Right" IsEnabled="{Binding DataContext.IsSearchButtonEnable,RelativeSource={RelativeSource FindAncestor, AncestorType= dxwui:WinUIDialogWindow},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                                       Command="{Binding DataContext.SearchOfferCommand, RelativeSource={RelativeSource FindAncestor, AncestorType= dxwui:WinUIDialogWindow}}" />
                                                                </Grid>
                                                            </dxdo:LayoutPanel>
                                                        </dxdo:AutoHideGroup>
                                                        <!--Add Contact-->
                                                        <dxdo:AutoHideGroup DockType="Bottom" Visibility="{Binding DataContext.IsInformationVisible,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                            <dxdo:LayoutPanel x:Name="AddCompetitor" ItemHeight="360" AllowDrag="False" AllowContextMenu="False" AllowFloat="True" AllowSizing="False"
                                                                      AllowClose="False" Caption="{DynamicResource ActivityAddCompetitor}">
                                                                <dxg:GridControl x:Name="linkedItemsAddCompetitor"
                                                                DataContext="{Binding DataContext,  RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                EnableSmartColumnsGeneration="True"
                                                                         ItemsSource="{Binding LinkeditemsCompetitorList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                SelectionMode="Row">
                                                                    <dxg:GridColumn FieldName="Name" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                                    <!--<dxg:GridColumn FieldName="Surname" AllowEditing="False" />-->
                                                                    <dxg:GridControl.View>
                                                                        <dxg:TableView x:Name="tableCompetitor" AllowBestFit="True" AutoWidth="True" EnableImmediatePosting="True"
                                                                               HorizontalScrollbarVisibility="Auto" VerticalScrollbarVisibility="Auto"
                                                                               AllowEditing="True"
                                                                               IndicatorWidth="25" 
                                                                               ShowGroupPanel="False" ShowIndicator="False"
                                                                               FadeSelectionOnLostFocus="False"
                                                                               NavigationStyle="Row"
                                                                               ShowSearchPanelMode="Default"
                                                                               ShowAutoFilterRow="True"
                                                                               SearchPanelHorizontalAlignment="Stretch"
                                                                               ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                                            <dxmvvm:Interaction.Behaviors>
                                                                                <dxmvvm:EventToCommand Command="{Binding DataContext.CompetitorRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                           PassEventArgsToCommand="True">
                                                                                    <dxmvvm:EventToCommand.EventArgsConverter>
                                                                                        <dx:EventArgsToDataRowConverter />
                                                                                    </dxmvvm:EventToCommand.EventArgsConverter>
                                                                                </dxmvvm:EventToCommand>
                                                                            </dxmvvm:Interaction.Behaviors>
                                                                        </dxg:TableView>
                                                                    </dxg:GridControl.View>
                                                                </dxg:GridControl>
                                                            </dxdo:LayoutPanel>
                                                        </dxdo:AutoHideGroup>
                                                        <!--Account-->
                                                        <!--<dxdo:AutoHideGroup DockType="Bottom" Visibility="{Binding DataContext.IsAccountVisible,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                    <dxdo:LayoutPanel x:Name="AddAccount" ItemHeight="360" AllowDrag="False" AllowContextMenu="False" AllowFloat="False" AllowSizing="False"
                                                                      AllowClose="False" Caption="{DynamicResource EditActivityAddAccount}">
                                                        <dxg:GridControl x:Name="linkedItemsAddAccount"  
                                                                        DataContext="{Binding DataContext,  RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                        EnableSmartColumnsGeneration="True"
                                                                        ItemsSource="{Binding CompaniesList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                        SelectionMode="Row">
                                                            <dxg:GridColumn Binding="{Binding Customers[0].CustomerName}" Header="{DynamicResource EditActivityGroup}" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                            <dxg:GridColumn FieldName="Name" Header="{DynamicResource EditActivityPlant}" AllowEditing="False" FilterPopupMode="CheckedList" />
                                                            <dxg:GridControl.View>
                                                                <dxg:TableView x:Name="tableAccount" AllowBestFit="True" AutoWidth="True" EnableImmediatePosting="True"
                                                                           HorizontalScrollbarVisibility="Auto" VerticalScrollbarVisibility="Auto"
                                                                           AllowEditing="True"
                                                                           IndicatorWidth="25" 
                                                                           ShowGroupPanel="False" ShowIndicator="False"
                                                                           NavigationStyle="Row"
                                                                           FadeSelectionOnLostFocus="False"
                                                                           ShowSearchPanelMode="Default"
                                                                           ShowAutoFilterRow="True"
                                                                           SearchPanelHorizontalAlignment="Stretch">
                                                                    <dxmvvm:Interaction.Behaviors>
                                                                        <dxmvvm:EventToCommand Command="{Binding DataContext.AccountRowMouseDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                                   EventName="MouseDoubleClick"
                                                                                   PassEventArgsToCommand="True">
                                                                            <dxmvvm:EventToCommand.EventArgsConverter>
                                                                                <dx:EventArgsToDataRowConverter />
                                                                            </dxmvvm:EventToCommand.EventArgsConverter>
                                                                        </dxmvvm:EventToCommand>
                                                                    </dxmvvm:Interaction.Behaviors>
                                                                </dxg:TableView>
                                                            </dxg:GridControl.View>
                                                        </dxg:GridControl>
                                                    </dxdo:LayoutPanel>
                                                </dxdo:AutoHideGroup>-->
                                                    </dxdo:DockLayoutManager.AutoHideGroups>
                                                </dxdo:DockLayoutManager>
                                            </dxlc:GroupBox>
                                        </Grid>
                                    </Grid>
                                </ScrollViewer>
                            </DataTemplate>
                        </dxlc:GroupBox.MaximizedContentTemplate>
                    </dxlc:GroupBox>
                    <!--Attachment-->
                    <dxlc:GroupBox Style="{StaticResource myGroupBoxStyle}">
                        <dxlc:GroupBox.HeaderTemplate>
                            <DataTemplate>
                                <DockPanel>
                                    <TextBlock Text="{DynamicResource LeadsAddViewAttachment}" Margin="5,0,0,0" FontWeight="Bold"
                                    VerticalAlignment="Center"
                                    />
                                    <TextBlock Name="AttachmentCount" Text="{Binding DataContext.ListAttachment.Count, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" Width="50" HorizontalAlignment="Left" VerticalAlignment="Center"
                                    FontWeight="Bold"
                                    Margin="5,1,0,0" />
                                </DockPanel>
                            </DataTemplate>
                        </dxlc:GroupBox.HeaderTemplate>
                        <dxlc:GroupBox.ContentTemplate>
                            <DataTemplate>
                                <StackPanel Margin="0">
                                    <Grid Margin="-5" x:Name="PART_Root">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25" />
                                            <!--<RowDefinition Height="25"/>-->
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Margin="3,0,0,0" Padding="2" FontWeight="Bold" Text="{DynamicResource ActivityFileNameBox}" />
                                        <TextBlock Grid.Row="0" Grid.Column="1" Margin="3,0,0,0" Padding="2" Text="{Binding DataContext.ListAttachment[0].OriginalFileName, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox},StringFormat='dd/MM/yyyy'}" />

                                        <!--<TextBlock Grid.Row="1" Grid.Column="0" Margin="3,0,0,0" Padding="2" FontWeight="Bold" Text="{DynamicResource ActivityCommentDateBox}"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Margin="3,0,0,0" Padding="2" Text="{Binding DataContext.ListAttachment[0].UploadedIn, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"/>-->

                                        <TextBlock Grid.Row="2" Grid.Column="0" Margin="3,0,0,0" Padding="2" FontWeight="Bold" Text="{DynamicResource ActivityFileSizeBox}" />
                                        <TextBlock Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3" Margin="3,0,0,0" Padding="2" Text="{Binding DataContext.ListAttachment[0].FileSize, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Converter={StaticResource BytesToKilobytesConverter}}" TextWrapping="Wrap" />
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Setter Property="Visibility" Value="Visible" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding DataContext.ListAttachment.Count, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" Value="0">
                                                        <Setter Property="Visibility" Value="Hidden" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>
                                    </Grid>
                                </StackPanel>
                            </DataTemplate>
                        </dxlc:GroupBox.ContentTemplate>

                        <dxlc:GroupBox.MaximizedContentTemplate>
                            <DataTemplate>
                                <Grid Width="900">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="80" />
                                    </Grid.RowDefinitions>
                                    <dxg:GridControl x:Name="gcattachment" Grid.Row="0"
                                                 HorizontalAlignment="Stretch" VerticalAlignment="Top" 
                                                 Margin="-10,-10,-10,-10" Padding="0"
                                                 ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                 DockPanel.Dock="Top" MaxHeight="1000"
                                                 ItemsSource="{Binding DataContext.ListAttachment,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay}"
                                                 SelectedItem="{Binding DataContext.SelectedAttachment, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ImplyNullLikeEmptyStringWhenFiltering="True">
                                        <dxg:GridControl.Columns>
                                            <dxg:GridColumn FixedWidth="True"
                                            Width="50" HorizontalHeaderContentAlignment="Center" FilterPopupMode="CheckedList">
                                                <dxg:GridColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <!--<Image Source="{Binding Value}"  Height="30" Width="30"/>-->
                                                        <Image Source="{Binding Path=Data.AttachmentImage}" Height="24" Width="24" />
                                                    </DataTemplate>
                                                </dxg:GridColumn.CellTemplate>
                                            </dxg:GridColumn>
                                            <dxg:GridColumn FieldName="OriginalFileName" Header="{DynamicResource ActivityFileName}" FixedWidth="False" Width="300" HorizontalHeaderContentAlignment="Left" FilterPopupMode="CheckedList" />
                                            <!--<dxg:GridColumn FieldName="CreationTime" Header="{DynamicResource ActivityChangeLogDate}" FixedWidth="False" Width="100" HorizontalHeaderContentAlignment="Center"/>-->
                                            <dxg:GridColumn FieldName="FileType" Header="{DynamicResource ActivityFileType}" FixedWidth="False" Width="60" HorizontalHeaderContentAlignment="Center" FilterPopupMode="CheckedList" />
                                            <dxg:GridColumn Header="{DynamicResource ActivityFileSize}" FixedWidth="False" Width="60" HorizontalHeaderContentAlignment="Center" FilterPopupMode="CheckedList">
                                                <dxg:GridColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock TextAlignment="Right" Text="{Binding Path=Data.FileSize, Converter={StaticResource BytesToKilobytesConverter}}" />
                                                    </DataTemplate>
                                                </dxg:GridColumn.CellTemplate>
                                            </dxg:GridColumn>
                                            <!--<dxg:GridColumn FieldName="" Header="{DynamicResource ActivityFileDownload}" FixedWidth="False" Width="80" HorizontalHeaderContentAlignment="Center">
                                            <dxg:GridColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Name="download"
                                                            Command="{Binding DataContext.DownloadFileCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}}}"
                                                            CommandParameter="{Binding RowData.Row}"
                                                            Content=""
                                                            IsEnabled="{Binding DataContext.IsAcceptControlEnableorder,Mode=OneTime, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}">
                                                        <Button.ContentTemplate>
                                                            <DataTemplate>
                                                                <Image Height="16" Width="16" Style="{DynamicResource DownloadAttachmentButtonImageStyle}" />
                                                            </DataTemplate>
                                                        </Button.ContentTemplate>
                                                    </Button>
                                                </DataTemplate>
                                            </dxg:GridColumn.CellTemplate>
                                        </dxg:GridColumn>-->
                                            <dxg:GridColumn Width="50" FieldName="" FixedWidth="True"
                                            HorizontalHeaderContentAlignment="Center" FilterPopupMode="CheckedList">
                                                <dxg:GridColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Name="delete"
                                                            Command="{Binding DataContext.DeleteFileCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}}}"
                                                            CommandParameter="{Binding RowData.Row}"
                                                            Content=""
                                                            IsEnabled="{Binding DataContext.IsAcceptControlEnableorder,Mode=OneTime, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}">
                                                            <Button.ContentTemplate>
                                                                <DataTemplate>
                                                                    <Image Height="16" Width="16"
                                                                       Source="/Emdep.Geos.Modules.Crm;component/Assets/Images/Delete.png" />
                                                                </DataTemplate>
                                                            </Button.ContentTemplate>
                                                        </Button>
                                                    </DataTemplate>
                                                </dxg:GridColumn.CellTemplate>
                                            </dxg:GridColumn>
                                        </dxg:GridControl.Columns>
                                        <dxg:GridControl.View>
                                            <dxg:TableView x:Name="attachmentTable" 
                                                       NavigationStyle="Row" 
                                                       AutoWidth="True" 
                                                       ShowGroupPanel="False" 
                                                       AllowEditing="True" 
                                                       Focusable="True" 
                                                       FadeSelectionOnLostFocus="False"
                                                       HorizontalScrollbarVisibility="Hidden" 
                                                       VerticalScrollbarVisibility="Auto"
                                                       ShowIndicator="False"
                                                       SearchPanelHorizontalAlignment="Stretch"
                                                       ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                <dxmvvm:Interaction.Behaviors>
                                                    <dxmvvm:EventToCommand Command="{Binding DataContext.AttachmentGridDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                                       EventName="MouseDoubleClick"
                                                                       PassEventArgsToCommand="True">
                                                        <dxmvvm:EventToCommand.EventArgsConverter>
                                                            <dx:EventArgsToDataRowConverter />
                                                        </dxmvvm:EventToCommand.EventArgsConverter>
                                                    </dxmvvm:EventToCommand>
                                                </dxmvvm:Interaction.Behaviors>
                                            </dxg:TableView>
                                        </dxg:GridControl.View>
                                    </dxg:GridControl>
                                    <ToggleButton Grid.Row="1"
                                              Height="30"
                                              Width="30"
                                              Margin="0,0,-5,-5"
                                              VerticalAlignment="Bottom"
                                              HorizontalAlignment="Right"
                                              DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              FontWeight="Bold"
                                              IsEnabled="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=IsPermissionEnabled}"
                                              IsChecked="{Binding DataContext.ShowCommentsFlyout, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Name="btnAddNewAttachment">

                                        <ToggleButton.ContentTemplate>
                                            <DataTemplate>
                                                <Image Height="24"
                                                   Width="24"
                                                   Margin="-10"
                                                   VerticalAlignment="Stretch"
                                                   HorizontalAlignment="Stretch"
                                                   Style="{DynamicResource AttachmentImageStyle}" />
                                            </DataTemplate>
                                        </ToggleButton.ContentTemplate>
                                    </ToggleButton>
                                    <dxe:FlyoutControl PlacementTarget="{Binding ElementName=btnAddNewAttachment}" StaysOpen="True">
                                        <dxmvvm:Interaction.Behaviors>
                                            <UIHelper:FlyoutControlBehavior IsOpen="{Binding DataContext.ShowCommentsFlyout, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        </dxmvvm:Interaction.Behaviors>
                                        <dxe:FlyoutControl.Settings>
                                            <dxe:FlyoutSettings Placement="Left" />
                                        </dxe:FlyoutControl.Settings>
                                        <Grid HorizontalAlignment="Stretch" VerticalAlignment="Bottom">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="auto" />
                                                <RowDefinition Height="auto" />
                                            </Grid.RowDefinitions>
                                            <dxe:ComboBoxEdit x:Name="editor" Width="650" Height="60" NullText="{DynamicResource ActivityNoFileChose}"
                                                    EditValue="{Binding DataContext.ActivityAttachmentList,RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}},UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                    ItemsSource="{Binding DataContext.ActivityAttachmentList,RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}},UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                    DisplayMember="OriginalFileName" HorizontalAlignment="Stretch"
                                                    AllowDefaultButton="False"
                                                    AutoComplete="True"
                                                    ImmediatePopup="True"
                                                    ValidateOnEnterKeyPressed="True" 
                                                    ValidateOnTextInput="True"
                                                    IsTextEditable="False" Style="{DynamicResource ComboBoxEditStyle}">
                                                <dxe:ComboBoxEdit.StyleSettings>
                                                    <dxe:TokenComboBoxStyleSettings NewTokenPosition="Far" EnableTokenWrapping="True" />
                                                </dxe:ComboBoxEdit.StyleSettings>
                                            </dxe:ComboBoxEdit>
                                            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right"
                                            >
                                                <Button Height="30"
                                                Width="Auto" Margin="0 5 0 0"
                                                HorizontalAlignment="Right"
                                                Command="{Binding Path =(dxefl:FlyoutBase.Flyout).PlacementTarget.DataContext.ChooseFileCommand, RelativeSource={RelativeSource Self}}"
                                                CommandParameter="{Binding ElementName=gcattachment}"
                                                Content="{DynamicResource ActivityFileChoose}" />
                                                <Button Height="30"
                                                Margin="5 0 0 0"
                                              VerticalAlignment="Bottom"
                                              HorizontalAlignment="Right"
                                                DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              FontWeight="Bold"
                                              Command="{Binding UploadFileCommand}"
                                              IsEnabled="{Binding DataContext.IsAcceptControlEnableorder,Mode=OneTime, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              Name="btnAttachFile">
                                                    <Button.Style>
                                                        <Style TargetType="{x:Type Button}">
                                                            <Setter Property="Visibility" Value="Visible" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding DataContext.ActivityAttachmentList.Count, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" Value="0">
                                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                    <Button.ContentTemplate>
                                                        <DataTemplate>
                                                            <Image Height="24"
                                                   Width="24"
                                                   Margin="-10"
                                                   VerticalAlignment="Stretch"
                                                   HorizontalAlignment="Stretch"
                                                   Style="{DynamicResource UploadAttachmentButtonImageStyle}" />
                                                        </DataTemplate>
                                                    </Button.ContentTemplate>
                                                </Button>
                                            </StackPanel>
                                        </Grid>
                                    </dxe:FlyoutControl>
                                </Grid>
                            </DataTemplate>
                        </dxlc:GroupBox.MaximizedContentTemplate>
                    </dxlc:GroupBox>
                    <!--Comments-->
                    <dxlc:GroupBox Visibility="{Binding DataContext.IsCommentsVisible, RelativeSource={RelativeSource Self}}" Style="{StaticResource myGroupBoxStyle}">
                        <dxlc:GroupBox.HeaderTemplate>
                            <DataTemplate>
                                <DockPanel>
                                    <TextBlock Text="{DynamicResource LeadsAddViewComment}" Margin="5,0,0,0" FontWeight="Bold"
                                    VerticalAlignment="Center"
                                    />
                                    <TextBlock Name="CommentsCount" Text="{Binding DataContext.ActivityCommentsList.Count, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" Width="50" HorizontalAlignment="Left" VerticalAlignment="Center"
                                    FontWeight="Bold"
                                    Margin="5,1,0,0" />
                                </DockPanel>
                            </DataTemplate>
                        </dxlc:GroupBox.HeaderTemplate>
                        <dxlc:GroupBox.ContentTemplate>
                            <DataTemplate>
                                <StackPanel Margin="0">
                                    <Grid Margin="-5" x:Name="PART_Root">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="25" />
                                            <RowDefinition Height="25" />
                                            <RowDefinition Height="70" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <!--<ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>-->
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Margin="3,0,0,0" Padding="2" FontWeight="Bold" Text="{DynamicResource ActivityCommentDateBox}" />
                                        <!--<TextBlock Grid.Row="0" Grid.Column="1" Margin="3,0,0,0" Padding="2" Text="{Binding DataContext.ActivityCommentsList[0].Datetime, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox},StringFormat=d,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" />-->

                                        <TextBlock Grid.Row="1" Grid.Column="0" Margin="3,0,0,0" Padding="2" FontWeight="Bold" Text="{DynamicResource ActivityCommentUserBox}" />
                                        <TextBlock Grid.Row="1" Grid.Column="1" Margin="3,0,0,0" Padding="2" Text="{Binding DataContext.ActivityCommentsList[0].People.FullName, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" />

                                        <TextBlock Grid.Row="2" Grid.Column="0" Margin="3,0,0,0" Padding="2" FontWeight="Bold" Text="{DynamicResource ActivityCommentTextBox}" />
                                        <TextBlock Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="3" Margin="3,0,0,0" Padding="2" Text="{Binding DataContext.CommentText, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" TextWrapping="WrapWithOverflow" />
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Setter Property="Visibility" Value="Visible" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding DataContext.ActivityCommentsList.Count, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" Value="0">
                                                        <Setter Property="Visibility" Value="Hidden" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>
                                    </Grid>
                                </StackPanel>
                            </DataTemplate>
                        </dxlc:GroupBox.ContentTemplate>
                        <dxlc:GroupBox.MaximizedContentTemplate>
                            <DataTemplate>
                                <Grid Width="900">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="40" />
                                    </Grid.RowDefinitions>
                                    <dxg:GridControl x:Name="gcComments" Grid.Row="0"
                                                 HorizontalAlignment="Stretch" VerticalAlignment="Top" 
                                                 SelectionMode="Row"
                                                 Margin="-10,-10,-10,-10" Padding="0"
                                                 DockPanel.Dock="Top" MaxHeight="1000"
                                                 ItemsSource="{Binding DataContext.ActivityCommentsList,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay}"
                                                 SelectedItem="{Binding DataContext.SelectedComment, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ImplyNullLikeEmptyStringWhenFiltering="True">
                                        <dxg:GridControl.Columns>
                                            <dxg:GridColumn FieldName="People.FullName" Header="{DynamicResource ActivityCommentUser}" FixedWidth="True"
                                            Width="150" FilterPopupMode="CheckedList">
                                                <dxg:GridColumn.DisplayTemplate>
                                                    <ControlTemplate>
                                                        <TextBlock Name="PART_Editor" FontWeight="Bold"></TextBlock>
                                                    </ControlTemplate>
                                                </dxg:GridColumn.DisplayTemplate>
                                            </dxg:GridColumn>
                                            <dxg:GridColumn Width="170"
                                            Binding="{Binding Datetime,StringFormat=g, ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}"
                                            FixedWidth="True"
                                            Header="{DynamicResource LeadsEditViewCommentDate}" FilterPopupMode="CheckedList">
                                                <dxg:GridColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <dxe:TextEdit DisplayFormatString="g" Name="PART_Editor" FontWeight="Bold" />
                                                    </DataTemplate>
                                                </dxg:GridColumn.CellTemplate>
                                            </dxg:GridColumn>
                                            <!--<dxg:GridColumn FieldName="Comments" Visible="False" ShowInColumnChooser="False" />-->
                                            <dxg:GridColumn Width="*" IsEnabled="False" AllowColumnFiltering="False" ShowInColumnChooser="False" />
                                            <dxg:GridColumn Width="40" FieldName="" FixedWidth="True"
                                            FilterPopupMode="CheckedList" AllowMoving="False" AllowColumnFiltering="false">
                                                <dxg:GridColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Name="deleteRowComment"
                                                            Command="{Binding DataContext.DeleteCommentRowCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}}}"
                                                            CommandParameter="{Binding RowData.Row}"
                                                            Content=""
                                                            IsEnabled="{Binding DataContext.IsAcceptControlEnableorder,Mode=OneTime, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}">
                                                            <Button.ContentTemplate>
                                                                <DataTemplate>
                                                                    <Image Height="16" Width="16"
                                                                       Source="/Emdep.Geos.Modules.Crm;component/Assets/Images/Delete.png" />
                                                                </DataTemplate>
                                                            </Button.ContentTemplate>
                                                        </Button>
                                                    </DataTemplate>
                                                </dxg:GridColumn.CellTemplate>
                                            </dxg:GridColumn>
                                        </dxg:GridControl.Columns>
                                        <dxmvvm:Interaction.Behaviors>
                                            <UIHelper:GridSelectingBehavior />
                                        </dxmvvm:Interaction.Behaviors>
                                        <dxg:GridControl.View>
                                            <dxg:TableView x:Name="commentTable"
                                                       NavigationStyle="Row" 
                                                       AutoWidth="True" 
                                                       ShowGroupPanel="False" 
                                                       AllowEditing="True" 
                                                       Focusable="True" 
                                                       FadeSelectionOnLostFocus="False"
                                                       HorizontalScrollbarVisibility="Hidden" 
                                                       VerticalScrollbarVisibility="Auto"
                                                       ShowIndicator="False"
                                                       RowDetailsVisibilityMode="Visible"
                                                       FocusedRow="{Binding DataContext.SelectedComment, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                       SearchPanelHorizontalAlignment="Stretch"
                                                       ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly">
                                                <!-- ShowSearchPanelMode="Always" SearchColumns="People.FullName;Comments"-->
                                                <dxg:TableView.RowDetailsTemplate>
                                                    <DataTemplate>
                                                        <dx:DXExpander IsExpanded="{Binding Path=RowState.(UIHelper:ShowDetailBehavior.ShowDetail)}" HorizontalExpand="None" VerticalExpand="FromTopToBottom">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="50" />
                                                                    <ColumnDefinition Width="*" />
                                                                </Grid.ColumnDefinitions>
                                                                <dxe:ImageEdit ShowLoadDialogOnClickMode="Never" ShowMenu="False" Source="{Binding Row.People.OwnerImage}" Stretch="UniformToFill" Width="50" Height="50" HorizontalAlignment="Center" VerticalAlignment="Top" />
                                                                <UIHelper:BindableRichTextBox x:Name="BindableRichTextBox_Editor1" HorizontalScrollBarVisibility="Auto" 
                                                                                       Document="{Binding Row.Comments ,Converter={UIConverter:RtfToFlowDocumentConverter}}" IsReadOnly="True" Grid.Column="1" Grid.Row="0" ScrollViewer.VerticalScrollBarVisibility="Auto" Style="{DynamicResource RichTextBoxStyle}">
                                                                </UIHelper:BindableRichTextBox>


                                                            </Grid>
                                                        </dx:DXExpander>
                                                    </DataTemplate>
                                                </dxg:TableView.RowDetailsTemplate>
                                                <dxmvvm:Interaction.Behaviors>
                                                    <dxmvvm:EventToCommand Command="{Binding DataContext.CommentsGridDoubleClickCommand,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                                                       EventName="MouseDoubleClick"
                                                                       PassEventArgsToCommand="True">
                                                        <dxmvvm:EventToCommand.EventArgsConverter>
                                                            <dx:EventArgsToDataRowConverter />
                                                        </dxmvvm:EventToCommand.EventArgsConverter>
                                                    </dxmvvm:EventToCommand>
                                                    <UIHelper:ShowDetailBehavior />
                                                </dxmvvm:Interaction.Behaviors>
                                            </dxg:TableView>
                                        </dxg:GridControl.View>
                                    </dxg:GridControl>
                                    <ToggleButton Grid.Row="1"
                                              Height="30"
                                              Width="30"
                                              Margin="0,0,-5,-5"
                                              VerticalAlignment="Bottom"
                                              HorizontalAlignment="Right"
                                              DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              FontWeight="Bold"
                                              IsEnabled="{Binding DataContext.IsAcceptControlEnableorder,Mode=OneTime, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}"
                                              Name="btnAddNewComment">
                                        <!--IsChecked="{Binding DataContext.ShowCommentsFlyout, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"-->

                                        <dxmvvm:Interaction.Triggers>
                                            <dxmvvm:EventToCommand Command="{Binding CommentButtonCheckedCommand}" EventName="Checked" PassEventArgsToCommand="True" />
                                            <dxmvvm:EventToCommand Command="{Binding CommentButtonUncheckedCommand}" EventName="Unchecked" PassEventArgsToCommand="True" />
                                        </dxmvvm:Interaction.Triggers>

                                        <ToggleButton.ContentTemplate>
                                            <DataTemplate>
                                                <Image Height="24"
                                                   Width="24"
                                                   Margin="-10"
                                                   VerticalAlignment="Stretch"
                                                   HorizontalAlignment="Stretch"
                                                   Style="{DynamicResource AddCommentButtonImageStyle}" />
                                            </DataTemplate>
                                        </ToggleButton.ContentTemplate>
                                    </ToggleButton>
                                    <dxe:FlyoutControl PlacementTarget="{Binding ElementName=btnAddNewComment}" StaysOpen="True">
                                        <dxmvvm:Interaction.Behaviors>
                                            <UIHelper:FlyoutControlBehavior IsOpen="{Binding DataContext.ShowCommentsFlyout, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                        </dxmvvm:Interaction.Behaviors>
                                        <dxe:FlyoutControl.Settings>
                                            <dxe:FlyoutSettings Placement="Left" />
                                        </dxe:FlyoutControl.Settings>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="20" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <!--<UIHelper:BindableRichTextBox Name="BindableRichTextBox_Editor"                                                               
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Height="{Binding DataContext.CommentboxHeight,RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type dxlc:GroupBox}},UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"                                                                 
                                            Width="850"
                                            Margin="-10" Document="{Binding DataContext.NewActivityComment,Converter={UIConverter:RtfToFlowDocumentConverter},  RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        </UIHelper:BindableRichTextBox>

                                        <StackPanel Orientation="Horizontal" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                                            <RadioButton GroupName="commentTextType" Content="{DynamicResource LeadEditSplitViewCommentTextNormal}" IsChecked="{Binding DataContext.IsNormal,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox,Mode=FindAncestor},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Right" Margin="0,0,15,0">
                                                -->
                                            <!--<RadioButton.ContentTemplate>
                                                <DataTemplate>
                                                    <Image Height="24" Width="24" Style="{DynamicResource TextFileImageStyle}" />
                                                </DataTemplate>
                                            </RadioButton.ContentTemplate>-->
                                            <!--

                                            </RadioButton>

                                            <RadioButton GroupName="commentTextType" Content="{DynamicResource LeadEditSplitViewCommentTextRtf}" IsChecked="{Binding DataContext.IsRtf, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox,Mode=FindAncestor},UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}" HorizontalAlignment="Left" Margin="0,0,5,0" >-->
                                            <!--<RadioButton.ContentTemplate>
                                                <DataTemplate>
                                                    <Image Height="24" Width="24" Style="{DynamicResource RtfFileImageStyle}" />
                                                </DataTemplate>
                                            </RadioButton.ContentTemplate>-->

                                            <UIHelper:BindableRichTextBox x:Name="BindableRichTextBox_Editor"
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Height="{Binding DataContext.CommentboxHeight,RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type dxlc:GroupBox}},UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                                            Width="850"
                                            Margin="-10"
                                            Style="{DynamicResource RichTextBoxStyle}"
                                            Document="{Binding DataContext.NewActivityComment,
                                            Converter={UIConverter:RtfToFlowDocumentConverter},  RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"                                       
                                            Visibility="{Binding DataContext.Richtextboxrtf, RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">

                                            </UIHelper:BindableRichTextBox>
                                            <TextBox x:Name="BindableRichTextBox_Editor1"
                                            TextWrapping="Wrap"
                                            AcceptsReturn="True" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch"
                                            Grid.Row="0"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2" 
                                            Height="{Binding DataContext.CommentboxHeight,RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type dxlc:GroupBox}},UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                                            Width="850"
                                            Margin="-10"
                                            Text="{Binding DataContext.NewActivityComment,
                                             RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Visibility="{Binding DataContext.Textboxnormal, RelativeSource={RelativeSource FindAncestor,
                                            AncestorType={x:Type dxlc:GroupBox}}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">

                                            </TextBox>
                                            <StackPanel Grid.Row="2"
                                            Grid.Column="0"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Bottom"
                                            Orientation="Horizontal">
                                                <RadioButton Margin="0,0,15,0"
                                                HorizontalAlignment="Right"
                                                Content="{DynamicResource LeadEditSplitViewCommentTextNormal}"
                                                GroupName="commentTextType"
                                             
                                                IsChecked="{Binding DataContext.IsNormal,RelativeSource={RelativeSource AncestorType=dxlc:GroupBox,Mode=FindAncestor},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">
                                                    <dxmvvm:Interaction.Behaviors>
                                                        <dxmvvm:EventToCommand Command="{Binding DataContext.IsnormalPreviewMouseRightButtonDown ,
                                                        RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" 
                                                                           EventName="Click"                                                           
                                                                       CommandParameter="{Binding ElementName=BindableRichTextBox_Editor}"
                                                               PassEventArgsToCommand="True">
                                                        </dxmvvm:EventToCommand>
                                                    </dxmvvm:Interaction.Behaviors>
                                                </RadioButton>
                                                <RadioButton Margin="0,0,5,0"
                                                HorizontalAlignment="Left"
                                                Content="{DynamicResource LeadEditSplitViewCommentTextRtf}"
                                                GroupName="commentTextType"
                                             
                                                IsChecked="{Binding DataContext.IsRtf, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox,Mode=FindAncestor},UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
                                                    <dxmvvm:Interaction.Behaviors>
                                                        <dxmvvm:EventToCommand Command="{Binding DataContext.IsnormalPreviewMouseRightButtonDown ,
                                                        RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" 
                                                                           EventName="Click"                                                           
                                                                       CommandParameter="{Binding ElementName=BindableRichTextBox_Editor}"
                                                               PassEventArgsToCommand="True">
                                                        </dxmvvm:EventToCommand>
                                                    </dxmvvm:Interaction.Behaviors>
                                                </RadioButton>
                                            </StackPanel>
                                            <Button Grid.Row="2"
                                                Grid.Column="1"
                                                Height="30"
                                                Width="Auto"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Bottom"
                                                Command="{Binding Path =(dxefl:FlyoutBase.Flyout).PlacementTarget.DataContext.AddNewCommentCommand, RelativeSource={RelativeSource Self}}"
                                                CommandParameter="{Binding ElementName=BindableRichTextBox_Editor}"
                                                Content="{Binding DataContext.CommentButtonText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxlc:GroupBox}}" />
                                        </Grid>
                                    </dxe:FlyoutControl>
                                </Grid>
                            </DataTemplate>
                        </dxlc:GroupBox.MaximizedContentTemplate>
                    </dxlc:GroupBox>
                    <!--Change Log-->
                    <dxlc:GroupBox Style="{StaticResource myGroupBoxStyle}">
                        <dxlc:GroupBox.HeaderTemplate>
                            <DataTemplate>
                                <DockPanel>
                                    <TextBlock Text="{DynamicResource LeadsAddViewChangeLog}" Margin="5,0,0,0" FontWeight="Bold"
                                    VerticalAlignment="Center"
                                    />
                                    <TextBlock Text="0" Name="ChangeLogCount" Width="50" HorizontalAlignment="Left" VerticalAlignment="Center"
                                    FontWeight="Bold"
                                    Margin="5,1,0,0" />
                                </DockPanel>
                            </DataTemplate>
                        </dxlc:GroupBox.HeaderTemplate>
                        <dxlc:GroupBox.MaximizedContentTemplate>
                            <DataTemplate>
                                <Grid Width="900">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="40" />
                                    </Grid.RowDefinitions>
                                </Grid>
                            </DataTemplate>
                        </dxlc:GroupBox.MaximizedContentTemplate>
                    </dxlc:GroupBox>

                </dxlc:FlowLayoutControl>

                <StackPanel Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="4"
                    HorizontalAlignment="Center" 
                    Orientation="Horizontal"
                    Margin="20,0,0,0"
                    Width="290">

                    <Button Content="{DynamicResource LeadsAddViewAccept}"
                    Command="{Binding AddActivityViewAcceptButtonCommand}"
                    Height="30"
                    Width="100"
                    Margin="0,0,30,0"
                    VerticalAlignment="Bottom"
                    IsEnabled="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=IsPermissionEnabled}" />

                    <Button Content="{DynamicResource LeadsAddViewCancel}"
                    Command="{Binding AddActivityViewCancelButtonCommand}" CommandParameter="{Binding ElementName=ActivityTableView}"
                    Height="30"
                    Width="100"
                    Margin="30,0,0,0"
                    VerticalAlignment="Bottom"
                    />
                </StackPanel>
            </Grid>
        </DockPanel>
    </ScrollViewer>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</dxwui:WinUIDialogWindow>
