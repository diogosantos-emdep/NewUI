<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.SAM.Views.AddWorkLogView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Emdep.Geos.Modules.SAM.Views"             
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:Converter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:UIConverter ="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"           
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:Validation="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
             mc:Ignorable="d" Title="{Binding WindowHeader,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
             d:DesignHeight="300" d:DesignWidth="300"
             Style="{DynamicResource WinUIDialogWindowStyle}"
             TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}">
    <dxwui:WinUIDialogWindow.Resources>
        <UIConverter:DateFormatConverter x:Key="DateFormatConverter" />
    </dxwui:WinUIDialogWindow.Resources>
    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding EscapeButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>


    <!--<Grid ShowGridLines="True">-->
        <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"></RowDefinition>
            <RowDefinition Height="5"></RowDefinition>
            <RowDefinition Height="50"></RowDefinition>
            <RowDefinition Height="5"></RowDefinition>
            <RowDefinition Height="30"></RowDefinition>
            <RowDefinition Height="5"></RowDefinition>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="90"></ColumnDefinition>
            <ColumnDefinition Width="5"></ColumnDefinition>
            <ColumnDefinition Width="140"></ColumnDefinition>
            <ColumnDefinition Width="5"></ColumnDefinition>
            <ColumnDefinition Width="120"></ColumnDefinition>
            <ColumnDefinition Width="5"></ColumnDefinition>
        </Grid.ColumnDefinitions>
    
        <!--Start Time-->
        <Label Content= "{DynamicResource WorkLogStartTime}" Grid.Row="0" Grid.Column="0" Margin="5 5 5 5" HorizontalAlignment="Left" VerticalAlignment="Center" Height="30" FontSize="16" />
        <dxe:DateEdit  Grid.Row="0" Grid.Column="2" Width="130"
                       Margin="5 5 5 5" HorizontalAlignment="Right" VerticalAlignment="Center"  AllowNullInput="False"                     
                     
          >

            <dxe:DateEdit.EditValue>
                <Binding Path="StartDate" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" 
                                                  ValidatesOnDataErrors="True"  >
                    <Binding.ValidationRules>
                        <Validation:ItemWorkLogValidation FieldName="StartDate" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:DateEdit.EditValue>

            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="SelectedIndexChanged" Command="{Binding OnDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
        </dxe:DateEdit>

     


        <dxe:ComboBoxEdit Grid.Row="0" Grid.Column="4" Height="25" Margin="5,5,5,5" Width="110"  
                                                   IsEnabled="{Binding InvertIsAllDayEvent,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                   DisplayFormatString="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }" HorizontalAlignment="Right" VerticalAlignment="Center"    
                                                       MaskType="DateTimeAdvancingCaret" Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                  ItemsSource="{Binding FromDates}"                                                 
                                                 
                          >
            
             <!--SelectedItem="{Binding StartTime,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }" ItemsSource="{Binding FromDates}"  DisplayMember="TimeOfDay"-->
                                                  
            <dxe:ComboBoxEdit.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Converter={StaticResource DateFormatConverter}}"/>
                </DataTemplate>
            </dxe:ComboBoxEdit.ItemTemplate>
         
            <dxe:ComboBoxEdit.SelectedItem>
               
                <Binding Path="StartTime" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:ItemWorkLogValidation FieldName="StartTime" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:ComboBoxEdit.SelectedItem>
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="SelectedIndexChanged" Command="{Binding OnTimeEditValueChangingCommand}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
        </dxe:ComboBoxEdit>
        
        <!--End Time-->
        <Label Content= "{DynamicResource WorkLogEndTime}" Grid.Row="2" Grid.Column="0"  HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5 5 5 5" Height="30" FontSize="16" />


        <dxe:DateEdit Grid.Row="2" Grid.Column="2" ValidateOnEnterKeyPressed="True" Width="130"
                      Margin="5 5 5 5" HorizontalAlignment="Right" VerticalAlignment="Center"
                      AllowNullInput="False" 
                      IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxe:DateEdit.EditValue>
                <Binding Path="EndDate" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay"
                                                 ValidatesOnDataErrors="True">
                    <Binding.ValidationRules>
                        <Validation:ItemWorkLogValidation FieldName="EndDate" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:DateEdit.EditValue>
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="SelectedIndexChanged" Command="{Binding DataContext.OnDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>

        </dxe:DateEdit>
        <dxe:ComboBoxEdit Grid.Row="2" Grid.Column="4" Height="25" VerticalAlignment="Center" Margin="5,5,5,5" Width="110" 
                                                  IsEnabled="{Binding InvertIsAllDayEvent,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                  ItemsSource="{Binding ToDates,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"                                                 
                                                 
                                                 MaskType="DateTimeAdvancingCaret"   DisplayFormatString="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }" Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                 >
              
            <!--SelectedItem="{Binding EndTime,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }" HorizontalAlignment="Right" DisplayMember="TimeOfDay"
            MaskType="DateTimeAdvancingCaret" Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"-->
            <dxe:ComboBoxEdit.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Converter={StaticResource DateFormatConverter}}"/>
                </DataTemplate>
             
            </dxe:ComboBoxEdit.ItemTemplate>
           <dxe:ComboBoxEdit.SelectedItem>
               
                <Binding Path="EndTime" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:ItemWorkLogValidation FieldName="EndTime" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:ComboBoxEdit.SelectedItem>
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="SelectedIndexChanged" Command="{Binding OnTimeEditValueChangingCommand}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
        </dxe:ComboBoxEdit>


        <!--<dxe:DateEdit  Grid.Row="2" Grid.Column="1" 
                       Margin="5 5 5 5" HorizontalAlignment="Stretch" VerticalAlignment="Center"                        
                       AllowNullInput="True"
                       IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">

            <dxe:DateEdit.EditValue>
                <Binding Path="StartDate" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay"
                                                  ValidatesOnDataErrors="True">
                    <Binding.ValidationRules>
                        <Validation:LeaveValidations FieldName="StartDate" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                    </Binding.ValidationRules>
                </Binding>
            </dxe:DateEdit.EditValue>

            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding OnDateEditValueChangingCommand}" PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
        </dxe:DateEdit>-->
        <!--<dxg:GridControl x:Name="dxgGridControl1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4"
                         ItemsSource="{Binding Path=EmployeeLeaves,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}" SelectionMode="Row"
                         SelectedItem="{Binding Path=SelectedLeaveRecord,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                         ImplyNullLikeEmptyStringWhenFiltering="True"
                         Visibility="{Binding IsGridViewVisible,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxg:GridColumn Header="{DynamicResource LeaveStartDate}" FieldName="StartDate"  Width="100" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True">
                <dxg:GridColumn.CellTemplate>
                    <DataTemplate>
                        --><!--<TextBlock VerticalAlignment="Center" Text="{Binding RowData.Row.StartDate,StringFormat=d,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" />--><!--
                    </DataTemplate>
                </dxg:GridColumn.CellTemplate>
            </dxg:GridColumn>


            <dxg:GridColumn Header="{DynamicResource LeaveStartTime}" FieldName="StartTime" Visible="{Binding HideColumn,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="100" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True">
                <dxg:GridColumn.EditSettings>
                    <dxe:TextEditSettings MaskType="DateTime"
                                           MaskUseAsDisplayFormat="True"
                                           Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    />
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

           
            <dxg:GridColumn Header="{DynamicResource LeaveStartTime}" FieldName="StartLeaveTimeForExcel" Visible="{Binding ShowColumn,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="100" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True">
                <dxg:GridColumn.EditSettings>
                    <dxe:TextEditSettings MaskType="DateTime"
                                           MaskUseAsDisplayFormat="True"
                                           Mask="{Binding TimeEditMask,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                    />
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridColumn Header="{DynamicResource LeaveEndDate}" FieldName="EndDate" Width="100" FixedWidth="True" FilterPopupMode="CheckedList" ReadOnly="True">
                <dxg:GridColumn.CellTemplate>
                    <DataTemplate>
                        --><!--<TextBlock VerticalAlignment="Center" Text="{Binding RowData.Row.EndDate,StringFormat=d,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" />--><!--
                    </DataTemplate>
                </dxg:GridColumn.CellTemplate>
            </dxg:GridColumn>

        </dxg:GridControl>-->

        <StackPanel Grid.Row="4"                     HorizontalAlignment="Center"                    VerticalAlignment="top"                    Orientation="Horizontal"                     Width="290" Grid.ColumnSpan="5" Grid.Column="2" >            <Button Content="{DynamicResource Accept}"                            Command="{Binding AddItemsSaveWorkLogCommand}"                            Height="30"                            Width="90"                            Margin="15,0,0,0"                            HorizontalAlignment="Center"                            VerticalAlignment="Bottom"  />            <Button Content="{DynamicResource Cancel}"                            Command="{Binding CancelButtonCommand}"                             Height="30"                            Width="90"                            Margin="55,0,0,0"                            HorizontalAlignment="Center"                            VerticalAlignment="Bottom" />        </StackPanel>
    </Grid>
</dxwui:WinUIDialogWindow>
