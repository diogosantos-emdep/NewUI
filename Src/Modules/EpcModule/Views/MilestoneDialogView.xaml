<dxwui:WinUIDialogWindow 
                        x:Class="Emdep.Geos.Modules.Epc.Views.MilestoneDialogView"
                        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                        xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
                        xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
                        xmlns:viewModel="clr-namespace:Emdep.Geos.Modules.Epc.ViewModels"
                        xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
                        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" 
                        xmlns:local="clr-namespace:Emdep.Geos.Modules.Epc.Common.EPC"  
                        mc:Ignorable="d" 
                        d:DesignHeight="350" d:DesignWidth="800">

    <dxwui:WinUIDialogWindow.Resources>
        <UIConverter:MilestoneActionConverter x:Key="MilestoneActionConverter"/>

        <ControlTemplate x:Key="popupContentTemplate">
            <dxg:GridControl x:Name="PART_GridControl" AutoExpandAllGroups="True">
                <dxg:GridControl.Columns>
                    <dxg:GridColumn Header="FullName" FieldName="FullName" />
                    <dxg:GridColumn Header="Email" FieldName="CompanyEmail" />
                    <!--<dxg:GridColumn FieldName="UserProfileImageInBytes" Width="60" FixedWidth="True">
                        <dxg:GridColumn.EditSettings>
                            <dxe:ImageEditSettings ShowMenu="True" />
                        </dxg:GridColumn.EditSettings>
                    </dxg:GridColumn>-->
                </dxg:GridControl.Columns>
                <dxg:GridControl.View>
                    <dxg:TableView Name="View" ShowGroupedColumns="True" AutoWidth="True" AllowPerPixelScrolling="True" 
                                   ScrollAnimationDuration="0" ShowAutoFilterRow="True" ShowTotalSummary="True" IsSynchronizedWithCurrentItem="False">
                    </dxg:TableView>
                </dxg:GridControl.View>
            </dxg:GridControl>
        </ControlTemplate>

    </dxwui:WinUIDialogWindow.Resources>
    <!--<dxwui:WinUIDialogWindow.DataContext>
        <viewModel:MilestoneDialogViewModel/>
    </dxwui:WinUIDialogWindow.DataContext>-->
    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape"  Command="{Binding MilestoneMailCancelButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"></RowDefinition>
            <RowDefinition Height="30"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="100"></RowDefinition>
            <RowDefinition Height="30"></RowDefinition>
            <RowDefinition Height="40"></RowDefinition>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100"/>
            <ColumnDefinition Width="50"/>
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Row="0" Grid.ColumnSpan="3" Orientation="Vertical">
            <Label Grid.Row="0" Grid.ColumnSpan="2" Content="Milestone Notification"
               FontSize="28" FontWeight="Bold" HorizontalAlignment="Left"
               VerticalAlignment="Top" FontFamily="Calibri" Margin="0,0,0,0" >
            </Label>
        </StackPanel>

        <!--Milestone Type-->
        <Label  Content="Milestone Type" Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" />
        <dxe:ComboBoxEdit x:Name="cmbType" HorizontalAlignment="Left" Width="150" 
                           IsTextEditable="False" Grid.Row="1" Grid.Column="2" Margin="0,3" 
                           ItemsSource="{dxe:EnumItemsSource EnumType=local:MilestoneMailType}" SelectedItem="{Binding MySelectedItem}" >
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="SelectedIndexChanged">
                    <i:InvokeCommandAction Command="{Binding MilestoneMailSelectedIndexChangedCommand}"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
        </dxe:ComboBoxEdit>

        <!--Mail To-->
        <Label  Content="TO" Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2" />
        <dxg:LookUpEdit Grid.Row="2" Grid.Column="2" Grid.ColumnSpan="1" Width="400" HorizontalAlignment="Left" Margin="0,3,0,3"
                        MaxHeight="90" PopupHeight="500" PopupWidth="750" PopupMinHeight="100" PopupMinWidth="100" IsPopupAutoWidth="False"
                        ValidateOnTextInput="True" ValidateOnEnterKeyPressed="True"
                        PopupContentTemplate="{StaticResource popupContentTemplate}"
                        ItemsSource="{Binding Path=UserList}"
                        EditValue="{Binding SelectedToUserList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        AutoPopulateColumns="False"
                        DisplayMember="FullName"
                        AutoComplete="True"
                        IncrementalFiltering="True"
                        VerticalScrollBarVisibility="Auto"
                        ImmediatePopup= "True">
            <dxg:LookUpEdit.StyleSettings>
                <dxg:TokenLookUpEditStyleSettings EnableTokenWrapping="True"/>
            </dxg:LookUpEdit.StyleSettings>
        </dxg:LookUpEdit>

        <!--Mail CC-->
        <Label  Content="CC" Grid.Column="0" Grid.Row="3" Grid.ColumnSpan="2" />
        <dxg:LookUpEdit Grid.Row="3" Grid.Column="2" Width="400" HorizontalAlignment="Left" Margin="0,3,0,3"
                        MaxHeight="90" PopupHeight="500" PopupWidth="750" PopupMinHeight="100" PopupMinWidth="100" IsPopupAutoWidth="False"
                        ValidateOnTextInput="True" ValidateOnEnterKeyPressed="True"
                        PopupContentTemplate="{StaticResource popupContentTemplate}"
                        ItemsSource="{Binding Path=UserList}"
                        EditValue="{Binding SelectedCCUserList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        AutoPopulateColumns="False"
                        DisplayMember="FullName"
                        AutoComplete="True"
                        IncrementalFiltering="True"
                        VerticalScrollBarVisibility="Auto"
                        ImmediatePopup= "True">
            <dxg:LookUpEdit.StyleSettings>
                <dxg:TokenLookUpEditStyleSettings EnableTokenWrapping="True"/>
            </dxg:LookUpEdit.StyleSettings>
        </dxg:LookUpEdit>

        <!--Description-->
        <Label Content="Description" Grid.Column="0" Grid.Row="4" Grid.ColumnSpan="2"></Label>
        <dxe:TextEdit Grid.Row="4" Grid.Column="2" Width="400" Height="100" 
                      HorizontalAlignment="Left" VerticalScrollBarVisibility="Visible"
                      VerticalContentAlignment="Top" HorizontalContentAlignment="Left"
                      AcceptsReturn="True" VerticalAlignment="Top"
                      Margin="0,0,25,0" Grid.ColumnSpan="2" 
                      Text="{Binding DataContext.ProjectMilestoneData.Description, RelativeSource={RelativeSource AncestorType={x:Type dxwui:WinUIDialogWindow}, Mode=FindAncestor}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" >
            <!--<dxe:TextEdit.EditValue>
                <Binding Path ="FeedbackWindowDescription" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Helpers:CustomRequiredFieldValidation ValidationMessage="{StaticResource FeedbackWindowDescriptionEmpty}" ValidationStep="UpdatedValue"   />
                    </Binding.ValidationRules>
                </Binding>
            </dxe:TextEdit.EditValue>-->
        </dxe:TextEdit>

        <Label Name="lblMsDate" Content= "New Date" Grid.Column="0" Grid.Row="5" 
               Width="150" HorizontalAlignment="Left" IsEnabled="{Binding IsVEnabl, Mode=OneWay}"
               Visibility="{Binding  ElementName=cmbType,Path=Text,Converter={StaticResource MilestoneActionConverter}}" Grid.ColumnSpan="2">
        </Label>
        <dxe:DateEdit Grid.Row="5" Grid.Column="2" Width="400" Margin="0,4,24,0"  
                      IsEnabled="{Binding IsEnable}" HorizontalAlignment="Center" 
                      Visibility="{Binding  ElementName=cmbType,Path=Text,Converter={StaticResource MilestoneActionConverter}}"
                      EditValue="{Binding DataContext.NewTargetDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow, Mode=FindAncestor}}" />

        <StackPanel Grid.Row="6" Grid.Column="2" Width="290" Margin="56,0"
                    HorizontalAlignment="Center" Orientation="Horizontal">
            
            <Button Content="Accept" Height="30" Width="100" Margin="0,0,30,0"
                    FontFamily="Calibri" VerticalAlignment="Bottom"
                    Command="{Binding MilestoneMailAcceptButtonCommand}">
            </Button>

            <Button Content="Cancel" Height="30" Width="100" Margin="30,0,0,0"
                    FontFamily="Calibri" VerticalAlignment="Bottom"  
                    Command="{Binding MilestoneMailCancelButtonCommand}" >
                <!--<i:Interaction.Triggers>
                    <i:EventTrigger EventName="MouseLeftButtonDown" >
                        <i:InvokeCommandAction Command="{Binding MilestoneMailCancelButtonCommand}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>-->
            </Button>
        </StackPanel>
        
    </Grid>
</dxwui:WinUIDialogWindow>