<UserControl x:Class="Emdep.Geos.Modules.Epc.Views.WbsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             xmlns:viewModel="clr-namespace:Emdep.Geos.Modules.Epc.ViewModels"
             xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             DataContext="{dxmvvm:ViewModelSource Type={x:Type viewModel:WbsViewModel}}"
              mc:Ignorable="d" 
             d:DesignHeight="400" d:DesignWidth="400">
    <!--<UserControl.DataContext>
        <viewModel:WbsViewModel/>
    </UserControl.DataContext>-->
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Emdep.Geos.Modules.Epc;component/Resources/EpcCommonResource.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <Style x:Key="ComboBoxEditStyle" TargetType="dxe:ComboBoxEdit">
                <Setter Property="EditNonEditableTemplate">
                    <Setter.Value>
                        <ControlTemplate>
                            <StackPanel HorizontalAlignment="Left" VerticalAlignment="Center" Orientation="Horizontal">
                                <Image Source="{Binding SelectedItem.IdImage, Converter={StaticResource WbsResourcesToImageConverter}}"  Margin="5"/>
                                <TextBlock Text="{Binding SelectedItem.Value}" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="ItemTemplate">
                    <Setter.Value>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Image Source="{Binding IdImage, Converter={StaticResource WbsResourcesToImageConverter}}"  Margin="0,0,5,0"/>
                                <TextBlock Text="{Binding Value}" VerticalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="IsTextEditable" Value="False" />
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <DockPanel LastChildFill="True">
            <dxwui:PageAdornerControl  Header="WBS Editor" DockPanel.Dock="Top" Margin="-20"/>
            <dx:DXTabControl>
                <dx:DXTabItem Header="WBS">
                    <dxb:BarManager>
                        <dxb:BarManager.Items>
                            <dxb:BarButtonItem Name="bbiWbsAddNode" Content="Add Node"  Glyph="{dx:DXImage Image=News_16x16.png}" >
                                <i:Interaction.Triggers>
                                    <i:EventTrigger  EventName="ItemClick" >
                                        <behaviors:InvokeDelegateCommandAction Command="{Binding WbsAddNodeCommand}" CommandParameter="{Binding RelativeSource={RelativeSource Self}, Path=InvokeParameter}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </dxb:BarButtonItem>
                            <dxb:BarButtonItem Name="bbiWbsDeleteNode" Content="Delete Node">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger  EventName="ItemClick" >
                                        <behaviors:InvokeDelegateCommandAction Command="{Binding WbsDeleteNodeCommand}" CommandParameter="{Binding RelativeSource={RelativeSource Self}, Path=InvokeParameter}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </dxb:BarButtonItem>
                        </dxb:BarManager.Items>
                  
                    <dxg:TreeListControl x:Name="treeList" ItemsSource="{Binding ListWbs}" Margin="-10" SelectionMode="Cell">
                        <dxg:TreeListControl.Columns>
                            <dxg:TreeListColumn FieldName="TaskTitle" Header=" Group" AllowSorting="True"  />
                            <dxg:TreeListColumn Header="Resources" AllowSorting="True"  >
                                <dxg:TreeListColumn.CellTemplate>
                                    <DataTemplate>
                                        <!--<dxe:ComboBoxEdit x:Name="resourcesCombo"
                                                          DisplayMember="Value" ValueMember="IdLookupValue" 
                                                          ApplyItemTemplateToSelectedItem="True"
                                                          IsTextEditable="False"
                                                          ItemsSource="{Binding View.DataContext.WbsResourcesList}"
                                                          Style="{StaticResource ComboBoxEditStyle}">
                                            <dxmvvm:Interaction.Triggers>
                                                <dxmvvm:EventToCommand Command="{Binding CommandWbsResourcesCombo}" PassEventArgsToCommand="True" EventName="EditValueChanged" SourceName="resourcesCombo"></dxmvvm:EventToCommand>
                                            </dxmvvm:Interaction.Triggers>
                                        </dxe:ComboBoxEdit>-->
                                    </DataTemplate>
                                </dxg:TreeListColumn.CellTemplate>
                            </dxg:TreeListColumn>
                            <dxg:TreeListColumn Header="Reference" AllowSorting="True"/>
                            <dxg:TreeListColumn Header="Description" AllowSorting="True"/>
                            <dxg:TreeListColumn Header="Hours" AllowSorting="True"/>
                            <dxg:TreeListColumn Header="MaterialUP" AllowSorting="True"/>
                            <dxg:TreeListColumn Header="Quantity" AllowSorting="True"/>
                            <dxg:TreeListColumn Header="Total" AllowSorting="True"/>
                        </dxg:TreeListControl.Columns>
                        <dxg:TreeListControl.View>
                                <dxg:TreeListView x:Name="treeListViewWbs" KeyFieldName="ID" ParentFieldName="ParentID" EditorShowMode="MouseUpFocused" AutoExpandAllNodes="True" AutoWidth="True" AllowPerPixelScrolling="True" ShowTotalSummary="True" AllowBestFit="True">
                                    <dxg:TreeListView.RowCellMenuCustomizations>
                                        <dxb:BarButtonItemLink BarItemName="bbiWbsAddNode"/>
                                        <dxb:BarButtonItemLink BarItemName="bbiWbsDeleteNode"/>
                                    </dxg:TreeListView.RowCellMenuCustomizations>
                                    <!--    <dxg:TreeListView.RowCellMenuCustomizations>
                                    <dxb:BarButtonItem Name="AddWbsNode" Content="Add Node" Command="{Binding Path=(dxb:GridPopupMenuBase.GridMenuInfo).View.DataContext.WbsAddNodeCommand, RelativeSource={RelativeSource Self}}" />
                                    <dxb:BarButtonItem Name="DeleteWbsNode" Content="Delete Node" IsVisible="{Binding Row.Node.HasChildren}" Command="{Binding Path=(dxb:GridPopupMenuBase.GridMenuInfo).View.DataContext.WbsDeleteNodeCommand, RelativeSource={RelativeSource Self}}"/> ItemClick="DeleteWbsNode_ItemClick"/>
                         
                                </dxg:TreeListView.RowCellMenuCustomizations>-->
                                </dxg:TreeListView>
                            </dxg:TreeListControl.View>
             

                    </dxg:TreeListControl>
                    </dxb:BarManager>
                </dx:DXTabItem>
                <dx:DXTabItem Header="Deliverables">
                    <Grid Background="Transparent">
                        <dxg:GridControl AutoGenerateColumns="AddNew" EnableSmartColumnsGeneration="True">
                            <dxg:GridControl.Columns>
                                <dxg:GridColumn FieldName="Items"/>
                                <dxg:GridColumn FieldName="Description"/>
                                <dxg:GridColumn FieldName="Quantity"/>
                            </dxg:GridControl.Columns>
                            <dxg:GridControl.View>
                                <dxg:TableView AllowPerPixelScrolling="True" ShowTotalSummary="True" ShowGroupPanel="False" AutoWidth="True"/>
                            </dxg:GridControl.View>
                        </dxg:GridControl>
                    </Grid>
                </dx:DXTabItem>
            </dx:DXTabControl>

        </DockPanel>

    </Grid>
</UserControl>
