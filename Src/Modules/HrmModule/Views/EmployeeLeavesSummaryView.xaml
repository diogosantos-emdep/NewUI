<UserControl x:Class="Emdep.Geos.Modules.Hrm.Views.EmployeeLeavesSummaryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Emdep.Geos.Modules.Hrm.Views"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:HrmApplication="clr-namespace:Emdep.Geos.Modules.Hrm" 
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
             xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:Interactive="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:Behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             xmlns:dxei="http://schemas.devexpress.com/winfx/2008/xaml/editors/internal"
             xmlns:dxi="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"
             xmlns:dxet="http://schemas.devexpress.com/winfx/2008/xaml/editors/themekeys"
             xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"  
             xmlns:Converters="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:Coverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <UserControl.Resources>
        <dx:BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <ControlTemplate x:Key="ItemTemplate" TargetType="{x:Type dxe:ListBoxEditItem}">
            <Border x:Name="rootBorder" BorderThickness="0,0,0,1" BorderBrush="{dxi:ThemeResource ThemeKey={dxgt:GridRowThemeKey ResourceKey=GridDataRowDelimiterBrush}}"
                     Background="{TemplateBinding Background}">
                <Grid x:Name="Root">
                    <Rectangle x:Name="FocusVisual" Opacity="0" Stroke="#FF3C3C3C" StrokeDashArray="1 2" StrokeThickness="1" />
                    <Border x:Name="InactiveSelectedState" Background="#FFDDDDDD" Opacity="0" />
                    <Border x:Name="SelectedState" Background="#FF92C0E0" Opacity="0" />
                    <Border x:Name="HoverState" Background="#FFCDE6F7" Opacity="0" 
                        Visibility="{Binding Path=(dxe:BaseEdit.OwnerEdit).AllowItemHighlighting, Converter={StaticResource BoolToVisibilityConverter}, RelativeSource={RelativeSource TemplatedParent}}" />
                    <Border x:Name="FocusedState" Background="#7F82B0D0" Opacity="0" />
                    <DockPanel HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" LastChildFill="True" VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                        <dxei:ImagePresenter DockPanel.Dock="Left" Padding="{StaticResource {dxet:ComboBoxEditThemeKey ResourceKey=SelectedItemImagePadding}}" />
                        <dx:ContentContainer x:Name="content" Margin="{StaticResource {dxet:ComboBoxEditThemeKey ResourceKey=SelectedItemContentPadding}}">
                            <ContentPresenter x:Name="contentPresenter" Height="Auto" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" Width="Auto" />
                        </dx:ContentContainer>
                    </DockPanel>
                </Grid>
            </Border>
            <ControlTemplate.Triggers>
                <DataTrigger Value="True">
                    <DataTrigger.Binding>
                        <MultiBinding Converter="{Converters:ListItemBackgroundColorConverter}">
                            <Binding Path="(dxe:BaseEdit.OwnerEdit).ItemsSource" RelativeSource="{RelativeSource Self}"/>
                            <Binding Path="."/>
                        </MultiBinding>
                    </DataTrigger.Binding>

                    <Setter TargetName="rootBorder" Property="BorderThickness" Value="0"/>
                </DataTrigger>
                <Trigger Property="IsKeyboardFocused" Value="True">
                    <Setter Property="Opacity" TargetName="SelectedState" Value="0" />
                    <Setter Property="Opacity" TargetName="HoverState" Value="0" />
                    <Setter Property="Opacity" TargetName="FocusVisual" Value="0" />
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Opacity" TargetName="SelectedState" Value="0" />
                    <Setter Property="Opacity" TargetName="HoverState" Value="0" />
                    <Setter Property="Opacity" TargetName="FocusVisual" Value="0" />
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Opacity" TargetName="SelectedState" Value="0" />
                    <Setter Property="Opacity" TargetName="HoverState" Value="0" />
                    <Setter Property="Opacity" TargetName="FocusVisual" Value="0" />
                </Trigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsSelected" Value="True" />
                        <Condition Property="IsFocused" Value="False" />
                    </MultiTrigger.Conditions>
                    <Setter Property="Opacity" TargetName="SelectedState" Value="0" />
                    <Setter Property="Opacity" TargetName="HoverState" Value="0" />
                    <Setter Property="Opacity" TargetName="FocusVisual" Value="0" />
                </MultiTrigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" TargetName="content" Value="0.35" />
                </Trigger>
                <Trigger Property="dx:ThemeManager.IsTouchEnabled" Value="True">
                    <Setter Property="Margin" TargetName="content" Value="12" />
                </Trigger>

            </ControlTemplate.Triggers>
        </ControlTemplate>

        <!--<Style x:Key="LeavesStyle" TargetType="{x:Type dxe:ListBoxEditItem}">
            <Setter Property="Background" Value="{Binding CompanyLeave.HtmlColor}" />
            <Setter Property="TextBlock.Foreground" Value="{Binding CompanyLeave.HtmlColor,Converter={Converters:ForegroundColorConverter}}"></Setter>
            <Setter Property="Template" Value="{StaticResource ItemTemplate}">
            </Setter>
        </Style>-->
        <!--<Style x:Key="LeavesRemainingStyle" TargetType="{x:Type dxe:ListBoxEditItem}">
            <Setter Property="Background" Value="{Binding Remaining,Converter={Converters:GridBackgroundConverter}}" />
            <Setter Property="Template" Value="{StaticResource ItemTemplate}">
            </Setter>
        </Style>-->
        <Style x:Key="LeavesDepartmentNameStyle" TargetType="{x:Type dxe:ListBoxEditItem}">
            <Setter Property="Background" Value="{Binding DepartmentHtmlColor}" />
            <Setter Property="TextBlock.Foreground" Value="{Binding DepartmentHtmlColor,Converter={Converters:ForegroundColorConverter}}"></Setter>
            <Setter Property="Template" Value="{StaticResource ItemTemplate}"></Setter>
        </Style>
        
        <Converters:HoursConverter x:Key="sourceConverter"/>
        
    </UserControl.Resources>
    <Grid >
        <Grid.RowDefinitions>
            <RowDefinition Height="55"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Label Content="{DynamicResource EmployeeLeavesSummaryHeader}" HorizontalAlignment="Left" Style="{StaticResource LabelTitleStyle}" Grid.Row="0" Grid.Column="0" />
        <Grid HorizontalAlignment="Right" Grid.Row="0" Grid.Column="1" Margin="0,5,0,0" >
            <Grid.RowDefinitions>
                <RowDefinition Height="AUTO" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
                <ColumnDefinition Width="AUTO" />
            </Grid.ColumnDefinitions>
            <!--Company-->
            <TextBlock Grid.Column="1" Grid.Row="2" Text="{DynamicResource CommonPlant}" FontWeight="Bold" Margin="10,2,5,0" HorizontalAlignment="Right" Height="25" IsEnabled="True" />

            <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}" Grid.Column="2" Grid.Row="0" Width="150" Height="30"
                                ItemsSource="{Binding Source={x:Static HrmApplication:HrmCommon.Instance}, Path=UserAuthorizedPlantsList}"
                                EditValue="{Binding Source={x:Static HrmApplication:HrmCommon.Instance}, Path=SelectedAuthorizedPlantsList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,5,0"
                                DisplayMember="ShortName">

                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:CheckedComboBoxStyleSettings />
                </dxe:ComboBoxEdit.StyleSettings>

                <dxmvvm:Interaction.Triggers>
                    <dxmvvm:EventToCommand EventName="EditValueChanged"
                                           Command="{Binding DataContext.PlantOwnerEditValueChangedCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                           PassEventArgsToCommand="True" />
                </dxmvvm:Interaction.Triggers>
            </dxe:ComboBoxEdit>

            <!--Period-->
            <DockPanel Grid.Column="3" Grid.Row="0" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5,0,0,0">
                <Image Style="{DynamicResource CalendarImageStyle}" Width="30" Height="20" Margin="2,0,3,0" />
                <TextBlock Text="{DynamicResource AnnualSalesPerformanceViewPeriod}" FontWeight="Bold" Margin="0,0,0,0" IsEnabled="True" />
            </DockPanel>

            <dxe:ComboBoxEdit Grid.Row="0" Grid.Column="4" 
                                Name="cmbPeriod"
                                IsTextEditable="False" Margin="5,0,0,0"
                                HorizontalAlignment="Left"
                                IsEnabled="True"
                                Height="30"
                                Width="100"
                                MaxLength="4" 
                                VerticalAlignment="Center" 
                                ItemsSource="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=FinancialYearLst, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding Source={x:Static HrmApplication:HrmCommon.Instance}, Path=SelectedPeriod,UpdateSourceTrigger=PropertyChanged}">
                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:ComboBoxStyleSettings />
                </dxe:ComboBoxEdit.StyleSettings>
                <dxmvvm:Interaction.Triggers>
                    <dxmvvm:EventToCommand EventName="EditValueChanged"
                                               Command="{Binding DataContext.SelectedYearChangedCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                            PassEventArgsToCommand="False"/>

                </dxmvvm:Interaction.Triggers>
            </dxe:ComboBoxEdit>

            <!-- Refresh Button -->
            <Button Visibility="Visible" Grid.Row="0" Grid.Column="6" Height="40" Width="40" HorizontalAlignment="Right" 
                    Command="{Binding RefreshButtonCommand}" CommandParameter="{Binding ElementName=LeavesSummaryTableView}" Margin="5,0,0,0">
                <Button.ToolTip>
                    <TextBlock Text="{DynamicResource ButtonRefresh}" />
                </Button.ToolTip>
                <Button.ContentTemplate>
                    <DataTemplate>
                        <Image Style="{DynamicResource RefreshButtonImageStyle}" Height="24" Width="24" Margin="-20" />
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>

            <!-- Print List-->
            <Button Visibility="Visible" Grid.Row="0" Grid.Column="7" Height="40" Width="40" HorizontalAlignment="Right" 
                    Command="{Binding PrintButtonCommand}" CommandParameter="{Binding ElementName=LeavesSummaryTableView}" Margin="5,0,0,0">
                <Button.ToolTip>
                    <TextBlock Text="{DynamicResource ButtonPrint}" />
                </Button.ToolTip>
                <Button.ContentTemplate>
                    <DataTemplate>
                        <Image Style="{DynamicResource PrinterButtonImageStyle}" Height="24" Width="24" Margin="-10" />
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>

            <!-- Export List-->
            <Button Visibility="Visible" Grid.Row="0" Grid.Column="8" Height="40" Width="40" HorizontalAlignment="Right" 
                    Command="{Binding ExportButtonCommand}"
                    CommandParameter="{Binding ElementName=LeavesSummaryTableView}" Margin="5,0,0,0">
                <Button.ToolTip>
                    <TextBlock Text="{DynamicResource ButtonExportToExcel}" />
                </Button.ToolTip>
                <Button.ContentTemplate>
                    <DataTemplate>
                        <Image Style="{DynamicResource ExcelExportButtonImageStyle}" Height="24" Width="24" Margin="-10" />
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>
        </Grid>
      
        <dxg:GridControl AllowLiveDataShaping="True" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                         ItemsSource="{Binding Path=EmployeeList,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}" 
                         SelectedItem="{Binding Path=SelectedLeaveSummary,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                         ImplyNullLikeEmptyStringWhenFiltering="True" >

            <dxg:GridControl.Bands>
                <dxg:GridControlBand>
                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColCompany}" FieldName="EmployeeCompanyAlias" FilterPopupMode="CheckedList" MinWidth="100" FixedWidth="True" ReadOnly="True" UnboundType="String" x:Name="CompanyName"  >
                        <dxg:GridColumn.CellStyle>   <!--[rdixit][GEOS2-6571][14.12.2024]-->
                            <Style TargetType="{x:Type dxg:LightweightCellEditor}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="BlackAndBlue">
                                        <Setter Property="Foreground" Value="White" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="WhiteAndBlue">
                                        <Setter Property="Foreground" Value="Black" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </dxg:GridColumn.CellStyle>
                    </dxg:GridColumn>
                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColCode}" FieldName="EmployeeCode" FilterPopupMode="CheckedList" Width="100" FixedWidth="True" ReadOnly="True"  >
                        <dxg:GridColumn.CellStyle>   <!--[rdixit][GEOS2-6571][14.12.2024]-->
                            <Style TargetType="{x:Type dxg:LightweightCellEditor}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="BlackAndBlue">
                                        <Setter Property="Foreground" Value="White" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="WhiteAndBlue">
                                        <Setter Property="Foreground" Value="Black" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </dxg:GridColumn.CellStyle>
                    </dxg:GridColumn>
                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColFullName}" FieldName="FullName" FilterPopupMode="CheckedList" MinWidth="300" FixedWidth="True" ReadOnly="True" >
                        <dxg:GridColumn.CellStyle>   <!--[rdixit][GEOS2-6571][14.12.2024]-->
                            <Style TargetType="{x:Type dxg:LightweightCellEditor}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="BlackAndBlue">
                                        <Setter Property="Foreground" Value="White" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="WhiteAndBlue">
                                        <Setter Property="Foreground" Value="Black" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </dxg:GridColumn.CellStyle>
                    </dxg:GridColumn>
                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColJDCode}" FieldName="EmpJobCodes" ColumnFilterMode="DisplayText" FilterPopupMode="CheckedList" Width="200" FixedWidth="True" ReadOnly="True" >
                        <dxg:GridColumn.PrintCellStyle>
                            <Style TargetType="dxe:BaseEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                                <Setter Property="DisplayTemplate">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="dxe:BaseEdit">
                                            <dxe:TextEdit Text="{Binding RowData.Row.EmpJobCodes}"
                                                           TextWrapping="Wrap" dxp:ExportSettings.BorderThickness="1" FontSize="13"
                                                           IsPrintingMode="True" />
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </dxg:GridColumn.PrintCellStyle>
                        <dxg:GridColumn.CellStyle>
                            <!--[rdixit][GEOS2-6571][14.12.2024]-->
                            <Style TargetType="{x:Type dxg:LightweightCellEditor}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="BlackAndBlue">
                                        <Setter Property="Foreground" Value="White" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="WhiteAndBlue">
                                        <Setter Property="Foreground" Value="Black" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </dxg:GridColumn.CellStyle>
                    </dxg:GridColumn>
                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColJobTitle}" FieldName="EmployeeJobTitles" FilterPopupMode="CheckedList"  MinWidth="250" FixedWidth="True" ReadOnly="True" >
                        <dxg:GridColumn.PrintCellStyle>
                            <Style TargetType="dxe:BaseEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                                <Setter Property="DisplayTemplate">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="dxe:BaseEdit">
                                            <dxe:TextEdit Text="{Binding RowData.Row.EmployeeJobTitles}"
                                                           TextWrapping="Wrap" dxp:ExportSettings.BorderThickness="1" FontSize="13"
                                                           IsPrintingMode="True" />
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </dxg:GridColumn.PrintCellStyle>
                        <dxg:GridColumn.CellStyle>
                            <!--[rdixit][GEOS2-6571][14.12.2024]-->
                            <Style TargetType="{x:Type dxg:LightweightCellEditor}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="BlackAndBlue">
                                        <Setter Property="Foreground" Value="White" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="WhiteAndBlue">
                                        <Setter Property="Foreground" Value="Black" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </dxg:GridColumn.CellStyle>
                    </dxg:GridColumn>

                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColDepartment}" FieldName="Departments" FilterPopupMode="CheckedList"   MinWidth="200" FixedWidth="True" ReadOnly="True" Name="Departments"   AllowCellMerge="True" >
                        <dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <dxe:ListBoxEdit ItemsSource="{Binding RowData.Row.LstEmployeeDepartments}" ShowBorder="False"
                                         ItemContainerStyle="{StaticResource LeavesDepartmentNameStyle}"
                                         DisplayMember="DepartmentName">
                                    <dxe:ListBoxEdit.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <UniformGrid Columns="1"></UniformGrid>
                                        </ItemsPanelTemplate>
                                    </dxe:ListBoxEdit.ItemsPanel>
                                </dxe:ListBoxEdit>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>
                        <dxg:GridColumn.PrintCellStyle>
                            <Style BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}" TargetType="{x:Type dxe:TextEdit}">
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                                <Setter Property="DisplayTemplate">
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <TextBlock dxp:TextExportSettings.FontSize="12" Text="{Binding RowData.Row.LstEmployeeDepartments, Converter={Converters:ListToWrapTextConverter},ConverterParameter=Departments}"
                                                   dxp:ExportSettings.TargetType="Text" dxp:ExportSettings.BorderThickness="1"
                                                   TextWrapping="WrapWithOverflow"/>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </dxg:GridColumn.PrintCellStyle>
                    </dxg:GridColumn>

                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColLeaveType}" FieldName="EmployeeAnnualLeave.CompanyLeave.Name" FilterPopupMode="CheckedList" MinWidth="180" FixedWidth="True"  ReadOnly="True" AllowCellMerge="False">
                        <dxg:GridColumn.CellStyle>
                            <Style TargetType="dxg:LightweightCellEditor">
                                <Setter Property="Background" Value="{Binding RowData.Row.EmployeeAnnualLeave.CompanyLeave.HtmlColor}" />
                                <Setter Property="TextBlock.Foreground" Value="{Binding RowData.Row.EmployeeAnnualLeave.CompanyLeave.HtmlColor,Converter={Converters:ForegroundColorConverter}}"></Setter>
                            </Style>
                        </dxg:GridColumn.CellStyle>

                        <dxg:GridColumn.PrintCellStyle>
                            <Style BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}" TargetType="{x:Type dxe:TextEdit}">
                                <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                                <Setter Property="DisplayTemplate">
                                    <Setter.Value>
                                        <ControlTemplate>
                                            <TextBlock Text="{Binding RowData.Row.EmployeeAnnualLeave.CompanyLeave.Name}"
                                                   dxp:ExportSettings.TargetType="Text" dxp:ExportSettings.BorderThickness="1"
                                                   dxp:TextExportSettings.FontSize="12" TextWrapping="WrapWithOverflow"/>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </dxg:GridColumn.PrintCellStyle>

                    </dxg:GridColumn>
                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColBacklog}" 
                            FieldName="EmployeeAnnualLeave.BacklogHoursInDays"
                            SortFieldName="EmployeeAnnualLeave.BacklogHoursCount" 
                            FilterPopupMode="CheckedList"  ColumnFilterMode="DisplayText" 
                            MinWidth="100" FixedWidth="True" ReadOnly="True"  AllowCellMerge="False">
                        <!--<dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.BacklogHoursCount"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>-->
                    </dxg:GridColumn>

                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColRegular}" 
                        FieldName="EmployeeAnnualLeave.RegularHoursInDays" 
                        SortFieldName="EmployeeAnnualLeave.RegularHoursCount" 
                        FilterPopupMode="CheckedList" ColumnFilterMode="DisplayText" 
                        MinWidth="100" FixedWidth="True" ReadOnly="True"  AllowCellMerge="False">
                        <!--<dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.RegularHoursCount"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>-->
                    </dxg:GridColumn>
                </dxg:GridControlBand>
                <dxg:GridControlBand MinWidth="400"
                    Name="Additional" ColumnsSource="{Binding DataContext.AdditionalBandGridColumns,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,RelativeSource={RelativeSource AncestorType=UserControl}}"
                    Header="{DynamicResource Additional}" 
                    HorizontalHeaderContentAlignment="Center" >
                </dxg:GridControlBand>

                <dxg:GridControlBand>
                    <!--<dxg:GridColumn FieldName="EmployeeAnnualLeave.SelectedAdditionalLeaves[0].AdditionalLeaveTotalHours" 
                            Header="Compensation"  AllowCellMerge="False"
                            MinWidth="100" FixedWidth="False" ReadOnly="True" FilterPopupMode="CheckedList">
                        <dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.SelectedAdditionalLeaves[0].AdditionalLeaveTotalHours"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>
                    </dxg:GridColumn>
                    <dxg:GridColumn FieldName="EmployeeAnnualLeave.SelectedAdditionalLeaves[1].AdditionalLeaveTotalHours" 
                            Header="Long Service"  AllowCellMerge="False"
                            MinWidth="100" FixedWidth="False" ReadOnly="True" FilterPopupMode="CheckedList">
                        <dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.SelectedAdditionalLeaves[1].AdditionalLeaveTotalHours"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>
                    </dxg:GridColumn>
                    <dxg:GridColumn Header="Bonus" MinWidth="100" FixedWidth="False" ReadOnly="True" 
                            FilterPopupMode="CheckedList"  AllowCellMerge="False">
                        <dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.SelectedAdditionalLeaves[2].AdditionalLeaveTotalHours"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>
                    </dxg:GridColumn>
                    <dxg:GridColumn FieldName="EmployeeAnnualLeave.SelectedAdditionalLeaves[3].AdditionalLeaveTotalHours" 
                Header="Other"  AllowCellMerge="False"
                MinWidth="100" FixedWidth="False" ReadOnly="True" FilterPopupMode="CheckedList">
                        <dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.SelectedAdditionalLeaves[3].AdditionalLeaveTotalHours"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>
                    </dxg:GridColumn>

                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColAdditional}" FieldName="EmployeeAnnualLeave.AdditionalHoursInDays"  ColumnFilterMode="DisplayText"  FilterPopupMode="CheckedList" MinWidth="100" FixedWidth="True" ReadOnly="True" Name="AdditionalHoursCount" AllowCellMerge="False">
                    </dxg:GridColumn>-->
                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColTotal}" 
                                    FieldName="EmployeeAnnualLeave.TotalHoursInDays" 
                                    FilterPopupMode="CheckedList"  MinWidth="100" FixedWidth="True" 
                                    ReadOnly="True" AllowCellMerge="False">
                        <!--<dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.TotalHoursCount"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>-->
                    </dxg:GridColumn>

                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColEnjoyed}" 
                                    FieldName="EmployeeAnnualLeave.EnjoyedTillYesterdayInDays" 
                                    SortFieldName="EmployeeAnnualLeave.EnjoyedTillYesterday"
                                    FilterPopupMode="CheckedList"  MinWidth="100" FixedWidth="True" 
                                    ReadOnly="True" AllowCellMerge="False" >
                        <!--<dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.EnjoyedTillYesterday"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>-->
                    </dxg:GridColumn>

                    <dxg:GridColumn Header="{DynamicResource Enjoying}" 
                                    FieldName="EmployeeAnnualLeave.EnjoyingFromTodayInDays" 
                                    SortFieldName="EmployeeAnnualLeave.EnjoyingFromToday" 
                                    FilterPopupMode="CheckedList"  MinWidth="100" FixedWidth="True" ReadOnly="True" AllowCellMerge="False" >
                        <!--<dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock >
                                    <TextBlock.Text >
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.EnjoyingFromToday"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>-->
                    </dxg:GridColumn>
                    
                    <dxg:GridColumn Header="{DynamicResource LeavesSummaryGridColRemaining}"  
                                    FieldName="EmployeeAnnualLeave.RemainingHoursInDays" 
                                    SortFieldName="EmployeeAnnualLeave.Remaining" 
                                    FilterPopupMode="CheckedList" MinWidth="100" FixedWidth="True" ReadOnly="True" AllowCellMerge="False">
                        <dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <DockPanel>
                                    <DockPanel.Style>
                                    <!--ToolTip="{DynamicResource ToolTipRemainingHoursAreMoreThan35PercentOfRegular}"
                                    >-->
<Style TargetType="DockPanel">
        <Style.Triggers>
        <DataTrigger Value="Visible">
                <DataTrigger.Binding>
                <MultiBinding Converter="{Converters:RemainingLeaveNotificationFlagVisibilityConverter}">
                        <Binding Path="RowData.Row.EmployeeAnnualLeave"/>
                        <Binding
                                    Source="{x:Static HrmApplication:HrmCommon.Instance}"
                                Path="PercentageForHighRemainingLeaves" 
                                    Mode="TwoWay"
                                    UpdateSourceTrigger="PropertyChanged"/>
                    </MultiBinding>
                </DataTrigger.Binding>
                <Setter Property="ToolTip" Value="{DynamicResource ToolTipRemainingHoursAreMoreThan35PercentOfRegular}"/>
        </DataTrigger>
    </Style.Triggers>
</Style>
                                </DockPanel.Style>
                                <Image Style="{DynamicResource NotificationFlagImageStyle}"
                                            Width="20" Stretch="Uniform" Margin="1"
                                           DockPanel.Dock="Left" HorizontalAlignment="Right"
                                           dxp:ExportSettings.TargetType="None"
                                           >
                                        <Image.Visibility>
                                            <MultiBinding Converter="{Converters:RemainingLeaveNotificationFlagVisibilityConverter}">
                                                <Binding Path="RowData.Row.EmployeeAnnualLeave"/>
                                                <Binding
                                                    Source="{x:Static HrmApplication:HrmCommon.Instance}"
                                                    Path="PercentageForHighRemainingLeaves" 
                                                    Mode="TwoWay"
                                                    UpdateSourceTrigger="PropertyChanged"/>
                                            </MultiBinding>
                                        </Image.Visibility>
                                    </Image>
                                    <TextBlock DockPanel.Dock="Left" HorizontalAlignment="Left"
                                               VerticalAlignment="Center"
                                               Text="{Binding Path=RowData.Row.EmployeeAnnualLeave.RemainingHoursInDays}">
                                    <!--<TextBlock.Text>
                                        <MultiBinding Converter="{Coverter:HoursToDayConverter}">
                                            <Binding Path="RowData.Row.EmployeeAnnualLeave.Remaining"  />
                                            <Binding Path="RowData.Row.CompanyShift.CompanyAnnualSchedule.DailyHoursCount" />
                                        </MultiBinding>
                                    </TextBlock.Text>-->
                                    </TextBlock>
                                </DockPanel>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>
                        <!--<dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <TextBlock HorizontalAlignment="Right" VerticalAlignment="Center" Name="tbRemaining" Margin="0,0,5,0" Text="{Binding RowData.Row.EmployeeAnnualLeave.RemainingHoursInDays}">
                                    </TextBlock>
                                    <Grid.Style>
                                        <Style>
                                            <Setter Property="Grid.Background" Value="{Binding Text,ElementName=tbRemaining,Converter={Converters:GridBackgroundConverter}}"  />
                                        </Style>
                                    </Grid.Style>
                                </Grid>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>-->
                    </dxg:GridColumn>
                </dxg:GridControlBand>
            </dxg:GridControl.Bands>
            <dxmvvm:Interaction.Behaviors>
                <UIHelper:GridSelectingBehavior />
                <dxmvvm:EventToCommand EventName="CustomRowFilter"
                                       Command="{Binding CustomRowFilterCommand}"
                                       PassEventArgsToCommand="True" />
            </dxmvvm:Interaction.Behaviors>
            
            <dxg:GridControl.TotalSummary>
                <dxg:GridSummaryItem x:Name="summary" FieldName="Name" SummaryType="Count" DisplayFormat="Total Count: {0}" Visible="True" Alignment="Left" />
            </dxg:GridControl.TotalSummary>
            <dxg:GridControl.View>
                <dxg:TableView x:Name="LeavesSummaryTableView"
                                   AllowCellMerge="True"
                                   RowDetailsVisibilityMode="Visible"
                                   ShowHorizontalLines="True"
                                   ShowSearchPanelMode="Always"
                                   ShowColumnHeaders="True"
                                   VerticalScrollbarVisibility="Auto" 
                                   HorizontalScrollbarVisibility="Auto"
                                   AllowFixedColumnMenu="False"
                                   ShowFixedTotalSummary="True" 
                                   SearchPanelHorizontalAlignment="Stretch"
                                   ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly"
                                   AllowEditing="False"
                                   AllowGrouping="True"
                                   ShowGroupPanel="False"     
                                   FocusedRow="{Binding Path=SelectedLeaveSummary,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                   ShowIndicator="False" AutoWidth="True"
                                   SearchString="{Binding MyFilterString,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">
                    <!--[rdixit][GEOS2-6571][14.12.2024]-->
                    <dxg:TableView.RowStyle>
                        <Style TargetType="{x:Type dxg:RowControl}" BasedOn="{StaticResource BaseUniversalStyle}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Row.EmployeeAnnualLeave.IsLeaveAvailable}" Value="FALSE">
                                    <Setter Property="Foreground" Value="Gray" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </dxg:TableView.RowStyle>
                    <dxg:TableView.FormatConditions>
                        <dxg:FormatCondition FieldName="EmployeeAnnualLeave.CompanyLeave.Namess"/>
                    </dxg:TableView.FormatConditions>
                    <dxg:TableView.Resources>
                        <DataTemplate x:Key="LeavesSummaryReportPrintHeaderTemplate">
                            <Grid Width="{Binding UsablePageWidth}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="50" />
                                    <ColumnDefinition Width="130" />
                                </Grid.ColumnDefinitions>
                                <dxe:TextEdit Text=" " Width="{Binding UsablePageWidth}" Grid.ColumnSpan="3" IsPrintingMode="True" Background="#333E5E" HorizontalAlignment="Stretch" 
                                                      VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" Style="{DynamicResource TextEdit20Style}" FontWeight="Bold" Height="50" />
                                <dxe:TextEdit Text="Leaves Summary Report" IsPrintingMode="True" HorizontalAlignment="Stretch" 
                                                      VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" Style="{DynamicResource TextEdit20Style}" FontWeight="Bold" />
                                <Image Source="/Emdep.Geos.Modules.Hrm;component/Assets/Images/GeosReportLogo.png" Height="50" Width="80" dxp:ExportSettings.TargetType="Image" Grid.Column="2" />
                            </Grid>
                        </DataTemplate>

                        <DataTemplate x:Key="LeavesSummaryReportPrintFooterTemplate">
                            <dxe:TextEdit HorizontalContentAlignment="Center" 
                                                  Width="{Binding Path=UsablePageWidth, Mode=OneWay}" 
                                                  dxp:ExportSettings.TargetType="PageNumber" 
                                                  dxp:PageNumberExportSettings.Kind="NumberOfTotal" 
                                                  dxp:PageNumberExportSettings.Format="Page {0} of {1}" />
                        </DataTemplate>
                    </dxg:TableView.Resources>
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand Command="{Binding GridDoubleClickCommand}" EventName="MouseDoubleClick" CommandParameter="{Binding ElementName=LeavesSummaryTableView}">
                            <dxmvvm:EventToCommand.EventArgsConverter>
                                <dx:EventArgsToDataRowConverter />
                            </dxmvvm:EventToCommand.EventArgsConverter>
                        </dxmvvm:EventToCommand>
                        <dxmvvm:EventToCommand EventName="ShowFilterPopup"
                                               Command="{Binding CustomShowFilterPopupCommand}"
                                               PassEventArgsToCommand="True"/>
                        
                        <UIHelper:CellMergeBehavior/>
                        
                    </dxmvvm:Interaction.Behaviors>
                </dxg:TableView>
            </dxg:GridControl.View>
        </dxg:GridControl>

    </Grid>

</UserControl>
