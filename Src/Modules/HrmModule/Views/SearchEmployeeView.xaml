<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Hrm.Views.SearchEmployeeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"    
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.Hrm.ViewModels"
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
             xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"             
                         xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
                         xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
                         xmlns:HrmApplication="clr-namespace:Emdep.Geos.Modules.Hrm"                         
                         xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
                         xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
                         xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing" 
                         xmlns:Converters="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="860" d:DesignWidth="870"
             Title="{DynamicResource HrmMainViewModelSearchEmployee}"
             TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}" Loaded="WinUIDialogWindow_Loaded">

    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape"  Command="{Binding ExportAttendanceViewCancelButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="30"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="30"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="10"/>
            <RowDefinition Height="30"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" HorizontalAlignment="Center">

            <Grid.ColumnDefinitions>
                
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="130"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="130"/>
                
            </Grid.ColumnDefinitions>

            <!--Plant-->
            <Label Content= "{DynamicResource CommonPlant}" Grid.Row="0" Grid.Column="0"  HorizontalAlignment="Right" Height="30" FontSize="16" FontWeight="Bold" />
            <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}" Grid.Column="2" Grid.Row="0" Width="120" Height="30" HorizontalAlignment="Left"
                                ItemsSource="{Binding CombineIslocationIsorganizationIscompanyList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                EditValue="{Binding SelectedAuthorizedPlantsList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,0"
                                DisplayMember="ShortName">

                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:CheckedComboBoxStyleSettings />
                </dxe:ComboBoxEdit.StyleSettings>

                
            </dxe:ComboBoxEdit>

            <!--Period-->
            <DockPanel Grid.Column="4" Grid.Row="0" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5,0,0,0">
                <Image Style="{DynamicResource CalendarImageStyle}" Width="30" Height="20" Margin="2,0,3,0" />
                <Label Content= "{DynamicResource AnnualSalesPerformanceViewPeriod}" Margin="0,0,0,0" Height="30" FontSize="16" FontWeight="Bold" />
            </DockPanel>

            <dxe:ComboBoxEdit Name="CombPeriod" Grid.Row="0" Grid.Column="6"
                              HorizontalAlignment="Left" VerticalAlignment="Center" 
                              IsTextEditable="False" Width="120" Height="30"
                              ItemsSource="{Binding DataContext.PeriodList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                              AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True">
                <!--EditValue="{Binding DataContext.SelectedPeriodList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}">-->
                
                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:CheckedComboBoxStyleSettings />
                </dxe:ComboBoxEdit.StyleSettings>
            </dxe:ComboBoxEdit>
        </Grid>

        <Grid Grid.Row="2" HorizontalAlignment="Center">
            
            <Grid.ColumnDefinitions>               
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="130"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="130"/>                
            </Grid.ColumnDefinitions>

            <Label Grid.Row="2" Grid.Column="0" Content="{DynamicResource EmployeeFirstName}" Height="30" FontSize="16" FontWeight="Bold" 
               HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5 5 5 5"/>

            <dxe:TextEdit Text="{Binding FirstName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                Margin="0,0,0,0" Grid.Row="2" Grid.Column="2" Width="120" Height="30"
                          VerticalAlignment="Center" HorizontalAlignment="Left">                                
            </dxe:TextEdit>

            <Label Grid.Row="2" Grid.Column="4" Content="{DynamicResource EmployeeLastName}" Height="30" FontSize="16" FontWeight="Bold" 
               HorizontalAlignment="Right" VerticalAlignment="Center" Margin="5,5,5,5"/>

            <dxe:TextEdit Text="{Binding LastName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" 
                      Margin="0,0,0,0" Grid.Row="2" Grid.Column="6" Width="120" Height="30"
                          VerticalAlignment="Center" HorizontalAlignment="Left">
            </dxe:TextEdit>
        </Grid>
        
        <!--search button-->
        <Grid Grid.Row="4" HorizontalAlignment="Center">
                <Grid.ColumnDefinitions>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="130"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="100"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="120"/>
                </Grid.ColumnDefinitions>
            
                <Button Grid.Row="4" Grid.Column="6" 
                    Style="{DynamicResource Button16Style}"
                    HorizontalAlignment="Left" VerticalAlignment="Top"
                    Content="{DynamicResource HRMSearch}"                    
                    Height="30" Width="110">

               
                    
                <Button.ContentTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="5" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Image Style="{DynamicResource SearchShortcutImageStyle}" Grid.Column="0" Height="24" Width="24" HorizontalAlignment="Left"/>
                                <TextBlock Grid.Column="2"  Text="{DynamicResource HRMSearch}" Style="{StaticResource TextBlock14Style}" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Left" />
                            </Grid>
                        </DataTemplate>
                    </Button.ContentTemplate>
                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand Command="{Binding DataContext.SearchButtonCommand,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType={x:Type dxwui:WinUIDialogWindow}}}"
                                                           EventName="Click" PassEventArgsToCommand="True">                        
                        <dxmvvm:EventToCommand.CommandParameter>
                            <Binding ElementName="CombPeriod"></Binding>
                        </dxmvvm:EventToCommand.CommandParameter>
                    </dxmvvm:EventToCommand>
                </dxmvvm:Interaction.Behaviors>
            </Button>
            </Grid>

        <Grid Grid.Row="6">
           
            <dxg:GridControl VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="6"
                         ItemsSource="{Binding DataContext.FinalEmployeeList,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                            SelectionMode="Row" Width="Auto" Height="Auto"
                             SelectedItem="{Binding DataContext.SelectedEmployee,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}">

                <dxg:GridColumn Header="{DynamicResource EmployeeCode}" FieldName="EmployeeCode" MinWidth="100" Width="120" FilterPopupMode="CheckedList" ReadOnly="True" />
                <dxg:GridColumn Header="{DynamicResource EmployeeFirstName}" FieldName="FirstName" MinWidth="100" Width="120" FilterPopupMode="CheckedList" ReadOnly="True"/>
                <dxg:GridColumn Header="{DynamicResource EmployeeLastName}" FieldName="LastName" MinWidth="100" MaxWidth="150" Width="200" FilterPopupMode="CheckedList" ReadOnly="True"/>
                <dxg:GridColumn Header="{DynamicResource Company}" FieldName="Company"  Width="200" MinWidth="100" MaxWidth="120" FilterPopupMode="CheckedList" ReadOnly="True" />
                <dxg:GridColumn Header="{DynamicResource Organization}" FieldName="Organization" ColumnFilterMode="DisplayText"  MinWidth="110" MaxWidth="120" Width="120" FilterPopupMode="CheckedList" ReadOnly="True" />
                <dxg:GridColumn Header="{DynamicResource Location}" FieldName="CompanyLocation.Alias"  ColumnFilterMode="DisplayText"  MinWidth="100" MaxWidth="120" Width="120" FilterPopupMode="CheckedList" ReadOnly="True"/>
                <dxg:GridColumn Header="{DynamicResource EmployeeHireDate}" FieldName="HireDate" MinWidth="70" MaxWidth="100" Width="120" FilterPopupMode="CheckedList" ReadOnly="True" /> <!--EmployeeJobDescription.JobDescriptionStartDate-->
                <dxg:GridColumn Header="{DynamicResource ExitDate}"  FieldName="ExitDate" MinWidth="70" MaxWidth="100" Width="120" FilterPopupMode="CheckedList" ReadOnly="True"/>

                <dxg:GridControl.TotalSummary>
                    <dxg:GridSummaryItem x:Name="summary" FieldName="" SummaryType="Count" DisplayFormat="Total Count: {0}" Visible="True" Alignment="Left"/>
                </dxg:GridControl.TotalSummary>

                <dxmvvm:Interaction.Behaviors>
                    <UIHelper:GridSelectingBehavior />
                </dxmvvm:Interaction.Behaviors>

                <dxg:GridControl.View>
                    <dxg:TableView x:Name="EmployeeProfileTableView"
                                   VerticalScrollbarVisibility="Auto"
                                  NavigationStyle="Row"
                                   AllowHorizontalScrollingVirtualization="True" 
                                   RowDetailsVisibilityMode="Visible"
                                   ShowHorizontalLines="True"
                                   ShowColumnHeaders="True"                                                               
                                   AllowFixedColumnMenu="False"
                                   AutoWidth="False"
                                   ShowFixedTotalSummary="True"
                                   ShowIndicator="False" 
                                   AllowColumnFiltering="True"
                                       AllowGrouping="False"
                                       ShowGroupPanel="False"
                                   ShowSearchPanelMode="Never">
                        <dxmvvm:Interaction.Behaviors>
                            <dxmvvm:EventToCommand Command="{Binding DataContext.CommandGridDoubleClick, RelativeSource={RelativeSource AncestorType={x:Type dxwui:WinUIDialogWindow}},Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                           EventName="MouseDoubleClick" PassEventArgsToCommand="True"
                                                   CommandParameter="{Binding ElementName=EmployeeProfileTableView}">
                            </dxmvvm:EventToCommand>
                        </dxmvvm:Interaction.Behaviors>
                    </dxg:TableView>
                </dxg:GridControl.View>
            </dxg:GridControl>
        </Grid>

        <Grid Grid.Row="8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Row="8" Grid.Column="1"
                    Style="{DynamicResource Button16Style}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Bottom"
                    Content="{DynamicResource CommonCancel}"
                    Command="{Binding EscapeButtonCommand }"
                    Height="30"
                    Width="100" />
        </Grid>           
    </Grid>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers> 
</dxwui:WinUIDialogWindow>