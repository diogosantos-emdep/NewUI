<dxwui:WinUIDialogWindow 
                    x:Class="Emdep.Geos.Modules.Hrm.Views.ImportAttendanceFileView"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                    xmlns:local="clr-namespace:Emdep.Geos.Modules.Hrm.Views"
                    xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
                    xmlns:dxprg="http://schemas.devexpress.com/winfx/2008/xaml/propertygrid"
                    xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
                    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"            
                    xmlns:ViewModel="clr-namespace:Emdep.Geos.Modules.Hrm.ViewModels"
                    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
                    xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
                    xmlns:Validation ="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
                    xmlns:dxei="http://schemas.devexpress.com/winfx/2008/xaml/editors/internal"
                    xmlns:themes="http://schemas.devexpress.com/winfx/2008/xaml/editors/themekeys"
                    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                    xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
                    mc:Ignorable="d" 
                    d:DesignHeight="400" d:DesignWidth="600"
                    Title="Import Attendance" 
                    TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}"
                    Style="{DynamicResource WinUIDialogWindowStyle}">
    <dxwui:WinUIDialogWindow.Resources>
        <ControlTemplate x:Name="TokenComboBoxStyleEx" x:Key="{themes:TokenEditorThemeKey ResourceKey=EmptyTokenContainerTemplate, IsThemeIndependent=True}" 
                         TargetType="{x:Type ContentControl}">
            <Grid>

                <TextBlock VerticalAlignment="Center" Text="" Foreground="#BF7F7F7F" x:Name="text" Margin="1" />
                <TextBlock VerticalAlignment="Center" Text="{Binding Path=(dxei:TokenEditorPresenter.OwnerPresenter).NullText, RelativeSource={RelativeSource Self}}" x:Name="nulltext" Margin="2,1" Opacity="0" Foreground="{Binding Path=(dxei:TokenEditorPresenter.OwnerPresenter).NullTextForeground, RelativeSource={RelativeSource Self}}" />
                <ContentPresenter />
            </Grid>
            <ControlTemplate.Triggers>
                <DataTrigger Binding="{Binding Path=(dxei:TokenEditorPresenter.OwnerPresenter).IsEditorActivated, RelativeSource={RelativeSource Self}}" Value="True">
                    <Setter Property="Opacity" TargetName="text" Value="0" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=(dxei:TokenEditorPresenter.OwnerPresenter).HasNullText, RelativeSource={RelativeSource Self}}" Value="True">
                    <Setter Property="Opacity" TargetName="text" Value="0" />
                    <Setter Property="Opacity" TargetName="nulltext" Value="1" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=(dxei:TokenEditorPresenter.OwnerPresenter).IsTokenEditorReadOnly, RelativeSource={RelativeSource Self}}" Value="True">
                    <Setter Property="Opacity" TargetName="text" Value="0" />
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=(dxei:TokenEditorPresenter.OwnerPresenter).IsTextEditable, RelativeSource={RelativeSource Self}}" Value="False">
                    <Setter Property="Opacity" TargetName="text" Value="0" />
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </dxwui:WinUIDialogWindow.Resources>

    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape"  Command="{Binding CloseButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>

    <dxmvvm:Interaction.Behaviors>
        <dxmvvm:OpenFileDialogService Title="Open Excel Report"/>
    </dxmvvm:Interaction.Behaviors>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="40"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="200"/>
            <RowDefinition Height="40"/>
            <RowDefinition Height="50"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100"/>
            <ColumnDefinition Width="300"/>
            <ColumnDefinition Width="65"/>
        </Grid.ColumnDefinitions>

        <Label Content="{DynamicResource ImportAttendanceDataSource}" Grid.Column="0" Grid.Row="0" HorizontalAlignment="Left" Margin="2"  />

        <dxe:ComboBoxEdit Grid.Column="1" Grid.Row="0" Height="30" SelectedIndex="{Binding DataSourceSelectedIndex}"
                          IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="EditValueChanged"
                                                           Command="{Binding DataContext.DataSourceSelectedIndexChanged, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                           PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>
            <dxe:ComboBoxEditItem>Excel</dxe:ComboBoxEditItem>
            <dxe:ComboBoxEditItem>Text</dxe:ComboBoxEditItem>
            <dxe:ComboBoxEditItem>ODBC</dxe:ComboBoxEditItem>
        </dxe:ComboBoxEdit>
        <Separator Grid.Row="1" Grid.ColumnSpan="4"></Separator>

        <Label  Grid.Column="0" Grid.Row="2" HorizontalAlignment="Left" Margin="2"  >
            <Label.Resources>
                <Style  TargetType="{x:Type Label}">
                    <Setter Property="Content" Value="{DynamicResource ImportAttendanceFileName}"></Setter>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="2">
                            <Setter Property="Content" Value="DSN : "></Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Label.Resources>
        </Label>

        <dxe:ComboBoxEdit  x:Name="editor" Grid.Column="1" Grid.Row="2" Height="30" ItemsSource="{Binding AttachmentFiles}"
                          ScrollViewer.VerticalScrollBarVisibility="Auto"
                          DisplayMember="OriginalFileName"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Center"
                          AllowDefaultButton="False"
                          AutoComplete="False"
                          Margin="2" 
                          VerticalScrollBarVisibility="Auto"
                          ValidateOnEnterKeyPressed="True" 
                          ValidateOnTextInput="True" 
                           ImmediatePopup="True">
            <dxe:ComboBoxEdit.Style>
                <Style TargetType="dxe:ComboBoxEdit">
                    <Setter Property="Visibility" Value="Visible"></Setter>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="2">
                            <Setter Property="Visibility" Value="Hidden"></Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </dxe:ComboBoxEdit.Style>
            <dxe:ComboBoxEdit.StyleSettings>
                <dxe:TokenComboBoxStyleSettings  NewTokenPosition="Far" EnableTokenWrapping="True"  />
            </dxe:ComboBoxEdit.StyleSettings>

            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="EditValueChanged"
                                                           Command="{Binding DataContext.SelectedItemChangedCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                           PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>

            <dxe:ComboBoxEdit.SelectedIndex>
                <Binding Path="AttachedFileIndex" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:RequiredValidationRule FieldName="AttachedFileIndex" ValidationStep="UpdatedValue" />
                    </Binding.ValidationRules>
                </Binding>
            </dxe:ComboBoxEdit.SelectedIndex>
        </dxe:ComboBoxEdit>

        <dxe:ComboBoxEdit Grid.Column="1" SelectedIndex="{Binding DsnSelectedIndex}" Grid.Row="2" Height="30" ItemsSource="{Binding Dsns}" >
            <dxe:ComboBoxEdit.Style>
                <Style TargetType="dxe:ComboBoxEdit">
                    <Setter Property="Visibility" Value="Hidden"></Setter>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="2">
                            <Setter Property="Visibility" Value="Visible"></Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </dxe:ComboBoxEdit.Style>
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="EditValueChanged" Command="{Binding DataContext.SelectedItemChangedCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                       PassEventArgsToCommand="True"/>
            </dxmvvm:Interaction.Behaviors>

            <!--<dxe:ComboBoxEdit.SelectedIndex>
                <Binding Path="AttachedFileIndex" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:RequiredValidationRule FieldName="AttachedFileIndex" ValidationStep="UpdatedValue" />
                    </Binding.ValidationRules>
                </Binding>
            </dxe:ComboBoxEdit.SelectedIndex>-->
        </dxe:ComboBoxEdit>

        <Button Content="..." Grid.Column="3" Grid.Row="2" HorizontalAlignment="Right" 
                  Height="30" Width="48" Margin="5,0,0,0"
                Command="{Binding ChooseFileCommandForAttendance}">
            <Button.Style>
                <Style TargetType="Button">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="2">
                            <Setter Property="Visibility" Value="Hidden"></Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>
        <Label  Grid.Column="0" Grid.Row="3" HorizontalAlignment="Left" Margin="2"   >
            <Label.Resources>
                <Style TargetType="{x:Type Label}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="0">
                            <Setter Property="Content" Value="{DynamicResource ImportAttendanceSheetName}" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="1">
                            <Setter Property="Content" Value="{DynamicResource ImportAttendanceSeparator}"></Setter>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="2">
                            <Setter Property="Content" Value="Table Name : "></Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Label.Resources>
        </Label>

        <dxe:ComboBoxEdit Grid.Column="1" Grid.Row="3" Height="30" HorizontalAlignment="Stretch" VerticalAlignment="Center" AutoComplete="True"
                          ImmediatePopup="True" Margin="2" SelectedItem="{Binding SheetNameSelectedItem}"
                          ValidateOnEnterKeyPressed="True"  
                          ValidateOnTextInput="True" 
                          IsTextEditable="False"
                          IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            <dxe:ComboBoxEdit.Resources>
                <Style TargetType="{x:Type dxe:ComboBoxEdit}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="0">
                            <Setter Property="ItemsSource" Value="{Binding ExelSheetNames}"></Setter>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="1">
                            <Setter Property="ItemsSource" Value="{Binding TextSeparators}"></Setter>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding DataSourceSelectedIndex}" Value="2">
                            <Setter Property="ItemsSource" Value="{Binding DsnTableNames}"></Setter>

                        </DataTrigger>
                    </Style.Triggers>

                </Style>
            </dxe:ComboBoxEdit.Resources>
            <dxmvvm:Interaction.Behaviors>
                <dxmvvm:EventToCommand EventName="EditValueChanged"
                                       Command="{Binding DataContext.SheetNameSelectedIndexChanged, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                       PassEventArgsToCommand="True"/>

            </dxmvvm:Interaction.Behaviors>
            <dxe:ComboBoxEdit.SelectedIndex>
                <Binding Path="SheetNameSelectedIndex" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:RequiredValidationRule FieldName="SheetNameSelectedIndex" ValidationStep="UpdatedValue" />
                    </Binding.ValidationRules>
                </Binding>
            </dxe:ComboBoxEdit.SelectedIndex>
        </dxe:ComboBoxEdit>
        <dxg:GridControl Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="4"
                         HorizontalAlignment="Stretch" Name="GridImportAttendanceImport"
                         VerticalAlignment="Top" 
                         Height="200" SelectionMode="Cell">
            <dxg:GridControl.Columns>
                <dxg:GridColumn Header="{DynamicResource GridColSourceField}" FieldName="EmployeeAttendanceImportField"  MinWidth="200" AllowSorting="False" AllowColumnFiltering="False">
                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <dxe:ComboBoxEdit Name="PART_Editor" ImmediatePopup="True"
                                              ItemsSource="{Binding RowData.Row.EmployeeAttendanceImportFieldList,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                              HorizontalAlignment="Stretch"  
                                              IsSynchronizedWithCurrentItem="True"
                                              DisplayMember="Name" 
                                              SelectedIndex="{Binding RowData.Row.EmployeeAttendanceImportFieldList.SelectedIndex}"
                                              IsTextEditable="False" 
                                              ApplyItemTemplateToSelectedItem="true" Padding="2">
                                <dxe:ComboBoxEdit.ItemContainerStyle>
                                    <Style TargetType="dxe:ComboBoxEditItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    </Style>
                                </dxe:ComboBoxEdit.ItemContainerStyle>

                                <dxe:ComboBoxEdit.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}"/>
                                    </DataTemplate>
                                </dxe:ComboBoxEdit.ItemTemplate>
                            </dxe:ComboBoxEdit>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>
                </dxg:GridColumn>
                <!--shubham[skadam] GEOS2-3537 HRM - Communication with PSD software -  Import attendance using the employee company e-mail [#IES20]-->
                <!--<dxg:GridColumn Header="{DynamicResource GridColTargetField }" FieldName="Column"  MinWidth="200" AllowSorting="False" AllowColumnFiltering="False" AllowEditing="false"/>-->
                <!--ItemsSource="{Binding DataContext.TargetFieldList,RelativeSource={RelativeSource AncestorType=UserControl}}"-->

                <dxg:GridColumn Header="{DynamicResource GridColTargetField}" FieldName="Column" FilterPopupMode="CheckedList" MinWidth="200" Width="130" FixedWidth="True" 
                                            ReadOnly="False" SortMode="DisplayText" ColumnFilterMode="DisplayText">

                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <dxe:ComboBoxEdit Name="PART_Editor" 
                                                ItemsSource="{Binding RowData.Row.EmployeeAttendanceTargetFieldList,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"                                                  
                                                  HorizontalAlignment="Stretch" IsTextEditable="False"
                                                  DisplayMember="Name"  ValueMember="Name"
                                                  AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True">

                            </dxe:ComboBoxEdit>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>
                    <!--<dxg:GridColumn.PrintCellStyle>
                        <Style TargetType="dxe:TextEdit" BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
                            <Setter Property="dxp:ExportSettings.TargetType" Value="Panel" />
                            <Setter Property="DisplayTemplate">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <dxe:TextEdit Name="PART_Editor" Text="{Binding Data.ECOSVisibilityValue}" HorizontalAlignment="Left"
                                                        IsPrintingMode="True">
                                        </dxe:TextEdit>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </dxg:GridColumn.PrintCellStyle>-->
                </dxg:GridColumn>
                
                <!--<dxg:GridColumn Header="{DynamicResource GridColTargetField}" FieldName="Column"  MinWidth="200" AllowSorting="False" AllowColumnFiltering="False">
                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <dxe:ComboBoxEdit Name="PART_Editor"
                                              ImmediatePopup="True"
                                              ItemsSource="{Binding RowData.Row.EmployeeAttendanceTargetFieldList,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                              HorizontalAlignment="Stretch"  
                                              IsSynchronizedWithCurrentItem="True"
                                              DisplayMember="Name" 
                                               SelectedIndex="{Binding RowData.Row.EmployeeAttendanceTargetFieldList.SelectedIndex}"
                                              IsTextEditable="False" 
                                              ApplyItemTemplateToSelectedItem="true" Padding="2">
                                <dxe:ComboBoxEdit.ItemContainerStyle>
                                    <Style TargetType="dxe:ComboBoxEditItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    </Style>
                                </dxe:ComboBoxEdit.ItemContainerStyle>

                                <dxe:ComboBoxEdit.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}"/>
                                    </DataTemplate>
                                </dxe:ComboBoxEdit.ItemTemplate>
                            </dxe:ComboBoxEdit>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>
                </dxg:GridColumn>-->
                
                
                

            </dxg:GridControl.Columns>
            <dxg:GridControl.View>
                <dxg:TableView x:Name="tblImportAttandance" 
                               AllowBestFit="True"
                               NavigationStyle="Cell"
                               ShowGroupPanel="False" 
                               ShowIndicator="False"
                               ShowGroupedColumns="False"
                               AutoWidth="True" 
                               HorizontalScrollbarVisibility="Hidden"
                               VerticalScrollbarVisibility="Hidden">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand EventName="ShowFilterPopup"
                                                       Command="{Binding ShowSourceColumnCustomFilterPopupCommand}"
                                                       PassEventArgsToCommand="True"/>
                    </dxmvvm:Interaction.Behaviors>
                </dxg:TableView>
            </dxg:GridControl.View>

            <dxg:GridControl.ItemsSource>
                <Binding  Path="EmployeeAttendance" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                    <Binding.ValidationRules>
                        <Validation:RequiredValidationRule FieldName="EmployeeAttendance" ValidationStep="UpdatedValue" />
                    </Binding.ValidationRules>
                </Binding>
            </dxg:GridControl.ItemsSource>
        </dxg:GridControl>
        <Grid Grid.Row="5"  Grid.ColumnSpan="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="1.5*"/>
                <ColumnDefinition Width="50"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="1.5*"/>
            </Grid.ColumnDefinitions>
            <Label Content="{DynamicResource ImportAttendanceFilterStartDate}" MinWidth="50"  VerticalAlignment="Center" Grid.Column="0" />
            <dxe:DateEdit Grid.Column="1"  HorizontalAlignment="Left"  Height="30" Width="120" ShowClearButton="False">
                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanged" Command="{Binding FilterStartDateValueChangedCommand}" PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
                <dxe:DateEdit.EditValue>
                    <Binding Path="FilterStartDate" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                        <Binding.ValidationRules>
                            <Validation:RequiredValidationRule FieldName="FilterStartDate" ValidationStep="UpdatedValue" />
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:DateEdit.EditValue>


            </dxe:DateEdit>
            <Label Content="{DynamicResource ImportAttendanceFilterEndDate}" MinWidth="50" VerticalAlignment="Center" Grid.Column="3" Margin="5,0,0,0" />
            <dxe:DateEdit Grid.Column="4"  Height="30"  HorizontalAlignment="Right" Width="120" ShowClearButton="False">
                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanged" Command="{Binding FilterEndDateValueChangedCommand}" PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
                <dxe:DateEdit.EditValue>
                    <Binding Path="FilterEndDate" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                        <Binding.ValidationRules>
                            <Validation:RequiredValidationRule FieldName="FilterStartDate" ValidationStep="UpdatedValue" />
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:DateEdit.EditValue>
            </dxe:DateEdit>
        </Grid>
        <StackPanel Grid.Row="6" Grid.ColumnSpan="3"
                    HorizontalAlignment="Center" 
                    Orientation="Horizontal"
                    Margin="20,0,0,0"
                    Width="290">

            <Button Content="{DynamicResource CancelButton}"
                    Command="{Binding CloseButtonCommand}" 
                    Height="30"
                    Width="100"
                    Margin="0,0,30,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" />

            <Button Content="{DynamicResource NextButton}"
                    Command="{Binding NextWindowCommand}" CommandParameter="{Binding ElementName=GridImportAttendanceImport}"
                    Height="30"
                    Width="100"
                    Margin="30,0,0,0"
                    Style="{DynamicResource Button16Style}"
                    IsEnabled="{Binding IsAcceptEnabled}"
                    VerticalAlignment="Bottom" />

        </StackPanel>

    </Grid>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</dxwui:WinUIDialogWindow> 
