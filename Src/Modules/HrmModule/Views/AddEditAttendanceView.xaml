<UserControl x:Class="Emdep.Geos.Modules.Hrm.Views.AddEditAttendanceView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Emdep.Geos.Modules.Hrm.Views"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
             xmlns:HrmApplication="clr-namespace:Emdep.Geos.Modules.Hrm" 
             xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:Validation="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             xmlns:Converters="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
             xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
             mc:Ignorable="d"
             d:DesignHeight="600"
               d:DesignWidth="300"
             >

    <UserControl.Resources>
        <!--<UIConverter:DateFormatConverter x:Key="DateFormatConverter" />
        <sys:String x:Key="ShortDateTimeFormat">dd/MM/yyyy hh:mm tt</sys:String>
        <sys:String x:Key="ShortTimeFormat">hh:mm tt</sys:String>
        <sys:String x:Key="ShortDateFormat">dd/MM/yyyy</sys:String>-->
        <Converters:ForegroundColorConverter x:Key="ForegroundColorConverter"/>
    </UserControl.Resources>
    
    <Grid ShowGridLines="True">
        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO" />
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
                <RowDefinition Height="AUTO"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="180"/>
                <ColumnDefinition Width="120"/>
                <ColumnDefinition Width="40"/>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            <!--Status-->
            <Label Grid.Row="0" Grid.Column="0" Content="Status" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5"/>

        
            <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}"   Grid.Column="1" 
                            Grid.Row="0"  Grid.ColumnSpan="2"  Height="30"  
                               ItemsSource="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=AttendanceStatusList}"
                              DisplayMember="Value" ValueMember="IdLookupValue"  IsTextEditable="False" ValidateOnTextInput="False"
                              AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True" ApplyItemTemplateToSelectedItem="True"
                              IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                              >
                <!-- Style for dropdown items -->
                <dxe:ComboBoxEdit.ItemContainerStyle >
                    <Style TargetType="dxe:ComboBoxEditItem">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding InUse}" Value="False">
                              <Setter Property="IsEnabled" Value="False"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </dxe:ComboBoxEdit.ItemContainerStyle>

                <!-- Template for the selected item -->
                <!-- Template for the selected item -->
                <dxe:ComboBoxEdit.EditTemplate>
                    <ControlTemplate>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch">
                            <Rectangle Width="10" Height="10" Fill="{Binding SelectedForAttendanceStatus.HtmlColor, RelativeSource={RelativeSource AncestorType=dxe:ComboBoxEdit}}" Margin="5,0,5,0"/>
                            <TextBlock Text="{Binding SelectedForAttendanceStatus.Value, RelativeSource={RelativeSource AncestorType=dxe:ComboBoxEdit}}"
                           Margin="5,0,0,0"
                           HorizontalAlignment="Stretch"
                           VerticalAlignment="Center"
                         />
                        </StackPanel>
                    </ControlTemplate>
                </dxe:ComboBoxEdit.EditTemplate>

                <!-- Template for each item in the dropdown list -->
                <dxe:ComboBoxEdit.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch">
                            <Rectangle Width="20" Height="20" Fill="{Binding HtmlColor}" Margin="5,0,5,0"/>
                            <TextBlock Text="{Binding Value}" Margin="5,0,0,0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                          />
                        </StackPanel>
                    </DataTemplate>
                </dxe:ComboBoxEdit.ItemTemplate>
                <!-- Binding for selected index -->
                <dxe:ComboBoxEdit.SelectedIndex>
                    <Binding Path="SelectedForAttendanceStatus" 
                 ValidatesOnDataErrors="True" 
                 UpdateSourceTrigger="PropertyChanged" 
                 Mode="TwoWay">
                        <Binding.ValidationRules>
                            <Validation:AttendanceValidation FieldName="SelectedForAttendanceStatus" 
                                                 ValidationStep="UpdatedValue" 
                                                 ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                        
                    </Binding>
                    
                </dxe:ComboBoxEdit.SelectedIndex>
            </dxe:ComboBoxEdit>
            <!--Employee-->
            <Label Grid.Row="1" Grid.Column="0" Content="{DynamicResource Employee}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5"/>
            <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}"  Grid.Column="1" 
                              Grid.Row="1" Grid.ColumnSpan="2" Height="30"  Margin="5,5,5,5" 
                              ItemsSource="{Binding EmployeeListFinal,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged }" 
                              IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                              DisplayMember="FullName" ValueMember="IdEmployee"  IsTextEditable="False" ValidateOnTextInput="False"
                              AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"
                                 >
                <dxe:ComboBoxEdit.ItemContainerStyle>
                    <Style TargetType="dxe:ComboBoxEditItem">
                        <Setter Property="Background" Value="{Binding HtmlColor}" />
                        <Setter Property="Background" Value="{Binding HtmlColor}" />
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="dxe:ComboBoxEditItem">
                                    <Border Background="{Binding Background, RelativeSource={RelativeSource TemplatedParent}}">
                                        <ContentPresenter />
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </dxe:ComboBoxEdit.ItemContainerStyle>
                <dxe:ComboBoxEdit.SelectedIndex>
                    <Binding Path="SelectedIndexForEmployee" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                        <Binding.ValidationRules >
                            <Validation:AttendanceValidation FieldName="SelectedIndexForEmployee" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:ComboBoxEdit.SelectedIndex>

                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="SelectedIndexChanged"
                                       Command="{Binding DataContext.SelectedIndexChangedCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                       PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
            </dxe:ComboBoxEdit>

            <!--Shift-->
            <Label Grid.Row="2" Grid.Column="0" Content="{DynamicResource AttendanceShift}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5" />
            <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}"  
                              Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="2"
                              Height="30" Margin="5,5,5,5" 
                              ItemsSource="{Binding EmployeeShiftList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                              DisplayMember="CompanyShift.Name" ValueMember="CompanyShift.IdCompanyShift"  IsTextEditable="False" ValidateOnTextInput="False"
                              AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"
                              ApplyItemTemplateToSelectedItem="True"
                              IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">

                <dxe:ComboBoxEdit.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Margin="5 0">
                                <TextBlock.Style>
                                    <Style>
                                        <Setter Property="TextBlock.Text" Value="{Binding CompanyShift.Name}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IdCompanyShift}" Value="0">
                                                <Setter Property="TextBlock.Text" Value="---" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            <!--<Image Margin="5 0" Height="16" Width="16" Source="{DynamicResource CoffeeCupImage}" 
                               VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Image.Style>
                                    <Style>
                                        <Setter Property="Image.Visibility" Value="Visible" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IdCompanyShift}" Value="0">
                                                <Setter Property="Image.Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Image.Style>
                            </Image>-->
                            
                            <TextBlock>
                                <TextBlock.Style>
                                    <Style>
                                        <Setter Property="TextBlock.Text" Value="-"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IdCompanyShift}" Value="0">
                                                <Setter Property="TextBlock.Text" Value="{x:Null}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>

                            <TextBlock Margin="5 0">
                                <TextBlock.Style>
                                    <Style>
                                        <Setter Property="TextBlock.Text" Value="{Binding CompanyShift.CompanySchedule.Company.Alias}"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IdCompanyShift}" Value="0">
                                                <Setter Property="TextBlock.Text" Value="{x:Null}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                    </DataTemplate>
                </dxe:ComboBoxEdit.ItemTemplate>

                <!--<dxe:ComboBoxEdit.ItemContainerStyle>
                    <Style TargetType="dxe:ComboBoxEditItem">
                        <Setter Property="ToolTip">
                            <Setter.Value>
                                <TextBlock Text="{Binding Name}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Setter.Value>
                        </Setter>
                    </Style>
                </dxe:ComboBoxEdit.ItemContainerStyle>-->

                <!--<dxe:ComboBoxEdit.ToolTip>
                    <TextBlock Text="{Binding SelectedCompanyShift.Name}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </dxe:ComboBoxEdit.ToolTip>-->

                <dxe:ComboBoxEdit.SelectedIndex>
                    <Binding Path="SelectedIndexForCompanyShift" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                        <Binding.ValidationRules >
                            <Validation:AttendanceValidation FieldName="SelectedIndexForCompanyShift" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:ComboBoxEdit.SelectedIndex>

                <dxe:ComboBoxEdit.ItemContainerStyle>
                    <Style TargetType="dxe:ComboBoxEditItem">
                        <Setter Property="IsEnabled" Value="{Binding IsEnabled}" />
                    </Style>
                </dxe:ComboBoxEdit.ItemContainerStyle>

                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="SelectedIndexChanged"
                                           Command="{Binding DataContext.SelectedIndexChangedForCompanyShiftCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                           PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
            </dxe:ComboBoxEdit>

            <!--Start Time-->
            <Label Content= "{DynamicResource AttendanceStartTime}" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Margin="5 5 5 5" HorizontalAlignment="Left" Height="30" FontSize="16" />

            <dxe:DateEdit  Grid.Row="3" Grid.Column="1" Margin="5 5 5 5" HorizontalAlignment="Stretch" VerticalAlignment="Center" AllowNullInput="True"
                       IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
                <dxe:DateEdit.EditValue>
                    <Binding Path="StartDate" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay"
                                                  ValidatesOnDataErrors="True">
                        <Binding.ValidationRules>
                            <Validation:AttendanceValidation FieldName="StartDate" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:DateEdit.EditValue>

                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding DataContext.OnDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                    <dxmvvm:EventToCommand EventName="GotFocus" Command="{Binding DataContext.OnDateFocusCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"/>
                </dxmvvm:Interaction.Behaviors>
            </dxe:DateEdit>

            <dxe:TextEdit Width="110" Mask="HH:mm" Margin="5"
                      Grid.Row="3" Grid.Column="2" Height="25" IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                      MaskType="DateTimeAdvancingCaret" DisplayFormatString="HH:mm">
                <dxe:TextEdit.EditValue>
                    <Binding Path="DataContext.StartTime" RelativeSource="{RelativeSource AncestorType=dxwui:WinUIDialogWindow}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                        <Binding.ValidationRules>
                            <Validation:EmployeeProfileValidation FieldName="StartTime" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:TextEdit.EditValue>
                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding DataContext.OnTextEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
            </dxe:TextEdit>

            <!--End Time-->
            <Label Content= "{DynamicResource AttendanceEndTime}" Grid.Row="4" Grid.Column="0"  HorizontalAlignment="Left" Margin="5 5 5 5" Height="30" FontSize="16" />

            <dxe:DateEdit Grid.Row="4" Grid.Column="1"  ValidateOnEnterKeyPressed="True" Margin="5 5 5 5" HorizontalAlignment="Stretch" VerticalAlignment="Center"
                     AllowNullInput="True" IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}" IsEnabled="{Binding EnableEndDateTime,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
                <dxe:DateEdit.EditValue>
                    <Binding Path="EndDate" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay" ValidatesOnDataErrors="True">
                        <Binding.ValidationRules>
                            <Validation:AttendanceValidation FieldName="EndDate" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:DateEdit.EditValue>
                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding DataContext.OnDateEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
            </dxe:DateEdit>

            <dxe:TextEdit Width="110" Mask="HH:mm" Margin="5"
                     Grid.Row="4" Grid.Column="2" Height="25" 
                     IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                          IsEnabled="{Binding EnableEndDateTime,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                     MaskType="DateTimeAdvancingCaret" DisplayFormatString="HH:mm" >
                <dxe:TextEdit.EditValue>
                    <Binding Path="DataContext.EndTime" RelativeSource="{RelativeSource AncestorType=dxwui:WinUIDialogWindow}" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                        <Binding.ValidationRules>
                            <Validation:EmployeeProfileValidation FieldName="EndTime" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:TextEdit.EditValue>
                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanging" Command="{Binding DataContext.OnTextEditValueChangingCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
            </dxe:TextEdit>

            <!--Is partial time-->
            <!--[nsatpute][17-12-2024][GEOS2-6635]-->
            <Label Grid.Row="5" Grid.Column="0" Content="{DynamicResource Addeditattendance_Ispartialtime}" Height="30" FontSize="16"
        HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5"/>
            <WrapPanel Grid.Row="5" Grid.Column="1">
            <dxe:ToggleSwitch x:Name="IsPartialTime" Margin="5,5,5,5"  Height="30" HorizontalAlignment="Left" VerticalAlignment="Center" ContentPlacement="Inside"
                                                 CheckedStateContent="Yes" UncheckedStateContent="No" ToggleSwitchWidth="60" ToggleSwitchHeight="27" IsThreeState="False"                                
                              IsEnabled="{Binding DataContext.IsPartialTimeEnable,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow,Mode=FindAncestor},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                              IsChecked="{Binding DataContext.IsPartialTime, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">
            </dxe:ToggleSwitch>
                <Image Visibility="{Binding DataContext.PartialTimeInformationVisible, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" x:Name="RefInfoImage" ToolTip="{DynamicResource Addeditattendance_OnlyOnePartialTimeAllowed}" HorizontalAlignment="Left" Margin="10,0,0,4" Height="22" Width="22" Source="/Emdep.Geos.Modules.HRM;component/Assets/Images/bInformation.png" VerticalAlignment="Center" />
            </WrapPanel>
            <Label Grid.Row="6" Grid.Column="0" Content="{DynamicResource Type}" Height="30" FontSize="16"
                   HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5"/>

            <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}"  Grid.Column="1" 
                              Grid.Row="6" Grid.ColumnSpan="2" Height="30"  Margin="5,5,5,5"
                              ItemsSource="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=AttendanceTypeList}"
                              DisplayMember="Value" ValueMember="IdLookupValue"  IsTextEditable="False" ValidateOnTextInput="False"
                              AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"
                              IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
                <dxe:ComboBoxEdit.SelectedIndex>
                    <Binding Path="SelectedIndexForAttendanceType" ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">
                        <Binding.ValidationRules >
                            <Validation:AttendanceValidation FieldName="SelectedIndexForAttendanceType" ValidationStep="UpdatedValue" ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </dxe:ComboBoxEdit.SelectedIndex>
            </dxe:ComboBoxEdit>

            <Label Grid.Row="7" Grid.Column="0" Content="{DynamicResource LeaveRemarks}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5"/>
            <TextBox Margin="5,5,5,5" Grid.Row="7" Grid.Column="1" Grid.ColumnSpan="2"  Height="90" TextWrapping="Wrap" Text="{Binding Remarks,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                 VerticalAlignment="Stretch" HorizontalAlignment="Stretch" ScrollViewer.VerticalScrollBarVisibility="Auto" 
                 AcceptsReturn="True"
                 IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">
            </TextBox>

            <Label Grid.Row="8" Grid.Column="0" Content="{DynamicResource LeaveAttachment}" Height="30" FontSize="16"
               HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5"/>


            <dxe:ComboBoxEdit x:Name="editor" Grid.Row="8" Grid.Column="1" Grid.ColumnSpan="2" Height="30" 
                          EditValue="{Binding DataContext.AttachmentObjectList,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow,Mode=FindAncestor},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                          ItemsSource="{Binding DataContext.AttachmentList,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow,Mode=FindAncestor}}"
                          ScrollViewer.VerticalScrollBarVisibility="Auto"
                          DisplayMember="OriginalFileName"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Center"
                          AllowDefaultButton="False"
                          AutoComplete="True"
                          ImmediatePopup="True" Margin="5 5 5 5"
                          ValidateOnEnterKeyPressed="True" 
                          ValidateOnTextInput="True"
                          IsTextEditable="False" Style="{DynamicResource ComboBoxEditStyle}" 
                          IsReadOnly="{Binding IsReadOnlyField,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                          SelectedItem="{Binding AttachedFile,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}">

                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:TokenComboBoxStyleSettings  NewTokenPosition="Far" EnableTokenWrapping="True"  />
                </dxe:ComboBoxEdit.StyleSettings>
                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="EditValueChanged"
                                                           Command="{Binding DataContext.SelectedItemChangedCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                           PassEventArgsToCommand="True"/>
                </dxmvvm:Interaction.Behaviors>
            </dxe:ComboBoxEdit>
            <Button Name="btnViewLeaveFile" ToolTip="View Document" Grid.Row="8" Grid.Column="3" Height="30" Width="40" 
                Visibility="{Binding DataContext.IsVisible,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow,Mode=FindAncestor},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                Command="{Binding DocumentViewCommand}"
                                   HorizontalAlignment="Left" >
                <Button.ContentTemplate>
                    <DataTemplate>
                        <Image Height="16" Width="16" Source="/Emdep.Geos.Modules.Hrm;component/Assets/Images/pdf-icon.png" />
                    </DataTemplate>
                </Button.ContentTemplate>
                <Button.Style>
                    <Style TargetType="{x:Type Button}">
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter  Property="Cursor" Value="Hand"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>


            <Button Content= "{DynamicResource ChooseFile}"
                    Height="30"  
                    Grid.Row="9" Grid.Column="1"
                    Width="120" 
                    Margin="5,5,5,5"
                    FontSize="16"
                    HorizontalAlignment="Right"   
                   VerticalAlignment="Center" 
                   Command="{Binding ChooseFileCommandForAttendance}" Style="{DynamicResource ButtonStyle}" 
                   IsEnabled="{Binding IsAcceptEnabled}"
                   Grid.ColumnSpan="2"/>

            <!--Created-->

            <Label Grid.Row="10" Grid.Column="0" Content="{DynamicResource LeaveCreated}" Height="30" FontSize="16"  HorizontalAlignment="Left" VerticalAlignment="Center" 
                   Visibility="{Binding IsCreatorVisibility,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Margin="5,5,5,5"/>
            <!--<Label Grid.Row="9" Grid.Column="1" Content="{Binding CreatorName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Height="30" FontSize="16"  
                   HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5"/>-->
            <Grid Grid.Row="10" Grid.Column="1" Grid.ColumnSpan="2" ShowGridLines="False" Visibility="{Binding IsCreatorVisibility,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="9*"/>
                </Grid.ColumnDefinitions>
                <StackPanel Margin="5,5,5,5" Grid.Row="9" Grid.Column="0" Orientation="Horizontal">
                <Image  Height="40" Width="40" HorizontalAlignment="Left">
                        <Image.Style>
                            <Style TargetType="Image">
                                <Setter Property="Source" Value="{Binding CreatorProfilePhotoBytes, Converter={Converters:ByteArrayToImage}}" />
                            </Style>
                        </Image.Style>
                    </Image>
            </StackPanel>
                <!--Grid.Column="1"-->
                <TextBlock Grid.Row="10"  Grid.Column="1" FontSize="16" Height="70"   HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="WrapWithOverflow"  Margin="5,0,0,0">
                <Run Text="{Binding CreatorName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" ToolTip="{Binding CreatorName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" FontSize="16" />  <LineBreak/>  
                <!--<Run Text="{Binding CreationDate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" FontSize="11"/>-->
                <Run Text="{Binding CreationDate, StringFormat=g, ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" FontSize="11"/>
            </TextBlock>
            </Grid>
            
            <StackPanel Margin="-30,20,5,5" Grid.Row="10" Grid.Column="3" Orientation="Horizontal" Visibility="{Binding IsCreatorVisibility, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                <Image Height="30" Width="30" HorizontalAlignment="Right">
                    <Image.Style>
                        <Style TargetType="Image">
                            <Style.Triggers>
                                
                                <DataTrigger Binding="{Binding IdReporterSource, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Value="319">
                                    <Setter Property="Image.Source" Value="{DynamicResource AttendancesAPI}" />
                                    <Setter Property="ToolTip" Value="{DynamicResource RemoteAttendance}"/>
                                   
                                </DataTrigger>

                                
                                <DataTrigger Binding="{Binding IdReporterSource, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Value="1747">
                                    <Setter Property="Image.Source" Value="{DynamicResource AttendancesHRM}" />
                                    <Setter Property="ToolTip"  Value="{DynamicResource FactoryAttendance}" />
                                    
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Image.Style>
                </Image>
            </StackPanel>


            <!--Updated-->
            <Label  Visibility="{Binding IsModifierVisibility,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Grid.Row="11" Grid.Column="0" Content="{DynamicResource LeaveUpdated}" Height="30" FontSize="16"  HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5"/>
            <Grid Grid.Row="11" Grid.Column="1" Grid.ColumnSpan="2" ShowGridLines="False" Visibility="{Binding IsModifierVisibility,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="9*"/>
                </Grid.ColumnDefinitions>
                <StackPanel Margin="5,5,5,5" Grid.Row="11" Grid.Column="0" Orientation="Horizontal">
                    <Image  Height="40" Width="40" HorizontalAlignment="Left">
                        <Image.Style>
                            <Style TargetType="Image">
                                <Setter Property="Source" Value="{Binding ModifierProfilePhotoBytes, Converter={Converters:ByteArrayToImage}}" />
                            </Style>
                        </Image.Style>
                    </Image>
                </StackPanel>
                <TextBlock Grid.Row="11"  Grid.Column="1"  FontSize="16" Height="60"   HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="WrapWithOverflow"  Margin="5,0,0,0">
                <Run Text="{Binding ModifierName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" ToolTip="{Binding ModifierName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" FontSize="16" />  <LineBreak/>  
                <Run Text="{Binding ModificationDate, StringFormat=g, ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" FontSize="11"/>
                </TextBlock>
            </Grid>
            <!--<StackPanel Margin="5,5,5,5" Grid.Row="9" Grid.Column="2"  Orientation="Horizontal">
                <Image  Height="30" Width="30" HorizontalAlignment="Right">
                    <Image.Style>
                        <Style>
                            --><!--<Setter Property="Image.Source" Value="{DynamicResource AttendancesAPI}" />--><!--
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IdReporterSource, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Value="319">
                                    <Setter Property="Image.Source" Value="{DynamicResource AttendancesAPI}" />
                                </DataTrigger>
                                <DataTrigger Binding="{Binding IdReporterSource,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Value="1747">
                                    <Setter Property="Image.Source" Value="{DynamicResource AttendancesHRM}" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Image.Style>
                </Image>
            </StackPanel>-->


            <!-- location -->
            <Grid Grid.Row="0" Grid.Column="4" ShowGridLines="False">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="10*"/>
                    <ColumnDefinition Width="9*"/>
                </Grid.ColumnDefinitions>
                <Label Grid.Row="0" Grid.Column="0" Content="{DynamicResource LocationAttendance}" Height="30" FontSize="16"  HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,5,0"/>
                <StackPanel Margin="5,5,5,5" Grid.Row="0" Grid.Column="5"  Orientation="Horizontal">
                    <Image  Height="16" Width="16" HorizontalAlignment="Left">
                        <Image.Style>
                            <Style>
                                <Setter Property="Image.Source" Value="{DynamicResource MapLocationImageStyle}" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding DataContext.IsCoordinatesNull, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" Value="True">
                                        <Setter Property="Image.Source" Value="/Emdep.Geos.Modules.Hrm;component/Assets/Images/gMapLocationSelected.png" />
                                        <Setter Property="Image.ToolTip" Value="{Binding DataContext.MapLatitudeAndLongitude,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" />
                                        <!--<Setter Property="Image.ToolTip" Value="{DynamicResource EditContactViewSetLocation}" />-->
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding DataContext.IsCoordinatesNull, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" Value="False">
                                        <!--<Setter Property="Image.ToolTip" Value="{DynamicResource EditContactViewSetLocation}" />-->
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Image.Style>
                        <Image.InputBindings>
                            <MouseBinding Gesture="LeftClick" Command="{Binding DataContext.SearchButtonClickCommand, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" 
                                              CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Grid}}"/>
                        </Image.InputBindings>
                    </Image>
                </StackPanel>
            </Grid>

            <Grid Grid.Row="1" Grid.Column="4" Grid.ColumnSpan="2" ShowGridLines="False" Visibility="{Binding IsMapVisibility,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="auto"/>
                </Grid.ColumnDefinitions>
                <Label Grid.Row="1" Grid.Column="0" Content="{Binding LocationValue, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" VerticalAlignment="Stretch" 
                       HorizontalAlignment="Stretch" ScrollViewer.VerticalScrollBarVisibility="Auto" FontSize="12" Margin="5,0,5,0"/>
                <StackPanel Margin="5,-10,0,0" Grid.Row="1" Grid.Column="4"  Orientation="Horizontal">
                    <Button Height="30" Width="50" Background="Transparent" Margin="0,0,0,0" BorderThickness="0" Command="{Binding CopyButtonCommand}">
                        <Image  Height="20" Width="20" HorizontalAlignment="Left">
                        <Image.Style>
                            <Style>
                                <Setter Property="Image.Source" Value="{DynamicResource LocationCopy}" />
                            </Style>
                        </Image.Style>
                    </Image>
                    </Button>
                </StackPanel>
            </Grid>

            <DockPanel Grid.Row="2" Grid.Column="4" Grid.ColumnSpan="4" Grid.RowSpan="11" Margin="0,-10,0,20">
                <!--<wv2:WebView2 CoreWebView2InitializationCompleted="webView_CoreWebView2InitializationCompleted" Name="webView" Source="https://www.google.com/maps/search/?api=1&query={Binding DataContext.MapLatitudeAndLongitude}" />-->
                <wv2:WebView2  HorizontalAlignment="Stretch" Name="webView" Source="{Binding DataContext.MapLatitudeAndLongitudeURL,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" />
            </DockPanel>

            <!--<ContentControl Margin="5,5,5,5" Grid.Row="8" Grid.Column="1"  HorizontalAlignment="Left" VerticalAlignment="Stretch">
                <ContentControl.Style>
                    <Style TargetType="ContentControl">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsLocationAvailable}" Value="true">
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <TextBlock>
                                     <Hyperlink NavigateUri="https://maps.google.com?q=37.7749,-122.4194">
                                        <Image Source="/Emdep.Geos.Modules.Hrm;component/Assets/Images/gMapLocationSelected.png" Width="30" Height="30"/>
                                    </Hyperlink>
                                            </TextBlock>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsLocationAvailable}" Value="false">
                                <Setter Property="ContentTemplate">
                                    <Setter.Value>
                                        <DataTemplate>
                                            <Image Source="/Emdep.Geos.Modules.Hrm;component/Assets/Images/wMapLocationSelected.png" Width="30" Height="30"/>
                                        </DataTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ContentControl.Style>
            </ContentControl>-->


            
            <StackPanel Orientation="Horizontal" Grid.Column="2" Grid.Row="13" Grid.ColumnSpan="3">
                <Button Content="{DynamicResource AttendanceViewAcceptButton}"
                        Command="{Binding AddAttendanceViewAcceptButtonCommand}"
                        FontSize="16"
                        Height="30"
                        Width="100"
                        Margin="5,5,15,5"
                        Style="{DynamicResource Button16Style}"
                        VerticalAlignment="Bottom" 
                       IsEnabled="{Binding IsAcceptEnabled}"/>

                <Button Content="{DynamicResource AttendanceViewCancelButton}"
                        Command="{Binding AddAttendanceViewCancelButtonCommand}" 
                        FontSize="16"
                        Height="30"
                        Width="100"
                        Margin="5,5,5,5"
                        Style="{DynamicResource Button16Style}"
                        VerticalAlignment="Bottom" />
            </StackPanel>
        </Grid>

    </Grid>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</UserControl>
