<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Hrm.Views.ContractSituationView"
                         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                         xmlns:local="clr-namespace:Emdep.Geos.Modules.Hrm.Views"
                         xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
                         xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
                         xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
                         xmlns:DataCommon="clr-namespace:Emdep.Geos.Data.Common.Hrm;assembly=Emdep.Geos.Data.Common"
                         xmlns:HrmApplication="clr-namespace:Emdep.Geos.Modules.Hrm" 
                         xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
                         xmlns:Validation="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
                         xmlns:Views="clr-namespace:Emdep.Geos.Modules.Hrm.Views"
                         xmlns:sys="clr-namespace:System;assembly=mscorlib"
                         xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                         xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
                         mc:Ignorable="d" 
                         d:DesignHeight="600" d:DesignWidth="600"
                         Style="{DynamicResource WinUIDialogWindowStyle}">

    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding AddContractSituationViewCancelButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>

    <Grid Margin="0 -50 0 0">
        <Grid.Resources>
            <BooleanToVisibilityConverter x:Key="BoolToVis" />
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="40"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="50"/>
        </Grid.ColumnDefinitions>

        <TextBlock 
            Grid.Row="0" 
            Grid.Column="0" 
            HorizontalAlignment="Center"
            Text="{Binding DataContext.WindowHeader, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,
                   RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow,Mode=FindAncestor}}" 
            Style="{DynamicResource CustomTitleStyle}"
            Visibility="{Binding IsHeader,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"/>
        
        <Button Grid.Row="0"
                Grid.Column="1"
                Height="40"
                Width="40"
                HorizontalAlignment="Right"
                CommandParameter="{Binding ElementName=pageViewMergrFiles}"
                Command="{Binding MergeButtonCommand}"
                Content=" "
                Visibility="{Binding IsMergeVisible,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,Converter={StaticResource BoolToVis},FallbackValue=Hidden}">
            <Button.ToolTip>
                <TextBlock Text="{DynamicResource ButtonMerge}" />
            </Button.ToolTip>
            <Button.ContentTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Image Grid.Column="0"
                            Height="24"
                            Width="24"
                            Margin="-10"
                            Source="{DynamicResource MergeImageSource}" />
                    </Grid>                    
                </DataTemplate>
            </Button.ContentTemplate>
        </Button>

        <Button Grid.Row="0"
                Grid.Column="1"
                Height="40"
                Width="40"
                HorizontalAlignment="Right"
                CommandParameter="{Binding ElementName=pageViewMergrFiles}"
                Command="{Binding MergeButtonCommand}"
                Content=" "
                Visibility="{Binding IsAddVisible,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,Converter={StaticResource BoolToVis},FallbackValue=Hidden}">
            <Button.ToolTip>
                <TextBlock Text="{DynamicResource AddFile}" />
            </Button.ToolTip>
            <Button.ContentTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Image
                            x:Name="AddImage"
                            Grid.Column="0"
                            Height="24"
                            Width="24"
                            Margin="-10"
                            Source="{DynamicResource AddImageSource}"/>
                    </Grid>
                </DataTemplate>
            </Button.ContentTemplate>
        </Button>

        <dxwui:PageView x:Name="pageViewMergrFiles"
                        Grid.Row="1"
                        Margin="0,5,0,0"
                        AnimationType="SlideHorizontal"
                        Background="Transparent"
                        BorderThickness="0,0,0,0"
                        SelectedIndex="{Binding SelectedViewIndex}"
                        ShowBackButton="True">
            <dxwui:PageViewItem Margin="0,0,0,0"
                                Height="0"
                                DataContext="{Binding}"
                                ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                ScrollViewer.VerticalScrollBarVisibility="Auto"
                                UseLayoutRounding="True">
                <Views:EditContractSituationView x:Name="contractSituationView"
                                      MinHeight="300"
                                      Height="Auto"
                                      MaxHeight="500"
                                      DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
            </dxwui:PageViewItem>

            <dxwui:PageViewItem Margin="0,0,0,0"
                                Height="0"
                                DataContext="{Binding}"
                                
                                UseLayoutRounding="True">
                <Views:ContractSituationSplitView x:Name="contractSituationSplitView"
                                            Height="Auto"
                                            MaxHeight="500"
                                            DataContext="{Binding DataContext, RelativeSource={RelativeSource AncestorType={x:Type Window}}}" />
            </dxwui:PageViewItem>
        </dxwui:PageView>
    </Grid>
    
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>

</dxwui:WinUIDialogWindow> 
