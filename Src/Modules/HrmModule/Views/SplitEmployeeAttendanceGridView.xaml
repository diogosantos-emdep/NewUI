<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Hrm.Views.SplitEmployeeAttendanceGridView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Emdep.Geos.Modules.Hrm.Views"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
             xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">

    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding DataContext.CancelButtonCommand,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"/>
    </dxwui:WinUIDialogWindow.InputBindings>
    <dxwui:WinUIDialogWindow.TitleStyle>
        <Style TargetType="ContentControl">
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Grid Grid.Row="0"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="5"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="5"/>
                                <ColumnDefinition Width="300"/>
                                <ColumnDefinition Width="5"/>
                                <ColumnDefinition Width="70"/>
                                <ColumnDefinition Width="auto"/>

                            </Grid.ColumnDefinitions>
                            <TextBlock  Text="{Binding DataContext.WindowHeader,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                        Style="{DynamicResource CustomTitleStyle}" Grid.Row="0" Grid.RowSpan="2"/>


                            <!-- Period -->
                            <DockPanel Grid.Column="7" Grid.Row="0" HorizontalAlignment="Right"   VerticalAlignment="Center"  >
                                <TextBlock Style="{DynamicResource CustomPeriodTitleStyle}" Text="{Binding DataContext.FromDate,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,StringFormat=d,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture},RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,-10,5,0"/>
                                <TextBlock Style="{DynamicResource CustomPeriodTitleStyle}" Text=" - " HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="Bold" Margin="0,-10,5,0"/>
                                <TextBlock Style="{DynamicResource CustomPeriodTitleStyle}" Text="{Binding DataContext.ToDate,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,StringFormat=d,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture},RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="0,-10,5,0"/>
                            </DockPanel>
                            <!--Calender Icon-->
                            <dxwui:AppBar x:Name="Appbar" HideMode="AlwaysVisible" Background="Transparent" Grid.Column="6"
                                  IsSticky="True" HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch"
                                  IsOpen="True" IsExitButtonEnabled="False" Margin="-10,-10,5,0">

                                <dxwui:AppBarButton x:Name="appbarbutton" ToolTip="{DynamicResource PeriodSelect}"
                                        GlyphHeight="24" GlyphWidth="24" AllowGlyphTheming="False"
                                        Style="{DynamicResource CalendarImageGlyphStyle}"
                                        GlyphStretch="Fill" IsEllipseEnabled="False" >
                                    <dxwui:AppBarButton.Flyout>
                                        <dxwui:MenuFlyout ShowIndicator="True" x:Name="MenuLayout">
                                            <dxwui:MenuFlyoutItem StaysOpenOnClick="True">
                                                <Grid Width="Auto" Height="Auto">
                                                    <DockPanel>
                                                        <StackPanel Orientation="Vertical" x:Name="PeriodCategories">
                                                            <!--This Year-->
                                                            <Button x:Name="ThisYear" Content="This Year" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="110"
                                                            Command="{Binding DataContext.PeriodCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                            CommandParameter="{Binding ElementName=ThisYear}">
                                                            </Button>
                                                            <!--Last Year-->
                                                            <Button x:Name="LastYear" Content="Last Year" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="110"
                                                            Command="{Binding DataContext.PeriodCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                            CommandParameter="{Binding ElementName=LastYear}">
                                                            </Button>
                                                            <!--This Month-->
                                                            <Button x:Name="ThisMonth" Content="{DynamicResource SAMThisMonth}" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="110"
                                                            Command="{Binding DataContext.PeriodCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                            CommandParameter="{Binding ElementName=ThisMonth}">
                                                            </Button>
                                                            <!--Last month-->
                                                            <Button x:Name="LastMonth" Content="{DynamicResource SAMLastMonth}" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                            Height="30" Width="110"
                                                            Command="{Binding DataContext.PeriodCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                            CommandParameter="{Binding ElementName=LastMonth}">
                                                            </Button>
                                                            <!--This week-->
                                                            <Button x:Name="ThisWeek" Content="{DynamicResource SAMThisWeek}" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                            Height="30" Width="110"
                                                            Command="{Binding DataContext.PeriodCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                            CommandParameter="{Binding ElementName=ThisWeek}">
                                                            </Button>
                                                            <!--Last week-->
                                                            <Button x:Name="LastWeek" Content="{DynamicResource SAMLastWeek}" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                            Height="30" Width="110"
                                                            Command="{Binding DataContext.PeriodCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                            CommandParameter="{Binding ElementName=LastWeek}">
                                                            </Button>
                                                            <!--Last 12 month-->
                                                            <Button x:Name="Last12Months" Content="Last 12 Months" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                            Height="30" Width="110"
                                                            Command="{Binding DataContext.PeriodCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                            CommandParameter="{Binding ElementName=Last12Months}">
                                                            </Button>
                                                            <!--Custom Range-->
                                                            <Button x:Name="CustomRange" Content="{DynamicResource PeriodCustomRange}" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="110"
                                                            Command="{Binding DataContext.PeriodCustomRangeCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                            CommandParameter="{Binding ElementName=CustomRange}">
                                                            </Button>
                                                            <StackPanel Orientation="Horizontal" Margin="0,50,0,0">
                                                                <Button Content="{DynamicResource SAMApply}" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="60" Background="Yellow" 
                                                            Command="{Binding DataContext.ApplyCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" CommandParameter="{Binding ElementName=MenuLayout}">
                                                                </Button>
                                                                <Button Content="{DynamicResource SAMCancel}" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="60" 
                                                            Command="{Binding DataContext.CancelCommand,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" CommandParameter="{Binding ElementName=MenuLayout}">
                                                                </Button>
                                                            </StackPanel>
                                                        </StackPanel>
                                                        <StackPanel Visibility="{Binding DataContext.IsCalendarVisible, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" Orientation="Horizontal">
                                                            <StackPanel Orientation="Vertical">
                                                                <dxe:TextEdit Text="{Binding DataContext.StartDate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" 
                                                  Height="30" TextWrapping="Wrap" Mask="dd/MM/yyyy"  
                                                  MaskType="DateTimeAdvancingCaret"  
                                                  MaskUseAsDisplayFormat="True"
                                                  HorizontalAlignment="Stretch" IsReadOnly="True"  Margin="2,2,2,2">
                                                                </dxe:TextEdit>
                                                                <!--Calendar-->
                                                                <dxe:DateEditCalendar DateTime="{Binding DataContext.StartDate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                      VerticalAlignment="Center"
                                                                      ShowToday="False"
                                                                      ShowClearButton="False"/>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Vertical">
                                                                <dxe:TextEdit Text="{Binding DataContext.EndDate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" 
                                                  Height="30" TextWrapping="Wrap" Mask="dd/MM/yyyy"  
                                                  MaskType="DateTimeAdvancingCaret"  
                                                  MaskUseAsDisplayFormat="True"
                                                  HorizontalAlignment="Stretch" IsReadOnly="True"  Margin="2,2,2,2">
                                                                </dxe:TextEdit>
                                                                <!--Calendar-->
                                                                <dxe:DateEditCalendar DateTime="{Binding DataContext.EndDate, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                      VerticalAlignment="Center"
                                                                      ShowToday="False"
                                                                      ShowClearButton="False"/>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </DockPanel>
                                                </Grid>
                                            </dxwui:MenuFlyoutItem>
                                        </dxwui:MenuFlyout>
                                    </dxwui:AppBarButton.Flyout>
                                </dxwui:AppBarButton>
                            </dxwui:AppBar>

                        </Grid>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </dxwui:WinUIDialogWindow.TitleStyle>

    <ScrollViewer ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto">
        <Grid >
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="50"/>
            </Grid.RowDefinitions>
          

            <Grid Grid.Row="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" >
                <dxg:GridControl x:Name="GridControlEmpolyeeAttendance" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="1" MinHeight="600" MaxHeight="600"
                         ImplyNullLikeEmptyStringWhenFiltering="True" AllowLiveDataShaping="True" ItemsSource="{Binding SplitAttendanceList,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                         SelectedItem="{Binding SelectedAttendance,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" 
                                 SelectionMode="Row" MinWidth="1100" Height="Auto" Loaded="GridControlEmpolyeeAttendance_Loaded">

                    <dxg:GridColumn Header=" " MinWidth="50" Width="50" MaxWidth="50" FixedWidth="True" Fixed="Left" ReadOnly="True" AllowColumnFiltering="false" AllowPrinting="False" ShowInColumnChooser="False" AllowMoving="false">
                        <dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <dxe:CheckEdit HorizontalAlignment="Center" IsChecked="{Binding RowData.Row.IsAttendanceChecked,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                               IsEnabled="{Binding RowData.Row.IsNotRegularShift,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">
                                    <dxmvvm:Interaction.Behaviors>
                                        <dxmvvm:EventToCommand  EventName="Checked" 
                                                                    Command="{Binding DataContext.PropertyCheckBoxSelectedCommand,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"                                                                   
                                                                    CommandParameter="{Binding ElementName=GridControlEmpolyeeAttendance}">
                                            <!--<dxmvvm:EventToCommand.EventArgsConverter>
                                                <dx:EventArgsToDataRowConverter />
                                            </dxmvvm:EventToCommand.EventArgsConverter>-->
                                        </dxmvvm:EventToCommand>
                                        <dxmvvm:EventToCommand  EventName="Unchecked" 
                                                                    Command="{Binding DataContext.PropertyUnCheckBoxSelectedCommand,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                                                                    CommandParameter="{Binding ElementName=GridControlEmpolyeeAttendance}"/>
                                    </dxmvvm:Interaction.Behaviors>
                                </dxe:CheckEdit>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>
                    </dxg:GridColumn>

                    <dxg:GridColumn Header="{DynamicResource SplitAttendanceGridHeaderName}" FieldName="Employee.FullName" MinWidth="250" MaxWidth="250" FilterPopupMode="CheckedList" ReadOnly="True"/>

                    <dxg:GridColumn Header="{DynamicResource SplitAttendanceGridHeaderDate}" FieldName="AccountingDate" MinWidth="120" MaxWidth="120" FilterPopupMode="CheckedList" ReadOnly="True"/>

                    <dxg:GridColumn Header="{DynamicResource SplitAttendanceGridHeaderStartTime}" FieldName="StartTime" MaxWidth="120"  MinWidth="120" FilterPopupMode="CheckedList" ReadOnly="False"/>

                    <dxg:GridColumn Header="{DynamicResource SplitAttendanceGridHeaderEndTime}" FieldName="EndTime" MinWidth="120" MaxWidth="120" FilterPopupMode="CheckedList" ReadOnly="False"/>

                    <dxg:GridColumn Header="{DynamicResource SplitAttendanceGridHeaderShift}" FieldName="CompanyShift.Name" MinWidth="250" MaxWidth="250" FilterPopupMode="CheckedList" ReadOnly="True"/>

                    <dxg:GridColumn Header="{DynamicResource SplitAttendanceGridHeaderType}" FieldName="CompanyWork.Name" MinWidth="170" MaxWidth="170" FilterPopupMode="CheckedList" ReadOnly="True"/>


                    <!--<dxg:GridControl.TotalSummary>
                    <dxg:GridSummaryItem x:Name="summary" FieldName="Name" SummaryType="Count" DisplayFormat="Total Count: {0}" Visible="True" Alignment="Left"/>
                </dxg:GridControl.TotalSummary>-->

                    <dxg:GridControl.View>
                        <dxg:TableView x:Name="EmployeeAttendanceTableView"
                                   NavigationStyle="Cell"
                                   RowDetailsVisibilityMode="Visible"
                                   ShowHorizontalLines="True"
                                   ShowSearchPanelMode="Always"
                                   ShowColumnHeaders="True"
                                   VerticalScrollbarVisibility="Auto" 
                                   HorizontalScrollbarVisibility="Auto"
                                   AllowFixedColumnMenu="False"
                                   ShowTotalSummary="False"
                                   ShowFixedTotalSummary="False"
                                   SearchPanelHorizontalAlignment="Stretch"
                                   EnableImmediatePosting="True"
                                   ImmediateUpdateRowPosition="True"
                                   AllowEditing="True"
                                   ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly"
                                   AllowGrouping="True"
                                   ShowGroupPanel="False"
                                   ShowIndicator="False" 
                                  >



                        </dxg:TableView>
                    </dxg:GridControl.View>
                </dxg:GridControl>

            </Grid>

            <StackPanel Grid.Row="1" 
                    HorizontalAlignment="Center" 
                    Orientation="Horizontal"
                    Margin="15,-41,0,0"
                    Width="250">

                <Button Content="{DynamicResource JobDescriptionAcceptButton}"
                    Command="{Binding DataContext.AcceptButtonCommand,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                    Height="30"
                    Width="100"
                    Margin="0,0,10,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" 
                    IsEnabled="{Binding IsAcceptEnabled}"/>


                <Button Content="{DynamicResource JobDescriptionCancelButton}"
                    Command="{Binding DataContext.CancelButtonCommand,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
                    Height="30"
                    Width="100"
                    Margin="10,0,0,0"
                    Style="{DynamicResource Button16Style}"
                    VerticalAlignment="Bottom" />
            </StackPanel>
        </Grid>
    </ScrollViewer>
        

  
</dxwui:WinUIDialogWindow>
