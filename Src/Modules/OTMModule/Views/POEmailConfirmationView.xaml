<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.OTM.Views.POEmailConfirmationView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Emdep.Geos.Modules.OTM.Views"
        xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
        xmlns:Validation="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
        xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
        xmlns:dxre="http://schemas.devexpress.com/winfx/2008/xaml/richedit"
        xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" 
        xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
        mc:Ignorable="d" d:DesignWidth="1800"
        Title="{DynamicResource TitleSendEmailToCustomer}"
        TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}"
        Style="{DynamicResource WinUIDialogWindowStyle}" Height="733"                >



    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding POEmailConfirmationViewCancelButtonCommand}" />
    </dxwui:WinUIDialogWindow.InputBindings>

    

    <ScrollViewer    ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto">
        <Grid Margin="0,15,0,0" ShowGridLines="False"   ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto" >


            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="5" />
                <RowDefinition Height="33" />
                <RowDefinition Height="5" />
                <RowDefinition Height="35" />
                <RowDefinition Height="5" />
                <RowDefinition Height="35" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="35" />
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="125" />
                <ColumnDefinition Width="80" />
                <ColumnDefinition Width="900" />
                <ColumnDefinition Width="50" />
            </Grid.ColumnDefinitions>

            <!--language-->
            <Label Content="{DynamicResource languageEmailToCustomer}" Grid.Row="0" Grid.Column="1" FontSize="15" Margin="5,0,0,0"   HorizontalAlignment="Left" />
          
            <!--GEOS2-7078 [ashish.malkhede][25/03/2025] -->
            <dxe:ComboBoxEdit ApplyItemTemplateToSelectedItem="True"
                              Grid.Row="0" Grid.Column="2" Grid.ColumnSpan="4"  Margin="0,-10,50,0"
        IsTextEditable="False"                     
        VerticalAlignment="Top"
        HorizontalAlignment="Stretch"
        Style="{DynamicResource ComboBoxEditStyle}"
        ItemsSource="{Binding Languages}"
        ValueMember="IdLanguage"
        DisplayMember="Name"
        SelectedIndex="{Binding SettingWindowLanguageSelectedIndex}"
        IsSynchronizedWithCurrentItem="True">
                <dxe:ComboBoxEdit.ItemTemplate>
                    <DataTemplate>
                        <DockPanel >
                            <Image Height="30" Width="30">
                                <Image.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding IdLanguage}" Value="2" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Image.Source" Value="{DynamicResource EnglishFlagImage}" />
                                            </MultiDataTrigger>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding IdLanguage}" Value="1" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Image.Source" Value="{DynamicResource SpanishFlagImage}" />
                                            </MultiDataTrigger>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding IdLanguage}" Value="6" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Image.Source" Value="{DynamicResource FrenchFlagImage}" />
                                            </MultiDataTrigger>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding IdLanguage}" Value="3" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Image.Source" Value="{DynamicResource PortugueseFlagImage}" />
                                            </MultiDataTrigger>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding IdLanguage}" Value="5" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Image.Source" Value="{DynamicResource RomanianFlagImage}" />
                                            </MultiDataTrigger>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding IdLanguage}" Value="7" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Image.Source" Value="{DynamicResource RussianFlagImage}" />
                                            </MultiDataTrigger>
                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding IdLanguage}" Value="4" />
                                                </MultiDataTrigger.Conditions>
                                                <Setter Property="Image.Source" Value="{DynamicResource ChineseFlagImage}" />
                                            </MultiDataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Image.Style>
                            </Image>
                            <TextBlock Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
         Padding="2" Margin="5,3,0,0" Style="{DynamicResource TextBlockStyle}" />
                        </DockPanel>
                    </DataTemplate>
                </dxe:ComboBoxEdit.ItemTemplate>
            </dxe:ComboBoxEdit>
                         
             <!--ToEmail-->
            <Label Content="{DynamicResource ToEmailToCustomer}" Grid.Row="2" Grid.Column="1"  Margin="5,0,0,0"  HorizontalAlignment="Left" />

            <dxe:ComboBoxEdit x:Name="editor1" Grid.Column="2" Grid.Row="2" 
             HorizontalAlignment="Stretch"
              EditValue="{Binding DataContext.SelectedOffer,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow},UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,ValidatesOnDataErrors=True}"
             ItemsSource="{Binding DataContext.ExcludedContactList,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow},Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
             ScrollViewer.VerticalScrollBarVisibility="Auto"
             DisplayMember="FullName"
                AllowDefaultButton="True" 
                AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"
               Style="{DynamicResource ComboBoxEditStyle}">
                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:TokenComboBoxStyleSettings NewTokenPosition="Far" EnableTokenWrapping="True" />
                </dxe:ComboBoxEdit.StyleSettings>
            </dxe:ComboBoxEdit>

            <!--CCEmail-->
            <Label Content="{DynamicResource CCEmailToCustomer}" Grid.Row="4"  Grid.Column="1"  Margin="5,0,0,0"    HorizontalAlignment="Left" />
            <dxe:ComboBoxEdit x:Name="editor2" Grid.Column="2" Grid.Row="4" 
    HorizontalAlignment="Stretch"
   EditValue="{Binding DataContext.SelectedCcList,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow},UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
  ItemsSource="{Binding DataContext.ExcludedCCContactList,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow},UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
  ScrollViewer.VerticalScrollBarVisibility="Auto"
  DisplayMember="FullName" 
  AllowDefaultButton="True" 
  AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"
  Style="{DynamicResource ComboBoxEditStyle}">
                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:TokenComboBoxStyleSettings NewTokenPosition="Far" EnableTokenWrapping="True" />
                </dxe:ComboBoxEdit.StyleSettings>
                
                
            </dxe:ComboBoxEdit>
           
            <Label Content="{DynamicResource BodyEmailToCustomer}" Grid.Row="5"   Grid.Column="1"   Grid.RowSpan="2"  HorizontalAlignment="Left" />

            <!-- if we hide QAT Margin="0,-40,0,0"-->
            <dxre:RichEditControl x:Name="richEdit" Height="750" 
           CommandBarStyle="Ribbon" Grid.ColumnSpan="2"
           Grid.Column="1" Grid.Row="7" ShowBorder="True" 
           Loaded="richEdit_Loaded" Padding="0" VerticalAlignment="Stretch"
           DocumentLoaded="richEdit_DocumentLoaded"
           DocumentSource="{Binding DataContext.HtmlEmailtemplate,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"
           Margin="0,-19,0,0">

                <dxre:RichEditControl.MailMergeOptions>
                    <dxre:DXRichEditMailMergeOptions ViewMergedData="True" />
                </dxre:RichEditControl.MailMergeOptions>



                <dxre:RichEditControl.DocumentCapabilitiesOptions>
                    <dxre:DXRichEditDocumentCapabilitiesOptions 
                 Sections="Enabled"  
                 HeadersFooters="Disabled"/>
                </dxre:RichEditControl.DocumentCapabilitiesOptions>


            

                <!--#region Ribbon Customization-->
                <dxre:RichEditControl.RibbonActions>

                    <!-- [pramod.misal][GEOS2-7080][26.03.2025] Add a static text item to display "Body" in the Ribbon -->
                    <dxb:InsertAction  Index="0" ContainerName="{x:Static dxre:DefaultBarItemNames.RibbonControl}" >
                        <dxb:BarStaticItem Content="Body:" />
                    </dxb:InsertAction>
                    
                    
                    <!-- Keep Home tab visible (ensure Home is selected) -->
                    <dxb:UpdateAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonPage_Home}" PropertyName="Caption" Value="Start" />

                    <!-- [pramod.misal][GEOS2-7080][26.03.2025]Minimize Ribbon by Default (Collapses it) -->
                    <dxb:UpdateAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonControl}" 
              PropertyName="IsMinimized" 
              Value="True" />


                    <!--Option 3 Hide the QAT-->
                    <!--<dxb:UpdateAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonControl}" PropertyName="ToolbarShowMode"  Value="Hide"/>-->
                   
                    
                    <!--Option 3-->
                    <!--<dxb:UpdateAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonControl}" PropertyName="RibbonStyle" Value="OfficeSlim"/>-->

                    <!-- [pramod.misal][GEOS2-7081][26.03.2025] -->
                    <dxb:UpdateAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonControl}" PropertyName="RibbonTitleBarVisibility" Value="Collapsed" />
                    <dxb:UpdateAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonControl}" PropertyName="ToolbarShowMode" Value="Hide" />

                    <!-- Remove Mail Merge and other unwanted tabs -->
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonPage_File}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonPage_MailMerge}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonCategory_HeaderFooterTools}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonCategory_TableTools}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonCategory_PictureTools}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonPage_Insert}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonPage_PageLayout}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonPage_References}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonPage_Review}" />
                    <dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonPage_View}" />

                    <!--<dxb:RemoveAction ElementName="{x:Static dxre:DefaultBarItemNames.RibbonControl}" />-->
                </dxre:RichEditControl.RibbonActions>
                <!--#endregion-->
            </dxre:RichEditControl>



            <StackPanel Grid.Row="9" Grid.Column="1" Grid.ColumnSpan="2"
         HorizontalAlignment="Center" 
         Orientation="Horizontal"
         Margin="20,5,0,0"
         Width="290">

                <Button Content="{DynamicResource AddContactViewAccept}"
         Command="{Binding POEmailConfirmationViewAcceptButtonCommand}"
         CommandParameter="{Binding ElementName=richEdit}"
         Height="30"
         Width="100"
         Margin="0,0,30,0"
         VerticalAlignment="Bottom" />

                <Button Content="{DynamicResource AddContactViewCancel}"
         Command="{Binding POEmailConfirmationViewCancelButtonCommand}" 
         Height="30"
         Width="100"
         Margin="30,0,0,0"
         VerticalAlignment="Bottom" />

            </StackPanel>

        </Grid>
    </ScrollViewer>
</dxwui:WinUIDialogWindow>
