<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.APM.Views.TaskParticipantsView"
           xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Emdep.Geos.Modules.APM.Views"
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" 
             xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             xmlns:dxci="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"  
             xmlns:APMCommon ="clr-namespace:Emdep.Geos.Modules.APM.CommonClasses"
             xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.APM.ViewModels"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:system="clr-namespace:System;assembly=mscorlib"
             xmlns:APMApplication="clr-namespace:Emdep.Geos.Modules.APM.CommonClasses"
             xmlns:Validation ="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations" 
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             mc:Ignorable="d"        
             Title="{DynamicResource TaskParticipantsHeader}"     
      TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}" >
    <!--[Shweta.Thube][GEOS2-7008]-->
    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding CancelButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>
    <dxwui:WinUIDialogWindow.Resources>
        <UIConverter:ImageUrlToByteArrayConverter x:Key="ImageUrlToByteArrayConverter" />
        <UIConverter:DelegatedToImageURLConverter x:Key="DelegatedToImageURLConverter" />
        <ControlTemplate x:Key="popupContentTemplate">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <!--<RowDefinition Height="5"/>
                <RowDefinition Height="Auto"/>-->
                </Grid.RowDefinitions>
                <dxg:GridControl Grid.Row="0" x:Name="PART_GridControl" AutoExpandAllGroups="True"  dx:DXSerializer.Enabled="True">
                    <dxg:GridControl.Columns>
                        <dxg:GridColumn Header=" " FieldName="OwnerImage">
                            <dxg:GridColumn.CellTemplate>
                                <DataTemplate>
                                    <Image  
                      Source="{Binding RowData.Row.EmployeeCodeWithIdGender, Converter={StaticResource DelegatedToImageURLConverter}, UpdateSourceTrigger=PropertyChanged ,ConverterParameter='image/png'}" 
                        VerticalAlignment="Center" Height="60" Width="Auto" Margin="2,0,0,0" >
                                        <Image.ToolTip>
                                            <Image  Source="{Binding RowData.Row.EmployeeCodeWithIdGender, Converter={StaticResource DelegatedToImageURLConverter}, UpdateSourceTrigger=PropertyChanged ,ConverterParameter='image/png'}"                             
                                   VerticalAlignment="Center" Height="200" Width="300" Margin="2,0,0,0" />

                                        </Image.ToolTip>
                                    </Image>
                                </DataTemplate>
                            </dxg:GridColumn.CellTemplate>

                        </dxg:GridColumn>
                        <dxg:GridColumn FieldName="EmployeeCode" />
                        <dxg:GridColumn FieldName="FirstName" />
                        <dxg:GridColumn FieldName="LastName" />
                        <dxg:GridColumn FieldName="JobCode" />
                        <dxg:GridColumn FieldName="Organization" />
                        <dxg:GridColumn FieldName="UserName" />
                    </dxg:GridControl.Columns>
                    <dxg:GridControl.View>
                        <dxg:TableView Name="View"
                                   ShowGroupedColumns="True"
                                   AutoWidth="True"
                                   AllowPerPixelScrolling="True"
                                   SearchPanelAllowFilter="False"
                                   ScrollAnimationDuration="0"
                                   ShowAutoFilterRow="True"
                                   ShowTotalSummary="True"
                                   IsSynchronizedWithCurrentItem="False" >

                            <dxg:TableView.RowStyle>
                                <Style TargetType="{x:Type dxg:RowControl}">
                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>

                                                <Condition Binding="{Binding Row.IsInActive}" Value="True" />
                                            </MultiDataTrigger.Conditions>

                                            <MultiDataTrigger.Setters>
                                                <Setter Property="Foreground" Value="Gray" />
                                                <Setter Property="IsEnabled" Value="False" />
                                            </MultiDataTrigger.Setters>
                                        </MultiDataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </dxg:TableView.RowStyle>

                        </dxg:TableView>
                    </dxg:GridControl.View>
                    <dxg:GridControl.Style>
                        <Style TargetType="dxg:GridControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding VisibleRowCount, RelativeSource={RelativeSource Self}}" Value="0">
                                    <Setter Property="ShowLoadingPanel" Value="True" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </dxg:GridControl.Style>
                </dxg:GridControl>
            </Grid>
        </ControlTemplate>
    </dxwui:WinUIDialogWindow.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>

        </Grid.RowDefinitions>
        <Grid  Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Text="{DynamicResource APMEmployee}" Grid.Column="0" IsEnabled="True"  FontSize="15" HorizontalAlignment="Left"  VerticalAlignment="Center" Margin="5,0,0,0"/>
            <!--<dxe:ComboBoxEdit  Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="380" Height="30"                         
Margin="5,0,5,0" AllowUpdateTwoWayBoundPropertiesOnSynchronization="False"  DisplayMember="FullName" FontSize="14"
    AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"
                               ItemsSource="{Binding ResponsibleList,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
 >
                <dxe:ComboBoxEdit.SelectedItem>
                    <Binding Path="DataContext.SelectedResponsible" RelativeSource="{RelativeSource AncestorType=dxwui:WinUIDialogWindow}" 
ValidatesOnDataErrors="True" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">

                    </Binding>
                </dxe:ComboBoxEdit.SelectedItem>

            </dxe:ComboBoxEdit>-->
            <dxg:LookUpEdit x:Name="searchLookUpEdit1"  Grid.Column="1"  FontSize="14" IsEnabled="True" Width="640" Height="30" HorizontalAlignment="Stretch"  VerticalAlignment="Center" Margin="5,0,5,0" 
PopupHeight="500"
PopupWidth="750"
PopupMinHeight="100"
PopupMinWidth="100" 
IsPopupAutoWidth="False"
FilterCondition="StartsWith"
FindButtonPlacement="Popup"
FindMode="Always"
PopupContentTemplate="{StaticResource popupContentTemplate}"                
ItemsSource="{Binding ResponsibleList, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
AutoPopulateColumns="False"
DisplayMember="FullName"
ValueMember="IdEmployee"
ImmediatePopup="True"
AutoComplete="True"
                            >

                <dxg:LookUpEdit.StyleSettings>
                    <dxg:SearchLookUpEditStyleSettings />
                </dxg:LookUpEdit.StyleSettings>

                <dxg:LookUpEdit.SelectedItem>
                    <Binding Path="DataContext.SelectedParticipant" RelativeSource="{RelativeSource AncestorType=dxwui:WinUIDialogWindow}"  UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">

                    </Binding>
                </dxg:LookUpEdit.SelectedItem>

            </dxg:LookUpEdit>
            <Button HorizontalAlignment="Right" Height="30" Width="30" Grid.Column="2"  Margin="0,5,5,5"
                    IsEnabled="{Binding IsAddButtonEnabled,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                    Command="{Binding AddButtonActionCommand}"
          >
                <Button.ToolTip>
                    <TextBlock Text="{DynamicResource ActionsAddNewActions}"/>
                </Button.ToolTip>
                <Button.ContentTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image Style="{DynamicResource APMAddButtonImageStyle}" Grid.Column="3" Height="20" Width="20" HorizontalAlignment="Right" Margin="-10" />
                        </Grid>
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>
        </Grid>



        <dxlc:LayoutGroup Grid.Row="1" Width="760" MaxHeight="900" VerticalAlignment="Stretch" HorizontalAlignment="Center"
			  Name="lgPartnumber" Header=" "
			  View="GroupBox"
   
			  dxlc:LayoutControl.AllowVerticalSizing="True"
                         
>
            <dxg:GridControl x:Name="AddParticipantsGrid" Margin="-10" FontSize="14"
     									  ItemsSource="{Binding ListParticipants,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}" 
				   Width="756"
				  MinWidth="130" Height="400"
				  ImplyNullLikeEmptyStringWhenFiltering="True">
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="EmployeeCode"  Header="{DynamicResource EmployeeCode}" CellToolTipBinding="{Binding EmployeeCode}" ReadOnly="True" FilterPopupMode="CheckedList" Width="9*"/>
                    <dxg:GridColumn  FieldName="ResponsibleDisplayName" Header="{DynamicResource EmployeeName}" CellToolTipBinding="{Binding ResponsibleDisplayName}" ReadOnly="True" FilterPopupMode="CheckedList" Width="18*"/>
                    <dxg:GridColumn  FieldName="Organization" Header="{DynamicResource EmployeeOrganization}" CellToolTipBinding="{Binding Organization}" ReadOnly="True" FilterPopupMode="CheckedList" Width="8*"/>
                    <dxg:GridColumn  FieldName="JobCode" Header="{DynamicResource JobCode}" CellToolTipBinding="{Binding JobCode}" ReadOnly="True" FilterPopupMode="CheckedList" Width="6*"/>
                    <dxg:GridColumn FieldName="JobDescriptionTitle"  Header="{DynamicResource JobTitle}" CellToolTipBinding="{Binding JobDescriptionTitle}" ReadOnly="True" FilterPopupMode="CheckedList" Width="18*"/>
                    <dxg:GridColumn Width="40" FieldName="" FixedWidth="True" AllowMoving="False" AllowColumnFiltering="false" >
                        <dxg:GridColumn.CellTemplate>
                            <DataTemplate>
                                <Button Name="deleteContactRow" ToolTip="Delete"  
                                        Command="{Binding DataContext.DeleteTaskCommand, RelativeSource={RelativeSource AncestorType={x:Type dxg:GridControl}}}"
                                        CommandParameter="{Binding RowData.Row}" >
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <Image Height="16" Width="16" >
                                                <Image.Style>
                                                    <Style TargetType="Image">
                                                        <Style.Triggers>
                                                            <MultiDataTrigger>
                                                                <MultiDataTrigger.Conditions>
                                                                    <Condition Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="BlackAndBlue" />
                                                                </MultiDataTrigger.Conditions>
                                                                <Setter Property="Source" Value="/Emdep.Geos.Modules.APM;component/Assets/Images/wDelete.png" />
                                                            </MultiDataTrigger>
                                                            <MultiDataTrigger>
                                                                <MultiDataTrigger.Conditions>
                                                                    <Condition Binding="{Binding Path=(dx:ThemeManager.TreeWalker).ThemeName, RelativeSource={RelativeSource Self}}" Value="WhiteAndBlue" />
                                                                </MultiDataTrigger.Conditions>
                                                                <Setter Property="Source" Value="/Emdep.Geos.Modules.APM;component/Assets/Images/bDelete.png" />
                                                            </MultiDataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Image.Style>
                                            </Image>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>
                            </DataTemplate>
                        </dxg:GridColumn.CellTemplate>
                    </dxg:GridColumn>
                </dxg:GridControl.Columns>

                <dxg:GridControl.View>
                    <dxg:TableView Name="AddParticipantsGridView"  NavigationStyle="Row"
						 VerticalScrollbarVisibility="Auto"
						 HorizontalScrollbarVisibility="Auto"
						 AutoWidth="False"
                                   SearchPanelHorizontalAlignment="Stretch"
						 ShowGroupPanel="False"
						 ShowIndicator="False"
						 AllowEditing="True" AllowLeaveInvalidEditor="True"
                         ShowSearchPanelMode="Always"
						 ColumnChooserColumnDisplayMode="ShowHiddenColumnsOnly" EnableImmediatePosting="True"
						 ItemsSourceErrorInfoShowMode="RowAndCell">

                    </dxg:TableView>
                </dxg:GridControl.View>
            </dxg:GridControl>

        </dxlc:LayoutGroup>

        <Button Content="{DynamicResource AddActionPlanAccept}"  FontSize="16" Height="30" Grid.Column="0" Grid.Row="3"
                            Width="100"  Style="{DynamicResource Button16Style}" Margin="220,10,5,5" HorizontalAlignment="Left"
                            Command="{Binding AcceptButtonCommand}" />
        <Button Content="{DynamicResource AddActionPlanCancel}" Grid.Column="1" Grid.Row="3"  HorizontalAlignment="Right"
                Command="{Binding CancelButtonCommand}"  
                FontSize="16" Margin="5,10,220,5" Height="30" Width="100" Style="{DynamicResource Button16Style}"/>


    </Grid>
</dxwui:WinUIDialogWindow>
