using DevExpress.Map.Native;
using DevExpress.Xpf.CodeView;
using DevExpress.Xpf.Core;
using DevExpress.Xpf.Editors;
using DevExpress.Xpf.Gauges;
//using DevExpress.Xpf.Grid;
using Emdep.Geos.Data.Common.ERM;
using Emdep.Geos.Modules.ERM.CommonClasses;
using Emdep.Geos.Modules.ERM.ViewModels;
using Emdep.Geos.UI.Common;
using Emdep.Geos.UI.Converters;
using Emdep.Geos.UI.Helper;
using Prism.Logging;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Data;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Net;
using System.Net.NetworkInformation;
using System.Runtime.InteropServices.ComTypes;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Shapes;

namespace Emdep.Geos.Modules.ERM.Views
{
    /// <summary>
    /// Interaction logic for ProductionTimelineView.xaml
    /// </summary>
    public partial class ProductionTimelineView : UserControl
    {
        public ProductionTimelineView()
        {
            InitializeComponent();


            Loaded += MyWindow_Loaded;
        }

        #region RND
        public int EMPGridCount = 0;
        public Boolean CheckempgridCount = false;
        private void MyWindow_Loaded(object sender, RoutedEventArgs e)
        {
            ERMCommon.Instance.Grid = ((Emdep.Geos.Modules.ERM.Views.ProductionTimelineView)sender).Grid1;
            //Emdep.Geos.Modules.ERM.ViewModels.ProductionTimelineViewModel productionTimelineViewModel = new Emdep.Geos.Modules.ERM.ViewModels.ProductionTimelineViewModel();
            //ProductionTimelineViewModel productionTimelineViewModel = new ProductionTimelineViewModel();
            //productionTimelineViewModel.FillData();
            List<int> TempPlantId = new List<int>();
            // ERMCommon.Instance.Grid.UpdateLayout();
            //AllCustomData(ERMCommon.Instance.Grid, ERMCommon.Instance.ProductionTimeList, TempPlantId);
            //AllCustomData(ERMCommon.Instance.Grid, ERMCommon.Instance.ProductionTimeList, TempPlantId, ERMCommon.Instance.StartDate, ERMCommon.Instance.EndDate);//[GEOS2-6965][rani dhamankar][12-03-2025]//[GEOS2-5883][gulab lakade][27 06 2024]
            if (ERMCommon.Instance.ERM_Employee_Attendance.Count() > 0 || ERMCommon.Instance.ERM_Counterpartstracking.Count() > 0 || ERMCommon.Instance.ERM_NO_OT_Time.Count() > 0 || ERMCommon.Instance.ERMCompanyHoliday.Count() > 0)
            {
                AllCustomDataNew_GEOS2_9220(ERMCommon.Instance.Grid, TempPlantId, ERMCommon.Instance.StartDate, ERMCommon.Instance.EndDate);//[GEOS2-6965][rani dhamankar][12-03-2025]//[GEOS2-5883][gulab lakade][27 06 2024]
            }
        }
        public DataTable DTProductionTimeline = new DataTable();
        //  List<ERM_ProductionTimeline> EmployeeProductionTimeList = new List<ERM_ProductionTimeline>(); 
        //DataTable dtTimetracking;
        //public DataTable DtTimetracking
        //{
        //    get { return dtTimetracking; }
        //    set
        //    {
        //        dtTimetracking = value;


        //    }
        //}
        #region [GEOS2-6693][rani dhamankar][28-02-2025]
        // Step 1: Declare the delegate type.
        public delegate byte[] DelegateImageUrlConverter(string imageUrl);

        // Step 2: Method to convert URL to byte array
        public byte[] ImageUrlToByteArray(string imageUrl)
        {
            //using (WebClient client = new WebClient())
            //{
            //    // Download image data as a byte array
            //    byte[] imageBytes = client.DownloadData(imageUrl);
            //    return imageBytes;
            //}
            // Download image data as a byte array
            byte[] imageBytes = Utility.ImageUtil.GetImageByWebClient(imageUrl);
            return imageBytes;
        }

        // Step 3: Method that will use the delegate
        public byte[] ImageUrlToByteArrayUsingDelegate(string imageUrl)
        {
            // Step 4: Create a delegate instance and invoke the method
            DelegateImageUrlConverter converter = new DelegateImageUrlConverter(ImageUrlToByteArray);
            return converter(imageUrl); // Invoke the method via the delegate
        }

        #endregion


        #region [GEOS2-8862][gulab lakade][22 07 2025]
        public async void AllCustomDataold(Grid MainGrid, List<ERM_ProductionTimeline> ProductionTimeList, List<int> TempPlantId, DateTime StartDates, DateTime EndDates)
        {

            try
            {
                GeosApplication.Instance.Logger.Log("Method AllCustomData ...", category: Category.Info, priority: Priority.Low);
                if (!DXSplashScreen.IsActive) { DXSplashScreen.Show<SplashScreenView>(); }

                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();//[gulab lakade][tool tips ][24 01 2024]
                Grid tempgrid = new Grid();
                #region [GEOS2-5040][gulab lakade][22 12 2023]
                ERMCommon.Instance.ProductionTimelineSprint = new System.Collections.ObjectModel.ObservableCollection<ERMProductionTimelineSprint>();
                ERMCommon.Instance.DataTableForProductionTimeLine = new DataTable();

                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Plant", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Week", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Date", typeof(DateTime));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Employee", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Stage", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Shift", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Logged", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Attendance", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("WOTime", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("DateHTMLColor", typeof(string));
                //ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Maintance11", typeof(string));
                //ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Meeting11", typeof(string));
                foreach (var item in ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Distinct())
                {
                    try
                    {
                        if (item.Name != "Working")
                        {

                            ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add(item.Name, typeof(TimeSpan));
                            #region //[pallavi jadhav][13 01 2025][GEOS2-6716] 
                            if (ERMCommon.Instance.DetailsList_IDLookup != null)
                            {
                                if (ERMCommon.Instance.DetailsList_IDLookup.Contains(item.IdLookupValue))
                                {
                                    #region [GEOS2-6573][rani dhamankar][07-05-2025]
                                    if (item.IdLookupValue == 1813)
                                    {
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Details_" + item.IdLookupValue, typeof(string));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("SwitchToStage", typeof(string));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Download", typeof(TimeSpan));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Transferred", typeof(TimeSpan));
                                    }
                                    else
                                    {
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Details_" + item.IdLookupValue, typeof(string)); //[pallavi jadhav][13 01 2025][GEOS2-6716] 
                                    }
                                    #endregion
                                }
                            }
                            #endregion
                        }
                    }
                    catch (Exception ex)
                    {
                        GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
                    }

                }

                //Aishwarya Ingale[Geos2-5883]
                foreach (var item1 in ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Distinct())
                {
                    try
                    {
                        if (item1.Name != "Working")
                        {
                            string uniqueColumnName = item1.Name + "_" + item1.IdLookupValue;
                            if (!ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Contains(uniqueColumnName))
                            {
                                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add(uniqueColumnName, typeof(TimeSpan));
                            }
                        }
                    }
                    catch (Exception ex)
                    {
                        GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
                    }
                }
                #endregion


                //DevExpress.Xpf.LayoutControl.LayoutGroup LayoutGroup = new DevExpress.Xpf.LayoutControl.LayoutGroup();
                //if (MainGrid != null)
                //{
                //    LayoutGroup = (DevExpress.Xpf.LayoutControl.LayoutGroup)MainGrid.Parent;
                //    //MainGrid = new Grid();
                //}

                //System.Windows.Controls.Grid EMPMainGrid = new System.Windows.Controls.Grid();
                //System.Windows.Controls.ScrollViewer EMPMainGrid = new System.Windows.Controls.ScrollViewer();
                System.Windows.Controls.StackPanel EMPMainGrid = new System.Windows.Controls.StackPanel();
                if (MainGrid != null)
                {
                    //EMPMainGrid = (System.Windows.Controls.Grid)MainGrid.Parent;
                    //EMPMainGrid = (System.Windows.Controls.ScrollViewer)MainGrid.Parent;
                    EMPMainGrid = (System.Windows.Controls.StackPanel)MainGrid.Parent;
                    //MainGrid = new Grid();
                }

                if (ProductionTimeList == null)
                {
                    ProductionTimeList = new List<ERM_ProductionTimeline>();
                }

                #region RND
                if (MainGrid.Children.Count > 0)
                {
                    MainGrid.Children.RemoveAt(0);
                    MainGrid.Children.Clear();
                }

                string tempname = MainGrid.Name;
                //MainGrid.ColumnDefinitions.Clear();
                //for (var a = 0; a < 1; a++)
                //{
                //    var c = new ColumnDefinition();
                //    c.Width = GridLength.Auto;
                //    //c.Width = new GridLength(50, GridUnitType.Pixel);
                //    MainGrid.ColumnDefinitions.Remove(c);
                //}
                // MainGrid.RowDefinitions.Clear();
                //MainGrid = tempgrid;
                // MainGrid.UpdateLayout();
                //maingrid column creation
                #region ColumnDefinition
                for (var a = 0; a < 1; a++)
                {
                    var c = new ColumnDefinition();
                    c.Width = GridLength.Auto;
                    //c.Width = new GridLength(400, GridUnitType.Pixel);
                    MainGrid.ColumnDefinitions.Add(c);
                }

                #endregion
                //maingrid row creation
                #region RowDefinition 
                for (var mainrow = 0; mainrow < 1; mainrow++)
                {
                    var r = new RowDefinition();
                    r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                    //r.Height =new GridLength(400, GridUnitType.Pixel);
                    MainGrid.RowDefinitions.Add(r);
                }


                //MainGrid
                #endregion
                #region Employee Label and ComboBox

                // MainGrid.ShowGridLines = false;
                //if (ERMCommon.Instance.EmployeeProductionTimeList == null)
                //{
                //    ERMCommon.Instance.EmployeeProductionTimeList = new List<ERM_ProductionTimeline>();
                //}
                //if (ERMCommon.Instance.EmployeeProductionTimeList.Count == 0)
                //{
                //    ERMCommon.Instance.EmployeeProductionTimeList = new List<ERM_ProductionTimeline>();
                //    ERMCommon.Instance.EmployeeProductionTimeList = ProductionTimeList.Where(x => x.EmployeeName != null).Distinct().ToList();
                //    var TempEmployeeProductionTimeList = ERMCommon.Instance.EmployeeProductionTimeList.GroupBy(a => a.EmployeeName).Select(grp => grp.First()).ToList().Distinct();
                //    ERMCommon.Instance.EmployeeProductionTimeList = new List<ERM_ProductionTimeline>(TempEmployeeProductionTimeList);
                //    ERMCommon.Instance.SelectedEmployee = new List<object>(ERMCommon.Instance.EmployeeProductionTimeList.ToList());
                //}

                //List<object> SelectedEmployee = new List<object>(EmployeeProductionTimeList.Select(a => a.EmployeeName).ToList());
                //}

                //StackPanel stackPanel = new StackPanel();
                //stackPanel.Orientation = Orientation.Horizontal;
                //stackPanel.Margin = new Thickness(0, 5, 0, 5);


                //TextBlock lbl = new TextBlock();
                //lbl.Text = "Employee:";
                //lbl.ToolTip = "Employee";
                //lbl.Width = 100;
                //lbl.TextAlignment = TextAlignment.Justify;
                //lbl.FontWeight = FontWeights.Bold;
                //lbl.Margin = new Thickness(0, -7, 0, 0);
                //lbl.Visibility = ERMCommon.Instance.IsEmployeeVisible;
                //stackPanel.Children.Add(lbl);

                //ComboBoxEdit comboBox = new ComboBoxEdit();
                //comboBox.Width = 250;
                //comboBox.HorizontalAlignment = HorizontalAlignment.Stretch;
                //comboBox.Margin = new Thickness(5, -7, 0, 0);
                //comboBox.ItemsSource = ERMCommon.Instance.EmployeeProductionTimeList;
                //comboBox.DisplayMember = "EmployeeName";
                //comboBox.EditValue = ERMCommon.Instance.SelectedEmployee;
                //comboBox.Visibility = ERMCommon.Instance.IsEmployeeVisible;
                //// comboBox.SelectedItem = ERMCommon.Instance.SelectedEmployee;
                //comboBox.EditValueChanged += ComboBox_EditValueChanged;
                //// Set the StyleSettings to CheckedComboBoxStyleSettings
                //comboBox.StyleSettings = new CheckedComboBoxStyleSettings();

                //// Hook up the SelectionChanged event if needed
                //// comboBox.EditValueChanged += new SelectionChangedEventHandler(ComboBoxEdit_EditValueChanged);
                ////ComboBox comboBox = new ComboBox();
                ////comboBox.Width = 250;
                ////comboBox.HorizontalAlignment = HorizontalAlignment.Stretch;
                ////comboBox.Margin = new Thickness(5, 0, 0, 0);
                ////comboBox.ItemsSource = EmployeeProductionTimeList;
                ////comboBox.DisplayMemberPath = "EmployeeName";
                ////comboBox.SelectionChanged += new SelectionChangedEventHandler(cmb_SelectionChanged);

                ////DataTemplate itemTemplate = new DataTemplate();
                ////FrameworkElementFactory checkBoxFactory = new FrameworkElementFactory(typeof(CheckBox));
                ////checkBoxFactory.SetBinding(CheckBox.ContentProperty, new Binding("EmployeeName"));
                ////checkBoxFactory.SetBinding(CheckBox.IsCheckedProperty, new Binding("IsSelected") { Mode = BindingMode.TwoWay });
                ////itemTemplate.VisualTree = checkBoxFactory;
                ////comboBox.ItemTemplate = itemTemplate;

                //stackPanel.Children.Add(comboBox);
                //Grid.SetRow(stackPanel, 0);
                //Grid.SetColumn(stackPanel, 0);
                //MainGrid.Children.Add(stackPanel);
                #endregion


                Grid PlantGrid = new Grid();
                PlantGrid.HorizontalAlignment = HorizontalAlignment.Stretch;
                PlantGrid.VerticalAlignment = VerticalAlignment.Stretch;



                if (ProductionTimeList.Count > 0)
                {
                    #region MainRowData 
                    //for (var maindata = 0; maindata < 1; maindata++)
                    //{
                    // plant  binding
                    var PlantList = ProductionTimeList.GroupBy(a => a.SiteName).ToList();
                    if (PlantList.Count > 0)
                    {
                        int plantCount = PlantList.Count();



                        PlantGrid.ShowGridLines = false;
                        //Plantgrid column creation
                        #region ColumnDefinition
                        for (var plantcolum = 0; plantcolum < 1; plantcolum++)
                        {
                            var c = new ColumnDefinition();
                            c.Width = GridLength.Auto;
                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                            PlantGrid.ColumnDefinitions.Add(c);
                        }

                        #endregion
                        //Plantgrid row creation
                        #region RowDefinition 
                        for (var plantrow = 0; plantrow < plantCount; plantrow++)
                        {
                            var r = new RowDefinition();
                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                            PlantGrid.RowDefinitions.Add(r);
                        }

                        #endregion
                        #region plantRowData 
                        //for (var plantdata = 0; plantdata < 4; plantdata++)
                        int Plantrow = 0;
                        foreach (var plantdata in PlantList)
                        {

                            #region Dates
                            Grid DateGrid = new Grid();
                            DateGrid.ShowGridLines = false;
                            //var DateList = ProductionTimeList.GroupBy(x => x.AttendanceStartDate.Value.Date).OrderByDescending(a => a.Key).ToList();
                            //   var DateList = ProductionTimeList.GroupBy(x => x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date : x.AttendanceStartDate.Value.Date ).OrderByDescending(a => a.Key).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]

                            //var DateList = ProductionTimeList.Where(a => a.JobDescriptionStartDate.HasValue && a.AttendanceStartDate == null && a.CounterpartStartDate.Value.Date >= a.JobDescriptionStartDate.Value.Date  && a.JobDescriptionEndDate.HasValue &&  a.JobDescriptionEndDate.HasValue  && a.CounterpartEndDate.Value.Date <= a.JobDescriptionEndDate.Value.Date ).GroupBy(x => x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date : x.AttendanceStartDate.Value.Date).OrderByDescending(a => a.Key).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]

                            #region [GEOS2-6965][rani dhamankar][12-03-2025]
                            var DateList = ProductionTimeList
                                             .Where(x =>
                                                 x.JobDescriptionStartDate.HasValue &&
                                                 (
                                                     (x.AttendanceStartDate.HasValue &&
                                                      x.AttendanceStartDate.Value.Date >= x.JobDescriptionStartDate.Value.Date &&
                                                      (!x.JobDescriptionEndDate.HasValue ||
                                                       (x.JobDescriptionEndDate.HasValue && x.AttendanceEndDate.HasValue &&
                                                        x.AttendanceEndDate.Value.Date <= x.JobDescriptionEndDate.Value.Date)))
                                                     ||
                                                     (x.AttendanceStartDate == null && x.CounterpartStartDate.HasValue &&
                                                      x.CounterpartStartDate.Value.Date >= x.JobDescriptionStartDate.Value.Date &&
                                                      (!x.JobDescriptionEndDate.HasValue ||
                                                       (x.JobDescriptionEndDate.HasValue && x.CounterpartEndDate.HasValue &&
                                                        x.CounterpartEndDate.Value.Date <= x.JobDescriptionEndDate.Value.Date)))
                                                        ||
                                                         (x.AttendanceStartDate == null && x.CounterpartStartDate == null &&
                                                      x.LeaveStartDate.Value.Date >= x.JobDescriptionStartDate.Value.Date &&
                                                      (!x.JobDescriptionEndDate.HasValue ||
                                                       (x.JobDescriptionEndDate.HasValue && x.LeaveStartDate.HasValue &&
                                                        x.LeaveStartDate.Value.Date <= x.JobDescriptionEndDate.Value.Date)))
                                                 )
                                             )
                                              .GroupBy(x => x.AttendanceStartDate == null
                                             ? x.CounterpartStartDate.HasValue ? x.CounterpartStartDate.Value.Date
                                             : (x.LeaveStartDate.HasValue ? x.LeaveStartDate.Value.Date : DateTime.MinValue)
                                             : x.AttendanceStartDate.HasValue ? x.AttendanceStartDate.Value.Date : DateTime.MinValue)
                                             .OrderByDescending(a => a.Key)
                                             .ToList();

                            #endregion
                            // var DateListActiveandInactive = DateList.Where(a => a.Key <= ProductionTimeList.Select(b => b.JobDescriptionEndDate.Value.Date).ToList());
                            //var DateList = DateListtemp.GroupBy(a => a.Key.Value.Date).ToList();
                            //Plantgrid column creation
                            #region ColumnDefinition
                            for (var Datescolumn = 0; Datescolumn < 1; Datescolumn++)
                            {
                                var c = new ColumnDefinition();
                                c.Width = GridLength.Auto;
                                //c.Width = new GridLength(50, GridUnitType.Pixel);
                                DateGrid.ColumnDefinitions.Add(c);
                            }

                            #endregion
                            //Plantgrid row creation
                            #region RowDefinition 
                            for (var Daterow = 0; Daterow < DateList.Count; Daterow++)
                            {
                                var r = new RowDefinition();
                                r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                DateGrid.RowDefinitions.Add(r);
                            }

                            #endregion
                            //  DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();
                            //   DataRow drs = ERMCommon.Instance.DataTableForProductionTimeLineGrid.NewRow();
                            if (DateList.Count > 0)
                            {
                                var FilterData = DateList.Where(a => a.Key.Date >= StartDates.Date && a.Key.Date <= EndDates.Date).ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                int DateRow = 0;
                                if (FilterData.Any())
                                {
                                    foreach (var itemDate in FilterData)
                                    {
                                        // DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();
                                        var index = DateList.IndexOf(itemDate);//[GEOS2-5235][pallavi jadhav]
                                        DateTime? NotNullShiftDate = DateTime.Now;//[GEOS2-5235][pallavi jadhav]
                                        Label PlantName = new Label();
                                        //[GEOS2-5235][pallavi jadhav]
                                        if (DateList.Count - 1 != index)
                                        {
                                            NotNullShiftDate = DateList[index + 1].Key;
                                        }
                                        DateTime? shiftStartDate = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                        DateTime? shiftEndDate = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                        //[GEOS2-5235][pallavi jadhav]
                                        // DateTime StartDate = Convert.ToDateTime(itemDate.Key.Date);//[GEOS2-5883][gulab lakade][274 06 2024]
                                        PlantName.Content = "Plant: " + Convert.ToString(plantdata.Key) + "        " + "Date: ";// + StartDate.Date.ToString("dd/MM/yyyy");
                                        PlantName.FontWeight = FontWeights.Bold;
                                        //PlantName.Width = 100;
                                        #region [GEOS2-5233][gulab lakade][16 01 2024]
                                        Label DateLabel = new Label();
                                        DateLabel.Content = itemDate.Key.Date.ToString("dd/MM/yyyy");// StartDate.Date.ToString("dd/MM/yyyy");[GEOS2-5883][gulab lakade][274 06 2024]
                                        DateLabel.FontWeight = FontWeights.Bold;
                                        //DateLabel.Width = 100;
                                        ToolTip HolidayTooltips = new ToolTip();
                                        //var TempHolidayRecord = ProductionTimeList.Where(x => x.AttendanceStartDate.Value.Date == StartDate.Date).FirstOrDefault();
                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                        //var TempHolidayRecord = ProductionTimeList.Where(x => x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.AttendanceStartDate.Value.Date == StartDate.Date).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                        //var TempHolidayRecord = itemDate.Where(x => x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == itemDate.Key.Date : x.AttendanceStartDate.Value.Date == itemDate.Key.Date).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]

                                        //[rani dhamankar] [12 - 03 - 2025][GEOS2 - 6965]
                                        var TempHolidayRecord = itemDate
                                         .Where(x =>
                                             (x.AttendanceStartDate == null && x.CounterpartStartDate.HasValue && x.CounterpartStartDate.Value.Date == itemDate.Key.Date)
                                             || (x.AttendanceStartDate.HasValue && x.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                             || (x.AttendanceStartDate == null && x.CounterpartStartDate == null && x.ISHolidayEvent == false && x.LeaveStartDate.HasValue && x.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                         )
                                         .FirstOrDefault();
                                        #endregion
                                        string HolidayType = string.Empty;
                                        string Holidayname = string.Empty;
                                        string HtmlColor = string.Empty;
                                        Image TooltipImage = new Image();
                                        TooltipImage.Visibility = Visibility.Hidden;


                                        if (TempHolidayRecord != null)
                                        {
                                            if (!string.IsNullOrWhiteSpace(TempHolidayRecord.HolidayType))
                                            {
                                                HolidayType = Convert.ToString(TempHolidayRecord.HolidayType);
                                            }
                                            if (!string.IsNullOrWhiteSpace(TempHolidayRecord.HolidayName))
                                            {
                                                Holidayname = Convert.ToString(TempHolidayRecord.HolidayName);
                                            }

                                        }

                                        //string DayName = StartDate.ToString("dddd", new CultureInfo("en-US"));//GEOS2-5883][gulab lakade][274 06 2024]
                                        string DayName = itemDate.Key.Date.ToString("dddd", new CultureInfo("en-US"));//GEOS2-5883][gulab lakade][274 06 2024]
                                        string ToolTipContent = string.Empty;
                                        if ((DayName == "Saturday" || DayName == "Sunday") && (!string.IsNullOrWhiteSpace(Holidayname)))
                                        {
                                            TimeSpan holidayStarttime = TempHolidayRecord.HolidayStartDate.Value.TimeOfDay;
                                            string holidayStarttimeInString = holidayStarttime.ToString("hh\\:mm");
                                            TimeSpan holidayEndtime = TempHolidayRecord.HolidayEndDate.Value.TimeOfDay;
                                            string holidayEndtimeInString = holidayEndtime.ToString("hh\\:mm");
                                            if (TempHolidayRecord.ISHolidayEvent == true)
                                            {
                                                ToolTipContent = "\r" + DayName + "\r\n" + Holidayname + "\r\n" + HolidayType;
                                            }
                                            else
                                            {
                                                ToolTipContent = "\r" + DayName + "\r\n" + Holidayname + " (" + holidayStarttimeInString + "-" + holidayEndtimeInString + ")\r\n" + HolidayType;
                                            }

                                            DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                            //  dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                            HtmlColor = Convert.ToString("#FF0000");
                                            TooltipImage.Visibility = Visibility.Visible;
                                        }
                                        else if ((DayName == "Saturday" || DayName == "Sunday") && string.IsNullOrWhiteSpace(Holidayname))
                                        {
                                            ToolTipContent = DayName;
                                            DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#808080"));
                                            // dr["DateHTMLColor"] = Convert.ToString("#808080");
                                            HtmlColor = Convert.ToString("#808080");
                                            TooltipImage.Visibility = Visibility.Visible;
                                        }
                                        else
                                            if ((!string.IsNullOrWhiteSpace(Holidayname)))
                                        {
                                            if (TempHolidayRecord.ISHolidayEvent == true)
                                            {
                                                ToolTipContent = "\r" + Holidayname + "\r\n " + HolidayType;
                                                DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                                //  dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                                HtmlColor = Convert.ToString("#FF0000");
                                                TooltipImage.Visibility = Visibility.Visible;
                                            }
                                            else
                                            {
                                                TimeSpan holidayStarttime = TempHolidayRecord.HolidayStartDate.Value.TimeOfDay;
                                                string holidayStarttimeInString = holidayStarttime.ToString("hh\\:mm");
                                                TimeSpan holidayEndtime = TempHolidayRecord.HolidayEndDate.Value.TimeOfDay;
                                                string holidayEndtimeInString = holidayEndtime.ToString("hh\\:mm");
                                                ToolTipContent = "\r" + Holidayname + " (" + holidayStarttimeInString + "-" + holidayEndtimeInString + ")\r\n" + HolidayType;
                                                DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                                // dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                                HtmlColor = Convert.ToString("#FF0000");
                                                TooltipImage.Visibility = Visibility.Visible;
                                            }

                                        }
                                        try
                                        {
                                            BitmapImage bitmapTooltip = new BitmapImage(new Uri(@"/Emdep.Geos.Modules.ERM;component/Assets/Images/INFO1.png", UriKind.Relative));

                                            TooltipImage.Source = bitmapTooltip;

                                            TooltipImage.Width = 20;
                                            TooltipImage.Height = 20;
                                            TooltipImage.ToolTip = ToolTipContent;
                                        }
                                        catch (Exception ex)
                                        {

                                        }


                                        #endregion
                                        #region StageGrid


                                        //if (plantdata == 0)
                                        //{



                                        Grid PlantTempGrid = new Grid();
                                        PlantTempGrid.ShowGridLines = false;

                                        //Stagegrid column creation
                                        #region ColumnDefinition
                                        for (var Stage1column = 0; Stage1column < 4; Stage1column++)
                                        {
                                            var c = new ColumnDefinition();
                                            if (Stage1column == 0)
                                            {
                                                c.Width = GridLength.Auto;
                                            }
                                            else if (Stage1column == 1)
                                            {
                                                c.Width = GridLength.Auto;
                                            }
                                            else if (Stage1column == 2)
                                            {
                                                c.Width = new GridLength(30, GridUnitType.Pixel);
                                            }
                                            else if (Stage1column == 3)
                                            {
                                                c.Width = new GridLength(1180, GridUnitType.Pixel);
                                            }

                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                            PlantTempGrid.ColumnDefinitions.Add(c);
                                        }

                                        #endregion
                                        //Plantgrid row creation
                                        #region RowDefinition 
                                        for (var Stage1row = 0; Stage1row < 2; Stage1row++)
                                        {
                                            var r = new RowDefinition();
                                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);

                                            PlantTempGrid.RowDefinitions.Add(r);
                                        }

                                        #endregion

                                        #region stage4

                                        Grid StageGrid = new Grid();
                                        StageGrid.ShowGridLines = false;

                                        //  var StageList = ProductionTimeList.Where(x => x.SiteName == plantdata.Key && x.AttendanceStartDate.Value.Date == StartDate.Date).GroupBy(a => a.StageCode).ToList();
                                        //var StageList = ProductionTimeList.Where(x => x.SiteName == plantdata.Key && x.AttendanceStartDate.Value.Date == StartDate.Date).OrderBy(z => z.Sequence).GroupBy(a => a.StageCode).ToList();//[pallavi jadhav] [GEOS2-5197] [02 01 2024]
                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                        //var StageList = ProductionTimeList.Where(x => x.SiteName == plantdata.Key && (x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.AttendanceStartDate.Value.Date == StartDate.Date)).OrderBy(z => z.Sequence).GroupBy(a => a.StageCode).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                        //var IdJobdescriptionList = ProductionTimeList.Where(x => x.SiteName == plantdata.Key && (x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.AttendanceStartDate.Value.Date == StartDate.Date)).GroupBy(a => a.IdJobDescription).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                        //var IdJobdescriptionList = itemDate.Where(x => x.SiteName == plantdata.Key && (x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == itemDate.Key.Date : x.AttendanceStartDate.Value.Date == itemDate.Key.Date)).GroupBy(a => a.IdJobDescription).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                        //var IdJobdescriptionList = itemDate.Where(x => x.SiteName == plantdata.Key && x.IsMainJobDescription == 1 && (x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == itemDate.Key.Date : x.AttendanceStartDate.Value.Date == itemDate.Key.Date)).GroupBy(a => a.IdJobDescription).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                        var IdJobdescriptionList = itemDate
                                         .Where(x => x.SiteName == plantdata.Key
                                                     && x.IsMainJobDescription == 1
                                                     && (
                                                         (x.AttendanceStartDate == null && x.CounterpartStartDate.HasValue && x.CounterpartStartDate.Value.Date == itemDate.Key.Date)
                                                         || (x.AttendanceStartDate.HasValue && x.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                         || (x.AttendanceStartDate == null && x.CounterpartStartDate == null && x.LeaveStartDate.HasValue && x.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                     )
                                                 )
                                         .GroupBy(a => a.IdJobDescription)
                                         .ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]

                                        List<PlanningDateReviewStages> TempStageList = new List<PlanningDateReviewStages>();
                                        if (IdJobdescriptionList != null && IdJobdescriptionList.Count() > 0)
                                        {
                                            foreach (var item in ERMCommon.Instance.WorkStageWiseJobDescription)
                                            {
                                                List<Int32> IdJobdescription = new List<int>();
                                                IdJobdescription = item.IdJobDescription.Select(int.Parse).ToList();
                                                var FindStage = IdJobdescriptionList.Where(x => IdJobdescription.Contains(x.Key)).ToList();
                                                if (FindStage.Count() > 0)
                                                {
                                                    var temp = ERMCommon.Instance.StageList.Where(x => x.IdStage == item.IdWorkStage).FirstOrDefault();
                                                    TempStageList.Add(temp);
                                                }
                                            }
                                        }

                                        if (ERMCommon.Instance.SelectedProductionTimeStagesList.Count() > 0)
                                        {
                                            List<Int32> TempSelectedIdStage = ERMCommon.Instance.SelectedProductionTimeStagesList.Cast<PlanningDateReviewStages>().Select(x => x.IdStage).ToList();

                                            TempStageList = TempStageList.Where(x => TempSelectedIdStage.Contains(x.IdStage)).ToList();
                                        }
                                        var StageList = TempStageList.OrderBy(x => x.Sequence).GroupBy(a => a.StageCode).ToList();

                                        int StageCount = StageList.Count();
                                        #endregion
                                        //Stagegrid column creation
                                        #region ColumnDefinition
                                        for (var Stagecolumn = 0; Stagecolumn < 1; Stagecolumn++)
                                        {
                                            var c = new ColumnDefinition();
                                            c.Width = GridLength.Auto;
                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                            StageGrid.ColumnDefinitions.Add(c);
                                        }

                                        #endregion
                                        //Plantgrid row creation
                                        #region RowDefinition 
                                        for (var Stagerow = 0; Stagerow < StageCount; Stagerow++)
                                        {
                                            var r = new RowDefinition();
                                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                            StageGrid.RowDefinitions.Add(r);
                                        }

                                        #endregion
                                        //for(int stagedata=0; stagedata< StageCount; stagedata++)
                                        int StageRow = 0;
                                        List<ERM_ProductionTimeline> ERM_ProductionTimelineExistingEmP = new List<ERM_ProductionTimeline>();

                                        foreach (var stagedata in StageList)
                                        {

                                            Grid stageTempGrid = new Grid();
                                            stageTempGrid.ShowGridLines = false;

                                            //Stagegrid column creation
                                            #region ColumnDefinition
                                            for (var Stage1column = 0; Stage1column < 1; Stage1column++)
                                            {
                                                var c = new ColumnDefinition();
                                                c.Width = GridLength.Auto;
                                                //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                stageTempGrid.ColumnDefinitions.Add(c);
                                            }

                                            #endregion
                                            //Plantgrid row creation
                                            #region RowDefinition 
                                            for (var Stage1row = 0; Stage1row < 4; Stage1row++)
                                            {
                                                var r = new RowDefinition();
                                                if (Stage1row == 2)
                                                {
                                                    r.Height = new GridLength(10, GridUnitType.Pixel);
                                                }
                                                else
                                                {
                                                    r.Height = GridLength.Auto;
                                                }

                                                stageTempGrid.RowDefinitions.Add(r);
                                            }

                                            #endregion

                                            //string StagesName = ProductionTimeList.Where(x => x.StageCode == stagedata.Key && x.SiteName == plantdata.Key).FirstOrDefault().StageName;
                                            string StagesName = TempStageList.Where(x => x.StageCode == stagedata.Key).FirstOrDefault().StageName;
                                            Label StageName = new Label();
                                            StageName.Content = Convert.ToString(stagedata.Key) + " - " + StagesName;
                                            StageName.FontWeight = FontWeights.Bold;
                                            //Grid.SetRow(StageName, 0);
                                            //Grid.SetColumn(StageName, 0);

                                            #region emp

                                            //var EmployeeCodeList = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && a.AttendanceStartDate.Value.Date == StartDate.Date).GroupBy(x => x.EmployeeCode).ToList();
                                            //var EmployeeCodeList11 = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && a.AttendanceStartDate == null && a.CounterpartStartDate.Value.Date == StartDate.Date).ToList();

                                            #region [GEOS2-5883][gulab lakade][274 06 2024]
                                            //var EmployeeCodeList11 = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).ToList();
                                            //var EmployeeCodeList = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).GroupBy(x => x.EmployeeCode).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                            var StageRecord = ERMCommon.Instance.StageList.Where(x => x.StageCode == stagedata.Key).FirstOrDefault();
                                            List<string> IdJobdescriptionINstring = ERMCommon.Instance.WorkStageWiseJobDescription.Where(a => a.IdWorkStage == StageRecord.IdStage).FirstOrDefault().IdJobDescription;
                                            List<Int32> IdJobdescription = new List<int>();
                                            IdJobdescription = IdJobdescriptionINstring.Select(int.Parse).ToList();

                                            //var EmployeeCodeList11 = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).ToList();
                                            //var EmployeeCodeList = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).GroupBy(x => x.EmployeeCode).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                            //var EmployeeCodeList = itemDate.Where(a => a.SiteName == plantdata.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date : a.AttendanceStartDate.Value.Date == itemDate.Key.Date)).GroupBy(x => x.EmployeeCode).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                            //var EmployeeCodeList = itemDate.Where(a => a.SiteName == plantdata.Key && IdJobdescription.Contains(a.IdJobDescription) && a.IsMainJobDescription == 1 && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date : a.AttendanceStartDate.Value.Date == itemDate.Key.Date)).GroupBy(x => x.EmployeeCode).ToList();//[GEOS2-6554][gulab lakade][28 11 2024]
                                            var EmployeeCodeList = itemDate.Where(a => a.SiteName == plantdata.Key && IdJobdescription.Contains(a.IdJobDescription) && a.IsMainJobDescription == 1 && ((a.AttendanceStartDate == null && a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date) || (a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date) || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date))).GroupBy(x => x.EmployeeCode).ToList();////[GEOS2-6965][rani dhamankar][12-03-2025]
                                            #endregion
                                            int EmployeeCount = EmployeeCodeList.Count();
                                            Grid EmpGrid = new Grid();
                                            EmpGrid.ShowGridLines = false;

                                            //Stagegrid column creation
                                            #region ColumnDefinition
                                            for (var empcolumn = 0; empcolumn < 4; empcolumn++)
                                            {
                                                var c = new ColumnDefinition();
                                                if (empcolumn == 0)
                                                {
                                                    c.Width = new GridLength(220, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 1)
                                                {
                                                    c.Width = new GridLength(100, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 2)
                                                {
                                                    c.Width = GridLength.Auto; //new GridLength(600, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 3)
                                                {
                                                    c.Width = new GridLength(70, GridUnitType.Pixel);
                                                }
                                                //c.Width = GridLength.Auto;
                                                //c.Width = new GridLength(150, GridUnitType.Pixel);
                                                EmpGrid.ColumnDefinitions.Add(c);
                                            }

                                            #endregion
                                            //Plantgrid row creation
                                            #region RowDefinition 
                                            for (var emprow = 0; emprow < EmployeeCount; emprow++)
                                            {
                                                var r = new RowDefinition();
                                                r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                EmpGrid.RowDefinitions.Add(r);
                                            }

                                            #endregion



                                            //for(int i=0; i<2;i++)
                                            int empcount = 0;

                                            foreach (var emp in EmployeeCodeList)
                                            {
                                                TimeSpan Hours_24 = new TimeSpan();
                                                TimeSpan Hours_0 = new TimeSpan();
                                                Hours_24 = TimeSpan.FromMinutes(1440);//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                Hours_0 = TimeSpan.Zero;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_24 = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_0 = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_Night = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                DateTime? MinAtt_Date = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                                DateTime? MaxAtt_Date = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                                DateTime? Shift_ST_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                DateTime? Shift_ED_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                TimeSpan tmpStartTimeCheck = new TimeSpan(14, 00, 0);
                                                TimeSpan tmpENDTimeCheck = new TimeSpan(12, 00, 0);
                                                //var TmpMinMaxATT = ProductionTimeList.Where(a => a.StageCode == stagedata.Key && a.EmployeeCode == emp.Key && a.AttendanceStartDate != null
                                                //&& (a.IsNightShift == 1  ? (a.AttendanceStartDate.Value.Date >= itemDate.Key.Date && a.AttendanceEndDate.Value.Date <= itemDate.Key.Date.AddDays(1)) : (a.AttendanceStartDate.Value.Date == itemDate.Key.Date && a.AttendanceEndDate.Value.Date == itemDate.Key.Date))).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                var TmpMinMaxATT = ProductionTimeList.Where(a => a.EmployeeCode == emp.Key && a.AttendanceStartDate != null
                                                && (a.IsNightShift == 1 && a.ShiftStartTime >= tmpStartTimeCheck ? (a.AttendanceStartDate.Value >= itemDate.Key.Date.Add(a.ShiftStartTime.Subtract(TimeSpan.FromHours(2))) && a.AttendanceEndDate.Value <= itemDate.Key.Date.AddDays(1).Date.Add(tmpENDTimeCheck)) : (a.AttendanceStartDate.Value.Date == itemDate.Key.Date && a.AttendanceEndDate.Value.Date == itemDate.Key.Date))).ToList();// [GEOS2-7755][gulab lakade][08 04 2025]
                                                #endregion 
                                                ERM_ProductionTimeline employee = new ERM_ProductionTimeline();
                                                if (TmpMinMaxATT.Count() > 0)
                                                {
                                                    DateTime? Shift_std_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                    Shift_std_Date = itemDate.Key.Date.Add(tmpStartTimeCheck);
                                                    DateTime? Shift_edd_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]

                                                    var Tmpshift = TmpMinMaxATT.FirstOrDefault();
                                                    TimeSpan tmptimespan = new TimeSpan(2, 0, 0);
                                                    TimeSpan tmpShiftStartTime = new TimeSpan(Tmpshift.ShiftStartTime.Hours, 0, 0);
                                                    TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                    if (Tmpshift.ShiftEndTime.Minutes > 0)
                                                    {
                                                        tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                    }
                                                    Shift_ST_Date = Shift_ST_Date.Value.Date.Add(Tmpshift.ShiftStartTime); //[GEOS2-7755][gulab lakade] [08 04 2025]


                                                    if (Tmpshift.IsNightShift == 1)
                                                    {

                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        Shift_edd_Date = itemDate.Key.Date.AddDays(1);
                                                        Shift_edd_Date = Shift_edd_Date.Value.Date.Add(tmpENDTimeCheck);
                                                        #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                        //MinAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceStartDate > Shift_std_Date).Min(a => a.AttendanceStartDate);
                                                        MinAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceStartDate > Shift_std_Date && x.AttendanceStartDate < Shift_edd_Date).Min(a => a.AttendanceStartDate);
                                                        #endregion 
                                                        MaxAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceEndDate < Shift_edd_Date).Max(a => a.AttendanceEndDate);

                                                        shiftStartDate = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                        //TimeSpan tmpStartTimeCheck = new TimeSpan(17, 00, 0);
                                                        //TimeSpan tmpENDTimeCheck = new TimeSpan(12, 00, 0);

                                                        if (tmpShiftStartTime >= tmpStartTimeCheck)
                                                        {
                                                            //[GEOS2-7092][gulab lakade][22 05 2025]
                                                            if (shiftStartDate > MinAtt_Date)
                                                            {
                                                                shiftStartDate = MinAtt_Date;
                                                            }
                                                            //end[GEOS2-7092][gulab lakade][22 05 2025]
                                                            if (tmpShiftEndTime >= tmpENDTimeCheck)
                                                            {
                                                                shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                                //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                            }
                                                            else
                                                            {
                                                                shiftEndDate = itemDate.Key.Date.AddDays(1);
                                                                shiftEndDate = shiftEndDate.Value.Date.Add(tmpShiftEndTime);
                                                                //Shift_ED_Date = Shift_ED_Date.Value.Date.AddDays(1).Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                            }
                                                            if (MaxAtt_Date < shiftEndDate)
                                                            {
                                                                MaxAtt_Date = shiftEndDate;
                                                            }
                                                            else
                                                            {
                                                                TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                                if (tmpenddt.Minutes > 0)
                                                                {
                                                                    TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                                    tmpenddt = tmpenddt.Add(tmpspan);
                                                                    tmpspan = new TimeSpan(0, tmpenddt.Minutes, 0);
                                                                    tmpenddt = tmpenddt.Subtract(tmpspan);
                                                                }
                                                                shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                            }
                                                        }
                                                        else
                                                        {
                                                            MinAtt_Date = shiftStartDate;
                                                            shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                            if (MaxAtt_Date < shiftEndDate)
                                                            {
                                                                MaxAtt_Date = shiftEndDate;
                                                            }
                                                            else
                                                            {
                                                                TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                                if (tmpenddt.Minutes > 0)
                                                                {
                                                                    TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                                    tmpenddt = tmpenddt.Add(tmpspan);
                                                                    tmpspan = new TimeSpan(0, tmpenddt.Minutes, 0);
                                                                    tmpenddt = tmpenddt.Subtract(tmpspan);
                                                                }
                                                                shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                            }
                                                            //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                        }
                                                        #endregion 

                                                    }
                                                    else
                                                    {
                                                        MinAtt_Date = TmpMinMaxATT.Min(a => a.AttendanceStartDate);
                                                        MaxAtt_Date = TmpMinMaxATT.Max(a => a.AttendanceEndDate);
                                                        shiftStartDate = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                        shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                        if (MinAtt_Date <= shiftStartDate)
                                                        {
                                                            TimeSpan tmpenddt = MinAtt_Date.Value.TimeOfDay;
                                                            TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                            tmpenddt = tmpenddt.Add(-tmpspan);
                                                            tmpShiftStartTime = tmpenddt;
                                                            shiftStartDate = MinAtt_Date.Value.Date.Add(tmpenddt);
                                                        }


                                                        if (MaxAtt_Date.Value.TimeOfDay >= tmpShiftEndTime)
                                                        {
                                                            TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                            TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                            tmpenddt = tmpenddt.Add(tmpspan);
                                                            tmpShiftEndTime = tmpenddt;
                                                            shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                        }
                                                        //else
                                                        //{
                                                        //    shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                        //}


                                                        //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                    }

                                                }
                                                else
                                                {
                                                    var Tmpshift = emp.FirstOrDefault();
                                                    if (Tmpshift != null)
                                                    {
                                                        #region [GEOS2-7755][gulab lakade][16 04 2025]
                                                        if (Tmpshift.IsNightShift == 1)
                                                        {
                                                            TimeSpan tmpShiftStartTime = Tmpshift.ShiftStartTime;


                                                            TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                            if (tmpShiftStartTime >= tmpStartTimeCheck)
                                                            {
                                                                if (tmpShiftEndTime >= tmpENDTimeCheck)
                                                                {
                                                                    shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                                }
                                                                else
                                                                {
                                                                    shiftEndDate = itemDate.Key.Date.AddDays(1);
                                                                    shiftEndDate = shiftEndDate.Value.Date.Add(tmpShiftEndTime);
                                                                }

                                                            }
                                                            else
                                                            {
                                                                shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                            }
                                                            shiftStartDate = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                            MinAtt_Date = shiftStartDate;
                                                            MaxAtt_Date = shiftEndDate;
                                                        }
                                                        else
                                                        {
                                                            TimeSpan tmpShiftStartTime = Tmpshift.ShiftStartTime;
                                                            TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                            MinAtt_Date = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                            MaxAtt_Date = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                            shiftStartDate = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                            shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                        }

                                                        #endregion
                                                    }

                                                }
                                                #endregion 
                                                //var tempempListNullable = ProductionTimeList.Where(a => a.StageCode == stagedata.Key && a.AttendanceStartDate == null && a.CounterpartStartDate.Value.Date == StartDate.Date).OrderBy(a => a.CounterPartStartTime).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                //if (tempempListNullable != null && tempempListNullable.Count() > 0)
                                                //{

                                                //    int IDOperator = tempempListNullable.FirstOrDefault().IdOperator;
                                                //    DateTime MaxAtt_Date = ProductionTimeList.Where(x => x.SiteName == plantdata.Key && x.IdOperator == IDOperator && x.AttendanceStartDate != null && x.AttendanceStartDate < StartDate.Date).Max(d => d.AttendanceStartDate.Value.Date);
                                                //    var MaxAtt_DateRecord = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.AttendanceStartDate.Value.Date == MaxAtt_Date && a.IdOperator == IDOperator).FirstOrDefault();
                                                //    if (MaxAtt_DateRecord != null)
                                                //    {
                                                //        foreach (var Update in ProductionTimeList.Where(a => a.AttendanceStartDate == null && a.IdOperator == IDOperator && a.StageCode == stagedata.Key && a.CounterpartStartDate.Value.Date == StartDate.Date))
                                                //        {
                                                //            Update.EmployeeCode = MaxAtt_DateRecord.EmployeeCode;
                                                //            Update.IdEmployee = MaxAtt_DateRecord.IdEmployee;
                                                //            Update.IdSite = MaxAtt_DateRecord.IdSite;
                                                //            Update.SiteName = MaxAtt_DateRecord.SiteName;
                                                //            Update.AttendanceStartDate = MaxAtt_DateRecord.AttendanceStartDate;
                                                //            Update.AttendanceEndDate = MaxAtt_DateRecord.AttendanceEndDate;
                                                //            Update.ShiftStartTime = MaxAtt_DateRecord.ShiftStartTime;
                                                //            Update.ShiftEndTime = MaxAtt_DateRecord.ShiftEndTime;
                                                //        }
                                                //    }
                                                //}
                                                //var employeelist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key &&  a.CounterpartStartDate.Value.Date == StartDate.Date).OrderBy(a => a.CounterPartStartTime).ToList();////[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                //employee = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate.Value.Date == StartDate.Date).FirstOrDefault();
                                                #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                //var employeelist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && (a.IsNightShift == 1 ? (a.AttendanceStartDate == null ? (a.CounterpartStartDate.Value.Date == StartDate.Date || a.CounterpartStartDate.Value.Date == StartDate.Date.AddDays(1)) : a.AttendanceStartDate.Value.Date == StartDate.Date) : (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date))).OrderBy(a => a.CounterPartStartTime).ToList();////[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                //employee = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).FirstOrDefault();
                                                //var employeelist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.IsNightShift == 1 ? (a.AttendanceStartDate == null ? (a.CounterpartStartDate.Value.Date == StartDate.Date || a.CounterpartStartDate.Value.Date == StartDate.Date.AddDays(1)) : a.AttendanceStartDate.Value.Date == StartDate.Date) : (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date))).OrderBy(a => a.CounterPartStartTime).ToList();////[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                //employee = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).FirstOrDefault();

                                                // var employeelist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.IsNightShift == 1 ? (a.AttendanceStartDate == null ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.AttendanceStartDate.Value.Date == itemDate.Key.Date) : (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date : a.AttendanceStartDate.Value.Date == itemDate.Key.Date))).OrderBy(a => a.CounterPartStartTime).ToList();////[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                // employee = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date : a.AttendanceStartDate.Value.Date == itemDate.Key.Date)).FirstOrDefault();
                                                //var employeelist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.IsNightShift == 1 ? (a.AttendanceStartDate == null ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.AttendanceStartDate.Value.Date == itemDate.Key.Date) : (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date : a.AttendanceStartDate.Value.Date == itemDate.Key.Date)) && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate != null && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))).OrderBy(a => a.CounterPartStartTime).ToList();////[GEOS2-5418] [gulab lakade] [23 02 2024]

                                                //employee = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date : a.AttendanceStartDate.Value.Date == itemDate.Key.Date) && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate != null && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))).FirstOrDefault();
                                                //var employeelist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && (a.IsNightShift == 1 ? (a.AttendanceStartDate == null ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.AttendanceStartDate.Value.Date == itemDate.Key.Date) : (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date : a.AttendanceStartDate.Value.Date == itemDate.Key.Date)) && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate != null && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))).OrderBy(a => a.CounterPartStartTime).ToList();////[GEOS2-6554][gulab lakade][28 11 2024]

                                                //employee = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date : a.AttendanceStartDate.Value.Date == itemDate.Key.Date) && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate != null && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))).FirstOrDefault();//[GEOS2-6554][gulab lakade][28 11 2024]

                                                if (MinAtt_Date >= shiftStartDate && MaxAtt_Date <= shiftEndDate)//[GEOS2-7641][gulab lakade][27 03 2025]
                                                {


                                                    //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                    #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                    //   var employeelist = emp
                                                    //.Where(a => a.SiteName == plantdata.Key
                                                    //            && a.EmployeeCode == emp.Key
                                                    //            && (
                                                    //                (
                                                    //                    a.IsNightShift == 1
                                                    //                    ? (a.AttendanceStartDate == null
                                                    //                        ? a.CounterpartStartDate.HasValue && (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                    //                        : a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                    //                    : (a.AttendanceStartDate == null
                                                    //                        ? a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                    //                        : a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                    //                )
                                                    //                || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                    //            )
                                                    //            && a.JobDescriptionStartDate.HasValue
                                                    //            && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date
                                                    //            && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate.HasValue && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))
                                                    //)
                                                    //.OrderBy(a => a.CounterPartStartTime == null ? TimeSpan.MaxValue : a.CounterPartStartTime)
                                                    //.ThenBy(a => a.LeaveStartDate == null ? DateTime.MinValue : a.LeaveStartDate)
                                                    //.ToList();



                                                    //   //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                    //   employee = emp
                                                    //   .Where(a => a.SiteName == plantdata.Key
                                                    //               && a.EmployeeCode == emp.Key
                                                    //               && (
                                                    //                   (a.AttendanceStartDate == null && a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date)
                                                    //                   || (a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                    //                   || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                    //               )
                                                    //               && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date
                                                    //               && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate.HasValue && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))
                                                    //           )
                                                    //   .FirstOrDefault();


                                                    var employeelist = emp.Where(a => a.SiteName == plantdata.Key
                                                                                                               && a.EmployeeCode == emp.Key
                                                                                                               && (
                                                                                                                   (
                                                                                                                       a.IsNightShift == 1
                                                                                                                       ? (a.AttendanceStartDate == null
                                                                                                                           ? a.CounterpartStartDate.HasValue && (a.CounterpartStartDate >= MinAtt_Date && a.CounterpartStartDate <= MaxAtt_Date)
                                                                                                                           : (a.AttendanceStartDate >= MinAtt_Date && a.AttendanceStartDate <= MaxAtt_Date))
                                                                                                                       : (a.AttendanceStartDate == null
                                                                                                                           ? a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                                                                                           : a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                                                                                   )
                                                                                                                   || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                                                                               )
                                                                                                               && a.JobDescriptionStartDate.HasValue
                                                                                                               && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date
                                                                                                               && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate.HasValue && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))
                                                                                                   )
                                                                                                   .OrderBy(a => a.CounterPartStartTime == null ? TimeSpan.MaxValue : a.CounterPartStartTime)
                                                                                                   .ThenBy(a => a.LeaveStartDate == null ? DateTime.MinValue : a.LeaveStartDate)
                                                                                                   .ToList();

                                                    //employee = emp
                                                    //.Where(a => a.SiteName == plantdata.Key
                                                    //            && a.EmployeeCode == emp.Key
                                                    //            && (
                                                    //                (a.AttendanceStartDate == null && a.CounterpartStartDate.HasValue &&( a.CounterpartStartDate >=MinAtt_Date  && a.CounterpartStartDate <= MaxAtt_Date))
                                                    //                || (a.AttendanceStartDate.HasValue && (a.AttendanceStartDate >= MinAtt_Date && a.AttendanceStartDate <= MaxAtt_Date))
                                                    //                || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && ( a.LeaveStartDate.Value.Date >= MinAtt_Date && a.LeaveStartDate.Value.Date  <= MaxAtt_Date))
                                                    //            )
                                                    //            && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date
                                                    //            && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate.HasValue && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))
                                                    //        )
                                                    //.FirstOrDefault();
                                                    employee = emp
                                               .Where(a => a.SiteName == plantdata.Key
                                                                                                               && a.EmployeeCode == emp.Key
                                                                                                               && (
                                                                                                                   (
                                                                                                                       a.IsNightShift == 1
                                                                                                                       ? (a.AttendanceStartDate == null
                                                                                                                           ? a.CounterpartStartDate.HasValue && (a.CounterpartStartDate >= MinAtt_Date && a.CounterpartStartDate <= MaxAtt_Date)
                                                                                                                           : (a.AttendanceStartDate >= MinAtt_Date && a.AttendanceStartDate <= MaxAtt_Date))
                                                                                                                       : (a.AttendanceStartDate == null
                                                                                                                           ? a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                                                                                           : a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                                                                                   )
                                                                                                                   || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                                                                               )
                                                                                                               && a.JobDescriptionStartDate.HasValue
                                                                                                               && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date
                                                                                                               && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate.HasValue && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))
                                                                                                   )
                                               .FirstOrDefault();
                                                    #endregion
                                                    #endregion
                                                    //var employeelist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date) && a.CounterpartStartDate.Value.Date == StartDate.Date).OrderBy(a => a.CounterPartStartTime).ToList();
                                                    //employee = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key  && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).FirstOrDefault();
                                                    if (employee != null)
                                                    {
                                                        #region [GEOS2-6738][gulab lakade][01 02 2025]
                                                        List<string> Emp_Stage = new List<string>();
                                                        Emp_Stage = employeelist.GroupBy(a => a.StageCode).Select(b => b.Key).ToList();
                                                        Emp_Stage.AddRange(employeelist.GroupBy(a => a.NonOT_Code).Select(b => b.Key).ToList());
                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        #endregion
                                                        DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();//[GEOS2-5394][gulab lakade][19 02 2024]
                                                        #region [pallavi jadhav] [16 01 2024] [GEOS2-5235]
                                                        double ShiftStartTime = 0;
                                                        double ShiftEndTime = 0;
                                                        double BreackTimeIndouble = 0;
                                                        if (employee.ShiftStartTime == TimeSpan.Zero && employee.ShiftEndTime == TimeSpan.Zero)
                                                        {
                                                            DateTime StartDate = Convert.ToDateTime(itemDate.Key.Date);
                                                            string WeeklyOffday = Convert.ToString(itemDate.Key.Date.DayOfWeek);
                                                            if (WeeklyOffday == "Saturday")
                                                            {
                                                                StartDate = itemDate.Key.Date.AddDays(-1);
                                                            }
                                                            else
                                                                if (WeeklyOffday == "Sunday")
                                                            {
                                                                StartDate = itemDate.Key.Date.AddDays(-2);
                                                            }
                                                            //var EMPDate = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.AttendanceStartDate.Value.DayOfWeek == StartDate.DayOfWeek && a.ShiftStartTime != null && a.ShiftStartTime != TimeSpan.Zero).FirstOrDefault();
                                                            //var EMPDate = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.CounterpartStartDate.Value.DayOfWeek == StartDate.DayOfWeek && a.ShiftStartTime != null && a.ShiftStartTime != TimeSpan.Zero).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                            #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                            //var EMPDate = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.DayOfWeek == StartDate.DayOfWeek : a.AttendanceStartDate.Value.DayOfWeek == StartDate.DayOfWeek) && a.ShiftStartTime != null && a.ShiftStartTime != TimeSpan.Zero).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                            //var EMPDate = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.DayOfWeek == StartDate.DayOfWeek : a.AttendanceStartDate.Value.DayOfWeek == StartDate.DayOfWeek) && a.ShiftStartTime != null && a.ShiftStartTime != TimeSpan.Zero).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                            //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            var EMPDate = emp
                                                                .Where(a => a.SiteName == plantdata.Key
                                                                            && a.EmployeeCode == emp.Key
                                                                            && (
                                                                                // If AttendanceStartDate is null, check CounterpartStartDate's DayOfWeek; otherwise, check AttendanceStartDate's DayOfWeek
                                                                                (
                                                                                    a.AttendanceStartDate == null
                                                                                    ? (a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.DayOfWeek == StartDate.DayOfWeek)
                                                                                    : a.AttendanceStartDate.Value.DayOfWeek == StartDate.DayOfWeek
                                                                                )
                                                                                // Ensure ShiftStartTime is not null or zero
                                                                                && a.ShiftStartTime != null
                                                                                && a.ShiftStartTime != TimeSpan.Zero
                                                                            )
                                                                            ||
                                                                            // If both AttendanceStartDate and CounterpartStartDate are null, check LeaveStartDate
                                                                            (a.AttendanceStartDate == null
                                                                             && a.CounterpartStartDate == null
                                                                             && a.LeaveStartDate.HasValue
                                                                             && a.LeaveStartDate.Value.DayOfWeek == StartDate.DayOfWeek)
                                                                )
                                                                .FirstOrDefault();


                                                            #endregion
                                                            if (EMPDate == null)
                                                            {
                                                                StartDate = StartDate.Date.AddDays(-1);
                                                                //var EMPRecord = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.CounterpartStartDate.Value.DayOfWeek == StartDate.DayOfWeek && a.ShiftStartTime != null && a.ShiftStartTime != TimeSpan.Zero).FirstOrDefault();

                                                                #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                                //var EMPRecord = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.DayOfWeek == StartDate.DayOfWeek : a.AttendanceStartDate.Value.DayOfWeek == StartDate.DayOfWeek) && a.ShiftStartTime != null && a.ShiftStartTime != TimeSpan.Zero).FirstOrDefault();
                                                                //var EMPRecord = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.DayOfWeek == StartDate.DayOfWeek : a.AttendanceStartDate.Value.DayOfWeek == StartDate.DayOfWeek) && a.ShiftStartTime != null && a.ShiftStartTime != TimeSpan.Zero).FirstOrDefault();

                                                                //[rani dhamankar] [12 - 03 - 2025][GEOS2 - 6965]
                                                                var EMPRecord = emp
                                                               .Where(a => a.SiteName == plantdata.Key
                                                                           && a.EmployeeCode == emp.Key
                                                                           && (
                                                                               // If AttendanceStartDate is null, check CounterpartStartDate's DayOfWeek; otherwise, check AttendanceStartDate's DayOfWeek
                                                                               (
                                                                                   a.AttendanceStartDate == null
                                                                                   ? (a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.DayOfWeek == StartDate.DayOfWeek)
                                                                                   : a.AttendanceStartDate.Value.DayOfWeek == StartDate.DayOfWeek
                                                                               )
                                                                               // Ensure ShiftStartTime is not null or zero
                                                                               && a.ShiftStartTime != null
                                                                               && a.ShiftStartTime != TimeSpan.Zero
                                                                           )
                                                                           ||
                                                                           // If both AttendanceStartDate and CounterpartStartDate are null, check LeaveStartDate
                                                                           (
                                                                               a.AttendanceStartDate == null
                                                                               && a.CounterpartStartDate == null
                                                                               && a.ISHolidayEvent == false
                                                                               && a.LeaveStartDate.HasValue
                                                                               && a.LeaveStartDate.Value.DayOfWeek == StartDate.DayOfWeek

                                                                           )
                                                               )
                                                               .FirstOrDefault();


                                                                #endregion

                                                                if (EMPRecord != null)
                                                                {
                                                                    if (EMPRecord.ShiftStartTime == TimeSpan.Zero && EMPRecord.ShiftEndTime == TimeSpan.Zero)
                                                                    {
                                                                        ShiftStartTime = Math.Round((Convert.ToDouble((EMPRecord.ShiftStartTime).TotalMinutes) / 60), 4);
                                                                        ShiftEndTime = Math.Round((Convert.ToDouble((EMPRecord.ShiftEndTime).TotalMinutes) / 60), 4);
                                                                        BreackTimeIndouble = Math.Round((Convert.ToDouble((employee.BreakTime).TotalMinutes) / 60), 4);


                                                                    }

                                                                }
                                                            }
                                                            else if (EMPDate.ShiftStartTime == TimeSpan.Zero && EMPDate.ShiftEndTime == TimeSpan.Zero)
                                                            {
                                                                ShiftStartTime = Math.Round((Convert.ToDouble((EMPDate.ShiftStartTime).TotalMinutes) / 60), 4);
                                                                ShiftEndTime = Math.Round((Convert.ToDouble((EMPDate.ShiftEndTime).TotalMinutes) / 60), 4);
                                                                BreackTimeIndouble = Math.Round((Convert.ToDouble((employee.BreakTime).TotalMinutes) / 60), 4);
                                                            }

                                                            else
                                                            {
                                                                ShiftStartTime = Math.Round((Convert.ToDouble((EMPDate.ShiftStartTime).TotalMinutes) / 60), 4);

                                                                ShiftEndTime = Math.Round((Convert.ToDouble((EMPDate.ShiftEndTime).TotalMinutes) / 60), 4);
                                                                BreackTimeIndouble = Math.Round((Convert.ToDouble((employee.BreakTime).TotalMinutes) / 60), 4);
                                                            }

                                                        }
                                                        else
                                                        {

                                                            ShiftStartTime = Math.Round((Convert.ToDouble((employee.ShiftStartTime).TotalMinutes) / 60), 4);

                                                            ShiftEndTime = Math.Round((Convert.ToDouble((employee.ShiftEndTime).TotalMinutes) / 60), 4);
                                                            BreackTimeIndouble = Math.Round((Convert.ToDouble((employee.BreakTime).TotalMinutes) / 60), 4);
                                                        }
                                                        #endregion
                                                        //start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        double TotalShiftTime = 0;
                                                        if (employee.IsNightShift == 1)
                                                        {
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                TimeSpan tmpdiff_shift = shiftEndDate.Value.TimeOfDay - shiftStartDate.Value.TimeOfDay;
                                                                TotalShiftTime = tmpdiff_shift.TotalHours;
                                                                TotalHours_Night = tmpdiff_shift.TotalMinutes;
                                                            }
                                                            else
                                                            {
                                                                //[GEOS2-7755][gulab lakade][22 04 2025]
                                                                //TotalHours_24 = (Hours_24 - employee.ShiftStartTime).TotalHours;
                                                                //TotalHours_0 = (employee.ShiftEndTime - Hours_0).TotalHours;
                                                                //TotalHours_0 = TotalHours_0 + 1;//[GEOS2-6771][gulab lakade][04 20 2025]
                                                                //TotalHours_Night = TotalHours_24 + TotalHours_0;
                                                                //TimeSpan totalHoursInTimespan = (Hours_24 - employee.ShiftStartTime) + (employee.ShiftEndTime - Hours_0);
                                                                //TotalShiftTime = Math.Round((Convert.ToDouble((totalHoursInTimespan).TotalMinutes) / 60), 4);
                                                                TotalHours_24 = (Hours_24 - shiftStartDate.Value.TimeOfDay).TotalHours;
                                                                TotalHours_0 = (shiftEndDate.Value.TimeOfDay - Hours_0).TotalHours;
                                                                TotalHours_0 = TotalHours_0 + 1;//[GEOS2-6771][gulab lakade][04 20 2025]
                                                                TotalHours_Night = TotalHours_24 + TotalHours_0;
                                                                TimeSpan totalHoursInTimespan = (Hours_24 - shiftStartDate.Value.TimeOfDay) + (shiftEndDate.Value.TimeOfDay - Hours_0);
                                                                TotalShiftTime = Math.Round((Convert.ToDouble((totalHoursInTimespan).TotalMinutes) / 60), 4);
                                                                //[GEOS2-7755][gulab lakade][22 04 2025]
                                                            }
                                                            #endregion

                                                        }
                                                        else
                                                        {
                                                            TotalShiftTime = ShiftEndTime - ShiftStartTime;
                                                        }
                                                        //end[GEOS2-5515][gulab lakade][28 03 2024]

                                                        // double BreackTimeIndouble = Math.Round((Convert.ToDouble((employee.BreakTime).TotalMinutes) / 60), 4);


                                                        double TotalShiftInDouble = TotalShiftTime - BreackTimeIndouble;
                                                        #region Attendance
                                                        double MaxEndLeaveTimeInDouuble = 0;
                                                        double AttendanceStartTimeDecimal = 0;
                                                        double AttenadnceEndTimeDecimal = 0;
                                                        TimeSpan AttendanceStartTime = new TimeSpan();
                                                        TimeSpan AttenadnceEndTime = new TimeSpan();
                                                        TimeSpan MaxEndLeaveTime = new TimeSpan();
                                                        string Week = string.Empty;
                                                        try
                                                        {



                                                            if (employeelist.Where(a => a.AttendanceStartDate != null).ToList().Count() > 0)
                                                            {
                                                                var tempStartAttendence = employeelist.OrderBy(a => a.AttendanceStartDate.Value.TimeOfDay).FirstOrDefault();
                                                                Week = tempStartAttendence.AttendanceWeek;
                                                                AttendanceStartTime = tempStartAttendence.AttendanceStartDate.Value.TimeOfDay;

                                                                //TimeSpan AttendanceStartTime = employee.AttendanceStartDate.Value.TimeOfDay;
                                                                //TimeSpan AttendanceStartTime = employee.AttendanceStartDate.Value.TimeOfDay;
                                                                AttendanceStartTimeDecimal = AttendanceStartTime.TotalHours;

                                                                var tempEndAttendence = employeelist.OrderByDescending(a => a.AttendanceEndDate.Value.TimeOfDay).FirstOrDefault();

                                                                AttenadnceEndTime = tempEndAttendence.AttendanceEndDate.Value.TimeOfDay;
                                                                //TimeSpan AttenadnceEndTime = employee.AttendanceEndDate.Value.TimeOfDay;
                                                                AttenadnceEndTimeDecimal = AttenadnceEndTime.TotalHours;
                                                                MaxEndLeaveTime = employeelist.OrderByDescending(a => a.LeaveEndTime).FirstOrDefault().LeaveEndTime;
                                                                MaxEndLeaveTimeInDouuble = MaxEndLeaveTime.TotalHours;
                                                            }
                                                            double TotalAttendanceHours = 0;// AttenadnceEndTimeDecimal - AttendanceStartTimeDecimal;
                                                                                            //double BreakTime = Math.Round((Convert.ToDouble((employee.BreakTime).TotalMinutes) / 60), 4);

                                                            //double BreakStartTime = Math.Round((Convert.ToDouble((employee.BreakStartTime).TotalMinutes)));

                                                            //double BreakEndTime = Math.Round((Convert.ToDouble((employee.BreakEndTime).TotalMinutes)));
                                                            //double TempBreakTime = BreakEndTime - BreakStartTime;

                                                            //double TempTotalShiftTime = ShiftEndTime - ShiftStartTime;
                                                            //double TotalWithoutBreak = Math.Round((((TempTotalShiftTime * 60) - TempBreakTime) / 60), 4);

                                                            #region [rani dhamankar][12-03-2025][GEOS2-6965]
                                                            if (employeelist.Where(a => a.LeaveStartDate != null && a.LeavesAllDayEvent == 1 && a.ISHolidayEvent == false).ToList().Count() > 0)
                                                            {
                                                                var tempStartAttendence = employeelist.Where(a => a.LeaveStartDate != null && a.LeavesAllDayEvent == 1 && a.ISHolidayEvent == false).OrderBy(a => a.LeaveStartDate.Value.TimeOfDay).FirstOrDefault();
                                                                Week = tempStartAttendence.AttendanceWeek;
                                                                AttendanceStartTime = tempStartAttendence.ShiftStartTime;
                                                                AttendanceStartTimeDecimal = AttendanceStartTime.TotalHours;

                                                                //var tempEndAttendence = employeelist.OrderByDescending(a => a.LeaveEndDate.Value.TimeOfDay).FirstOrDefault();

                                                                AttenadnceEndTime = tempStartAttendence.LeaveEndDate.Value.TimeOfDay;
                                                                //TimeSpan AttenadnceEndTime = employee.AttendanceEndDate.Value.TimeOfDay;
                                                                AttenadnceEndTimeDecimal = AttenadnceEndTime.TotalHours;
                                                                MaxEndLeaveTime = tempStartAttendence.ShiftEndTime;
                                                                MaxEndLeaveTimeInDouuble = MaxEndLeaveTime.TotalHours;
                                                            }
                                                            #endregion


                                                        }
                                                        catch (Exception ex)
                                                        {

                                                        }
                                                        TimeSpan TotalLoggedTime = new TimeSpan();
                                                        double TotalAttendanceWithoutLeave = 0;
                                                        #endregion

                                                        #region Logged
                                                        //TimeSpan loggedStartTime = employee.CounterpartStartDate.Value.TimeOfDay;
                                                        ////double LoggedStartTimeDecimal = loggedStartTime.TotalHours;
                                                        //double LoggedStartTimeDecimal = Math.Round(loggedStartTime.TotalHours, 2);

                                                        //TimeSpan LoggedEndTime = employee.CounterpartEndDate.Value.TimeOfDay;
                                                        //// double LoggedEndTimeDecimal = LoggedEndTime.TotalHours;
                                                        //double LoggedEndTimeDecimal = Math.Round(LoggedEndTime.TotalHours, 2);
                                                        Week = employee.AttendanceWeek;
                                                        #endregion


                                                        TextBox empName = new TextBox();

                                                        empName.Text = employee.EmployeeName;
                                                        empName.Width = 140;
                                                        empName.TextWrapping = TextWrapping.Wrap;
                                                        empName.TextAlignment = TextAlignment.Center;
                                                        empName.IsReadOnly = true;
                                                        empName.BorderBrush = new SolidColorBrush(Colors.Transparent);
                                                        var employeeImageKey = employee.EmployeeCode;
                                                        Image EmployeeImage = new Image();
                                                        BitmapImage bitmapImage = new BitmapImage();

                                                        #region [GEOS2-6693][rani dhamankar][28-02-2025]
                                                        if (!ERMCommon.Instance.ImagesDictionary.ContainsKey(employeeImageKey))
                                                        {
                                                            try
                                                            {
                                                                // Construct the URL for the rounded employee image
                                                                string tempEMPImageUrl = $"https://api.emdep.com/GEOS/Images.aspx?FilePath=/Images/Employees/Rounded/{employee.EmployeeCode}.png";

                                                                // Use the delegate to convert the image URL to a byte array
                                                                byte[] imageBytes = ImageUrlToByteArrayUsingDelegate(tempEMPImageUrl);
                                                                if (imageBytes.Length > 0)
                                                                {
                                                                    // Create the BitmapImage from the byte array
                                                                    using (MemoryStream ms = new MemoryStream(imageBytes))
                                                                    {
                                                                        bitmapImage.BeginInit();
                                                                        bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                                                                        bitmapImage.StreamSource = ms;
                                                                        bitmapImage.EndInit();
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    // Fallback image URL if the original image is empty
                                                                    string fallbackImageUrl = $"https://api.emdep.com/GEOS/Images.aspx?FilePath=/Images/Employees/{employee.EmployeeCode}.png";
                                                                    imageBytes = ImageUrlToByteArrayUsingDelegate(fallbackImageUrl);

                                                                    using (MemoryStream ms = new MemoryStream(imageBytes))
                                                                    {
                                                                        bitmapImage.BeginInit();
                                                                        bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                                                                        bitmapImage.StreamSource = ms;
                                                                        bitmapImage.EndInit();
                                                                    }
                                                                }

                                                                // Store the loaded image in the memory cache (ImagesDictionary) for future use
                                                                ERMCommon.Instance.ImagesDictionary.Add(employee.EmployeeCode, bitmapImage);
                                                            }
                                                            catch (Exception ex)
                                                            {
                                                                // Handle any exceptions that may occur during image loading
                                                                Console.WriteLine($"Error loading image: {ex.Message}");
                                                            }
                                                        }
                                                        else
                                                        {
                                                            // If the image exists in memory, retrieve it from the dictionary
                                                            bitmapImage = ERMCommon.Instance.ImagesDictionary[employee.EmployeeCode];
                                                        }
                                                        #endregion

                                                        #endregion
                                                        var images = ERMCommon.Instance.ImagesDictionary.Where(a => a.Key == employee.EmployeeCode).FirstOrDefault();
                                                        EmployeeImage.Source = images.Value;
                                                        EmployeeImage.Width = 100;
                                                        EmployeeImage.Height = 100;
                                                        #region Image and EMP Name
                                                        Grid ImageGrid = new Grid();
                                                        //Image and EMP Name column creation
                                                        //ImageGrid.ShowGridLines = true;
                                                        #region ColumnDefinition
                                                        for (var Imagecolumn = 0; Imagecolumn < 1; Imagecolumn++)
                                                        {
                                                            var c = new ColumnDefinition();
                                                            c.Width = GridLength.Auto;

                                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                            ImageGrid.ColumnDefinitions.Add(c);
                                                        }

                                                        #endregion
                                                        //Image and EMP Name row creation
                                                        #region RowDefinition 
                                                        for (var Imagerow = 0; Imagerow < 2; Imagerow++)
                                                        {
                                                            var r = new RowDefinition();
                                                            if (Imagerow == 0)
                                                            {
                                                                r.Height = new GridLength(120, GridUnitType.Pixel);
                                                            }
                                                            else
                                                            {
                                                                //r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                                r.Height = new GridLength(47, GridUnitType.Pixel);
                                                            }

                                                            ImageGrid.RowDefinitions.Add(r);


                                                        }
                                                        //ImageGrid.ShowGridLines = true;
                                                        ImageGrid.Width = 180;
                                                        //ImageGrid.Height = 120;
                                                        #endregion
                                                        //Border Imageborder = new Border()
                                                        //{
                                                        //    BorderThickness = new Thickness()
                                                        //    {
                                                        //        Bottom = 1,
                                                        //        Left = 1,
                                                        //        Right = 1,
                                                        //        Top = 1
                                                        //    },
                                                        //    BorderBrush = new SolidColorBrush(Colors.Black)
                                                        //};
                                                        //Grid.SetRow(Imageborder, 0);
                                                        //Grid.SetColumn(Imageborder, 0);

                                                        Grid.SetRow(EmployeeImage, 0);
                                                        Grid.SetColumn(EmployeeImage, 0);
                                                        Grid.SetRow(empName, 1);
                                                        Grid.SetColumn(empName, 0);
                                                        // ImageGrid.Children.Add(Imageborder);
                                                        ImageGrid.Children.Add(EmployeeImage);
                                                        ImageGrid.Children.Add(empName);



                                                        #endregion

                                                        #region Aishwarya [Geos2-5853]


                                                        var downloadTransferredTimes = ProductionTimeList.Where(x => x.PauseType == "Download" || x.PauseType == "Transferred" && x.SiteName == employee.SiteName && x.EmployeeCode == employee.EmployeeCode && x.StageCode == employee.StageCode).FirstOrDefault(); //&& (x.BreakStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.BreakStartDate .Value.Date == StartDate.Date)
                                                        TimeSpan totalDuration = TimeSpan.Zero;
                                                        if (downloadTransferredTimes != null)
                                                        {

                                                            TimeSpan duration = downloadTransferredTimes.CounterPartEndTime - downloadTransferredTimes.CounterPartStartTime;
                                                            totalDuration += duration;

                                                        }

                                                        #endregion


                                                        //EmployeeProfile.Source
                                                        #region Pallavi
                                                        LinearGaugeControl linearGauge = new LinearGaugeControl();
                                                        // linearGauge.bu = true;
                                                        LinearGaugeControl linearGauge_night = new LinearGaugeControl();
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        //if (employee.IsNightShift == 1 && shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        //{
                                                        //    linearGauge.MouseMove += LinearGauge_MouseMove;
                                                        //}
                                                        //else
                                                        //{
                                                        linearGauge.MouseMove += LinearGauge_MouseMove;
                                                        linearGauge_night.MouseMove += linearGauge_night_MouseMove;
                                                        // }

                                                        #endregion
                                                        //try
                                                        //{


                                                        //Int32 DayDate = (Int32)employee.AttendanceStartDate.Value.DayOfWeek;
                                                        //Int32 month = (Int32)employee.AttendanceStartDate.Value.Month;
                                                        //Int32 DayDate = (Int32)employee.CounterpartStartDate.Value.DayOfWeek;
                                                        //Int32 month = (Int32)employee.CounterpartStartDate.Value.Month;
                                                        //Int32 DayDate = (Int32)(employee.AttendanceStartDate == null ? employee.CounterpartStartDate.Value.DayOfWeek : employee.AttendanceStartDate.Value.DayOfWeek);
                                                        //Int32 month = (Int32)(employee.AttendanceStartDate == null ? employee.CounterpartStartDate.Value.Month : employee.AttendanceStartDate.Value.Month);

                                                        // Determine DayOfWeek, using LeaveStartDate if AttendanceStartDate and CounterpartStartDate are both null
                                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                        Int32 DayDate = (Int32)(
                                                            employee.AttendanceStartDate == null && employee.CounterpartStartDate == null && employee.ISHolidayEvent == false && employee.LeaveStartDate.HasValue
                                                            ? employee.LeaveStartDate.Value.DayOfWeek
                                                            : (employee.AttendanceStartDate == null ? employee.CounterpartStartDate.Value.DayOfWeek : employee.AttendanceStartDate.Value.DayOfWeek)
                                                        );

                                                        // Determine Month, using LeaveStartDate if AttendanceStartDate and CounterpartStartDate are both null
                                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                        Int32 month = (Int32)(
                                                            employee.AttendanceStartDate == null && employee.CounterpartStartDate == null && employee.ISHolidayEvent == false && employee.LeaveStartDate.HasValue
                                                            ? employee.LeaveStartDate.Value.Month
                                                            : (employee.AttendanceStartDate == null ? employee.CounterpartStartDate.Value.Month : employee.AttendanceStartDate.Value.Month)
                                                        );

                                                        linearGauge.Name = "D" + Convert.ToString(employee.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(employee.IdStage);
                                                        linearGauge_night.Name = "D" + Convert.ToString(employee.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(employee.IdStage);
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        //if (employee.IsNightShift == 1 && shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        //{
                                                        //    linearGauge.Name = "D" + Convert.ToString(employee.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(employee.IdStage);
                                                        //}
                                                        //else
                                                        //{
                                                        //    linearGauge.Name = "D" + Convert.ToString(employee.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(employee.IdStage);
                                                        //    linearGauge_night.Name = "D" + Convert.ToString(employee.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(employee.IdStage);
                                                        //}

                                                        #endregion
                                                        //}
                                                        //catch (Exception ex)
                                                        //{

                                                        //}
                                                        //+ "_" + Convert.ToString(employee.IdStage) ;
                                                        //linearGauge.Width = 1300;

                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        //linearGauge.Width = 1370;
                                                        //linearGauge.Height = 100;
                                                        if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                        {

                                                            int HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                linearGauge.Width = 1370;
                                                                //linearGauge_night.Width = (int)(HoursByTotalHours_night);
                                                            }
                                                            else
                                                            #endregion
                                                            if (TotalHours_24 > TotalHours_0)
                                                            {
                                                                #region [GEOS2-6662][gulab lakade][18 12 2024]
                                                                if (TotalHours_0 == 0)
                                                                {
                                                                    //[GEOS2-7755][gulab lakade][20 04 2025]
                                                                    TotalHours_0 = 2;
                                                                    TotalHours_Night = TotalHours_Night + 2;
                                                                    HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                                    int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                                    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue + 32;
                                                                    //[GEOS2-7755][gulab lakade][20 04 2025]
                                                                }
                                                                else
                                                                {
                                                                    int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                                    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue + 32;
                                                                }

                                                                //int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                //linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                                //linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue + 25;
                                                                #endregion
                                                            }

                                                            else
                                                               if (TotalHours_24 < TotalHours_0)
                                                            {
                                                                int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue + 32;
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                            }


                                                            //linearGauge.Width = 1060;
                                                            linearGauge.Height = 100;


                                                            linearGauge_night.Height = 100;
                                                        }
                                                        else
                                                        if ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date)
                                                        {
                                                            int StarttimeHours = (int)employee.AttendanceStartDate.Value.Hour;
                                                            int EndTimeHours = (int)employee.AttendanceEndDate.Value.Hour;
                                                            int EndTimeMinute = (int)employee.AttendanceEndDate.Value.Minute;
                                                            TotalHours_24 = (24 - StarttimeHours);
                                                            if (EndTimeMinute > 0)
                                                            {
                                                                TotalHours_0 = EndTimeHours + 1;
                                                            }
                                                            else
                                                            {
                                                                TotalHours_0 = EndTimeHours;
                                                            }
                                                            int TempTotalhours = (int)TotalHours_24 + (int)TotalHours_0;
                                                            TotalHours_Night = TempTotalhours;
                                                            int HoursByTotalHours_night = (int)(1430 / (TempTotalhours));
                                                            if (TotalHours_24 > TotalHours_0)
                                                            {
                                                                int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * (TotalHours_0 - 0)));
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue + 20;
                                                            }
                                                            else
                                                            {
                                                                int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * (TotalHours_0 - 0)));
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue + 20;
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                            }


                                                            //linearGauge.Width = 1060;
                                                            linearGauge.Height = 100;


                                                            linearGauge_night.Height = 100;
                                                        }
                                                        else if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent == 1)//[GEOS2-8189][rani dhamankar][03-06-2025]
                                                        {
                                                            int HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                linearGauge.Width = 1370;
                                                                //linearGauge_night.Width = (int)(HoursByTotalHours_night);
                                                            }
                                                            else
                                                            if (TotalHours_24 > TotalHours_0)
                                                            {

                                                                if (TotalHours_0 == 0)
                                                                {

                                                                    TotalHours_0 = 2;
                                                                    TotalHours_Night = TotalHours_Night + 2;
                                                                    HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                                    int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                                    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue + 32;

                                                                }
                                                                else
                                                                {
                                                                    int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                                    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue + 32;
                                                                }

                                                            }

                                                            else
                                                               if (TotalHours_24 < TotalHours_0)
                                                            {
                                                                int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue + 32;
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                            }


                                                            linearGauge.Height = 100;
                                                            linearGauge_night.Height = 100;



                                                        }
                                                        else
                                                        {
                                                            linearGauge.Width = 1370;
                                                            linearGauge.Height = 100;
                                                            linearGauge_night.Width = 0;
                                                            linearGauge_night.Height = 100;
                                                        }
                                                        #endregion



                                                        DefaultScaleLabelControl label;
                                                        // // Create a LinearScale
                                                        LinearScale linearScale = new LinearScale();
                                                        LinearScale linearnightScale = new LinearScale();
                                                        linearScale.LayoutMode = 0;
                                                        linearScale.Markers.Clear();
                                                        linearScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                        linearScale.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                        linearnightScale.LayoutMode = 0;
                                                        linearnightScale.Markers.Clear();
                                                        linearnightScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                        linearnightScale.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));

                                                        linearnightScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                        if (ApplicationThemeHelper.ApplicationThemeName.ToString() == "BlackAndBlue")
                                                        {
                                                            label = new DefaultScaleLabelControl()
                                                            {
                                                                Foreground = new SolidColorBrush(Colors.White)
                                                            };



                                                            var foregroundProperty = label.GetType().GetProperty("Foreground");
                                                            if (foregroundProperty != null)
                                                            {
                                                                foregroundProperty.SetValue(label, new SolidColorBrush(Colors.White));
                                                            }

                                                            linearScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")) };
                                                            linearScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                            {
                                                                MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")),
                                                                MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"))

                                                            };

                                                            linearnightScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")) };
                                                            linearnightScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                            {
                                                                MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")),
                                                                MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"))

                                                            };


                                                            #region RND
                                                            CustomScaleLabelPresentation customScaleLabelPresentation = new CustomScaleLabelPresentation();

                                                            ControlTemplate labelTemplate = new ControlTemplate();

                                                            FrameworkElementFactory textBlockFactory = new FrameworkElementFactory(typeof(TextBlock));
                                                            textBlockFactory.SetBinding(TextBlock.TextProperty, new Binding("Text"));
                                                            textBlockFactory.SetValue(TextBlock.ForegroundProperty, new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")));
                                                            textBlockFactory.SetValue(TextBlock.MarginProperty, new Thickness(-1, -10, 0, 0)); // Adjust the values as needed

                                                            labelTemplate.VisualTree = textBlockFactory;

                                                            // Set the LabelTemplate for CustomScaleLabelPresentation
                                                            customScaleLabelPresentation.LabelTemplate = labelTemplate;

                                                            // Set CustomScaleLabelPresentation for LinearScale.LabelPresentation
                                                            linearScale.LabelPresentation = customScaleLabelPresentation;
                                                            linearnightScale.LabelPresentation = customScaleLabelPresentation;
                                                            #endregion
                                                        }
                                                        else
                                                        {

                                                            label = new DefaultScaleLabelControl()
                                                            {
                                                                Foreground = new SolidColorBrush(Colors.Black)
                                                            };

                                                            var foregroundProperty = label.GetType().GetProperty("Foreground");
                                                            if (foregroundProperty != null)
                                                            {
                                                                foregroundProperty.SetValue(label, new SolidColorBrush(Colors.Black));
                                                            }
                                                            linearScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")) };
                                                            linearScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                            {
                                                                MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")),
                                                                MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000"))
                                                            };

                                                            linearnightScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")) };
                                                            linearnightScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                            {
                                                                MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")),
                                                                MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000"))
                                                            };
                                                            #region REND
                                                            CustomScaleLabelPresentation customScaleLabelPresentation = new CustomScaleLabelPresentation();

                                                            ControlTemplate labelTemplate = new ControlTemplate();

                                                            FrameworkElementFactory textBlockFactory = new FrameworkElementFactory(typeof(TextBlock));
                                                            textBlockFactory.SetBinding(TextBlock.TextProperty, new Binding("Text"));
                                                            textBlockFactory.SetValue(TextBlock.ForegroundProperty, new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")));
                                                            textBlockFactory.SetValue(TextBlock.MarginProperty, new Thickness(-1, -10, 0, 0));

                                                            labelTemplate.VisualTree = textBlockFactory;

                                                            // Set the LabelTemplate for CustomScaleLabelPresentation
                                                            customScaleLabelPresentation.LabelTemplate = labelTemplate;

                                                            // Set CustomScaleLabelPresentation for LinearScale.LabelPresentation
                                                            linearScale.LabelPresentation = customScaleLabelPresentation;
                                                            linearnightScale.LabelPresentation = customScaleLabelPresentation;


                                                            #endregion
                                                        }
                                                        double BarStartValue = 0;
                                                        double BarEndValue = 0;
                                                        if ((employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date)) && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][03-06-2025]
                                                        {
                                                            if (AttendanceStartTime < employee.ShiftStartTime)
                                                            {
                                                                //start[gulab lakade] [beta changes][14 03 2024]
                                                                if (AttendanceStartTime == TimeSpan.FromHours(0))
                                                                {
                                                                    int ShiftStartMinute = employee.ShiftStartTime.Minutes;
                                                                    int ShiftStartHours = employee.ShiftStartTime.Hours;
                                                                    if (ShiftStartMinute > 0)
                                                                    {
                                                                        ShiftStartHours = ShiftStartHours;
                                                                    }
                                                                    else
                                                                    {
                                                                        ShiftStartHours = ShiftStartHours;
                                                                    }
                                                                    BarStartValue = ShiftStartHours;// ShiftStartTime;
                                                                }
                                                                else
                                                                {
                                                                    int ShiftStartMinute = AttendanceStartTime.Minutes;
                                                                    int ShiftStartHours = AttendanceStartTime.Hours;
                                                                    if (ShiftStartMinute > 0)
                                                                    {
                                                                        ShiftStartHours = ShiftStartHours;
                                                                    }
                                                                    else
                                                                    {
                                                                        ShiftStartHours = ShiftStartHours;
                                                                    }
                                                                    BarStartValue = ShiftStartHours;// ShiftStartTime;
                                                                }
                                                                //end[gulab lakade] [beta changes][14 03 2024]
                                                                //}

                                                            }
                                                            else
                                                            {
                                                                int ShiftStartMinute = employee.ShiftStartTime.Minutes;
                                                                int ShiftStartHours = employee.ShiftStartTime.Hours;
                                                                if (ShiftStartMinute > 0)
                                                                {
                                                                    ShiftStartHours = ShiftStartHours;
                                                                }
                                                                else
                                                                {
                                                                    ShiftStartHours = ShiftStartHours;
                                                                }
                                                                BarStartValue = ShiftStartHours;// ShiftStartTime;

                                                            }


                                                            if (employee.IsNightShift != 1 && ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                            {
                                                                if (AttenadnceEndTime < employee.ShiftEndTime)
                                                                {
                                                                    int ShiftendMinute = AttenadnceEndTime.Minutes;
                                                                    int ShiftendHours = AttenadnceEndTime.Hours;
                                                                    if (ShiftendMinute > 0)
                                                                    {
                                                                        ShiftendHours = ShiftendHours + 1;
                                                                    }
                                                                    else
                                                                    {
                                                                        ShiftendHours = ShiftendHours;
                                                                    }

                                                                    BarEndValue = ShiftendHours;// ShiftEndTime;
                                                                }
                                                                else
                                                                {
                                                                    int ShiftendMinute = employee.ShiftEndTime.Minutes;
                                                                    int ShiftendHours = employee.ShiftEndTime.Hours;
                                                                    if (ShiftendMinute > 0)
                                                                    {
                                                                        ShiftendHours = ShiftendHours + 1;
                                                                    }
                                                                    else
                                                                    {
                                                                        ShiftendHours = ShiftendHours;
                                                                    }

                                                                    BarEndValue = ShiftendHours;// ShiftEndTime;
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //if (AttenadnceEndTime > employee.ShiftEndTime )//[GEOS2-6662][gulab lakade][18 12 2024]
                                                                if (AttenadnceEndTime > employee.ShiftEndTime && (AttenadnceEndTime < TimeSpan.FromHours(19)))//[GEOS2-6662][gulab lakade][18 12 2024]
                                                                {
                                                                    int ShiftendMinute = AttenadnceEndTime.Minutes;
                                                                    int ShiftendHours = AttenadnceEndTime.Hours;
                                                                    if (ShiftendMinute > 0)
                                                                    {
                                                                        ShiftendHours = ShiftendHours + 1;
                                                                    }
                                                                    else
                                                                    {
                                                                        ShiftendHours = ShiftendHours;
                                                                    }

                                                                    BarEndValue = ShiftendHours;// ShiftEndTime;
                                                                }
                                                                else
                                                                {
                                                                    int ShiftendMinute = employee.ShiftEndTime.Minutes;
                                                                    int ShiftendHours = employee.ShiftEndTime.Hours;
                                                                    if (ShiftendMinute > 0)
                                                                    {
                                                                        ShiftendHours = ShiftendHours + 1;
                                                                    }
                                                                    else
                                                                    {
                                                                        ShiftendHours = ShiftendHours;
                                                                    }

                                                                    BarEndValue = ShiftendHours;// ShiftEndTime;
                                                                }
                                                            }

                                                        }
                                                        #region [rani dhamankar] [12 -03 - 2025][GEOS2 - 6965]
                                                        else if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false && ((employee.LeaveStartDate != null && employee.LeaveEndDate != null)))
                                                        {
                                                            if (employee.IsNightShift == 1)
                                                            {
                                                                if (AttendanceStartTime < employee.ShiftStartTime)
                                                                {
                                                                    //start[gulab lakade] [beta changes][14 03 2024]
                                                                    if (AttendanceStartTime == TimeSpan.FromHours(0))
                                                                    {
                                                                        int ShiftStartMinute = employee.ShiftStartTime.Minutes;
                                                                        int ShiftStartHours = employee.ShiftStartTime.Hours;
                                                                        if (ShiftStartMinute > 0)
                                                                        {
                                                                            ShiftStartHours = ShiftStartHours;
                                                                        }
                                                                        else
                                                                        {
                                                                            ShiftStartHours = ShiftStartHours;
                                                                        }
                                                                        BarStartValue = ShiftStartHours;// ShiftStartTime;
                                                                    }
                                                                    else
                                                                    {
                                                                        int ShiftStartMinute = AttendanceStartTime.Minutes;
                                                                        int ShiftStartHours = AttendanceStartTime.Hours;
                                                                        if (ShiftStartMinute > 0)
                                                                        {
                                                                            ShiftStartHours = ShiftStartHours;
                                                                        }
                                                                        else
                                                                        {
                                                                            ShiftStartHours = ShiftStartHours;
                                                                        }
                                                                        BarStartValue = ShiftStartHours;// ShiftStartTime;
                                                                    }
                                                                    //end[gulab lakade] [beta changes][14 03 2024]
                                                                    //}

                                                                }
                                                                else
                                                                {
                                                                    int ShiftStartMinute = employee.ShiftStartTime.Minutes;
                                                                    int ShiftStartHours = employee.ShiftStartTime.Hours;
                                                                    if (ShiftStartMinute > 0)
                                                                    {
                                                                        ShiftStartHours = ShiftStartHours;
                                                                    }
                                                                    else
                                                                    {
                                                                        ShiftStartHours = ShiftStartHours;
                                                                    }
                                                                    BarStartValue = ShiftStartHours;// ShiftStartTime;

                                                                }
                                                            }
                                                            else
                                                            {
                                                                int ShiftStartMinute = employee.ShiftStartTime.Minutes;
                                                                int ShiftStartHours = employee.ShiftStartTime.Hours;
                                                                if (ShiftStartMinute > 0)
                                                                {
                                                                    ShiftStartHours = ShiftStartHours;
                                                                }
                                                                else
                                                                {
                                                                    ShiftStartHours = ShiftStartHours;
                                                                }
                                                                BarStartValue = ShiftStartHours;
                                                                int ShiftendMinute = employee.ShiftEndTime.Minutes;
                                                                int ShiftendHours = employee.ShiftEndTime.Hours;
                                                                if (ShiftendMinute > 0)
                                                                {
                                                                    ShiftendHours = ShiftendHours + 1;
                                                                }
                                                                else
                                                                {
                                                                    ShiftendHours = ShiftendHours;
                                                                }
                                                                #region [GEOS2-8189][rani dhamankar][03-06-2025]
                                                                TimeSpan duration;

                                                                #endregion
                                                                BarEndValue = ShiftendHours;
                                                            }
                                                        }
                                                        #endregion
                                                        else
                                                        {
                                                            if (AttendanceStartTime < employee.ShiftStartTime)
                                                            {
                                                                //start[gulab lakade] [beta changes][14 03 2024]
                                                                if (AttendanceStartTime == TimeSpan.FromHours(0))
                                                                {
                                                                    BarStartValue = ShiftStartTime;
                                                                }
                                                                else
                                                                {
                                                                    BarStartValue = (int)AttendanceStartTimeDecimal;
                                                                }
                                                                //end[gulab lakade] [beta changes][14 03 2024]
                                                                //}

                                                            }
                                                            else
                                                            {
                                                                BarStartValue = ShiftStartTime;
                                                            }

                                                            if (AttenadnceEndTime > employee.ShiftEndTime)
                                                            {
                                                                if (MaxEndLeaveTime > AttenadnceEndTime)
                                                                {
                                                                    if ((MaxEndLeaveTimeInDouuble % 1) == 0)
                                                                    {
                                                                        BarEndValue = MaxEndLeaveTimeInDouuble;
                                                                    }
                                                                    else
                                                                    {
                                                                        int temp = (int)MaxEndLeaveTimeInDouuble;
                                                                        BarEndValue = temp + 1;// MaxEndLeaveTimeInDouuble;
                                                                    }

                                                                }
                                                                else
                                                                {
                                                                    if ((AttenadnceEndTimeDecimal % 1) == 0)
                                                                    {
                                                                        BarEndValue = AttenadnceEndTimeDecimal;
                                                                    }
                                                                    else
                                                                    {
                                                                        int temp = (int)AttenadnceEndTimeDecimal;
                                                                        BarEndValue = temp + 1;// MaxEndLeaveTimeInDouuble;
                                                                    }

                                                                }
                                                            }
                                                            else if (MaxEndLeaveTime > employee.ShiftEndTime)
                                                            {

                                                                if ((MaxEndLeaveTimeInDouuble % 1) == 0)
                                                                {
                                                                    BarEndValue = MaxEndLeaveTimeInDouuble;
                                                                }
                                                                else
                                                                {
                                                                    int temp = (int)MaxEndLeaveTimeInDouuble;
                                                                    BarEndValue = temp + 1;// MaxEndLeaveTimeInDouuble;
                                                                }
                                                            }
                                                            else
                                                            {
                                                                ////start[gulab lakade] [beta changes][14 03 2024]
                                                                //if (ShiftEndTime == 0.5)
                                                                //{

                                                                //    BarEndValue = 24;
                                                                //}
                                                                //else
                                                                //{
                                                                BarEndValue = ShiftEndTime;
                                                                //}
                                                                //end[gulab lakade] [beta changes][14 03 2024]
                                                            }
                                                        }


                                                        TimeSpan BarStartTime = TimeSpan.FromHours(BarStartValue);
                                                        TimeSpan BarEndTime = TimeSpan.FromHours(BarEndValue);
                                                        //BarStartValue = 22;
                                                        //BarEndValue = 5;
                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        if ((employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date)) && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                        {
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                linearScale.StartValue = BarStartValue; // Start at 10.30 hours
                                                                linearScale.EndValue = BarEndValue; // End at 13.00 hours
                                                                linearScale.MajorIntervalCount = (int)Math.Round((BarEndValue - BarStartValue), 0);
                                                                //  linearScale.MinorIntervalCount = 4;
                                                                //linearnightScale.MinorIntervalCount = 4;

                                                            }
                                                            else
                                                            {

                                                                #endregion
                                                                // double LinearscaleStartTime = (employee.ShiftStartTime).TotalHours;
                                                                linearScale.StartValue = BarStartValue; // Start at 10.30 hours
                                                                linearScale.EndValue = 24; // End at 13.00 hours
                                                                linearnightScale.StartValue = 0;

                                                                //double LinearnightScaleEndTime = (employee.ShiftEndTime).TotalHours;

                                                                //[GEOS2-6662][gulab lakade][18 12 2024]
                                                                if (TotalHours_0 > BarEndValue)
                                                                {
                                                                    //[GEOS2-7755][gulab lakade ][22 04 2025]
                                                                    //TotalHours_0 = shiftEndDate.Value.TimeOfDay.TotalHours;
                                                                    BarEndValue = TotalHours_0;
                                                                }

                                                                double LinearnightScaleEndTime = BarEndValue;
                                                                //end [GEOS2-6662][gulab lakade][18 12 2024]
                                                                var currentculter = CultureInfo.CurrentCulture;
                                                                string DecimalSeparotor = currentculter.NumberFormat.NumberDecimalSeparator;
                                                                if (Convert.ToString(LinearnightScaleEndTime).Contains(DecimalSeparotor))
                                                                {
                                                                    LinearnightScaleEndTime = LinearnightScaleEndTime + 1;
                                                                    linearnightScale.EndValue = Math.Round(LinearnightScaleEndTime, 0);
                                                                }
                                                                else
                                                                {
                                                                    linearnightScale.EndValue = Math.Round(LinearnightScaleEndTime, 0);
                                                                }

                                                                // TotalHours_24=24- BarStartValue;//[GEOS2-6662][gulab lakade][18 12 2024]
                                                                if ((int)Math.Round(TotalHours_24, 0) <= 0)
                                                                {
                                                                    linearScale.MajorIntervalCount = 1;
                                                                }
                                                                else
                                                                {
                                                                    //linearScale.MajorIntervalCount = (int)Math.Round(TotalHours_24, 0);
                                                                    linearScale.MajorIntervalCount = (int)Math.Round((24 - BarStartValue), 0);//[GEOS2-6662][gulab lakade][18 12 2024]
                                                                }

                                                                if ((int)Math.Round(TotalHours_0, 0) <= 0)
                                                                {
                                                                    linearnightScale.MajorIntervalCount = 1;
                                                                }
                                                                else
                                                                {
                                                                    linearnightScale.MajorIntervalCount = (int)Math.Round(TotalHours_0, 0);
                                                                }

                                                                linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                                {
                                                                    ShowFirst = false
                                                                };
                                                                linearScale.LabelOptions = new LinearScaleLabelOptions()
                                                                {

                                                                    Offset = -45


                                                                };
                                                                linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                                {
                                                                    ShowFirst = false,
                                                                    Offset = -45


                                                                };
                                                            }//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        }
                                                        else if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent == 1)//[GEOS2-8189][rani dhamankar][03-06-2025]//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                        {
                                                            linearScale.StartValue = BarStartValue; // Start at 16.00 hours
                                                            linearScale.EndValue = 24; // End at 00.30 hours
                                                            linearnightScale.StartValue = 0;
                                                            if ((int)Math.Round(TotalHours_0, 0) <= 0)//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                            {
                                                                BarEndValue = (int)ShiftEndTime;
                                                                linearScale.EndValue = (int)ShiftEndTime;
                                                            }
                                                            if (TotalHours_0 > BarEndValue)
                                                            {
                                                                BarEndValue = TotalHours_0;
                                                            }

                                                            double LinearnightScaleEndTime = BarEndValue;
                                                            var currentculter = CultureInfo.CurrentCulture;
                                                            string DecimalSeparotor = currentculter.NumberFormat.NumberDecimalSeparator;
                                                            if (Convert.ToString(LinearnightScaleEndTime).Contains(DecimalSeparotor))
                                                            {
                                                                LinearnightScaleEndTime = LinearnightScaleEndTime + 1;
                                                                linearnightScale.EndValue = Math.Round(LinearnightScaleEndTime, 0);
                                                            }
                                                            else
                                                            {
                                                                linearnightScale.EndValue = Math.Round(LinearnightScaleEndTime, 0);
                                                            }

                                                            if ((int)Math.Round(TotalHours_24, 0) <= 0)
                                                            {
                                                                //linearScale.MajorIntervalCount = 1;
                                                                linearScale.MajorIntervalCount = (int)ShiftEndTime - (int)ShiftStartTime;//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                            }
                                                            else
                                                            {
                                                                linearScale.MajorIntervalCount = (int)Math.Round((24 - BarStartValue), 0);
                                                            }

                                                            if ((int)Math.Round(TotalHours_0, 0) <= 0)
                                                            {
                                                                //linearnightScale.MajorIntervalCount = 1;
                                                                linearScale.MajorIntervalCount = (int)ShiftEndTime - (int)ShiftStartTime;//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                            }
                                                            else
                                                            {
                                                                linearnightScale.MajorIntervalCount = (int)Math.Round(TotalHours_0, 0);
                                                            }

                                                            linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                ShowFirst = false
                                                            };
                                                            linearScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                Offset = -45
                                                            };
                                                            linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                ShowFirst = false,
                                                                Offset = -45
                                                            };
                                                        }
                                                        else
                                                        {

                                                            //linearScale.StartValue = ShiftStartTime; // Start at 10.30 hours
                                                            linearScale.StartValue = BarStartValue; // Start at 10.30 hours

                                                            //linearScale.EndValue = ShiftEndTime; // End at 13.00 hours
                                                            linearScale.EndValue = BarEndValue; // End at 13.00 hours

                                                            TimeSpan totalHours = new TimeSpan();

                                                            int timeInterval = 1;

                                                            if (BarStartValue != BarEndValue)
                                                            {
                                                                if (BarEndValue > BarStartValue)
                                                                {
                                                                    double TempTimeDifference = BarEndValue - BarStartValue;
                                                                    //double TempTimeDifference = Math.Round((Convert.ToDouble((totalHours).TotalMinutes) / 60), 0);
                                                                    timeInterval = Convert.ToInt32(Math.Round((TempTimeDifference), 0));
                                                                }
                                                            }
                                                            linearScale.MajorIntervalCount = timeInterval;

                                                            #region [pallavi jadhav] [GEOS2-5743][05-06-2024]

                                                            linearScale.MinorIntervalCount = 4;
                                                            linearnightScale.MinorIntervalCount = 4;

                                                            #endregion
                                                        }
                                                        #endregion


                                                        #region logged
                                                        TimeSpan OldStartTime = new TimeSpan();
                                                        TimeSpan OldEndTime = new TimeSpan();
                                                        TimeSpan NewStartTime = new TimeSpan();
                                                        TimeSpan NewEndTime = new TimeSpan();

                                                        double TotalBreakTimeForToolTip = 0;
                                                        double TotalLoggedTimeForToolTip = 0;
                                                        double TotalpauseTimeForToolTip = 0;


                                                        double OldEndTimeIndoble = 0;
                                                        double OldStartTimeIndoble = 0;
                                                        double MaintanceTimeIndouble = 0;

                                                        if (employeelist.Count() > 0)
                                                        {
                                                            #region pausetime
                                                            #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                            if ((employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date)) && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][03-06-2025]
                                                            {
                                                                #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                                {
                                                                    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                    UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                    UnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                    // UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                    linearScale.Ranges.Add(UnLoggBar);
                                                                }
                                                                else
                                                                {
                                                                    #endregion
                                                                    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                    UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                    UnLoggBar.EndValue = new RangeValue(24);
                                                                    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                    // UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                    linearScale.Ranges.Add(UnLoggBar);

                                                                    LinearScaleRange NightShiftUnLoggBar = new LinearScaleRange();
                                                                    NightShiftUnLoggBar.StartValue = new RangeValue(0);
                                                                    NightShiftUnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                    NightShiftUnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                    // UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                    NightShiftUnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                    linearnightScale.Ranges.Add(NightShiftUnLoggBar);
                                                                }// [GEOS2-7755][gulab lakade][08 04 2025]
                                                            }
                                                            else if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent == 1) //[GEOS2-8189][rani dhamankar] [03 - 06 - 2025]
                                                            {
                                                                double LeaveStartTimeIndouble = 0;
                                                                double LeaveEndTimeIndouble = 0;
                                                                LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(employee.LeaveStartTime.TotalMinutes) / 60), 4);
                                                                LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(employee.LeaveEndTime.TotalMinutes) / 60), 4);
                                                                LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                UnLoggBar.StartValue = new RangeValue(LeaveStartTimeIndouble);
                                                                UnLoggBar.EndValue = new RangeValue(24);
                                                                UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearScale.Ranges.Add(UnLoggBar);

                                                                LinearScaleRange NightShiftUnLoggBar = new LinearScaleRange();
                                                                NightShiftUnLoggBar.StartValue = new RangeValue(0);
                                                                NightShiftUnLoggBar.EndValue = new RangeValue(LeaveEndTimeIndouble);
                                                                NightShiftUnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                NightShiftUnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearnightScale.Ranges.Add(NightShiftUnLoggBar);
                                                            }
                                                            else
                                                            {
                                                                //                                                        if ( PauseType == "Download" || x.PauseType == "Transferred" && x.SiteName == employee.SiteName && x.EmployeeCode == employee.EmployeeCode && x.StageCode == employee.StageCode).FirstOrDefault(); //&& (x.BreakStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.BreakStartDate .Value.Date == StartDate.Date)
                                                                //)
                                                                LinearScaleRange UnLoggBar = new LinearScaleRange();


                                                                UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                UnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                // UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearScale.Ranges.Add(UnLoggBar);
                                                            }
                                                            #endregion
                                                            #endregion
                                                            #region [GEOS2-5558][gulab lakade]
                                                            //var employeeLogglist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate != null && (a.IsNightShift == 1 ? (a.CounterpartStartDate.Value.Date == StartDate.Date || a.CounterpartStartDate.Value.Date == StartDate.Date.AddDays(1)) : a.CounterpartStartDate.Value.Date == StartDate.Date)).OrderBy(a => a.CounterpartStartDate).ToList();
                                                            List<ERM_ProductionTimeline> ProductionTimeListByIdDrawing = new List<ERM_ProductionTimeline>();
                                                            #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                            //ProductionTimeListByIdDrawing = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate != null && (a.IsNightShift == 1 ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.CounterpartStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.CounterpartStartDate).ToList();
                                                            //ProductionTimeListByIdDrawing = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate != null && (a.IsNightShift == 1 ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.CounterpartStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.CounterpartStartDate).ToList();
                                                            //ProductionTimeListByIdDrawing = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.CounterpartStartDate != null && (a.IsNightShift == 1 ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.CounterpartStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.CounterpartStartDate).ToList();//[GEOS2-6554][gulab lakade][02 12 2024]
                                                            //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            //ProductionTimeListByIdDrawing = emp
                                                            //  .Where(a => a.SiteName == plantdata.Key
                                                            //              && a.EmployeeCode == emp.Key
                                                            //              // Check if CounterpartStartDate is not null, or if it's null, use LeaveStartDate
                                                            //              && (
                                                            //                  a.CounterpartStartDate != null && (
                                                            //                      a.IsNightShift == 1
                                                            //                      ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                            //                      : a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                            //                  )
                                                            //                  // If CounterpartStartDate is null, check LeaveStartDate
                                                            //                  || (a.CounterpartStartDate == null && a.ISHolidayEvent == false && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                            //              )
                                                            //  )
                                                            //  .OrderBy(a => a.CounterpartStartDate == null ? TimeSpan.MaxValue : a.CounterPartStartTime)
                                                            //  .ThenBy(a => a.LeaveStartDate == null ? DateTime.MinValue : a.LeaveStartDate)
                                                            //  .ToList();

                                                            //ProductionTimeListByIdDrawing = emp
                                                            //.Where(a => a.SiteName == plantdata.Key
                                                            //            && a.EmployeeCode == emp.Key
                                                            //            // Check if CounterpartStartDate is not null, or if it's null, use LeaveStartDate
                                                            //            && (
                                                            //                a.CounterpartStartDate != null && (
                                                            //                    a.IsNightShift == 1
                                                            //                    ? (a.ShiftStartTime <= tmpStartTimeCheck ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date :

                                                            //                    (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                            //                    )
                                                            //                    : a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                            //                )
                                                            //                // If CounterpartStartDate is null, check LeaveStartDate
                                                            //                || (a.CounterpartStartDate == null && a.ISHolidayEvent == false && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                            //            )
                                                            //)
                                                            //.OrderBy(a => a.CounterpartStartDate == null ? TimeSpan.MaxValue : a.CounterPartStartTime)
                                                            //.ThenBy(a => a.LeaveStartDate == null ? DateTime.MinValue : a.LeaveStartDate)
                                                            //.ToList();
                                                            ProductionTimeListByIdDrawing = emp
                                                            .Where(a => a.SiteName == plantdata.Key
                                                                        && a.EmployeeCode == emp.Key
                                                                        // Check if CounterpartStartDate is not null, or if it's null, use LeaveStartDate
                                                                        && (
                                                                            a.CounterpartStartDate != null && (
                                                                                a.IsNightShift == 1
                                                                                ? (a.ShiftStartTime <= tmpStartTimeCheck ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date :

                                                                                (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                                                )
                                                                                : a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                                            )
                                                                        // If CounterpartStartDate is null, check LeaveStartDate
                                                                        // || (a.CounterpartStartDate == null && a.ISHolidayEvent == false && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                                        )
                                                            ).OrderBy(a => a.CounterpartStartDate).ToList();
                                                            #endregion
                                                            #endregion
                                                            #region [GEOS2-7902][gulab lakade][23 04 2025]
                                                            var GPByStages = ProductionTimeListByIdDrawing.GroupBy(x => x.StageCode).ToList();
                                                            //var StageByIDOtItem = ERMCommon.Instance.ProductionStagesList.OTITemStagesList.Where(x => x.Code == stagedata.Key).ToList();
                                                            //var StageByIDDrawing = ERMCommon.Instance.ProductionStagesList.DrawingIdStagesList.Where(x => x.Code == stagedata.Key).ToList();
                                                            List<string> st_GP_Stages = new List<string>();
                                                            if (GPByStages.Count() > 0)
                                                            {
                                                                foreach (var GP_Stage in GPByStages)
                                                                {
                                                                    st_GP_Stages.Add(GP_Stage.Key);
                                                                }

                                                            }
                                                            st_GP_Stages.Add(stagedata.Key);
                                                            var StageByIDOtItem = ERMCommon.Instance.ProductionStagesList.OTITemStagesList.Where(x => st_GP_Stages.Contains(x.Code)).ToList();
                                                            var StageByIDDrawing = ERMCommon.Instance.ProductionStagesList.DrawingIdStagesList.Where(x => st_GP_Stages.Contains(x.Code)).ToList();

                                                            #endregion

                                                            if (StageByIDOtItem.Count() > 0)
                                                            {
                                                                var GroupByOtItemData = ProductionTimeListByIdDrawing.GroupBy(x => x.IdOTItem).ToList();

                                                                foreach (var IDOTitem in GroupByOtItemData)
                                                                {
                                                                    var SerialNumber = ProductionTimeListByIdDrawing.Where(a => a.IdOTItem == IDOTitem.Key).FirstOrDefault();

                                                                    if (SerialNumber != null)
                                                                    {
                                                                        var employeeLogglist = ProductionTimeListByIdDrawing.Where(a => a.IdOTItem == IDOTitem.Key && a.IdCounterpart == SerialNumber.IdCounterpart).OrderBy(a => a.CounterpartStartDate).ToList();
                                                                        #region LoggedTime
                                                                        //var LoggedTimeData = (from a in employeelist
                                                                        //                          //where a.CounterPartStartTime >= employee.ShiftStartTime && a.CounterPartEndTime <= employee.ShiftEndTime
                                                                        //                      where a.CounterPartStartTime >= BarStartTime && a.CounterPartEndTime <= BarEndTime && a.CounterpartStartDate.Value.Date == StartDate.Date
                                                                        //                      select new
                                                                        //                      {
                                                                        //                          a.CounterPartStartTime,
                                                                        //                          a.CounterPartEndTime,
                                                                        //                          a.AttendanceType,
                                                                        //                          a.AttendanceTypeColor
                                                                        //                      }).Distinct().OrderBy(a => a.CounterPartStartTime).ToList();
                                                                        //var employeeLogglist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate.Value.Date == StartDate.Date).OrderBy(a => a.CounterpartStartDate).ToList();


                                                                        //var LoggedTimeData = employeeLogglist.GroupBy(test => test.CounterPartStartTime)
                                                                        //                               .Select(grp => grp.FirstOrDefault())
                                                                        //                               .OrderBy(f => f.CounterPartStartTime)
                                                                        //                               .ToList();
                                                                        #region [GEOS2-7902][gulab lakade][23 04 2025]
                                                                        //var LoggedTimeDataTemp = employeeLogglist.GroupBy(test => test.CounterPartStartTime)
                                                                        //                                .Select(grp => grp.OrderByDescending(t => t.CounterPartEndTime).FirstOrDefault()).ToList();
                                                                        //var LoggedTimeData = LoggedTimeDataTemp.OrderBy(c => c.CounterpartStartDate).ToList();//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                        var LoggedTimeData = employeeLogglist
                                                                                              .Where(test => test.CounterPartStartTime != null)
                                                                                              .GroupBy(test => test.CounterPartStartTime)
                                                                                              .Select(grp => grp.OrderByDescending(t => t.CounterPartEndTime).FirstOrDefault())
                                                                                              .OrderBy(c => c.CounterpartStartDate)
                                                                                              .ToList();
                                                                        #endregion 
                                                                        if (LoggedTimeData.Count() > 0)
                                                                        {
                                                                            int logCount = 0;
                                                                            int TotallogCount = LoggedTimeData.Count() - 1;
                                                                            //[GEOS2-6771][gulab lakade][04 2 2025]
                                                                            //TimeSpan LastEndTime = new TimeSpan();
                                                                            //LastEndTime = TimeSpan.Zero;
                                                                            DateTime LastEndTime = new DateTime();
                                                                            LastEndTime = Convert.ToDateTime("1900-01-01");
                                                                            //[GEOS2-6771][gulab lakade][04 2 2025]
                                                                            foreach (var logtime in LoggedTimeData)
                                                                            {
                                                                                bool checkDuplicateValue = true;
                                                                                //if (LastEndTime != TimeSpan.Zero)
                                                                                if (LastEndTime != Convert.ToDateTime("1900-01-01"))//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                                {
                                                                                    //if (LastEndTime <= logtime.CounterPartStartTime)
                                                                                    if (LastEndTime <= logtime.CounterpartStartDate)//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                                    {
                                                                                        checkDuplicateValue = false;
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    checkDuplicateValue = false;
                                                                                }
                                                                                if (checkDuplicateValue == false)
                                                                                {
                                                                                    //LastEndTime = logtime.CounterPartEndTime;

                                                                                    #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                                    if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                                    {
                                                                                        #region [GEOS2-6771][gulab lakade][05 04 2025]
                                                                                        DateTime TempStartATDate = new DateTime();
                                                                                        DateTime TempEndATDate = new DateTime();

                                                                                        if (logtime.AttendanceStartDate == null)
                                                                                        {
                                                                                            //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                            //TempStartATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftStartTime);
                                                                                            //TempEndATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftEndTime);
                                                                                            TempStartATDate = Convert.ToDateTime(shiftStartDate);
                                                                                            TempEndATDate = Convert.ToDateTime(shiftEndDate);
                                                                                            //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                            //TempStartATDate = Convert.ToDateTime(LoggedTimeData.Min(a => a.AttendanceStartDate));
                                                                                            //TempEndATDate = Convert.ToDateTime(LoggedTimeData.Max(a => a.AttendanceEndDate));
                                                                                            TempStartATDate = Convert.ToDateTime(MinAtt_Date);
                                                                                            TempEndATDate = Convert.ToDateTime(MaxAtt_Date);
                                                                                            //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                        }
                                                                                        DateTime CPTStartDate = logtime.CounterpartStartDate.Value;
                                                                                        DateTime CPTEndDate = logtime.CounterpartEndDate.Value;
                                                                                        #endregion

                                                                                        //if ((logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date && logtime.CounterpartStartDate.Value.TimeOfDay >= logtime.ShiftStartTime) || (logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1) && logtime.CounterpartEndDate.Value.TimeOfDay <= logtime.ShiftEndTime))
                                                                                        if (TempStartATDate <= CPTStartDate && TempEndATDate >= CPTEndDate)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                        {
                                                                                            double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                                            double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                                            #region Lineargauge 
                                                                                            //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble >= (employee.ShiftEndTime).TotalHours)
                                                                                            if (TempStartATDate.Date == CPTStartDate.Date && CPTStartDate.Date == CPTEndDate.Date)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                            {
                                                                                                //if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                                //if (logtime.CounterpartEndDate.Value.TimeOfDay > logtime.CounterpartStartDate.Value.TimeOfDay)
                                                                                                if (CPTEndDate > CPTStartDate)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                                {
                                                                                                    TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                    if (tempsequence != null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                    }

                                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                    }
                                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                    #endregion
                                                                                                    LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = (EndTimeIndouble - StartTimeIndouble);
                                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                    if (tempsequence != null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                    }
                                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                    }
                                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                    #endregion
                                                                                                    LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                }

                                                                                                if (logCount == 0)
                                                                                                {
                                                                                                    //if(ShiftStartTime < StartTimeIndouble)
                                                                                                    //{
                                                                                                    //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                                    //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                                    //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                                    //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                                    //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                    //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                    //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                                    //    linearScale.Ranges.Add(UnLoggBar);
                                                                                                    //}
                                                                                                }
                                                                                                LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                                LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                                LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                                LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                                string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                                if (string.IsNullOrEmpty(logTimeColor))
                                                                                                {
                                                                                                    //logTimeColor = "#0000FF";
                                                                                                    logTimeColor = "#00b54d";
                                                                                                }
                                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                                LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                                SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                                //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                                SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                                SelectedTooltips.BarTypeName = "LoggedType";
                                                                                                //SelectedTooltips1.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                                SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                SelectedTooltips.ToolTipsType = "Working";

                                                                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                                {
                                                                                                    SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                }
                                                                                                SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                                {
                                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                    {
                                                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                        if (Tooltipdata == null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }

                                                                                                #endregion
                                                                                                linearScale.Ranges.Add(LoggBar);
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble <= (employee.ShiftEndTime).TotalHours)
                                                                                                if (CPTStartDate.Date < CPTEndDate.Date)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                                {
                                                                                                    #region Linearscale

                                                                                                    TimeSpan LoggTimeDiffernce = Hours_24.Subtract(logtime.CounterpartStartDate.Value.TimeOfDay);
                                                                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                    if (tempsequence != null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                    }
                                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                    }
                                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                    #endregion

                                                                                                    LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                                    LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                                    LoggBar.EndValue = new RangeValue(Hours_24.TotalHours);
                                                                                                    LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                    string logTimeColor1 = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                                    if (string.IsNullOrEmpty(logTimeColor1))
                                                                                                    {
                                                                                                        //logTimeColor = "#0000FF";
                                                                                                        logTimeColor1 = "#00b54d";
                                                                                                    }
                                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                                    LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor1)) };
                                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                                    ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                                    SelectedTooltips1.ToolTipsStartTime = StartTimeIndouble;
                                                                                                    //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                                    SelectedTooltips1.ToolTipsEndTime = 1439; //Hours_24.TotalHours;
                                                                                                    SelectedTooltips1.BarTypeName = "LoggedType";
                                                                                                    //SelectedTooltips1.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                                    SelectedTooltips1.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    SelectedTooltips1.ToolTipsType = "Working";
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips1.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                                    {
                                                                                                        SelectedTooltips1.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    }
                                                                                                    SelectedTooltips1.PauseTypeId = logtime.PauseTypeId;
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips1.IdEmployee = employee.IdEmployee;
                                                                                                    SelectedTooltips1.IdStage = employee.IdStage;
                                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                                    {
                                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                        {
                                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                            if (Tooltipdata == null)
                                                                                                            {
                                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                            }
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                    }

                                                                                                    #endregion
                                                                                                    linearScale.Ranges.Add(LoggBar);
                                                                                                    #endregion

                                                                                                    #region Linear_NightShit

                                                                                                    TimeSpan LoggTimeDiffernce1 = logtime.CounterpartEndDate.Value.TimeOfDay.Subtract(Hours_0);
                                                                                                    double LoggTimeDiffernceIndouble1 = Math.Round((Convert.ToDouble(LoggTimeDiffernce1.TotalMinutes) / 60), 4);
                                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble1;
                                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble1;
                                                                                                    var tempsequence1 = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                    if (tempsequence1 != null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence1.Sequence;
                                                                                                    }
                                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                    }
                                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                    #endregion


                                                                                                    LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                                    NightShftLoggBar.StartValue = new RangeValue(0);
                                                                                                    NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                                    NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                                                                    {
                                                                                                        //logTimeColor = "#0000FF";
                                                                                                        logTimeColor = "#00b54d";
                                                                                                    }
                                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                                    NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                                    SelectedTooltips.ToolTipsStartTime = 0;
                                                                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    SelectedTooltips.ToolTipsType = "Working";
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                                    {
                                                                                                        SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    }
                                                                                                    SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                                    {
                                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                        {
                                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                            if (Tooltipdata == null)
                                                                                                            {
                                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                            }
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }

                                                                                                    #endregion
                                                                                                    linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                                    #endregion
                                                                                                    LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    #region Linear_NightShit
                                                                                                    if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                                    {
                                                                                                        TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                                        double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                        if (tempsequence != null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                        }
                                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                        }
                                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                        #endregion
                                                                                                        LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = (EndTimeIndouble - StartTimeIndouble);
                                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                        if (tempsequence != null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                        }
                                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                        }
                                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                        #endregion
                                                                                                        LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                    }

                                                                                                    if (logCount == 0)
                                                                                                    {
                                                                                                        //if(ShiftStartTime < StartTimeIndouble)
                                                                                                        //{
                                                                                                        //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                                        //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                                        //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                                        //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                                        //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                        //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                        //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                                        //    linearScale.Ranges.Add(UnLoggBar);
                                                                                                        //}
                                                                                                    }
                                                                                                    LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                                    NightShftLoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                                    NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                                    NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                                                                    {
                                                                                                        //logTimeColor = "#0000FF";
                                                                                                        logTimeColor = "#00b54d";
                                                                                                    }
                                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                                    NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                                    SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    SelectedTooltips.ToolTipsType = "Working";
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                                    {
                                                                                                        SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    }
                                                                                                    SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                                    {
                                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                        {
                                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                            if (Tooltipdata == null)
                                                                                                            {
                                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                            }
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }

                                                                                                    #endregion
                                                                                                    linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                                    #endregion
                                                                                                }

                                                                                            }
                                                                                            #endregion

                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                                        double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                                        if (BarEndValue >= EndTimeIndouble && BarStartValue <= StartTimeIndouble && logtime.CounterpartStartDate.Value.Date == logtime.CounterpartEndDate.Value.Date)
                                                                                        {
                                                                                            if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                            {
                                                                                                TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                                double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                #endregion
                                                                                                LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = (EndTimeIndouble - StartTimeIndouble);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                #endregion
                                                                                                LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                            }

                                                                                            if (logCount == 0)
                                                                                            {
                                                                                                //if(ShiftStartTime < StartTimeIndouble)
                                                                                                //{
                                                                                                //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                                //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                                //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                                //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                                //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                                //    linearScale.Ranges.Add(UnLoggBar);
                                                                                                //}
                                                                                            }
                                                                                            LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                            LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                            LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                            LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                            //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                            //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                            string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                            if (string.IsNullOrEmpty(logTimeColor))
                                                                                            {
                                                                                                //logTimeColor = "#0000FF";
                                                                                                logTimeColor = "#00b54d";
                                                                                            }
                                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                            LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                            SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                            SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                            SelectedTooltips.BarTypeName = "LoggedType";
                                                                                            //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                            SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            SelectedTooltips.ToolTipsType = "Working";
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                            {
                                                                                                SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            }
                                                                                            SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                            SelectedTooltips.IdStage = employee.IdStage;
                                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                            {
                                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                {
                                                                                                    //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    if (Tooltipdata == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }

                                                                                            #endregion
                                                                                            linearScale.Ranges.Add(LoggBar);
                                                                                        }
                                                                                    }

                                                                                    #endregion
                                                                                    //if (logCount == TotallogCount)
                                                                                    //{
                                                                                    //    if (ShiftEndTime > EndTimeIndouble)
                                                                                    //    {
                                                                                    //        TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (ShiftEndTime - EndTimeIndouble);
                                                                                    //        LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                    //        UnLoggBar.StartValue = new RangeValue(EndTimeIndouble);
                                                                                    //        UnLoggBar.EndValue = new RangeValue(ShiftEndTime);
                                                                                    //        UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                    //        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //        UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                    //        linearScale.Ranges.Add(UnLoggBar);
                                                                                    //    }
                                                                                    //}
                                                                                }
                                                                            }
                                                                        }

                                                                        #endregion
                                                                    }
                                                                }
                                                            }
                                                            else
                                                                if (StageByIDDrawing.Count() > 0)
                                                            {
                                                                var GroupByIDdrawingData = ProductionTimeListByIdDrawing.GroupBy(x => x.IdDrawing).ToList();

                                                                foreach (var IDdrawingItem in GroupByIDdrawingData)
                                                                {
                                                                    var SerialNumber = ProductionTimeListByIdDrawing.Where(a => a.IdDrawing == IDdrawingItem.Key).FirstOrDefault();

                                                                    if (SerialNumber != null)
                                                                    {
                                                                        var employeeLogglist = ProductionTimeListByIdDrawing.Where(a => a.IdDrawing == IDdrawingItem.Key && a.IdCounterpart == SerialNumber.IdCounterpart).OrderBy(a => a.CounterpartStartDate).ToList();
                                                                        #region LoggedTime
                                                                        //var LoggedTimeData = (from a in employeelist
                                                                        //                          //where a.CounterPartStartTime >= employee.ShiftStartTime && a.CounterPartEndTime <= employee.ShiftEndTime
                                                                        //                      where a.CounterPartStartTime >= BarStartTime && a.CounterPartEndTime <= BarEndTime && a.CounterpartStartDate.Value.Date == StartDate.Date
                                                                        //                      select new
                                                                        //                      {
                                                                        //                          a.CounterPartStartTime,
                                                                        //                          a.CounterPartEndTime,
                                                                        //                          a.AttendanceType,
                                                                        //                          a.AttendanceTypeColor
                                                                        //                      }).Distinct().OrderBy(a => a.CounterPartStartTime).ToList();
                                                                        //var employeeLogglist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate.Value.Date == StartDate.Date).OrderBy(a => a.CounterpartStartDate).ToList();


                                                                        //var LoggedTimeData = employeeLogglist.GroupBy(test => test.CounterPartStartTime)
                                                                        //                               .Select(grp => grp.FirstOrDefault())
                                                                        //                               .ToList();

                                                                        //var LoggedTimeData = employeeLogglist.GroupBy(test => test.CounterPartStartTime)   //[pallavi jadhav][GEOS2]
                                                                        //                                      .Select(grp => grp.OrderByDescending(t => t.CounterPartEndTime).FirstOrDefault())
                                                                        //                                      .ToList();
                                                                        var LoggedTimeData = employeeLogglist.GroupBy(test => test.CounterPartStartTime)   //[pallavi jadhav][GEOS2]
                                                                                                             .Select(grp => grp.OrderByDescending(t => t.CounterPartEndTime).FirstOrDefault())
                                                                                                             .OrderBy(c => c.CounterpartStartDate)//[GEOS2-6771][gulab lakade][04 20 2025]
                                                                                                             .ToList();


                                                                        if (LoggedTimeData.Count() > 0)
                                                                        {
                                                                            int logCount = 0;
                                                                            int TotallogCount = LoggedTimeData.Count() - 1;
                                                                            //[GEOS2-6771][gulab lakade][04 2 2025]
                                                                            //TimeSpan LastEndTime = new TimeSpan();
                                                                            //LastEndTime = TimeSpan.Zero;
                                                                            DateTime LastEndTime = new DateTime();
                                                                            LastEndTime = Convert.ToDateTime("1900-01-01");
                                                                            //[GEOS2-6771][gulab lakade][04 2 2025]
                                                                            foreach (var logtime in LoggedTimeData)
                                                                            {
                                                                                bool checkDuplicateValue = true;
                                                                                //if (LastEndTime != TimeSpan.Zero)
                                                                                if (LastEndTime != Convert.ToDateTime("1900-01-01")) //[GEOS2-6771][gulab lakade][04 2 2025]
                                                                                {
                                                                                    // if (LastEndTime <= logtime.CounterPartStartTime) //[GEOS2-6771][gulab lakade][04 2 2025]
                                                                                    if (LastEndTime <= logtime.CounterpartStartDate)
                                                                                    {
                                                                                        checkDuplicateValue = false;
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    checkDuplicateValue = false;
                                                                                }


                                                                                if (checkDuplicateValue == false)
                                                                                {
                                                                                    //LastEndTime = logtime.CounterPartEndTime;//[GEOS2-6771][gulab lakade][04 20 2025]

                                                                                    #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                                    if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                                    {
                                                                                        #region [GEOS2-6771][gulab lakade][05 04 2025]
                                                                                        DateTime TempStartATDate = new DateTime();
                                                                                        DateTime TempEndATDate = new DateTime();

                                                                                        if (logtime.AttendanceStartDate == null)
                                                                                        {
                                                                                            //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                            //TempStartATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftStartTime);
                                                                                            //TempEndATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftEndTime);
                                                                                            TempStartATDate = Convert.ToDateTime(shiftStartDate);
                                                                                            TempEndATDate = Convert.ToDateTime(shiftEndDate);
                                                                                            //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                            //TempStartATDate = Convert.ToDateTime(LoggedTimeData.Min(a => a.AttendanceStartDate));
                                                                                            //TempEndATDate = Convert.ToDateTime(LoggedTimeData.Max(a => a.AttendanceEndDate));
                                                                                            TempStartATDate = Convert.ToDateTime(MinAtt_Date);
                                                                                            TempEndATDate = Convert.ToDateTime(MaxAtt_Date);
                                                                                            //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                        }
                                                                                        DateTime CPTStartDate = logtime.CounterpartStartDate.Value;
                                                                                        DateTime CPTEndDate = logtime.CounterpartEndDate.Value;
                                                                                        #endregion
                                                                                        //if ((logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date && logtime.CounterpartStartDate.Value.TimeOfDay >= logtime.ShiftStartTime) || (logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1) && logtime.CounterpartEndDate.Value.TimeOfDay <= logtime.ShiftEndTime))
                                                                                        if (TempStartATDate <= CPTStartDate && TempEndATDate >= CPTEndDate)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                        {
                                                                                            double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                                            double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                                            #region Lineargauge 
                                                                                            //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble >= (employee.ShiftEndTime).TotalHours)
                                                                                            if (TempStartATDate.Date == CPTStartDate.Date && CPTStartDate.Date == CPTEndDate.Date)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                            {
                                                                                                //if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                                //if (logtime.CounterpartEndDate.Value.TimeOfDay > logtime.CounterpartStartDate.Value.TimeOfDay)
                                                                                                if (CPTEndDate > CPTStartDate)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                                {
                                                                                                    TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                    if (tempsequence != null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                    }
                                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                    }
                                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                    #endregion
                                                                                                    LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = (EndTimeIndouble - StartTimeIndouble);
                                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                    if (tempsequence != null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                    }
                                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                    }
                                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                    #endregion
                                                                                                    LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                }

                                                                                                if (logCount == 0)
                                                                                                {
                                                                                                    //if(ShiftStartTime < StartTimeIndouble)
                                                                                                    //{
                                                                                                    //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                                    //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                                    //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                                    //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                                    //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                    //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                    //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                                    //    linearScale.Ranges.Add(UnLoggBar);
                                                                                                    //}
                                                                                                }
                                                                                                LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                                LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                                LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                                LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                                string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                                if (string.IsNullOrEmpty(logTimeColor))
                                                                                                {
                                                                                                    //logTimeColor = "#0000FF";
                                                                                                    logTimeColor = "#00b54d";
                                                                                                }
                                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                                LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                                SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                                //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                                SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                                SelectedTooltips.BarTypeName = "LoggedType";
                                                                                                //SelectedTooltips1.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                                SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                SelectedTooltips.ToolTipsType = "Working";
                                                                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                                {
                                                                                                    SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                }
                                                                                                SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                                {
                                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                    {
                                                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                        if (Tooltipdata == null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }

                                                                                                #endregion
                                                                                                linearScale.Ranges.Add(LoggBar);
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble <= (employee.ShiftEndTime).TotalHours)
                                                                                                if (CPTStartDate.Date < CPTEndDate.Date)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                                {
                                                                                                    #region Linearscale

                                                                                                    TimeSpan LoggTimeDiffernce = Hours_24.Subtract(logtime.CounterpartStartDate.Value.TimeOfDay);
                                                                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                    if (tempsequence != null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                    }
                                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                    }
                                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                    #endregion

                                                                                                    LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                                    LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                                    LoggBar.EndValue = new RangeValue(Hours_24.TotalHours);
                                                                                                    LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                    string logTimeColor1 = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                                    if (string.IsNullOrEmpty(logTimeColor1))
                                                                                                    {
                                                                                                        //logTimeColor = "#0000FF";
                                                                                                        logTimeColor1 = "#00b54d";
                                                                                                    }
                                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                                    LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor1)) };
                                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                                    ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                                    SelectedTooltips1.ToolTipsStartTime = StartTimeIndouble;
                                                                                                    //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                                    SelectedTooltips1.ToolTipsEndTime = 1439; //Hours_24.TotalHours;
                                                                                                    SelectedTooltips1.BarTypeName = "LoggedType";
                                                                                                    //SelectedTooltips1.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                                    SelectedTooltips1.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    SelectedTooltips1.ToolTipsType = "Working";
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips1.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                                    {
                                                                                                        SelectedTooltips1.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    }
                                                                                                    SelectedTooltips1.PauseTypeId = logtime.PauseTypeId;
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips1.IdEmployee = employee.IdEmployee;
                                                                                                    SelectedTooltips1.IdStage = employee.IdStage;
                                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                                    {
                                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                        {
                                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                            if (Tooltipdata == null)
                                                                                                            {
                                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                            }
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                    }

                                                                                                    #endregion
                                                                                                    linearScale.Ranges.Add(LoggBar);
                                                                                                    #endregion

                                                                                                    #region Linear_NightShit

                                                                                                    TimeSpan LoggTimeDiffernce1 = logtime.CounterpartEndDate.Value.TimeOfDay.Subtract(Hours_0);
                                                                                                    double LoggTimeDiffernceIndouble1 = Math.Round((Convert.ToDouble(LoggTimeDiffernce1.TotalMinutes) / 60), 4);
                                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble1;
                                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble1;
                                                                                                    var tempsequence1 = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                    if (tempsequence1 != null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence1.Sequence;
                                                                                                    }
                                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                    }
                                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                    #endregion


                                                                                                    LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                                    NightShftLoggBar.StartValue = new RangeValue(0);
                                                                                                    NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                                    NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                                                                    {
                                                                                                        //logTimeColor = "#0000FF";
                                                                                                        logTimeColor = "#00b54d";
                                                                                                    }
                                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                                    NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                                    SelectedTooltips.ToolTipsStartTime = 0;
                                                                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    SelectedTooltips.ToolTipsType = "Working";
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                                    {
                                                                                                        SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    }
                                                                                                    SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                                    {
                                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                        {
                                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                            if (Tooltipdata == null)
                                                                                                            {
                                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                            }
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }

                                                                                                    #endregion
                                                                                                    linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                                    #endregion
                                                                                                    LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    #region Linear_NightShit
                                                                                                    if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                                    {
                                                                                                        TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                                        double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                        if (tempsequence != null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                        }
                                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                        }
                                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                        #endregion
                                                                                                        LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                        if (tempsequence != null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                        }
                                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                        {
                                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                        }
                                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                        #endregion
                                                                                                        LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                                    }

                                                                                                    if (logCount == 0)
                                                                                                    {
                                                                                                        //if(ShiftStartTime < StartTimeIndouble)
                                                                                                        //{
                                                                                                        //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                                        //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                                        //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                                        //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                                        //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                        //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                        //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                                        //    linearScale.Ranges.Add(UnLoggBar);
                                                                                                        //}
                                                                                                    }
                                                                                                    LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                                    NightShftLoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                                    NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                                    NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                                                                    {
                                                                                                        //logTimeColor = "#0000FF";
                                                                                                        logTimeColor = "#00b54d";
                                                                                                    }
                                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                                    NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                                    SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    SelectedTooltips.ToolTipsType = "Working";
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                                    {
                                                                                                        SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    }
                                                                                                    SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                                    {
                                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                        {
                                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                            if (Tooltipdata == null)
                                                                                                            {
                                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                            }
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                        }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }

                                                                                                    #endregion
                                                                                                    linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                                    #endregion
                                                                                                }

                                                                                            }
                                                                                            #endregion

                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                                        double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                                        if (BarEndValue >= EndTimeIndouble && BarStartValue <= StartTimeIndouble && logtime.CounterpartStartDate.Value.Date == logtime.CounterpartEndDate.Value.Date)
                                                                                        {
                                                                                            if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                            {
                                                                                                TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                                double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                #endregion
                                                                                                LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                #endregion
                                                                                                LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                            }

                                                                                            if (logCount == 0)
                                                                                            {
                                                                                                //if(ShiftStartTime < StartTimeIndouble)
                                                                                                //{
                                                                                                //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                                //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                                //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                                //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                                //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                                //    linearScale.Ranges.Add(UnLoggBar);
                                                                                                //}
                                                                                            }
                                                                                            LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                            LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                            LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                            LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                            //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                            //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                            string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                            if (string.IsNullOrEmpty(logTimeColor))
                                                                                            {
                                                                                                //logTimeColor = "#0000FF";
                                                                                                logTimeColor = "#00b54d";
                                                                                            }
                                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                            LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                            SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                            SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                            SelectedTooltips.BarTypeName = "LoggedType";
                                                                                            //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                            SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            SelectedTooltips.ToolTipsType = "Working";
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                            {
                                                                                                SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            }
                                                                                            SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                            SelectedTooltips.IdStage = employee.IdStage;
                                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                            {
                                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                {
                                                                                                    //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    if (Tooltipdata == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }

                                                                                            #endregion
                                                                                            linearScale.Ranges.Add(LoggBar);
                                                                                        }
                                                                                    }

                                                                                    #endregion
                                                                                    //if (logCount == TotallogCount)
                                                                                    //{
                                                                                    //    if (ShiftEndTime > EndTimeIndouble)
                                                                                    //    {
                                                                                    //        TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (ShiftEndTime - EndTimeIndouble);
                                                                                    //        LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                    //        UnLoggBar.StartValue = new RangeValue(EndTimeIndouble);
                                                                                    //        UnLoggBar.EndValue = new RangeValue(ShiftEndTime);
                                                                                    //        UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                    //        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //        UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                    //        linearScale.Ranges.Add(UnLoggBar);
                                                                                    //    }
                                                                                    //}
                                                                                }
                                                                            }
                                                                        }

                                                                        #endregion
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                                //var employeeLogglist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate != null && (a.IsNightShift == 1 ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.CounterpartStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.CounterpartStartDate).ToList();
                                                                //var employeeLogglist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate != null && (a.IsNightShift == 1 ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.CounterpartStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.CounterpartStartDate).ToList();
                                                                /*var employeeLogglist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.CounterpartStartDate != null && (a.IsNightShift == 1 ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.CounterpartStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.CounterpartStartDate).ToList();*/////[GEOS2-6554][gulab lakade][02 12 2024]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                      //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                                #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                //  var employeeLogglist = emp
                                                                // .Where(a => a.SiteName == plantdata.Key
                                                                //             && a.EmployeeCode == emp.Key
                                                                //             && (
                                                                //                 // Check if CounterpartStartDate is not null and follow the existing logic
                                                                //                 a.CounterpartStartDate != null && (
                                                                //                     a.IsNightShift == 1
                                                                //                     ? (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                                //                     : a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                                //                 )
                                                                //                 // If CounterpartStartDate is null, check LeaveStartDate
                                                                //                 || (a.CounterpartStartDate == null && a.ISHolidayEvent == false && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                                //             )
                                                                // )
                                                                // .OrderBy(a => a.CounterpartStartDate == null ? TimeSpan.MaxValue : a.CounterPartStartTime)
                                                                //.ThenBy(a => a.LeaveStartDate == null ? DateTime.MinValue : a.LeaveStartDate)
                                                                //.ToList();
                                                                var employeeLogglist = emp
                                                                 .Where(a => a.SiteName == plantdata.Key
                                                                             && a.EmployeeCode == emp.Key
                                                                             && (
                                                                                 // Check if CounterpartStartDate is not null and follow the existing logic
                                                                                 a.CounterpartStartDate != null && (
                                                                                     a.IsNightShift == 1
                                                                                     ? (
                                                                                     a.ShiftStartTime <= tmpStartTimeCheck ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date :
                                                                                     (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                                                     )
                                                                                     : a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                                                 )
                                                                                 // If CounterpartStartDate is null, check LeaveStartDate
                                                                                 || (a.CounterpartStartDate == null && a.ISHolidayEvent == false && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                                             )
                                                                 )
                                                                 .OrderBy(a => a.CounterpartStartDate == null ? TimeSpan.MaxValue : a.CounterPartStartTime)
                                                                .ThenBy(a => a.LeaveStartDate == null ? DateTime.MinValue : a.LeaveStartDate)
                                                                .ToList();
                                                                #endregion
                                                                #endregion
                                                                #region LoggedTime
                                                                //var LoggedTimeData = (from a in employeelist
                                                                //                          //where a.CounterPartStartTime >= employee.ShiftStartTime && a.CounterPartEndTime <= employee.ShiftEndTime
                                                                //                      where a.CounterPartStartTime >= BarStartTime && a.CounterPartEndTime <= BarEndTime && a.CounterpartStartDate.Value.Date == StartDate.Date
                                                                //                      select new
                                                                //                      {
                                                                //                          a.CounterPartStartTime,
                                                                //                          a.CounterPartEndTime,
                                                                //                          a.AttendanceType,
                                                                //                          a.AttendanceTypeColor
                                                                //                      }).Distinct().OrderBy(a => a.CounterPartStartTime).ToList();
                                                                //var employeeLogglist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.CounterpartStartDate.Value.Date == StartDate.Date).OrderBy(a => a.CounterpartStartDate).ToList();


                                                                //var LoggedTimeData = employeeLogglist.GroupBy(test => test.CounterPartStartTime)
                                                                //                               .Select(grp => grp.FirstOrDefault())
                                                                //                               .ToList();
                                                                //var LoggedTimeData = employeeLogglist.GroupBy(test => test.CounterPartStartTime)
                                                                //                                             .Select(grp => grp.OrderByDescending(t => t.CounterPartEndTime).FirstOrDefault())
                                                                //
                                                                //   .ToList();
                                                                #region [GEOS2-7902][gulab lakade][23 04 2025]
                                                                //var LoggedTimeData = employeeLogglist
                                                                // .Where(test => test.CounterPartStartTime != null)
                                                                // .GroupBy(test => test.CounterPartStartTime)
                                                                // .Select(grp => grp.OrderByDescending(t => t.CounterPartEndTime).FirstOrDefault())
                                                                // .ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                                var LoggedTimeData = employeeLogglist
                                                                 .Where(test => test.CounterPartStartTime != null)
                                                                 .GroupBy(test => test.CounterPartStartTime)
                                                                 .Select(grp => grp.OrderByDescending(t => t.CounterPartEndTime).FirstOrDefault())
                                                                 .OrderBy(c => c.CounterpartStartDate)
                                                                 .ToList();
                                                                #endregion 



                                                                if (LoggedTimeData.Count() > 0)
                                                                {
                                                                    int ttcount = 0;
                                                                    int logCount = 0;
                                                                    int TotallogCount = LoggedTimeData.Count() - 1;
                                                                    //TimeSpan LastEndTime = new TimeSpan();//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                    DateTime LastEndTime = new DateTime();
                                                                    //LastEndTime = TimeSpan.Zero;
                                                                    LastEndTime = Convert.ToDateTime("1900-01-01");//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                    foreach (var logtime in LoggedTimeData)
                                                                    {
                                                                        ttcount = ttcount + 1;
                                                                        bool checkDuplicateValue = true;
                                                                        //if (LastEndTime != TimeSpan.Zero)
                                                                        if (LastEndTime != Convert.ToDateTime("1900-01-01"))//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                        {
                                                                            //if (LastEndTime <= logtime.CounterPartStartTime)
                                                                            if (LastEndTime <= logtime.CounterpartStartDate)
                                                                            {
                                                                                checkDuplicateValue = false;
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            checkDuplicateValue = false;
                                                                        }


                                                                        if (checkDuplicateValue == false)
                                                                        {
                                                                            //LastEndTime = logtime.CounterPartEndTime;//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                            #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                            if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                            {
                                                                                #region [GEOS2-6771][gulab lakade][05 04 2025]
                                                                                DateTime TempStartATDate = new DateTime();
                                                                                DateTime TempEndATDate = new DateTime();

                                                                                if (logtime.AttendanceStartDate == null)
                                                                                {
                                                                                    //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                    //TempStartATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftStartTime);
                                                                                    //TempEndATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftEndTime);
                                                                                    TempStartATDate = Convert.ToDateTime(shiftStartDate);
                                                                                    TempEndATDate = Convert.ToDateTime(shiftEndDate);
                                                                                    //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                }
                                                                                else
                                                                                {
                                                                                    //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                    TempStartATDate = Convert.ToDateTime(MinAtt_Date);
                                                                                    TempEndATDate = Convert.ToDateTime(MaxAtt_Date);
                                                                                    //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                }
                                                                                DateTime CPTStartDate = logtime.CounterpartStartDate.Value;
                                                                                DateTime CPTEndDate = logtime.CounterpartEndDate.Value;
                                                                                #endregion

                                                                                //if ((logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date && logtime.CounterpartStartDate.Value.TimeOfDay >= logtime.ShiftStartTime) || (logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1) && logtime.CounterpartEndDate.Value.TimeOfDay <= logtime.ShiftEndTime))
                                                                                if (TempStartATDate <= CPTStartDate && TempEndATDate >= CPTEndDate)
                                                                                {
                                                                                    double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                                    double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);


                                                                                    #region Lineargauge 
                                                                                    //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble >= (employee.ShiftEndTime).TotalHours)
                                                                                    if (TempStartATDate.Date == CPTStartDate.Date && CPTStartDate.Date == CPTEndDate.Date)
                                                                                    {
                                                                                        //if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                        //if (logtime.CounterpartEndDate.Value.TimeOfDay > logtime.CounterpartStartDate.Value.TimeOfDay)
                                                                                        if (CPTEndDate > CPTStartDate)
                                                                                        {
                                                                                            TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                            double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                            TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            #endregion
                                                                                            LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            #endregion
                                                                                            LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]

                                                                                        }

                                                                                        if (logCount == 0)
                                                                                        {
                                                                                            //if(ShiftStartTime < StartTimeIndouble)
                                                                                            //{
                                                                                            //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                            //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                            //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                            //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                            //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                            //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                            //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                            //    linearScale.Ranges.Add(UnLoggBar);
                                                                                            //}
                                                                                        }
                                                                                        LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                        LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                        LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                        LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                        string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                        if (string.IsNullOrEmpty(logTimeColor))
                                                                                        {
                                                                                            //logTimeColor = "#0000FF";
                                                                                            logTimeColor = "#00b54d";
                                                                                        }
                                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                        LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                        //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                        SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                        SelectedTooltips.BarTypeName = "LoggedType";
                                                                                        //SelectedTooltips1.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        SelectedTooltips.ToolTipsType = "Working";
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                        {
                                                                                            SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        }
                                                                                        SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips.IdStage = employee.IdStage;
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }

                                                                                        #endregion
                                                                                        linearScale.Ranges.Add(LoggBar);
                                                                                    }
                                                                                    #region [GEOS2-6771][gulab lakade][05 04 2025]
                                                                                    else
                                                                                    {

                                                                                        //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble <= (employee.ShiftEndTime).TotalHours)
                                                                                        if (CPTStartDate.Date < CPTEndDate.Date)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                        {
                                                                                            #region Linearscale
                                                                                            DateTime stdt = logtime.CounterpartStartDate.Value;
                                                                                            DateTime endt = logtime.CounterpartEndDate.Value;
                                                                                            TimeSpan LoggTimeDiffernce = Hours_24.Subtract(logtime.CounterpartStartDate.Value.TimeOfDay);
                                                                                            double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                            TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            #endregion

                                                                                            LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                            LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                            LoggBar.EndValue = new RangeValue(Hours_24.TotalHours);
                                                                                            LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                            string logTimeColor1 = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                            if (string.IsNullOrEmpty(logTimeColor1))
                                                                                            {
                                                                                                //logTimeColor = "#0000FF";
                                                                                                logTimeColor1 = "#00b54d";
                                                                                            }
                                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                            LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor1)) };
                                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                            ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                            SelectedTooltips1.ToolTipsStartTime = StartTimeIndouble;
                                                                                            //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                            SelectedTooltips1.ToolTipsEndTime = 1439; //Hours_24.TotalHours;
                                                                                            SelectedTooltips1.BarTypeName = "LoggedType";
                                                                                            //SelectedTooltips1.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                            SelectedTooltips1.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            SelectedTooltips1.ToolTipsType = "Working";
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips1.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                            {
                                                                                                SelectedTooltips1.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            }
                                                                                            SelectedTooltips1.PauseTypeId = logtime.PauseTypeId;
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips1.IdEmployee = employee.IdEmployee;
                                                                                            SelectedTooltips1.IdStage = employee.IdStage;
                                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                            {
                                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                {
                                                                                                    //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == Hours_24.TotalHours && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    if (Tooltipdata == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                    }
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                            }

                                                                                            #endregion
                                                                                            linearScale.Ranges.Add(LoggBar);
                                                                                            #endregion

                                                                                            #region Linear_NightShit

                                                                                            TimeSpan LoggTimeDiffernce1 = logtime.CounterpartEndDate.Value.TimeOfDay.Subtract(Hours_0);
                                                                                            double LoggTimeDiffernceIndouble1 = Math.Round((Convert.ToDouble(LoggTimeDiffernce1.TotalMinutes) / 60), 4);
                                                                                            TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble1;

                                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble1;
                                                                                            var tempsequence1 = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                            if (tempsequence1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence1.Sequence;
                                                                                            }
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            #endregion

                                                                                            LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                            NightShftLoggBar.StartValue = new RangeValue(0);
                                                                                            NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                            NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                            //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                            //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                            string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                            if (string.IsNullOrEmpty(logTimeColor))
                                                                                            {
                                                                                                //logTimeColor = "#0000FF";
                                                                                                logTimeColor = "#00b54d";
                                                                                            }
                                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                            NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                            SelectedTooltips.ToolTipsStartTime = 0;
                                                                                            SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                            SelectedTooltips.BarTypeName = "LoggedType";
                                                                                            //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                            SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            SelectedTooltips.ToolTipsType = "Working";
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                            {
                                                                                                SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            }
                                                                                            SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                            SelectedTooltips.IdStage = employee.IdStage;
                                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                            {
                                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                {
                                                                                                    //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    if (Tooltipdata == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }

                                                                                            #endregion
                                                                                            linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                            #endregion
                                                                                            LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            #region Linear_NightShit
                                                                                            if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                            {
                                                                                                TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                                double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                                TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                #endregion
                                                                                                LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                                #endregion
                                                                                                LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                            }

                                                                                            if (logCount == 0)
                                                                                            {
                                                                                                //if(ShiftStartTime < StartTimeIndouble)
                                                                                                //{
                                                                                                //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                                //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                                //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                                //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                                //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                                //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                                //    linearScale.Ranges.Add(UnLoggBar);
                                                                                                //}
                                                                                            }
                                                                                            LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                            NightShftLoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                            NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                            NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                            //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                            //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                            string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                            if (string.IsNullOrEmpty(logTimeColor))
                                                                                            {
                                                                                                //logTimeColor = "#0000FF";
                                                                                                logTimeColor = "#00b54d";
                                                                                            }
                                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                            NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                            SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                            SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                            SelectedTooltips.BarTypeName = "LoggedType";
                                                                                            //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                            SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            SelectedTooltips.ToolTipsType = "Working";
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                            {
                                                                                                SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            }
                                                                                            SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                            //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                            SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                            SelectedTooltips.IdStage = employee.IdStage;
                                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                            {
                                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                                {
                                                                                                    //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                    if (Tooltipdata == null)
                                                                                                    {
                                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                    }
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }

                                                                                            #endregion
                                                                                            linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                            #endregion
                                                                                        }

                                                                                    }
                                                                                    #endregion
                                                                                    #endregion

                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                if (logtime.CounterPartStartTime != TimeSpan.Zero && logtime.CounterPartEndTime != TimeSpan.Zero)
                                                                                {
                                                                                    double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                                    double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                                    if (BarEndValue >= EndTimeIndouble && BarStartValue <= StartTimeIndouble && logtime.CounterpartStartDate.Value.Date == logtime.CounterpartEndDate.Value.Date)
                                                                                    {
                                                                                        if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                        {
                                                                                            TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                            double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                            TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            #endregion
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            #endregion
                                                                                        }

                                                                                        if (logCount == 0)
                                                                                        {
                                                                                            //if(ShiftStartTime < StartTimeIndouble)
                                                                                            //{
                                                                                            //    TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (StartTimeIndouble - OldEndTimeIndoble);
                                                                                            //    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                                            //    UnLoggBar.StartValue = new RangeValue(ShiftStartTime);
                                                                                            //    UnLoggBar.EndValue = new RangeValue(StartTimeIndouble);
                                                                                            //    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                            //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                            //    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                            //    linearScale.Ranges.Add(UnLoggBar);
                                                                                            //}
                                                                                        }
                                                                                        LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                        LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                        LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                        LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                        string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                        if (string.IsNullOrEmpty(logTimeColor))
                                                                                        {
                                                                                            //logTimeColor = "#0000FF";
                                                                                            logTimeColor = "#00b54d";
                                                                                        }
                                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                        LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                        SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                        SelectedTooltips.BarTypeName = "LoggedType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        SelectedTooltips.ToolTipsType = "Working";
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                        {
                                                                                            SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        }
                                                                                        SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips.IdStage = employee.IdStage;
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }

                                                                                        #endregion
                                                                                        linearScale.Ranges.Add(LoggBar);
                                                                                        LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-7755][gulab lakade][08 04 2025]

                                                                                    }
                                                                                }
                                                                            }

                                                                            #endregion
                                                                            //if (logCount == TotallogCount)
                                                                            //{
                                                                            //    if (ShiftEndTime > EndTimeIndouble)
                                                                            //    {
                                                                            //        TotalpauseTimeForToolTip = TotalpauseTimeForToolTip + (ShiftEndTime - EndTimeIndouble);
                                                                            //        LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                            //        UnLoggBar.StartValue = new RangeValue(EndTimeIndouble);
                                                                            //        UnLoggBar.EndValue = new RangeValue(ShiftEndTime);
                                                                            //        UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                            //        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                            //        UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                            //        linearScale.Ranges.Add(UnLoggBar);
                                                                            //    }
                                                                            //}
                                                                        }
                                                                    }
                                                                }

                                                                #endregion
                                                            }
                                                            #endregion


                                                            #region Break Time
                                                            //var BreakTimeData = (from a in employeelist
                                                            //                         //where a.BreakStartTime>= employee.ShiftStartTime && a.BreakEndTime<= employee.ShiftEndTime
                                                            //                     where a.BreakStartTime >= BarStartTime && a.BreakEndTime <= BarEndTime && a.BreakStartDate.Value.Date == StartDate.Date
                                                            //                     select new
                                                            //                     {
                                                            //                         a.BreakStartTime,
                                                            //                         a.BreakEndTime,
                                                            //                         a.PauseType,
                                                            //                         a.PauseTypeColor

                                                            //                     }).Distinct().ToList();

                                                            //var employeeBreakNotnulllist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.BreakStartDate != null).OrderBy(a => a.BreakStartDate).ToList();
                                                            //var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.BreakStartDate.Value.Date == StartDate.Date).OrderBy(a => a.BreakStartDate).ToList();
                                                            #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                            //var employeeBreakNotnulllist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.BreakStartDate != null).OrderBy(a => a.BreakStartDate).ToList();
                                                            //var employeeBreakNotnulllist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.BreakStartDate != null).OrderBy(a => a.BreakStartDate).ToList();

                                                            var employeeBreakNotnulllist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.BreakStartDate != null).OrderBy(a => a.BreakStartDate).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                                            #endregion
                                                            //var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && (a.IsNightShift == 1 ? (a.BreakStartDate.Value.Date == itemDate.Key.Date || a.BreakStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.BreakStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.BreakStartDate).ToList();
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            //var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && (a.IsNightShift == 1 ? (a.BreakStartDate.Value.Date == itemDate.Key.Date || a.BreakStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.BreakStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.BreakStartDate).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                                            //var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key &&
                                                            //(
                                                            //a.IsNightShift == 1 ?
                                                            //(a.ShiftStartTime <= tmpStartTimeCheck ? a.BreakStartDate.Value.Date == itemDate.Key.Date :
                                                            //(a.BreakStartDate.Value.Date == itemDate.Key.Date || a.BreakStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                            //) : a.BreakStartDate.Value.Date == itemDate.Key.Date
                                                            //)
                                                            //).OrderBy(a => a.BreakStartDate).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                                            var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key &&
                                                          (a.IsNightShift == 1 ?
                                                            (a.BreakStartDate.Value >= itemDate.Key.Date.Add(a.ShiftStartTime.Subtract(TimeSpan.FromHours(2)))
                                                            && a.BreakEndDate.Value < itemDate.Key.Date.AddDays(1).Date.Add(a.ShiftStartTime))
                                                            : a.BreakStartDate.Value.Date == itemDate.Key.Date)
                                                           ).OrderBy(a => a.BreakStartDate).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                                            #endregion

                                                            //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            #region [GEOS2-7902][gulab lakade][23 04 2025]
                                                            //var BreakTimeData = employeeBreaklist.Where(test => test.BreakStartTime != null).GroupBy(test => test.BreakStartTime)
                                                            //                               .Select(grp => grp.FirstOrDefault())
                                                            //                               .OrderBy(a => a.BreakStartTime)
                                                            //                               .ToList();

                                                            var BreakTimeData = employeeBreaklist.Where(test => test.BreakStartTime != null).GroupBy(test => test.BreakStartTime)
                                                                                          .Select(grp => grp.FirstOrDefault())
                                                                                          .OrderBy(a => a.BreakStartDate)
                                                                                          .ToList();

                                                            //var BreakTimeData = employeeBreaklist.Where(test => test.BreakStartTime != null).GroupBy(test => test.BreakStartDate)
                                                            //    .Select(grp => grp.OrderByDescending(x => x.PauseTypeId == 2273 || x.PauseTypeId== 2274) // priority 1
                                                            //    .ThenBy(x => x.PauseTypeId == 1725)                    // priority 2
                                                            //    .FirstOrDefault()) // pick the best one
                                                            //    .OrderBy(a => a.BreakStartDate).ToList();
                                                            #endregion 
                                                            if (BreakTimeData.Count() > 0)
                                                            {
                                                                #region [GEOS2-5394][gulab lakade][19 02 2024]
                                                                var GroupbyPouseType = BreakTimeData.GroupBy(x => x.PauseType).ToList();
                                                                if (GroupbyPouseType != null && GroupbyPouseType.Count() > 0)
                                                                {
                                                                    foreach (var pauseitem in GroupbyPouseType)
                                                                    {
                                                                        var RecordByPuaseType = BreakTimeData.Where(a => a.PauseType == pauseitem.Key).ToList();
                                                                        if (RecordByPuaseType != null && RecordByPuaseType.Count() > 0)
                                                                        {
                                                                            double TemppauseIndouble = 0;
                                                                            string Breakname = string.Empty;
                                                                            foreach (var record in RecordByPuaseType)
                                                                            {
                                                                                var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == record.PauseType).FirstOrDefault();
                                                                                if (TempBreakRecord != null)
                                                                                {
                                                                                    double pauseStartTimeIndouble = Math.Round((Convert.ToDouble(record.BreakStartTime.TotalMinutes) / 60), 4);
                                                                                    double pauseEndTimeIndouble = Math.Round((Convert.ToDouble(record.BreakEndTime.TotalMinutes) / 60), 4);
                                                                                    Breakname = TempBreakRecord.Name;
                                                                                    TemppauseIndouble = TemppauseIndouble + (pauseEndTimeIndouble - pauseStartTimeIndouble);

                                                                                }

                                                                            }

                                                                            double TemppauseIndouble1 = 0;
                                                                            string Breakname1 = string.Empty;

                                                                            foreach (var record in RecordByPuaseType)
                                                                            {

                                                                                var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == record.PauseType).FirstOrDefault();
                                                                                if (TempBreakRecord != null)
                                                                                {
                                                                                    double pauseStartTimeIndouble = Math.Round((Convert.ToDouble(record.BreakStartTime.TotalMinutes) / 60), 4);
                                                                                    double pauseEndTimeIndouble = Math.Round((Convert.ToDouble(record.BreakEndTime.TotalMinutes) / 60), 4);
                                                                                    Breakname1 = TempBreakRecord.Name + "_" + TempBreakRecord.IdLookupValue;//Aishwarya Ingale[Geos2-5853]
                                                                                    TemppauseIndouble1 = TemppauseIndouble1 + (pauseEndTimeIndouble - pauseStartTimeIndouble);

                                                                                }
                                                                            }


                                                                            if (!String.IsNullOrWhiteSpace(Breakname))
                                                                            {
                                                                                TimeSpan BreakTime = TimeSpan.FromHours(Convert.ToDouble(TemppauseIndouble));
                                                                                dr[Breakname] = Convert.ToString(BreakTime.Add(-TimeSpan.FromMilliseconds(BreakTime.Milliseconds)));

                                                                            }

                                                                            if (!String.IsNullOrWhiteSpace(Breakname1))
                                                                            {
                                                                                TimeSpan BreakTime1 = TimeSpan.FromHours(Convert.ToDouble(TemppauseIndouble1));
                                                                                dr[Breakname1] = Convert.ToString(BreakTime1.Add(-TimeSpan.FromMilliseconds(BreakTime1.Milliseconds)));

                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                #endregion
                                                                // [GEOS2-7902][gulab lakade][23 04 2025]
                                                                //TimeSpan LastEndTime = new TimeSpan();
                                                                //LastEndTime = TimeSpan.Zero;
                                                                DateTime? LastEndTime = Convert.ToDateTime("1900-01-01");
                                                                //[GEOS2-7902][gulab lakade] [23 04 2025]
                                                                foreach (var breakitem in BreakTimeData)
                                                                {
                                                                    bool checkDuplicateValue = true;
                                                                    //if (LastEndTime != TimeSpan.Zero)
                                                                    if (LastEndTime == Convert.ToDateTime("1900-01-01"))
                                                                    {
                                                                        //if (LastEndTime <= breakitem.BreakStartTime)
                                                                        if (LastEndTime <= breakitem.BreakStartDate)
                                                                        {
                                                                            checkDuplicateValue = false;
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        checkDuplicateValue = false;
                                                                    }

                                                                    if (checkDuplicateValue == false)
                                                                    {
                                                                        //LastEndTime = breakitem.BreakEndTime;
                                                                        LastEndTime = breakitem.BreakEndDate;

                                                                        //TimeSpan totalDuration = TimeSpan.Zero;
                                                                        double BreakStartTimeIndouble = 0.0;
                                                                        double BreakEndTimeIndouble = 0.0;

                                                                        //var downloadTransferredTimes3 = BreakTimeData.Where(x => x.PauseType == "Download" || x.PauseType == "Transferred" && x.SiteName == employee.SiteName && x.EmployeeCode == employee.EmployeeCode && x.StageCode == employee.StageCode).ToList(); //&& (x.BreakStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.BreakStartDate .Value.Date == StartDate.Date)
                                                                        //if (downloadTransferredTimes3 != null)
                                                                        //{
                                                                        if (breakitem.PauseType == "Download" || breakitem.PauseType == "Transferred")
                                                                        {

                                                                            TimeSpan duration = breakitem.CounterPartEndTime - breakitem.CounterPartStartTime;
                                                                            BreakStartTimeIndouble = Math.Round((Convert.ToDouble(breakitem.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                            BreakEndTimeIndouble = Math.Round((Convert.ToDouble(breakitem.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                        }
                                                                        else
                                                                        {
                                                                            BreakStartTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakStartTime.TotalMinutes) / 60), 4);
                                                                            BreakEndTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakEndTime.TotalMinutes) / 60), 4);
                                                                        }
                                                                        //}
                                                                        //else
                                                                        //{
                                                                        //    BreakStartTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakStartTime.TotalMinutes) / 60), 4);
                                                                        //    BreakEndTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakEndTime.TotalMinutes) / 60), 4);
                                                                        //}

                                                                        //TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                        {
                                                                            #region Linear
                                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                                            {
                                                                                if (breakitem.PauseType == "Maintenance")
                                                                                {
                                                                                    MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                }
                                                                                LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                #region [wrong break time in EAMX Luis suggest][Gulab lakade][23 08 2024]
                                                                                if (BreakStartTimeIndouble <= BreakEndTimeIndouble)
                                                                                {
                                                                                    BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                }
                                                                                else
                                                                                {
                                                                                    BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                                }
                                                                                #endregion
                                                                                BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);

                                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                {
                                                                                    Pausetimecolor = "#00FF00";
                                                                                }
                                                                                BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "pauseType";
                                                                                //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                string BreakType = string.Empty;
                                                                                if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                {
                                                                                    BreakType = Convert.ToString(breakitem.PauseType);
                                                                                }
                                                                                else
                                                                                {
                                                                                    BreakType = "Break";
                                                                                }
                                                                                SelectedTooltips.ToolTipsType = BreakType;
                                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                                #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                {
                                                                                    SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                }
                                                                                if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                {
                                                                                    SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                }
                                                                                #endregion
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearScale.Ranges.Add(BreakLoggBar);
                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                try
                                                                                {
                                                                                    var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                    var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                    if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                        var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        if (TempBreakRecord != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        }
                                                                                        else if (TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        }
                                                                                        #endregion

                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    }
                                                                                }
                                                                                catch (Exception ex)
                                                                                {
                                                                                    GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                }
                                                                                #endregion
                                                                            }
                                                                            #endregion
                                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                            //else

                                                                            //    if (BreakStartTimeIndouble >= (employee.ShiftEndTime).TotalHours && BreakEndTimeIndouble >= (employee.ShiftEndTime).TotalHours)
                                                                            //{
                                                                            //    if (breakitem.PauseType == "Maintenance")
                                                                            //    {
                                                                            //        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                            //    }


                                                                            //    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                            //    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                            //    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                            //    #region [wrong break time in EAMX Luis suggest][Gulab lakade][23 08 2024]
                                                                            //    //if (BarEndValue >= BreakEndTimeIndouble)
                                                                            //    //{
                                                                            //    //    BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                            //    //}
                                                                            //    //else 
                                                                            //    //{
                                                                            //    //    BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                            //    //}

                                                                            //    if (BreakStartTimeIndouble <= BreakEndTimeIndouble)
                                                                            //    {
                                                                            //        BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                            //    }
                                                                            //    else
                                                                            //    {
                                                                            //        BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                            //    }
                                                                            //    #endregion
                                                                            //    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                            //    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);

                                                                            //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                            //    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                            //    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                            //    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                            //    {
                                                                            //        Pausetimecolor = "#00FF00";
                                                                            //    }
                                                                            //    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                            //    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            //    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            //    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                            //    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                            //    SelectedTooltips.BarTypeName = "pauseType";
                                                                            //    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                            //    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                            //    string BreakType = string.Empty;
                                                                            //    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                            //    {
                                                                            //        BreakType = Convert.ToString(breakitem.PauseType);
                                                                            //    }
                                                                            //    else
                                                                            //    {
                                                                            //        BreakType = "Break";
                                                                            //    }
                                                                            //    SelectedTooltips.ToolTipsType = BreakType;
                                                                            //    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                            //    SelectedTooltips.IdStage = employee.IdStage;
                                                                            //    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                            //    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                            //    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                            //    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                            //    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                            //    {
                                                                            //        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                            //    }
                                                                            //    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                            //    {
                                                                            //        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                            //    }
                                                                            //    #endregion
                                                                            //    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            //    {
                                                                            //        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                            //        {
                                                                            //            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                            //            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                            //            if (Tooltipdata == null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            //            }
                                                                            //        }
                                                                            //        else
                                                                            //        {

                                                                            //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            //        }
                                                                            //    }
                                                                            //    else
                                                                            //    {
                                                                            //        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                            //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            //    }

                                                                            //    #endregion
                                                                            //    linearScale.Ranges.Add(BreakLoggBar);
                                                                            //    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                            //    try
                                                                            //    {
                                                                            //        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                            //        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                            //        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                            //        {
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                            //            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                            //            if (tempsequence != null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                            //            }
                                                                            //            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                            //            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                            //            if (TempBreakRecord != null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                            //            }
                                                                            //            else if (TempBreakRecord1 != null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                            //            }
                                                                            //            #endregion

                                                                            //            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                            //            }
                                                                            //            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                            //        }
                                                                            //    }
                                                                            //    catch (Exception ex)
                                                                            //    {
                                                                            //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                            //    }
                                                                            //    #endregion

                                                                            //}
                                                                            #endregion
                                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                            else
                                                                            {
                                                                                if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftStartDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftStartDate.Value.Date))
                                                                                {
                                                                                    if (breakitem.PauseType == "Maintenance")
                                                                                    {
                                                                                        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                    }
                                                                                    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                    #region [wrong break time in EAMX Luis suggest][Gulab lakade][23 08 2024]
                                                                                    if (BreakStartTimeIndouble <= BreakEndTimeIndouble)
                                                                                    {
                                                                                        BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                                    }
                                                                                    #endregion
                                                                                    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);

                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                    {
                                                                                        Pausetimecolor = "#00FF00";
                                                                                    }
                                                                                    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "pauseType";
                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    string BreakType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                    {
                                                                                        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakType = "Break";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = BreakType;
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                    {
                                                                                        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                    }
                                                                                    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                    {
                                                                                        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                    }
                                                                                    #endregion
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearScale.Ranges.Add(BreakLoggBar);
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    try
                                                                                    {
                                                                                        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            if (TempBreakRecord != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            else if (TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            #endregion

                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                    #endregion
                                                                                }
                                                                                else
                                                                                {
                                                                                    if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftStartDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftEndDate.Value.Date))
                                                                                    {
                                                                                        #region LinearScale
                                                                                        if (breakitem.PauseType == "Maintenance")
                                                                                        {
                                                                                            MaintanceTimeIndouble = MaintanceTimeIndouble + (24 - BreakStartTimeIndouble);
                                                                                        }
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        try
                                                                                        {
                                                                                            var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                            var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                            if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((24 - BreakStartTimeIndouble), 4);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }

                                                                                                #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                                var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                if (TempBreakRecord != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                else if (TempBreakRecord1 != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                #endregion
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            }
                                                                                        }
                                                                                        catch (Exception ex)
                                                                                        {
                                                                                            GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                        }
                                                                                        #endregion

                                                                                        LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                        //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                        BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                        BreakLoggBar.EndValue = new RangeValue(24);
                                                                                        BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (24 - BreakStartTimeIndouble);
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                        string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                        if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                        {
                                                                                            Pausetimecolor = "#00FF00";
                                                                                        }
                                                                                        BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                        SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                        SelectedTooltips.BarTypeName = "pauseType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        string BreakType = string.Empty;
                                                                                        if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                        {
                                                                                            BreakType = Convert.ToString(breakitem.PauseType);
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            BreakType = "Break";
                                                                                        }
                                                                                        SelectedTooltips.ToolTipsType = BreakType;
                                                                                        SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips.IdStage = employee.IdStage;
                                                                                        #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                        SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                        SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                        SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                        if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                        {
                                                                                            SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                        }
                                                                                        if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                        {
                                                                                            SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                        }
                                                                                        #endregion
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == 24 && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }

                                                                                        #endregion
                                                                                        linearScale.Ranges.Add(BreakLoggBar);
                                                                                        #endregion
                                                                                        #region NightShift
                                                                                        if (breakitem.PauseType == "Maintenance")
                                                                                        {
                                                                                            MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - 0);
                                                                                        }
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        try
                                                                                        {
                                                                                            var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                            var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                            if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - 0), 4);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                                var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                if (TempBreakRecord != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                else if (TempBreakRecord1 != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                #endregion
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            }
                                                                                        }
                                                                                        catch (Exception ex)
                                                                                        {
                                                                                            GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                        }
                                                                                        #endregion

                                                                                        LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                        //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                        NightBreakLoggBar.StartValue = new RangeValue(0);
                                                                                        NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                        NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - 0);
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                        string Pausetimecolor1 = breakitem.PauseTypeColor;
                                                                                        if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                        {
                                                                                            Pausetimecolor = "#00FF00";
                                                                                        }
                                                                                        NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips1.ToolTipsStartTime = 0;
                                                                                        SelectedTooltips1.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                        SelectedTooltips1.BarTypeName = "pauseType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        string BreakType1 = string.Empty;
                                                                                        if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                        {
                                                                                            BreakType1 = Convert.ToString(breakitem.PauseType);
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            BreakType1 = "Break";
                                                                                        }
                                                                                        SelectedTooltips1.ToolTipsType = BreakType;
                                                                                        SelectedTooltips1.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips1.IdStage = employee.IdStage;
                                                                                        #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                        SelectedTooltips1.NonOT_Name = breakitem.NonOT_Name;
                                                                                        SelectedTooltips1.PauseTypeId = breakitem.PauseTypeId;
                                                                                        SelectedTooltips1.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                        if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                        {
                                                                                            SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                        }
                                                                                        if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                        {
                                                                                            SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                        }
                                                                                        #endregion
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == 0 && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType1 && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                        }
                                                                                        #endregion
                                                                                        linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                        #endregion
                                                                                    }
                                                                                    else if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftEndDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftEndDate.Value.Date))
                                                                                    {
                                                                                        #region NightShift
                                                                                        if (breakitem.PauseType == "Maintenance")
                                                                                        {
                                                                                            MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                        }

                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        try
                                                                                        {
                                                                                            var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                            var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                            if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                                var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                if (TempBreakRecord != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                else if (TempBreakRecord1 != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                #endregion
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            }
                                                                                        }
                                                                                        catch (Exception ex)
                                                                                        {
                                                                                            GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                        }
                                                                                        #endregion
                                                                                        LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                        //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                        NightBreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                        NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                        NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                        string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                        if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                        {
                                                                                            Pausetimecolor = "#00FF00";
                                                                                        }
                                                                                        NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                        SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                        SelectedTooltips.BarTypeName = "pauseType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        string BreakType = string.Empty;
                                                                                        if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                        {
                                                                                            BreakType = Convert.ToString(breakitem.PauseType);
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            BreakType = "Break";
                                                                                        }
                                                                                        SelectedTooltips.ToolTipsType = BreakType;
                                                                                        SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips.IdStage = employee.IdStage;
                                                                                        #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                        SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                        SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                        SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                        if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                        {
                                                                                            SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                        }
                                                                                        if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                        {
                                                                                            SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                        }
                                                                                        #endregion
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                        #endregion
                                                                                        linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                        #endregion
                                                                                    }

                                                                                }
                                                                                #endregion
                                                                                #region [GEOS2-7755][gulab lakade][08 04 2025]




                                                                                //if (BreakStartTimeIndouble >= (employee.ShiftEndTime).TotalHours && BreakEndTimeIndouble <= (employee.ShiftEndTime).TotalHours)
                                                                                //{
                                                                                //    #region LinearScale
                                                                                //    if (breakitem.PauseType == "Maintenance")
                                                                                //    {
                                                                                //        MaintanceTimeIndouble = MaintanceTimeIndouble + (24 - BreakStartTimeIndouble);
                                                                                //    }
                                                                                //    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                //    try
                                                                                //    {
                                                                                //        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                //        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                //        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                //        {
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((24 - BreakStartTimeIndouble), 4);
                                                                                //            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                //            if (tempsequence != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                //            }

                                                                                //            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                //            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            if (TempBreakRecord != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            else if (TempBreakRecord1 != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            #endregion
                                                                                //            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                //            }
                                                                                //            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                //        }
                                                                                //    }
                                                                                //    catch (Exception ex)
                                                                                //    {
                                                                                //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                //    }
                                                                                //    #endregion

                                                                                //    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                //    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                //    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                //    BreakLoggBar.EndValue = new RangeValue(24);
                                                                                //    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                //    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (24 - BreakStartTimeIndouble);
                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                //    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                //    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                //    {
                                                                                //        Pausetimecolor = "#00FF00";
                                                                                //    }
                                                                                //    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                //    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                //    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                //    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                //    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                //    SelectedTooltips.BarTypeName = "pauseType";
                                                                                //    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                //    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //    string BreakType = string.Empty;
                                                                                //    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                //    {
                                                                                //        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        BreakType = "Break";
                                                                                //    }
                                                                                //    SelectedTooltips.ToolTipsType = BreakType;
                                                                                //    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                //    SelectedTooltips.IdStage = employee.IdStage;
                                                                                //    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                //    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                //    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                //    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                //    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                //    {
                                                                                //        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                //    }
                                                                                //    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                //    {
                                                                                //        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                //    }
                                                                                //    #endregion
                                                                                //    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                //    {
                                                                                //        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                //        {
                                                                                //            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                //            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == 24 && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //            if (Tooltipdata == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //            }
                                                                                //        }
                                                                                //        else
                                                                                //        {

                                                                                //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //        }
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //    }

                                                                                //    #endregion
                                                                                //    linearScale.Ranges.Add(BreakLoggBar);
                                                                                //    #endregion

                                                                                //    #region NightShift
                                                                                //    if (breakitem.PauseType == "Maintenance")
                                                                                //    {
                                                                                //        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - 0);
                                                                                //    }
                                                                                //    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                //    try
                                                                                //    {
                                                                                //        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                //        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                //        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                //        {
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - 0), 4);
                                                                                //            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                //            if (tempsequence != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                //            }
                                                                                //            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                //            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            if (TempBreakRecord != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            else if (TempBreakRecord1 != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            #endregion
                                                                                //            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                //            }
                                                                                //            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                //        }
                                                                                //    }
                                                                                //    catch (Exception ex)
                                                                                //    {
                                                                                //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                //    }
                                                                                //    #endregion

                                                                                //    LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                //    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                //    NightBreakLoggBar.StartValue = new RangeValue(0);
                                                                                //    NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                //    NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                //    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - 0);
                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                //    string Pausetimecolor1 = breakitem.PauseTypeColor;
                                                                                //    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                //    {
                                                                                //        Pausetimecolor = "#00FF00";
                                                                                //    }
                                                                                //    NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                //    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                //    ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                //    SelectedTooltips1.ToolTipsStartTime = 0;
                                                                                //    SelectedTooltips1.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                //    SelectedTooltips1.BarTypeName = "pauseType";
                                                                                //    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                //    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //    string BreakType1 = string.Empty;
                                                                                //    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                //    {
                                                                                //        BreakType1 = Convert.ToString(breakitem.PauseType);
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        BreakType1 = "Break";
                                                                                //    }
                                                                                //    SelectedTooltips1.ToolTipsType = BreakType;
                                                                                //    SelectedTooltips1.IdEmployee = employee.IdEmployee;
                                                                                //    SelectedTooltips1.IdStage = employee.IdStage;
                                                                                //    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                //    SelectedTooltips1.NonOT_Name = breakitem.NonOT_Name;
                                                                                //    SelectedTooltips1.PauseTypeId = breakitem.PauseTypeId;
                                                                                //    SelectedTooltips1.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                //    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                //    {
                                                                                //        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                //    }
                                                                                //    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                //    {
                                                                                //        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                //    }
                                                                                //    #endregion
                                                                                //    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                //    {
                                                                                //        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                //        {
                                                                                //            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                //            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == 0 && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType1 && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //            if (Tooltipdata == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                //            }
                                                                                //        }
                                                                                //        else
                                                                                //        {

                                                                                //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                //        }
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                //    }
                                                                                //    #endregion
                                                                                //    linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                //    #endregion


                                                                                //}
                                                                                //else
                                                                                //{
                                                                                //    #region NightShift
                                                                                //    if (breakitem.PauseType == "Maintenance")
                                                                                //    {
                                                                                //        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                //    }

                                                                                //    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                //    try
                                                                                //    {
                                                                                //        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                //        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                //        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                //        {
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                //            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                //            if (tempsequence != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                //            }
                                                                                //            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                //            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            if (TempBreakRecord != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            else if (TempBreakRecord1 != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            #endregion
                                                                                //            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                //            }
                                                                                //            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                //        }
                                                                                //    }
                                                                                //    catch (Exception ex)
                                                                                //    {
                                                                                //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                //    }
                                                                                //    #endregion
                                                                                //    LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                //    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                //    NightBreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                //    NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                //    NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                //    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                //    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                //    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                //    {
                                                                                //        Pausetimecolor = "#00FF00";
                                                                                //    }
                                                                                //    NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                //    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                //    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                //    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                //    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                //    SelectedTooltips.BarTypeName = "pauseType";
                                                                                //    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                //    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //    string BreakType = string.Empty;
                                                                                //    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                //    {
                                                                                //        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        BreakType = "Break";
                                                                                //    }
                                                                                //    SelectedTooltips.ToolTipsType = BreakType;
                                                                                //    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                //    SelectedTooltips.IdStage = employee.IdStage;
                                                                                //    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                //    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                //    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                //    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                //    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                //    {
                                                                                //        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                //    }
                                                                                //    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                //    {
                                                                                //        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                //    }
                                                                                //    #endregion
                                                                                //    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                //    {
                                                                                //        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                //        {
                                                                                //            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                //            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //            if (Tooltipdata == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //            }
                                                                                //        }
                                                                                //        else
                                                                                //        {

                                                                                //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //        }
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //    }
                                                                                //    #endregion
                                                                                //    linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                //    #endregion
                                                                                //}  


                                                                                #endregion
                                                                            }

                                                                            #endregion

                                                                        }
                                                                        else
                                                                        {
                                                                            if (BarEndValue >= BreakEndTimeIndouble && BarStartValue <= BreakStartTimeIndouble)
                                                                            {

                                                                                if (breakitem.BreakStartTime <= breakitem.BreakEndTime)
                                                                                {
                                                                                    if (breakitem.PauseType == "Maintenance")
                                                                                    {
                                                                                        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                    }
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    try
                                                                                    {
                                                                                        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            if (TempBreakRecord != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            else if (TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            #endregion
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                    #endregion

                                                                                    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                    if (BarEndValue >= BreakEndTimeIndouble)
                                                                                    {
                                                                                        BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                                    }
                                                                                    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                    {
                                                                                        Pausetimecolor = "#00FF00";
                                                                                    }
                                                                                    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "pauseType";
                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    string BreakType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                    {
                                                                                        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakType = "Break";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = BreakType;
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                    {
                                                                                        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                    }
                                                                                    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                    {
                                                                                        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                    }
                                                                                    #endregion
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {

                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearScale.Ranges.Add(BreakLoggBar);
                                                                                }
                                                                            }
                                                                        }
                                                                        #endregion
                                                                    }
                                                                }
                                                            }
                                                            #endregion
                                                            //TotalpauseTimeForToolTip = TotalShiftTime - (TotalLoggedTimeForToolTip + TotalBreakTimeForToolTip);
                                                            //var LoggStartTimeRecord = employeelist.FirstOrDefault();
                                                            //TimeSpan LoggStartTime = new TimeSpan();
                                                            //if (LoggStartTimeRecord != null)
                                                            //{
                                                            //    LoggStartTime = LoggStartTimeRecord.CounterPartStartTime;
                                                            //}

                                                            //var LoggEndTimeRecord = employeelist.LastOrDefault();
                                                            //TimeSpan LoggEndTime = new TimeSpan();
                                                            //if (LoggEndTimeRecord != null)
                                                            //{
                                                            //    LoggEndTime = LoggEndTimeRecord.CounterPartEndTime;
                                                            //}

                                                        }
                                                        #endregion

                                                        #region Attendance

                                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                        //var employeeAttendlist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == StartDate.Date).OrderBy(a => a.AttendanceStartDate).ToList();
                                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                        //var employeeAttendlist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == StartDate.Date).OrderBy(a => a.AttendanceStartDate).ToList();
                                                        #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                        //var employeeAttendlist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == itemDate.Key.Date).OrderBy(a => a.AttendanceStartDate).ToList();
                                                        var employeeAttendlist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.AttendanceStartDate != null && a.AttendanceStartDate >= shiftStartDate && a.AttendanceStartDate <= shiftEndDate).OrderBy(a => a.AttendanceStartDate).ToList();
                                                        #endregion

                                                        //var employeeAttendlist = emp
                                                        //    .Where(a => a.SiteName == plantdata.Key
                                                        //                && a.EmployeeCode == emp.Key
                                                        //                && IdJobdescription.Contains(a.IdJobDescription)
                                                        //                && (
                                                        //                    (a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                        //                    || (a.AttendanceStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                        //                ))
                                                        //    .OrderBy(a => a.AttendanceStartDate == null ? DateTime.MaxValue : a.AttendanceStartDate.Value)  // Handle null AttendanceStartDate
                                                        //    .ThenBy(a => a.LeaveStartDate == null ? DateTime.MaxValue : a.LeaveStartDate.Value)  // Handle null LeaveStartDate
                                                        //    .ToList();

                                                        #endregion
                                                        #endregion
                                                        //if (employeeAttendlist.Count() == 0)
                                                        //{

                                                        //}

                                                        if (employeeAttendlist.Count() > 0)
                                                        {
                                                            var CheckIdUser = employeeAttendlist.Where(a => a.IdUser == null || a.IdUser == 0 && ((a.LeavesAllDayEvent != 1 || a.LeavesAllDayEvent == null) && a.ISHolidayEvent == false)).ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            if (CheckIdUser.Count() == 0)
                                                            {
                                                                #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                                //var employeeLeaveNotnulllist = employeeAttendlist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.LeaveStartDate != null).OrderBy(a => a.LeaveStartDate).ToList();
                                                                //var employeeLeavelist = employeeLeaveNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.LeaveStartDate.Value.Date == StartDate.Date).OrderBy(a => a.LeaveStartDate).ToList();
                                                                var employeeLeaveNotnulllist = employeeAttendlist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.LeaveStartDate != null).OrderBy(a => a.LeaveStartDate).ToList();
                                                                var employeeLeavelist = employeeLeaveNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.LeaveStartDate.Value.Date == itemDate.Key.Date && a.LeavesAllDayEvent == 0).OrderBy(a => a.LeaveStartDate).ToList();
                                                                #endregion
                                                                var Leavedata = employeeLeavelist.GroupBy(test => test.LeaveStartTime)
                                                                                               .Select(grp => grp.First())
                                                                                               .ToList();

                                                                //var Leavedata = (from a in employeeAttendlist
                                                                //                 select new
                                                                //                 {
                                                                //                     a.LeaveStartTime,
                                                                //                     a.LeaveEndTime,
                                                                //                     a.LeaveType,
                                                                //                     a.LeaveTypeColor
                                                                //                 }
                                                                //                ).Distinct().ToList();


                                                                if (Leavedata.Count() > 0)
                                                                {
                                                                    foreach (var leave in Leavedata)
                                                                    {
                                                                        bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                                        // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                                        double LeaveStartTimeIndouble = 0;
                                                                        double LeaveEndTimeIndouble = 0;
                                                                        if (!existTotalAttandance)
                                                                        {
                                                                            LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(leave.LeaveStartTime.TotalMinutes) / 60), 4);
                                                                            LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(leave.LeaveEndTime.TotalMinutes) / 60), 4);
                                                                        }
                                                                        else
                                                                        {
                                                                            LeaveStartTimeIndouble = 0;
                                                                            LeaveEndTimeIndouble = 0;
                                                                        }
                                                                        // double LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(leave.LeaveStartTime.TotalMinutes) / 60), 4);
                                                                        // double LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(leave.LeaveEndTime.TotalMinutes) / 60), 4);
                                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                        {
                                                                            if (LeaveStartTimeIndouble != null)
                                                                            {
                                                                                LinearScaleRangeBar AttendanceLeaveStart = new LinearScaleRangeBar();
                                                                                if (LeaveStartTimeIndouble > LeaveEndTimeIndouble)
                                                                                {
                                                                                    AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                                    AttendanceLeaveStart.AnchorValue = 24;
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = 24;
                                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    string LeaveType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                                    {
                                                                                        LeaveType = leave.LeaveType;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        LeaveType = "Leaves";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = LeaveType;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                }
                                                                                if (LeaveStartTimeIndouble < LeaveEndTimeIndouble)
                                                                                {
                                                                                    AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                                    AttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    string LeaveType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                                    {
                                                                                        LeaveType = leave.LeaveType;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        LeaveType = "Leaves";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = LeaveType;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                }

                                                                                AttendanceLeaveStart.Visible = true;
                                                                                AttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                                // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                string LeaveTimeColor = leave.LeaveTypeColor;
                                                                                if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                                {
                                                                                    LeaveTimeColor = "#000000";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };

                                                                                linearScale.RangeBars.Add(AttendanceLeaveStart);
                                                                            }
                                                                            if (LeaveStartTimeIndouble > LeaveEndTimeIndouble)
                                                                            {
                                                                                #region nightShift
                                                                                LinearScaleRangeBar NightAttendanceLeaveStart = new LinearScaleRangeBar();
                                                                                NightAttendanceLeaveStart.Value = 0;
                                                                                NightAttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                                NightAttendanceLeaveStart.Visible = true;
                                                                                NightAttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                                // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                string LeaveTimeColor = leave.LeaveTypeColor;
                                                                                if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                                {
                                                                                    LeaveTimeColor = "#000000";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                NightAttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = 0;
                                                                                SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "LeaveType";
                                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                                SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                string LeaveType = string.Empty;
                                                                                if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                                {
                                                                                    LeaveType = leave.LeaveType;
                                                                                }
                                                                                else
                                                                                {
                                                                                    LeaveType = "Leaves";
                                                                                }
                                                                                SelectedTooltips.ToolTipsType = LeaveType;
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearnightScale.RangeBars.Add(NightAttendanceLeaveStart);
                                                                                #endregion
                                                                            }
                                                                        }
                                                                        else if (employee.LeavesAllDayEvent != 1)//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                                        {
                                                                            LinearScaleRangeBar AttendanceLeaveStart = new LinearScaleRangeBar();
                                                                            AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                            AttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                            AttendanceLeaveStart.Visible = true;
                                                                            AttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                            // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                            string LeaveTimeColor = leave.LeaveTypeColor;
                                                                            if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                            {
                                                                                LeaveTimeColor = "#000000";
                                                                            }
                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                            AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };
                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                            SelectedTooltips.BarTypeName = "LeaveType";
                                                                            SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                            SelectedTooltips.IdStage = employee.IdStage;
                                                                            SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                            string LeaveType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                            {
                                                                                LeaveType = leave.LeaveType;
                                                                            }
                                                                            else
                                                                            {
                                                                                LeaveType = "Leaves";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = LeaveType;
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }

                                                                            #endregion
                                                                            linearScale.RangeBars.Add(AttendanceLeaveStart);
                                                                        }

                                                                        #endregion

                                                                    }
                                                                }
                                                                var Attendancedata = employeeAttendlist
                                                                        .Where(a => a.AttendanceStartDate.HasValue)
                                                                        .GroupBy(test => test.AttendanceStartDate.Value.TimeOfDay)
                                                                        .Select(grp => grp.First())
                                                                        .ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                                if (Attendancedata.Count() > 0)
                                                                {
                                                                    foreach (var Attend in Attendancedata)
                                                                    {
                                                                        //TotalAttendanceWithoutLeave = TotalAttendanceHours;
                                                                        // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate!=null && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                                        bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                                        double AttenadnceStartTimeIndouble = 0;
                                                                        double AttenadnceEndTimeIndouble = 0;
                                                                        if (!existTotalAttandance)
                                                                        {
                                                                            AttenadnceStartTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceStartDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                            AttenadnceEndTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceEndDate.Value.TimeOfDay.TotalMinutes) / 60), 2);

                                                                        }

                                                                        // double AttenadnceStartTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceStartDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                        // double AttenadnceEndTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceEndDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                        //double AttenadnceStartTimeIndouble = Math.Round(Attend.AttendanceStartDate.Value.TimeOfDay.TotalHours,2);
                                                                        //double AttenadnceEndTimeIndouble = Math.Round(Attend.AttendanceEndDate.Value.TimeOfDay.TotalHours,2);
                                                                        //TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);
                                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                        {
                                                                            if (AttenadnceStartTimeIndouble != null)
                                                                            {
                                                                                LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                                //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                                //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                                if (AttenadnceStartTimeIndouble < AttenadnceEndTimeIndouble)
                                                                                {
                                                                                    Attendance.Value = AttenadnceStartTimeIndouble;
                                                                                    Attendance.AnchorValue = AttenadnceEndTimeIndouble;

                                                                                    TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);


                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "AttendanceType";
                                                                                    SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    string AttendenceType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                                    {
                                                                                        AttendenceType = Attend.AttendanceType;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        AttendenceType = "Attendance";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = AttendenceType;
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                }
                                                                                if (AttenadnceStartTimeIndouble > AttenadnceEndTimeIndouble)
                                                                                {
                                                                                    Attendance.Value = AttenadnceStartTimeIndouble;
                                                                                    Attendance.AnchorValue = 24;

                                                                                    TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (24 - AttenadnceStartTimeIndouble);


                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = 24;
                                                                                    SelectedTooltips.BarTypeName = "AttendanceType";
                                                                                    SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    string AttendenceType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                                    {
                                                                                        AttendenceType = Attend.AttendanceType;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        AttendenceType = "Attendance";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = AttendenceType;
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                }
                                                                                Attendance.Visible = true;
                                                                                Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                                string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                                if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                                {
                                                                                    AttendanceTimeColor = "#000000";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                                #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                                                if (shiftStartDate.Value.Date == Attend.AttendanceStartDate.Value.Date)
                                                                                {
                                                                                    linearScale.RangeBars.Add(Attendance);
                                                                                }
                                                                                else if (shiftEndDate.Value.Date == Attend.AttendanceEndDate.Value.Date)
                                                                                {
                                                                                    linearnightScale.RangeBars.Add(Attendance);
                                                                                }

                                                                                #endregion

                                                                            }
                                                                            if (AttenadnceEndTimeIndouble < AttenadnceStartTimeIndouble)
                                                                            {
                                                                                #region Night

                                                                                TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - 0);


                                                                                LinearScaleRangeBar NightAttendance = new LinearScaleRangeBar();
                                                                                //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                                //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                                NightAttendance.Value = 0;
                                                                                NightAttendance.AnchorValue = AttenadnceEndTimeIndouble;
                                                                                NightAttendance.Visible = true;
                                                                                NightAttendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                                NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                                string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                                if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                                {
                                                                                    AttendanceTimeColor = "#000000";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = 0;
                                                                                SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "AttendanceType";
                                                                                SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                string AttendenceType = string.Empty;
                                                                                if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                                {
                                                                                    AttendenceType = Attend.AttendanceType;
                                                                                }
                                                                                else
                                                                                {
                                                                                    AttendenceType = "Attendance";
                                                                                }
                                                                                SelectedTooltips.ToolTipsType = AttendenceType;
                                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearnightScale.RangeBars.Add(NightAttendance);
                                                                                #endregion
                                                                            }
                                                                        }
                                                                        else
                                                                        {

                                                                            TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);


                                                                            LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                            //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                            //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                            Attendance.Value = AttenadnceStartTimeIndouble;
                                                                            Attendance.AnchorValue = AttenadnceEndTimeIndouble;
                                                                            Attendance.Visible = true;
                                                                            Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                            Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                            string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                            if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                            {
                                                                                AttendanceTimeColor = "#000000";
                                                                            }
                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                            Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                            SelectedTooltips.BarTypeName = "AttendanceType";
                                                                            SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                            string AttendenceType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                            {
                                                                                AttendenceType = Attend.AttendanceType;
                                                                            }
                                                                            else
                                                                            {
                                                                                AttendenceType = "Attendance";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = AttendenceType;
                                                                            SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                            SelectedTooltips.IdStage = employee.IdStage;
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }

                                                                            #endregion
                                                                            linearScale.RangeBars.Add(Attendance);
                                                                        }
                                                                        #endregion

                                                                    }
                                                                }
                                                            }

                                                        }
                                                        else
                                                        {

                                                            #region if Attendance is null
                                                            if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                            {
                                                                //ShiftEndTime - ShiftStartTime;

                                                                LinearScaleRangeBar Attendance = new LinearScaleRangeBar();


                                                                //if (ShiftStartTime > ShiftEndTime)//[GEOS2-7755][gulab lakade][16 04 2025]
                                                                //{
                                                                Attendance.Value = ShiftStartTime;
                                                                //Attendance.AnchorValue = 24;
                                                                //TotalAttendanceWithoutLeave = (24 - ShiftStartTime);
                                                                Attendance.AnchorValue = (ShiftStartTime + 0.10);
                                                                //TotalAttendanceWithoutLeave = (24 - ShiftStartTime);
                                                                TotalAttendanceWithoutLeave = (0);
                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                SelectedTooltips.ToolTipsStartTime = ShiftStartTime;
                                                                //SelectedTooltips.ToolTipsEndTime = 24;
                                                                SelectedTooltips.ToolTipsEndTime = (ShiftStartTime + 0.10);
                                                                SelectedTooltips.BarTypeName = "AttendanceType";
                                                                SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);
                                                                string AttendenceType = string.Empty;
                                                                AttendenceType = "Attendance";
                                                                SelectedTooltips.ToolTipsType = AttendenceType;
                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                {
                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                    {
                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == ShiftStartTime && x.ToolTipsEndTime == 24 && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                        if (Tooltipdata == null)
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                }

                                                                #endregion
                                                                Attendance.Visible = true;
                                                                Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                                string AttendanceTimeColor = "#000000";
                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };

                                                                linearScale.RangeBars.Add(Attendance);
                                                                // }//[GEOS2-7755][gulab lakade][16 04 2025]


                                                                if (ShiftEndTime < ShiftStartTime)
                                                                {
                                                                    //#region Night
                                                                    //TotalAttendanceWithoutLeave = (ShiftEndTime - 0);
                                                                    //LinearScaleRangeBar NightAttendance = new LinearScaleRangeBar();
                                                                    ////Attendance.Value = AttenadnceEndTimeIndouble;
                                                                    ////Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                    //NightAttendance.Value = 0;
                                                                    //NightAttendance.AnchorValue = ShiftEndTime;
                                                                    //NightAttendance.Visible = true;
                                                                    //NightAttendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    //NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                    //string AttendanceTimeColor = "#000000";
                                                                    ////LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    //NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    //#region Tool Tips [Gulab lakade][24 01 2024]
                                                                    //ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    //SelectedTooltips.ToolTipsStartTime = 0;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    //SelectedTooltips.BarTypeName = "AttendanceType";
                                                                    //SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);
                                                                    //string AttendenceType = string.Empty;
                                                                    //AttendenceType = "Attendance";
                                                                    //SelectedTooltips.ToolTipsType = AttendenceType;
                                                                    //SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                    //SelectedTooltips.IdStage = employee.IdStage;
                                                                    //if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    //{
                                                                    //    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                    //    {
                                                                    //        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == 0 && x.ToolTipsEndTime == ShiftEndTime && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                    //        if (Tooltipdata == null)
                                                                    //        {
                                                                    //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    //        }
                                                                    //    }
                                                                    //    else
                                                                    //    {
                                                                    //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    //    }
                                                                    //}
                                                                    //else
                                                                    //{
                                                                    //    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                    //    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    //}

                                                                    //#endregion
                                                                    //linearnightScale.RangeBars.Add(NightAttendance);
                                                                    //#endregion
                                                                }
                                                            }
                                                            #region [GEOS2-6965][rani dhamankar][12-03-2025]
                                                            else if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false)//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            {
                                                                if (employee.IsNightShift == 1)  //[GEOS2-8189][rani dhamankar] [03 - 06 - 2025]
                                                                {

                                                                    double LeaveStartTimeIndouble = 0;
                                                                    double LeaveEndTimeIndouble = 0;
                                                                    LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(employee.LeaveStartTime.TotalMinutes) / 60), 4);
                                                                    LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(employee.LeaveEndTime.TotalMinutes) / 60), 4);
                                                                    TotalAttendanceWithoutLeave = 0;
                                                                    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                    Attendance.Value = LeaveStartTimeIndouble;

                                                                    Attendance.AnchorValue = 24;
                                                                    Attendance.Visible = true;
                                                                    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                    string AttendanceTimeColor = employee.LeaveTypeColor;
                                                                    if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                    {
                                                                        AttendanceTimeColor = "#000000";
                                                                    }
                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    SelectedTooltips.ToolTipsEndTime = 24;
                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                    SelectedTooltips.AttendanceStartDate = (employee.LeaveStartDate == null ? employee.LeaveStartDate : employee.LeaveEndDate);
                                                                    string AttendenceType = string.Empty;
                                                                    AttendenceType = "Leave";
                                                                    SelectedTooltips.ToolTipsType = employee.LeaveType;
                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == AttendenceType && x.LeaveStartDate == (employee.LeaveStartDate == null ? employee.LeaveEndDate : employee.LeaveStartDate) && x.IdEmployee == employee.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }
                                                                    LinearScaleRangeBar NightAttendance = new LinearScaleRangeBar();
                                                                    NightAttendance.Value = 0;

                                                                    NightAttendance.AnchorValue = LeaveEndTimeIndouble;
                                                                    NightAttendance.Visible = true;
                                                                    NightAttendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    ProductionTimeLineToolTipdata NightShiftSelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    NightShiftSelectedTooltips.ToolTipsStartTime = 0;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    NightShiftSelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                    NightShiftSelectedTooltips.BarTypeName = "LeaveType";
                                                                    NightShiftSelectedTooltips.AttendanceStartDate = (employee.LeaveStartDate == null ? employee.LeaveStartDate : employee.LeaveEndDate);
                                                                    string NightShiftAttendenceType = string.Empty;
                                                                    NightShiftAttendenceType = "Leave";
                                                                    NightShiftSelectedTooltips.ToolTipsType = employee.LeaveType;
                                                                    NightShiftSelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                    NightShiftSelectedTooltips.IdStage = employee.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == NightShiftAttendenceType && x.LeaveStartDate == (employee.LeaveStartDate == null ? employee.LeaveEndDate : employee.LeaveStartDate) && x.IdEmployee == employee.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                    }

                                                                    linearScale.RangeBars.Add(Attendance);
                                                                    linearnightScale.RangeBars.Add(NightAttendance);

                                                                }
                                                                else
                                                                {

                                                                    double LeaveStartTimeIndouble = 0;
                                                                    double LeaveEndTimeIndouble = 0;
                                                                    LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(employee.ShiftStartTime.TotalMinutes) / 60), 4);
                                                                    LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(employee.ShiftEndTime.TotalMinutes) / 60), 4);
                                                                    TotalAttendanceWithoutLeave = 0;
                                                                    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                    Attendance.Value = LeaveStartTimeIndouble;

                                                                    Attendance.AnchorValue = LeaveEndTimeIndouble;
                                                                    Attendance.Visible = true;
                                                                    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                    string AttendanceTimeColor = employee.LeaveTypeColor;
                                                                    if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                    {
                                                                        AttendanceTimeColor = "#000000";
                                                                    }
                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                    SelectedTooltips.AttendanceStartDate = (employee.LeaveStartDate == null ? employee.LeaveStartDate : employee.LeaveEndDate);
                                                                    string AttendenceType = string.Empty;
                                                                    AttendenceType = "Leave";
                                                                    SelectedTooltips.ToolTipsType = employee.LeaveType;
                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == AttendenceType && x.LeaveStartDate == (employee.LeaveStartDate == null ? employee.LeaveEndDate : employee.LeaveStartDate) && x.IdEmployee == employee.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }

                                                                    #endregion
                                                                    linearScale.RangeBars.Add(Attendance);
                                                                }
                                                            }
                                                            #endregion
                                                            else //if (employee.LeavesAllDayEvent != 1)//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            {

                                                                //TotalAttendanceWithoutLeave = ShiftEndTime - ShiftStartTime;
                                                                TotalAttendanceWithoutLeave = 0;
                                                                LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                Attendance.Value = ShiftStartTime;
                                                                //Attendance.AnchorValue = ShiftEndTime;
                                                                Attendance.AnchorValue = ShiftStartTime + 0.10;
                                                                Attendance.Visible = true;
                                                                Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                string AttendanceTimeColor = "#000000";
                                                                if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                {
                                                                    AttendanceTimeColor = "#000000";
                                                                }
                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                SelectedTooltips.ToolTipsStartTime = ShiftStartTime;
                                                                //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                SelectedTooltips.ToolTipsEndTime = ShiftStartTime + 0.10;
                                                                SelectedTooltips.BarTypeName = "AttendanceType";
                                                                SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);
                                                                string AttendenceType = string.Empty;
                                                                AttendenceType = "Attendance";
                                                                SelectedTooltips.ToolTipsType = AttendenceType;
                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                {
                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                    {
                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == ShiftStartTime && x.ToolTipsEndTime == ShiftEndTime && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                        if (Tooltipdata == null)
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                }

                                                                #endregion
                                                                linearScale.RangeBars.Add(Attendance);
                                                            }

                                                            #endregion



                                                        }



                                                        //TimeSpan tempLeaveStart = new TimeSpan();
                                                        //tempLeaveStart = TimeSpan.FromHours(0);
                                                        //if (employee.LeaveStartTime != tempLeaveStart)
                                                        //{
                                                        //    if (employee.AttendanceStartDate.Value.Date == employee.LeaveStartDate.Value.Date)
                                                        //    {


                                                        //        TimeSpan LeaveDifference = new TimeSpan();
                                                        //        LeaveDifference = employee.LeaveEndTime - employee.LeaveStartTime;
                                                        //        TotalAttendanceWithoutLeave = TotalAttendanceHours - LeaveDifference.TotalHours;
                                                        //        double LeaveStartTime = Math.Round((Convert.ToDouble(employee.LeaveStartTime.TotalMinutes) / 60), 4);
                                                        //        double LeaveEndTime = Math.Round((Convert.ToDouble(employee.LeaveEndTime.TotalMinutes) / 60), 4);
                                                        //        LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                        //        Attendance.Value = LeaveStartTime;
                                                        //        Attendance.AnchorValue = ShiftStartTime;
                                                        //        Attendance.Visible = true;
                                                        //        Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //        Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                        //        LinearScaleRangeBar AttendanceLeaveStart = new LinearScaleRangeBar();
                                                        //        AttendanceLeaveStart.Value = LeaveEndTime;
                                                        //        AttendanceLeaveStart.AnchorValue = LeaveStartTime;
                                                        //        AttendanceLeaveStart.Visible = true;
                                                        //        AttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //        AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };

                                                        //        LinearScaleRangeBar AttendanceLeaveend = new LinearScaleRangeBar();
                                                        //        AttendanceLeaveend.Value = ShiftEndTime;
                                                        //        AttendanceLeaveend.AnchorValue = LeaveEndTime;
                                                        //        AttendanceLeaveend.Visible = true;
                                                        //        AttendanceLeaveend.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //        AttendanceLeaveend.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                        //        linearScale.RangeBars.Add(Attendance);
                                                        //        linearScale.RangeBars.Add(AttendanceLeaveStart);
                                                        //        linearScale.RangeBars.Add(AttendanceLeaveend);
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        TotalAttendanceWithoutLeave = TotalAttendanceHours;
                                                        //        LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                        //        Attendance.Value = ShiftEndTime;
                                                        //        Attendance.AnchorValue = ShiftStartTime;
                                                        //        Attendance.Visible = true;
                                                        //        Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //        Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                        //        linearScale.RangeBars.Add(Attendance);
                                                        //    }
                                                        //}
                                                        //else
                                                        //{
                                                        //    TotalAttendanceWithoutLeave = TotalAttendanceHours;
                                                        //    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                        //    Attendance.Value = ShiftEndTime;
                                                        //    Attendance.AnchorValue = ShiftStartTime;
                                                        //    Attendance.Visible = true;
                                                        //    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                        //    linearScale.RangeBars.Add(Attendance);
                                                        //}


                                                        #endregion


                                                        #region aishwariya
                                                        #region Total EMP grid
                                                        Grid TotalGrid = new Grid();
                                                        TotalGrid.ShowGridLines = false;


                                                        //Total EMP column creation
                                                        #region ColumnDefinition
                                                        for (var Totalcolumn = 0; Totalcolumn < 1; Totalcolumn++)
                                                        {
                                                            var c = new ColumnDefinition();
                                                            c.Width = GridLength.Auto;
                                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                            TotalGrid.ColumnDefinitions.Add(c);
                                                        }





                                                        #endregion
                                                        //Total EMP  row creation
                                                        #region RowDefinition 
                                                        for (var Totalrow = 0; Totalrow < 4; Totalrow++)
                                                        {
                                                            var r = new RowDefinition();
                                                            if (Totalrow == 0)
                                                            {
                                                                r.Height = new GridLength(35, GridUnitType.Pixel);
                                                            }
                                                            else
                                                           if (Totalrow == 1)
                                                            {
                                                                r.Height = new GridLength(33, GridUnitType.Pixel);
                                                            }
                                                            else
                                                            {
                                                                r.Height = GridLength.Auto;
                                                            }
                                                            TotalGrid.RowDefinitions.Add(r);
                                                        }






                                                        #endregion
                                                        //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalWithoutBreak));
                                                        //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalShiftTime - TotalBreakTimeForToolTip));
                                                        // TimeSpan TimespanTotalLoggedTime = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTime));
                                                        TimeSpan TimespanTotalAttendanceWithoutLeave = TimeSpan.FromHours(Convert.ToDouble(TotalAttendanceWithoutLeave));
                                                        Label totallabel = new Label();
                                                        totallabel.Content = "Total";
                                                        totallabel.FontWeight = FontWeights.Bold;
                                                        totallabel.Margin = new Thickness(10, 0, 10, 0);
                                                        //totallabel.fo
                                                        Label totalWithoutBreak = new Label();

                                                        //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip + TotalBreakTimeForToolTip)) - (employee.BreakTime);
                                                        TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalShiftInDouble));
                                                        totalWithoutBreak.Content = TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds));
                                                        totalWithoutBreak.Margin = new Thickness(10, 10, 10, 0);
                                                        Label loggedtime = new Label();
                                                        TotalLoggedTime = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip + TotalBreakTimeForToolTip));
                                                        loggedtime.Content = TotalLoggedTime.Add(-TimeSpan.FromMilliseconds(TotalLoggedTime.Milliseconds));
                                                        loggedtime.Margin = new Thickness(10, 5, 10, 0);
                                                        Label AttendanceWithoutLeavetime = new Label();
                                                        if (TimespanTotalAttendanceWithoutLeave != TimeSpan.Zero)
                                                        {

                                                            #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                            //if (TempPlantId.Count() == 0)
                                                            //{

                                                            //    TimespanTotalAttendanceWithoutLeave = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMinutes(employee.BreakTime.TotalMinutes));
                                                            //    // AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                            //    // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                            //    bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                            //    if (!existTotalAttandance)
                                                            //    {
                                                            //        AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));

                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        AttendanceWithoutLeavetime.Content = DBNull.Value;
                                                            //    }
                                                            //}
                                                            //else
                                                            //{
                                                            #endregion
                                                            AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                            // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                            bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                            if (!existTotalAttandance)
                                                            {
                                                                // AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                                AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                            }
                                                            else
                                                            {
                                                                AttendanceWithoutLeavetime.Content = "00:00:00";
                                                            }
                                                            //}
                                                        }
                                                        else
                                                        {
                                                            AttendanceWithoutLeavetime.Content = "00:00:00";
                                                        }
                                                        if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false)//[rani dhamankar][20-02-2025][GEOS2-6685]
                                                        {
                                                            AttendanceWithoutLeavetime.Content = "";
                                                        }
                                                        AttendanceWithoutLeavetime.Margin = new Thickness(10, -5, 10, 0);
                                                        Grid.SetRow(totallabel, 0);
                                                        Grid.SetColumn(totallabel, 0);
                                                        Grid.SetRow(totalWithoutBreak, 1);
                                                        Grid.SetColumn(totalWithoutBreak, 0);
                                                        Grid.SetRow(loggedtime, 2);
                                                        Grid.SetColumn(loggedtime, 0);
                                                        Grid.SetRow(AttendanceWithoutLeavetime, 3);
                                                        Grid.SetColumn(AttendanceWithoutLeavetime, 0);


                                                        // TotalGrid.Children.Add(EmployeeImage);
                                                        TotalGrid.Children.Add(totallabel);
                                                        TotalGrid.Children.Add(totalWithoutBreak);
                                                        TotalGrid.Children.Add(loggedtime);
                                                        TotalGrid.Children.Add(AttendanceWithoutLeavetime);






                                                        #endregion
                                                        #region Titles  Name
                                                        Label Titlelabel = new Label();
                                                        Titlelabel.Content = "";
                                                        Label Shift = new Label();
                                                        Shift.Content = "Shift";
                                                        Shift.Margin = new Thickness(10, 10, 10, 0);
                                                        Label logged = new Label();
                                                        logged.Content = "Logged";
                                                        logged.Margin = new Thickness(10, 5, 10, 0);
                                                        Label Attendance1 = new Label();
                                                        Attendance1.Content = "Att/Leaves";
                                                        Attendance1.Margin = new Thickness(10, -5, 10, 0);

                                                        Grid TitleGrid = new Grid();

                                                        //TitleGrid.ShowGridLines = false;


                                                        // Name column creation
                                                        #region ColumnDefinition
                                                        for (var Titlecolumn = 0; Titlecolumn < 2; Titlecolumn++)
                                                        {
                                                            var c = new ColumnDefinition();
                                                            c.Width = GridLength.Auto;
                                                            //c.Width = new GridLength(50, GridUnitType.Pixel);

                                                            TitleGrid.ColumnDefinitions.Add(c);
                                                        }




                                                        #endregion

                                                        #region RowDefinition 
                                                        for (var Titlerow = 0; Titlerow < 4; Titlerow++)
                                                        {
                                                            var r = new RowDefinition();
                                                            if (Titlerow == 0)
                                                            {
                                                                r.Height = new GridLength(35, GridUnitType.Pixel);
                                                            }
                                                            else
                                                            if (Titlerow == 1)
                                                            {
                                                                r.Height = new GridLength(33, GridUnitType.Pixel);
                                                            }
                                                            else
                                                            {
                                                                r.Height = GridLength.Auto;
                                                                //  r.Height = new GridLength(20, GridUnitType.Pixel);
                                                            }

                                                            TitleGrid.RowDefinitions.Add(r);
                                                        }


                                                        #endregion

                                                        Grid.SetRow(Titlelabel, 0);
                                                        Grid.SetColumn(Titlelabel, 0);
                                                        Grid.SetRow(Shift, 1);
                                                        Grid.SetColumn(Shift, 0);
                                                        Grid.SetRow(logged, 2);
                                                        Grid.SetColumn(logged, 0);
                                                        Grid.SetRow(Attendance1, 3);
                                                        Grid.SetColumn(Attendance1, 0);

                                                        TitleGrid.Children.Add(Titlelabel);
                                                        TitleGrid.Children.Add(Shift);
                                                        TitleGrid.Children.Add(logged);
                                                        TitleGrid.Children.Add(Attendance1);

                                                        #endregion

                                                        #endregion


                                                        TimeSpan BreakTimeForToolTip = new TimeSpan();
                                                        TimeSpan LoggedTimeForToolTip = new TimeSpan();
                                                        TimeSpan pauseTimeForToolTip = new TimeSpan();
                                                        LoggedTimeForToolTip = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip));
                                                        LoggedTimeForToolTip = LoggedTimeForToolTip.Add(-TimeSpan.FromMilliseconds(LoggedTimeForToolTip.Milliseconds));

                                                        //BreakTimeForToolTip = TimeSpan.FromHours(Convert.ToDouble(TotalBreakTimeForToolTip));
                                                        //BreakTimeForToolTip = BreakTimeForToolTip.Add(-TimeSpan.FromMilliseconds(BreakTimeForToolTip.Milliseconds));


                                                        BreakTimeForToolTip = employee.BreakTime.Add(-TimeSpan.FromMilliseconds(employee.BreakTime.Milliseconds));

                                                        pauseTimeForToolTip = TimeSpan.FromHours(Convert.ToDouble(TotalBreakTimeForToolTip));
                                                        pauseTimeForToolTip = pauseTimeForToolTip.Add(-TimeSpan.FromMilliseconds(pauseTimeForToolTip.Milliseconds));

                                                        linearGauge.ToolTip = " OT Registered Time: " + LoggedTimeForToolTip + "\n Pause Time: " + pauseTimeForToolTip + "\n Shift Break Time: " + BreakTimeForToolTip;

                                                        linearGauge.Scales.Add(linearScale);
                                                        //linearGauge.Scales.Add(linearnightScale);
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        if (employee.IsNightShift == 1 && shiftStartDate.Value.Date != shiftEndDate.Value.Date)
                                                        {
                                                            linearGauge_night.Scales.Add(linearnightScale);
                                                        }
                                                        #endregion 
                                                        //linearGauge_night.Scales.Add(linearnightScale);//temp
                                                        //var firstscale = linearGauge_night.Scales.FirstOrDefault();
                                                        //if(firstscale!=null)
                                                        //{
                                                        //    linearGauge_night.Scales.Remove(firstscale);
                                                        //}

                                                        #endregion
                                                        #region [GEOS2-5040][gulab lakade]
                                                        #region  [GEOS2-5394][gulab lakade][19 02 2024]
                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                        if (ERMCommon.Instance.Emp_Productiontime.GroupBy(a => a.StageName).Count() > 0)
                                                        {

                                                            var groupbyGrid = ERMCommon.Instance.Emp_Productiontime.OrderBy(b => b.StageSequence).GroupBy(a => a.StageName);
                                                            foreach (var sd in groupbyGrid)
                                                            {
                                                                DataRow dr1 = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();//[GEOS2-5394][gulab lakade][19 02 2024]
                                                                                                                                         //dr["Plant"] = Convert.ToString(plantdata.Key);
                                                                                                                                         //dr["Week"] = Convert.ToString(Week);
                                                                                                                                         //dr["Date"] = Convert.ToString(itemDate.Key.Date);
                                                                                                                                         //dr["Employee"] = Convert.ToString(employee.EmployeeName);
                                                                                                                                         //dr["Stage"] = Convert.ToString(stagedata.Key);
                                                                                                                                         //dr["Total_Shift"] = Convert.ToString(TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds)));
                                                                                                                                         //dr["Total_Logged"] = Convert.ToString(TotalLoggedTime.Add(-TimeSpan.FromMilliseconds(TotalLoggedTime.Milliseconds)));
                                                                                                                                         // bool exists = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                                bool exists = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                                if (!exists)
                                                                {

                                                                    if (employee.AttendanceStartDate != null || employee.AttendanceEndDate != null)
                                                                    {


                                                                        double AttStartTime = employee.AttendanceStartDate.Value.Hour;
                                                                        double AttEndTime = employee.AttendanceEndDate.Value.Hour;
                                                                        double TotalTime = AttEndTime - AttStartTime;
                                                                        double Total1 = TotalAttendanceWithoutLeave;//Aishwarya Ingale[Geos2-6579]
                                                                        TimeSpan TimespanTotalAttendance = TimeSpan.FromHours(Convert.ToDouble(Total1));//Aishwarya Ingale[Geos2-6579]
                                                                        #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                                        //if (TempPlantId.Count() == 0)
                                                                        //{

                                                                        //    //TimespanTotalAttendanceWithoutLeave = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMinutes(employee.BreakTime.TotalMinutes));//[GEOS2-5886][gulab lakade][27 06 2024]

                                                                        //    //dr["Total_Attendance"] = Convert.ToString(TimespanTotalAttendance.Add(-TimeSpan.FromMinutes(employee.BreakTime.TotalMinutes)));
                                                                        //    dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave);
                                                                        //}
                                                                        //else
                                                                        //{
                                                                        #endregion
                                                                        dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendance);
                                                                        // }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    dr1["Total_Attendance"] = DBNull.Value;
                                                                }

                                                                //    if (TempPlantId.Count() == 0)
                                                                //{

                                                                //    //TimespanTotalAttendanceWithoutLeave = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMinutes(employee.BreakTime.TotalMinutes));//[GEOS2-5886][gulab lakade][27 06 2024]
                                                                //    dr["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds)));
                                                                //}
                                                                //else
                                                                //{
                                                                //    dr["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds)));
                                                                //}
                                                                //TimeSpan WOTime1 = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip));
                                                                //WOTime1 += totalDuration;//Aishwarya Ingale
                                                                double TotolWorkingTime = ERMCommon.Instance.Emp_Productiontime.Where(a => a.TimeType == "Working" && a.StageName == sd.Key).Sum(b => b.TimeValue);
                                                                TimeSpan WOTime1 = TimeSpan.FromHours(Convert.ToDouble(TotolWorkingTime));
                                                                // WOTime1 += totalDuration;//Aishwarya Ingale
                                                                dr1["WOTime"] = Convert.ToString(WOTime1.Add(-TimeSpan.FromMilliseconds(WOTime1.Milliseconds)));
                                                                //dr["DeliveryWeek"] = Convert.ToString(plantdata.Key);
                                                                //dr["DeliveryWeek"] = Convert.ToString(plantdata.Key);
                                                                #region [GEOS2-6573][rani dhamankar][07-05-2025]
                                                                var temprecord1 = employeelist.OrderBy(a => a.IdCounterpartTracking).ToList();
                                                                DataTable DataTableForGridLayout = new DataTable();
                                                                DataTableForGridLayout.Columns.Add("IdCounterpart", typeof(string));
                                                                DataTableForGridLayout.Columns.Add("IdCounterpartTracking", typeof(string));
                                                                if (temprecord1.Count() > 0)
                                                                {
                                                                    // var reorderedResult1 = temprecord1.OrderBy(r => r.AttendanceStartDate).ThenBy(r => r.AttendanceEndDate).ToList();

                                                                    var reorderedResult1 = temprecord1.OrderBy(a => a.AttendanceStartDate ?? a.CounterpartStartDate ?? a.JobDescriptionStartDate ?? DateTime.MaxValue).ToList();//[GEOS2-8124][rani dhamankar][16-05-2025]

                                                                    if (reorderedResult1.Count() > 0)
                                                                    {
                                                                        foreach (var item in reorderedResult1.Distinct().ToList())
                                                                        {
                                                                            bool checkexistIdCounterpartTrackingRecord = DataTableForGridLayout.Select().Any(a => a["IdCounterpartTracking"].ToString().ToUpper() == item.IdCounterpartTracking.ToString().ToUpper());
                                                                            if (checkexistIdCounterpartTrackingRecord == false)
                                                                            {

                                                                                int? checkIdstage_first = 0;
                                                                                string Production = string.Empty;
                                                                                //string Rework = string.Empty;

                                                                                string Rework_First = string.Empty;
                                                                                string Rework_Second = string.Empty;
                                                                                string Rework_Third = string.Empty;
                                                                                string Rework_Fourth = string.Empty;

                                                                                string POWS_First = string.Empty;
                                                                                string POWS_Second = string.Empty;
                                                                                string POWS_Third = string.Empty;
                                                                                string POWS_Fourth = string.Empty;


                                                                                string ROWS_First = string.Empty;
                                                                                string ROWS_Second = string.Empty;
                                                                                string ROWS_Third = string.Empty;
                                                                                string ROWS_Fourth = string.Empty;


                                                                                TimeSpan ProductionTime = new TimeSpan();
                                                                                TimeSpan Rework_Time = new TimeSpan();
                                                                                TimeSpan TotalProductiontime = new TimeSpan();
                                                                                TimeSpan TotalReworktime = new TimeSpan();


                                                                                int? DetectedIdStage_first = 0;

                                                                                string Rework = string.Empty;
                                                                                string POWS = string.Empty;
                                                                                string ROWS = string.Empty;
                                                                                TimeSpan TotalProductionOwstime = new TimeSpan();
                                                                                TimeSpan TotalReworkOwstime = new TimeSpan();
                                                                                TimeSpan OWSprodandReworkTime = new TimeSpan();
                                                                                List<TimeTrackingCurrentStage> ReworkTimeStageList = new List<TimeTrackingCurrentStage>();
                                                                                List<ERM_Timetracking_rework_ows> ReworkOWSList = new List<ERM_Timetracking_rework_ows>();

                                                                                List<TimeTrackingCurrentStage> TimeTrackingList = new List<TimeTrackingCurrentStage>();

                                                                                TimeTrackingList = item.TimeTrackingAddingPostServer.Where(x => x.TimeTrackIdCounterparttracking == item.IdCounterpartTracking && x.TimeTrackDifference > TimeSpan.Zero && x.Startdate.HasValue && x.Enddate.HasValue
                                                                                                   && x.Startdate.Value.Date == itemDate.Key.Date && x.Enddate.Value.Date == itemDate.Key.Date).ToList();

                                                                                if (item.IsNightShift == 1 && item.AttendanceStartDate > itemDate.Key.Date && item.AttendanceEndDate.Value.Date <= itemDate.Key.Date.AddDays(1) && item.ShiftStartTime != null && item.ShiftStartTime != TimeSpan.Zero)
                                                                                {
                                                                                    TimeTrackingList = item.TimeTrackingAddingPostServer.Where(x => x.TimeTrackIdCounterparttracking == item.IdCounterpartTracking && x.TimeTrackDifference > TimeSpan.Zero && x.Startdate.HasValue && x.Enddate.HasValue
                                                                                                   && x.Startdate.Value.Date == itemDate.Key.Date.AddDays(1) && x.Enddate.Value.Date == itemDate.Key.Date.AddDays(1)).ToList();
                                                                                }
                                                                                #region First Rework is true
                                                                                if (!DataTableForGridLayout.Columns.Contains("Production_" + Convert.ToString(item.IdStage)))
                                                                                    DataTableForGridLayout.Columns.Add("Production_" + Convert.ToString(item.IdStage), typeof(TimeSpan));
                                                                                if (!DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                    DataTableForGridLayout.Columns.Add("Download_" + Convert.ToString(item.IdStage), typeof(TimeSpan));
                                                                                if (!DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                    DataTableForGridLayout.Columns.Add("Transferred_" + Convert.ToString(item.IdStage), typeof(TimeSpan));
                                                                                DataRow drr = DataTableForGridLayout.NewRow();
                                                                                drr["IdCounterpart"] = item.IdCounterpart;
                                                                                drr["IdCounterpartTracking"] = item.IdCounterpartTracking;

                                                                                if (ReworkOWSList.Count() > 0)
                                                                                {
                                                                                    #region check reworkflag_Second 
                                                                                    //if (reworkflag_Second == false)
                                                                                    if (ReworkOWSList.Count() == 1)
                                                                                    {
                                                                                        var tempR_P_OWS = ReworkOWSList.Where(a => a.OWS_ID == 1).FirstOrDefault();
                                                                                        if (tempR_P_OWS != null)
                                                                                        {
                                                                                            checkIdstage_first = tempR_P_OWS.CheckStageId;
                                                                                            DetectedIdStage_first = tempR_P_OWS.DetectedStageId;
                                                                                        }
                                                                                        #region reworkflag_First data check and fill only
                                                                                        #region checkIdstage_first == item.IdStage
                                                                                        if (checkIdstage_first == item.IdStage)
                                                                                        {
                                                                                            try
                                                                                            {
                                                                                                #region reworkflag_First completed
                                                                                                string production_first = "Production_" + checkIdstage_first;
                                                                                                if (!DataTableForGridLayout.Columns.Contains(Production))
                                                                                                {
                                                                                                    drr[production_first] = TimeSpan.Zero;
                                                                                                }
                                                                                                if (DataTableForGridLayout.Columns.Contains(production_first))
                                                                                                {
                                                                                                    if (Convert.ToString(drr[production_first]) != null)
                                                                                                    {
                                                                                                        string reworkowsInstring = Convert.ToString(drr["Production_" + checkIdstage_first]);
                                                                                                        if (string.IsNullOrEmpty(Convert.ToString(reworkowsInstring)) || reworkowsInstring == "0" || reworkowsInstring == "00:00:00")
                                                                                                        {
                                                                                                            reworkowsInstring = "0.00:00:00";
                                                                                                        }
                                                                                                        string timeString = Convert.ToString(reworkowsInstring); // Example time format string
                                                                                                        string[] format = { @"hh\:mm\:ss", @"d\.hh\:mm\:ss" }; // Specify the format of the time string
                                                                                                        TimeSpan TempproductionTime = TimeSpan.ParseExact(timeString, format, null);

                                                                                                        if (DataTableForGridLayout.Columns.Contains(production_first))
                                                                                                        {

                                                                                                            TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                                            TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                                            DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                            TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                            if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                                            {
                                                                                                                drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                                            }
                                                                                                            if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                                            {
                                                                                                                drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                                            }

                                                                                                            //if (DataTableForGridLayout.Columns.Contains(Production))
                                                                                                            //{
                                                                                                            //    drr[production_first] = AddintotalTimeDifference + PostservertotalTimeDifference + ProductionTimeDifference;
                                                                                                            //}

                                                                                                        }

                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        if (DataTableForGridLayout.Columns.Contains(production_first))
                                                                                                        {
                                                                                                            TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                                            TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                                            DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                            TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                            if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                                            {
                                                                                                                drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                                            }
                                                                                                            if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                                            {
                                                                                                                drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                                            }
                                                                                                        }

                                                                                                    }
                                                                                                }

                                                                                                checkIdstage_first = 0;
                                                                                                // ReworkTimeIndouble = 0;
                                                                                                DetectedIdStage_first = 0;
                                                                                                ReworkOWSList.RemoveAll(a => a.OWS_ID == 1);
                                                                                                #endregion


                                                                                                #region reworkflag_First again true
                                                                                                if (item.Rework == true)
                                                                                                {
                                                                                                    ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                                    selected_rework_ows.OWS_ID = 1;
                                                                                                    selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);
                                                                                                    //reworkflag_First = true;
                                                                                                    checkIdstage_first = item.IdStage;
                                                                                                    var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                                    int lastindex = reorderedResult1.Count();
                                                                                                    if (lastindex - 1 > DetectedStageIndex)
                                                                                                    {
                                                                                                        var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                        if (Detectedrecord != null)
                                                                                                        {
                                                                                                            DetectedIdStage_first = Detectedrecord.IdStage;// detected rework stage
                                                                                                            selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);
                                                                                                        }
                                                                                                        TimeTrackingCurrentStage Temp_ReworkTime = new TimeTrackingCurrentStage();
                                                                                                        Temp_ReworkTime.IdStage = Detectedrecord.IdStage;
                                                                                                        Temp_ReworkTime.IdCounterparttracking = Convert.ToInt32(Detectedrecord.IdCounterpartTracking);
                                                                                                        Temp_ReworkTime.TimeDifference = Detectedrecord.CounterpartTimeDifference;
                                                                                                        ReworkTimeStageList.Add(Temp_ReworkTime);

                                                                                                    }

                                                                                                    if (checkIdstage_first == DetectedIdStage_first)
                                                                                                    {
                                                                                                        // reworkflag_First = false;
                                                                                                        checkIdstage_first = 0;
                                                                                                        DetectedIdStage_first = 0;
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ReworkOWSList.Add(selected_rework_ows);
                                                                                                    }

                                                                                                }
                                                                                                #endregion
                                                                                            }
                                                                                            catch (Exception ex)
                                                                                            {
                                                                                                GeosApplication.Instance.Logger.Log(string.Format("Error in method FillDashboard() - {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            try
                                                                                            {


                                                                                                #region only Add reworkflag_First data not other  
                                                                                                #region  if (item.Rework == 1) DetectedIdStage_Second
                                                                                                #region if(checkIdstage_Second==DetectedIdStage_Second)
                                                                                                Int32 Max_owsID = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                                selected_rework_ows.OWS_ID = Max_owsID + 1;
                                                                                                bool sameCheck_Detect = false;
                                                                                                if (item.Rework == true)
                                                                                                {
                                                                                                    var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                                    if ((reorderedResult1.Count() - 1) > DetectedStageIndex)
                                                                                                    {
                                                                                                        var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                        if (Detectedrecord != null)
                                                                                                        {
                                                                                                            selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);
                                                                                                        }
                                                                                                    }
                                                                                                    selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);

                                                                                                    if (selected_rework_ows.CheckStageId == selected_rework_ows.DetectedStageId)
                                                                                                    {
                                                                                                        sameCheck_Detect = true;
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ReworkOWSList.Add(selected_rework_ows);

                                                                                                    }

                                                                                                }

                                                                                                #endregion

                                                                                                if (item.Rework == true && sameCheck_Detect == false)
                                                                                                {
                                                                                                    Int32 Max_owsID_Add = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                    Int32 Max_owsID_Add_minus = Max_owsID_Add - 1;
                                                                                                    var R_P_OWSMax = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add).FirstOrDefault();
                                                                                                    var R_P_OWSMax_minus = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add_minus).FirstOrDefault();

                                                                                                    #region Rework==1 and DetectedIdStage_first == item.IdStage
                                                                                                    if (R_P_OWSMax_minus.DetectedStageId == item.IdStage)
                                                                                                    {
                                                                                                        TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                    }
                                                                                                    #endregion
                                                                                                    else
                                                                                                    {
                                                                                                        #region Rework OWS
                                                                                                        string ROWS_second = "ROWS_" + R_P_OWSMax_minus.DetectedStageId;
                                                                                                        TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        #endregion
                                                                                                        #region Production OWS
                                                                                                        TotalProductionOwstime = TotalProductionOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        #endregion
                                                                                                    }
                                                                                                }
                                                                                                #endregion
                                                                                                else
                                                                                                {


                                                                                                    #region if (DetectedIdStage_first != item.IdStage)
                                                                                                    Int32 Max_owsID_Add = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                    //Int32 Max_owsID_Add_minus = Max_owsID_Add - 1;
                                                                                                    var R_P_OWSMax = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add).FirstOrDefault();
                                                                                                    //var R_P_OWSMax_minus = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add_minus).FirstOrDefault();

                                                                                                    //if (DetectedIdStage_first == item.IdStage)
                                                                                                    if (R_P_OWSMax.DetectedStageId == item.IdStage)
                                                                                                    {

                                                                                                        string Rework_second = "Rework_" + item.IdStage;
                                                                                                        TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        #region  rework ows and production ows
                                                                                                        POWS_First = "POWS_" + item.IdStage;
                                                                                                        ROWS_First = "ROWS_" + R_P_OWSMax.DetectedStageId;

                                                                                                        TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                        TotalProductionOwstime = TotalProductionOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        #endregion
                                                                                                    }

                                                                                                    #endregion
                                                                                                }
                                                                                                #endregion
                                                                                            }
                                                                                            catch (Exception ex)
                                                                                            {
                                                                                                GeosApplication.Instance.Logger.Log(string.Format("Error in method FillDashboard() - {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                                                                            }
                                                                                        }
                                                                                        #endregion
                                                                                        #endregion
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        try
                                                                                        {

                                                                                            #region check reworkflag_Third 
                                                                                            //if (reworkflag_Third == false)
                                                                                            if (ReworkOWSList.Count() > 1)
                                                                                            {
                                                                                                Int32 Max_owsID = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                Int32 Max_owsID_minus = Max_owsID - 1;
                                                                                                var tempR_P_OWSMax = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID).FirstOrDefault();
                                                                                                var tempR_P_OWSMax_minusone = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_minus).FirstOrDefault();
                                                                                                #region reworkflag_Second data check and fill only
                                                                                                #region checkIdstage_Second  == item.IdStage
                                                                                                //if (checkIdstage_Second == item.IdStage)
                                                                                                if (tempR_P_OWSMax.CheckStageId == item.IdStage)
                                                                                                {
                                                                                                    #region   if(checkIdstage_Second==DetectedIdStage_first)
                                                                                                    //if (checkIdstage_Second == DetectedIdStage_first)
                                                                                                    if (tempR_P_OWSMax.CheckStageId == tempR_P_OWSMax_minusone.DetectedStageId)
                                                                                                    {
                                                                                                        string Rework_second = "Rework_" + item.IdStage;
                                                                                                        TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                    }
                                                                                                    #endregion
                                                                                                    else
                                                                                                    {
                                                                                                        #region Rework OWS

                                                                                                        //string ROWS_second = "ROWS_" + DetectedIdStage_first;
                                                                                                        string ROWS_second = "ROWS_" + tempR_P_OWSMax_minusone.DetectedStageId;
                                                                                                        TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                        TotalProductionOwstime = TotalProductionOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        #endregion


                                                                                                    }
                                                                                                    #region reworkflag_Second completed
                                                                                                    ReworkOWSList.RemoveAll(a => a.OWS_ID == Max_owsID);

                                                                                                    #endregion


                                                                                                    #region reworkflag_Second again true

                                                                                                    if (item.Rework == true)
                                                                                                    {
                                                                                                        Int32 Max_owsID_Add = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                        var tempR_P_OWSMax_add = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add).FirstOrDefault();
                                                                                                        ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                                        selected_rework_ows.OWS_ID = Max_owsID_Add + 1;
                                                                                                        selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);
                                                                                                        //reworkflag_Second = true;
                                                                                                        //checkIdstage_Second = item.IdStage;
                                                                                                        var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                                        int lastindex = reorderedResult1.Count();
                                                                                                        if (lastindex - 1 > DetectedStageIndex)
                                                                                                        {
                                                                                                            var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                            if (Detectedrecord != null)
                                                                                                            {
                                                                                                                //DetectedIdStage_Second = Detectedrecord.IdStage;// detected rework stage
                                                                                                                selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);
                                                                                                            }
                                                                                                            TimeTrackingCurrentStage Temp_ReworkTime = new TimeTrackingCurrentStage();
                                                                                                            Temp_ReworkTime.IdStage = Detectedrecord.IdStage;
                                                                                                            Temp_ReworkTime.IdCounterparttracking = Convert.ToInt32(Detectedrecord.IdCounterpartTracking);
                                                                                                            Temp_ReworkTime.TimeDifference = Detectedrecord.CounterpartTimeDifference;
                                                                                                            ReworkTimeStageList.Add(Temp_ReworkTime);
                                                                                                        }
                                                                                                        ReworkOWSList.Add(selected_rework_ows);


                                                                                                    }
                                                                                                    #endregion

                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    #region only Add reworkflag_Second data not other  
                                                                                                    #region  if (item.Rework == 1) DetectedIdStage_Third
                                                                                                    #region if(checkIdstage_Second==DetectedIdStage_Second)
                                                                                                    Int32 Max_owsID_1 = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                    var tempR_P_OWSMax_1 = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_1).FirstOrDefault();
                                                                                                    Int32 Max_owsID_1_minus = Max_owsID_1 - 1;
                                                                                                    var tempR_P_OWSMax_1_minus = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_1_minus).FirstOrDefault();
                                                                                                    bool sameCheck_Detect = false;
                                                                                                    if (item.Rework == true)
                                                                                                    {
                                                                                                        ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                                        selected_rework_ows.OWS_ID = Max_owsID_1 + 1;
                                                                                                        var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                                        if ((reorderedResult1.Count() - 1) > DetectedStageIndex)
                                                                                                        {
                                                                                                            var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                            if (Detectedrecord != null)
                                                                                                            {
                                                                                                                //DetectedIdStage_Third = Detectedrecord.IdStage;
                                                                                                                selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);
                                                                                                            }
                                                                                                        }
                                                                                                        //checkIdstage_Third = item.IdStage;
                                                                                                        selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);
                                                                                                        //if (checkIdstage_Third == DetectedIdStage_Third )
                                                                                                        if (selected_rework_ows.CheckStageId == selected_rework_ows.DetectedStageId)
                                                                                                        {
                                                                                                            sameCheck_Detect = true;
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            ReworkOWSList.Add(selected_rework_ows);
                                                                                                        }

                                                                                                    }

                                                                                                    #endregion

                                                                                                    if (item.Rework == true && sameCheck_Detect == false)
                                                                                                    {
                                                                                                        #region item.Rework == 1 and  if (DetectedIdStage_Second != item.IdStage)
                                                                                                        //if (DetectedIdStage_Second == item.IdStage)
                                                                                                        if (tempR_P_OWSMax_1_minus.DetectedStageId == item.IdStage)
                                                                                                        {
                                                                                                            TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                            string Rework_third = "Rework_" + item.IdStage;


                                                                                                        }
                                                                                                        #endregion
                                                                                                        else
                                                                                                        {
                                                                                                            #region Rework OWS
                                                                                                            //string ROWS_second = "ROWS_" + DetectedIdStage_Second;
                                                                                                            string ROWS_second = "ROWS_" + tempR_P_OWSMax_1_minus.DetectedStageId;
                                                                                                            TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                            #endregion

                                                                                                        }
                                                                                                    }
                                                                                                    #endregion
                                                                                                    else
                                                                                                    {

                                                                                                        #region if (DetectedIdStage_Second != item.IdStage)
                                                                                                        //if (DetectedIdStage_Second == item.IdStage)
                                                                                                        if (tempR_P_OWSMax_1.DetectedStageId == item.IdStage)
                                                                                                        {

                                                                                                            string Rework_third = "Rework_" + item.IdStage;
                                                                                                            TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            #region  rework ows and production ows


                                                                                                            POWS_Second = "POWS_" + item.IdStage;
                                                                                                            //ROWS_Second = "ROWS_" + DetectedIdStage_Second;
                                                                                                            ROWS_Second = "ROWS_" + tempR_P_OWSMax_1.DetectedStageId;

                                                                                                            TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                            TotalProductionOwstime = TotalProductionOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));


                                                                                                            #endregion
                                                                                                        }

                                                                                                        #endregion
                                                                                                    }
                                                                                                    #endregion
                                                                                                }

                                                                                                #endregion
                                                                                                #endregion
                                                                                            }

                                                                                            #endregion
                                                                                        }
                                                                                        catch (Exception ex)
                                                                                        {
                                                                                            GeosApplication.Instance.Logger.Log(string.Format("Error in method FillDashboard() - {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                                                                        }
                                                                                    }
                                                                                    #endregion
                                                                                }
                                                                                #endregion
                                                                                else
                                                                                {
                                                                                    try
                                                                                    {

                                                                                        #region if (item.Rework == 1) Firstrework==true
                                                                                        if (item.Rework == true)
                                                                                        {
                                                                                            ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                            selected_rework_ows.OWS_ID = 1;
                                                                                            var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                            int lastindex = reorderedResult1.Count();
                                                                                            if (lastindex - 1 > DetectedStageIndex)
                                                                                            {
                                                                                                try
                                                                                                {
                                                                                                    var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                    if (Detectedrecord != null)
                                                                                                    {
                                                                                                        selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);// detected rework stage

                                                                                                    }

                                                                                                }
                                                                                                catch (Exception ex)
                                                                                                {

                                                                                                }
                                                                                                //end

                                                                                                // reworkflag_First = true;
                                                                                                // checkIdstage_first = item.IdStage;
                                                                                                selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);
                                                                                                ReworkOWSList.Add(selected_rework_ows);
                                                                                                Production = "Production_" + item.IdStage;
                                                                                                Rework_First = "Rework_" + selected_rework_ows.DetectedStageId;
                                                                                                POWS_First = "POWS_" + selected_rework_ows.DetectedStageId;
                                                                                                ROWS_First = "ROWS_" + selected_rework_ows.DetectedStageId;
                                                                                                ProductionTime = TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                TotalProductiontime += ProductionTime;
                                                                                                //drr[Production] = ProductionTime;
                                                                                                if (DataTableForGridLayout.Columns.Contains(Production))  // [Rupali Sarode][GEOS2-4347][05-05-2023]
                                                                                                {
                                                                                                    if (!string.IsNullOrEmpty(Convert.ToString(item.CounterpartTimeDifference)) && Convert.ToString(item.CounterpartTimeDifference) != "0")
                                                                                                    {
                                                                                                        //if (ProductionTime != TimeSpan.Zero)//Aishwarya Ingale[Geos2-6069]
                                                                                                        //{
                                                                                                        TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                                        TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                                        DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                        TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                        if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                                        {
                                                                                                            drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                                        }
                                                                                                        if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                                        {
                                                                                                            drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                                        }
                                                                                                        //}
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        //if (ProductionTime != TimeSpan.Zero)//Aishwarya Ingale[Geos2-6069]
                                                                                                        //{
                                                                                                        TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                                        TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                                        DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                        TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                        if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                                        {
                                                                                                            drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                                        }
                                                                                                        if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                                        {
                                                                                                            drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                                        }
                                                                                                        //}
                                                                                                    }
                                                                                                }

                                                                                            }
                                                                                        }
                                                                                        #endregion
                                                                                        else
                                                                                        {
                                                                                            TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                            TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                            DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                            TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                            if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                            {
                                                                                                drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                            }
                                                                                            if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                            {
                                                                                                drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log(string.Format("Error in method AllCustomData() - {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                }

                                                                                DataTableForGridLayout.Rows.Add(drr);

                                                                            }
                                                                        }

                                                                    }

                                                                }
                                                                #endregion

                                                                double Temp_Break = 0;
                                                                foreach (var grbyBreak in sd.Where(b => b.TimeType != "Working").GroupBy(a => a.TimeType).ToList())
                                                                {
                                                                    double t_break = grbyBreak.Sum(b => b.TimeValue);
                                                                    Temp_Break = Temp_Break + t_break;
                                                                    TimeSpan time_break = TimeSpan.FromHours(Convert.ToDouble(t_break));

                                                                    #region [GEOS2-6914][pallavi jadhav][03 02 2025]
                                                                    int idlookup = sd.Where(b => b.TimeType != "Working" && b.TimeType == grbyBreak.Key).Select(b => b.IdlookupValue).FirstOrDefault();
                                                                    if (grbyBreak.Key == "Assign WO")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Designers Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Production Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Commercial Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Trainer")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else
                                                                    {
                                                                        dr1[grbyBreak.Key] = Convert.ToString(time_break);
                                                                    }
                                                                    #endregion


                                                                    #region //[pallavi jadhav][13 01 2025][GEOS2-6716] 
                                                                    if (grbyBreak.FirstOrDefault().IdlookupValue != null)
                                                                    {
                                                                        int TempDetail = Convert.ToInt32(grbyBreak.FirstOrDefault().IdlookupValue);
                                                                        if (ERMCommon.Instance.DetailsList_IDLookup != null)
                                                                        {
                                                                            if (ERMCommon.Instance.DetailsList_IDLookup.Contains(TempDetail))
                                                                            {
                                                                                if (grbyBreak.FirstOrDefault().Details != null)
                                                                                {
                                                                                    string TempComment = Convert.ToString(grbyBreak.FirstOrDefault().Details);
                                                                                    dr1["Details_" + TempDetail] = TempComment;

                                                                                }

                                                                            }
                                                                        }
                                                                    }
                                                                    #endregion

                                                                }


                                                                #region [GEOS2-6573][rani dhamankar][07-05-2025]

                                                                if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(StageRecord.IdStage)))
                                                                {
                                                                    //[GEOS2-8124][rani dhamankar][16-05-2025]
                                                                    TimeSpan DownloadtotalTime = DataTableForGridLayout.AsEnumerable().Select(row => row.Field<TimeSpan?>("Download_" + Convert.ToString(StageRecord.IdStage)) ?? TimeSpan.Zero).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);

                                                                    if (DownloadtotalTime > TimeSpan.Zero)
                                                                    {
                                                                        dr1["Download"] = DownloadtotalTime;
                                                                    }
                                                                }

                                                                if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(StageRecord.IdStage)))
                                                                {
                                                                    //[GEOS2-8124][rani dhamankar][16-05-2025]
                                                                    TimeSpan TransferredtotalTime = DataTableForGridLayout.AsEnumerable().Select(row => row.Field<TimeSpan?>("Transferred_" + Convert.ToString(StageRecord.IdStage)) ?? TimeSpan.Zero).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);

                                                                    if (TransferredtotalTime > TimeSpan.Zero)
                                                                    {
                                                                        dr1["Transferred"] = TransferredtotalTime;
                                                                    }
                                                                }

                                                                dr1["SwitchToStage"] = employee.SwitchToStage != null ? employee.SwitchToStage.ToString() : "";
                                                                #endregion
                                                                dr1["DateHTMLColor"] = HtmlColor;


                                                                dr1["Plant"] = Convert.ToString(plantdata.Key);
                                                                dr1["Week"] = Convert.ToString(Week);
                                                                dr1["Date"] = Convert.ToString(itemDate.Key.Date);
                                                                dr1["Employee"] = Convert.ToString(employee.EmployeeName);
                                                                dr1["Stage"] = Convert.ToString(sd.Key);
                                                                dr1["Total_Shift"] = Convert.ToString(TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds)));
                                                                //dr1["Total_Logged"] = Convert.ToString(TotalLoggedTime.Add(-TimeSpan.FromMilliseconds(TotalLoggedTime.Milliseconds)));
                                                                TimeSpan T_loggedTime = TimeSpan.FromHours(Convert.ToDouble(Temp_Break + TotolWorkingTime));
                                                                dr1["Total_Logged"] = Convert.ToString(T_loggedTime.Add(-TimeSpan.FromMilliseconds(T_loggedTime.Milliseconds)));

                                                                if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false)
                                                                {

                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr1);
                                                                }
                                                            }
                                                        }
                                                        #region [GEOS2-7641][gulab lakade][27 03 2025] 
                                                        else
                                                        {
                                                            bool exists = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                            if (!exists)
                                                            {
                                                                DataRow dr1 = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();

                                                                if (TempPlantId.Count() == 0)
                                                                {
                                                                    dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave);
                                                                }
                                                                else
                                                                {
                                                                    double Total1 = TotalAttendanceWithoutLeave;
                                                                    TimeSpan TimespanTotalAttendance = TimeSpan.FromHours(Convert.ToDouble(Total1));
                                                                    dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendance);
                                                                }
                                                                dr1["DateHTMLColor"] = HtmlColor;
                                                                dr1["Plant"] = Convert.ToString(plantdata.Key);
                                                                dr1["Week"] = Convert.ToString(Week);
                                                                dr1["Date"] = Convert.ToString(itemDate.Key.Date);
                                                                dr1["Employee"] = Convert.ToString(employee.EmployeeName);
                                                                dr1["Stage"] = Convert.ToString(stagedata.Key);
                                                                dr1["Total_Shift"] = Convert.ToString(TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds)));
                                                                if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false)
                                                                {

                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr1);
                                                                }


                                                            }
                                                        }
                                                        #endregion
                                                        #endregion
                                                        //ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr);
                                                        #endregion
                                                        #region RND
                                                        Grid GaugeControlGrid = new Grid();
                                                        GaugeControlGrid.ShowGridLines = false;
                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                        {
                                                            linearGauge.Margin = new Thickness(20, 32, -45, 0);
                                                            linearGauge_night.Margin = new Thickness(-35, 32, -40, 0);
                                                            int HoursByTotalHours_night = 0;
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                var c = new ColumnDefinition();
                                                                c.Width = new GridLength(1370, GridUnitType.Pixel);
                                                                GaugeControlGrid.ColumnDefinitions.Add(c);
                                                            }
                                                            else
                                                            {
                                                                #endregion
                                                                HoursByTotalHours_night = (int)(1370 / TotalHours_Night);
                                                                int Column_0 = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                int Column_1 = (int)(HoursByTotalHours_night * TotalHours_0);
                                                                int widthValue = 1370 - (Column_0 + Column_1);
                                                                if (Column_0 > Column_1)
                                                                {
                                                                    Column_0 = Column_0;
                                                                }
                                                                else
                                                                    if (Column_0 < Column_1)
                                                                {
                                                                    Column_1 = Column_1;
                                                                }
                                                                //int NightLinearWidth = (int)(1370 / TotalHours_0);
                                                                #region ColumnDefinition
                                                                for (var empcolumn = 0; empcolumn < 2; empcolumn++)
                                                                {
                                                                    var c = new ColumnDefinition();
                                                                    if (empcolumn == 0)
                                                                    {
                                                                        c.Width = new GridLength(Column_0, GridUnitType.Pixel);
                                                                    }
                                                                    else if (empcolumn == 1)
                                                                    {
                                                                        c.Width = new GridLength(Column_1, GridUnitType.Pixel);//GridLength.Auto;

                                                                    }

                                                                    GaugeControlGrid.ColumnDefinitions.Add(c);
                                                                }

                                                                #endregion
                                                            }//[GEOS2-7755][gulab lakade][08 04 2025]
                                                        }
                                                        else
                                                        {
                                                            #region ColumnDefinition
                                                            linearGauge.Margin = new Thickness(-12, 32, -50, 0);
                                                            linearGauge_night.Margin = new Thickness(-50, 32, -15, 0);
                                                            for (var empcolumn = 0; empcolumn < 1; empcolumn++)
                                                            {
                                                                var c = new ColumnDefinition();
                                                                if (empcolumn == 0)
                                                                {
                                                                    c.Width = new GridLength(1370, GridUnitType.Pixel);
                                                                }
                                                                GaugeControlGrid.ColumnDefinitions.Add(c);
                                                            }

                                                            #endregion
                                                        }

                                                        #endregion
                                                        //Stagegrid column creation

                                                        //Plantgrid row creation
                                                        #region RowDefinition 
                                                        for (var emprow = 0; emprow < 1; emprow++)
                                                        {
                                                            var r = new RowDefinition();
                                                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                            GaugeControlGrid.RowDefinitions.Add(r);
                                                        }
                                                        //var first = linearnightScale.ShowMajorTickmarks.CompareTo(0);
                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                        {

                                                            //Grid.SetRow(linearGauge, 0);
                                                            //Grid.SetColumn(linearGauge, 0);
                                                            //Grid.SetRow(linearGauge_night, 0);
                                                            //Grid.SetColumn(linearGauge_night, 1);
                                                            //GaugeControlGrid.Children.Add(linearGauge);
                                                            //GaugeControlGrid.Children.Add(linearGauge_night);
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (employee.IsNightShift == 1 && shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                Grid.SetRow(linearGauge, 0);
                                                                Grid.SetColumn(linearGauge, 0);
                                                                GaugeControlGrid.Children.Add(linearGauge);
                                                            }
                                                            else
                                                            {
                                                                Grid.SetRow(linearGauge, 0);
                                                                Grid.SetColumn(linearGauge, 0);
                                                                Grid.SetRow(linearGauge_night, 0);
                                                                Grid.SetColumn(linearGauge_night, 1);
                                                                GaugeControlGrid.Children.Add(linearGauge);
                                                                GaugeControlGrid.Children.Add(linearGauge_night);
                                                            }
                                                            #endregion
                                                        }
                                                        else
                                                        {
                                                            Grid.SetRow(linearGauge, 0);
                                                            Grid.SetColumn(linearGauge, 0);
                                                            //Grid.SetRow(linearGauge_night, 0);
                                                            //Grid.SetColumn(linearGauge_night, 1);
                                                            GaugeControlGrid.Children.Add(linearGauge);
                                                            //GaugeControlGrid.Children.Add(linearGauge_night);
                                                        }
                                                        #endregion

                                                        #endregion

                                                        #endregion

                                                        #endregion

                                                        Grid.SetRow(ImageGrid, empcount);
                                                        Grid.SetColumn(ImageGrid, 0);

                                                        //Grid.SetRow(empEndTime, empcount);
                                                        //Grid.SetColumn(empEndTime, 2);

                                                        //Grid.SetRow(linearGauge, empcount);
                                                        //Grid.SetColumn(linearGauge, 2);
                                                        Grid.SetRow(GaugeControlGrid, empcount);
                                                        Grid.SetColumn(GaugeControlGrid, 2);
                                                        //EmpGrid.Children.Add(empName);
                                                        EmpGrid.Children.Add(ImageGrid);
                                                        //EmpGrid.Children.Add(empEndTime);
                                                        // EmpGrid.Children.Add(linearGauge);
                                                        EmpGrid.Children.Add(GaugeControlGrid);
                                                        #region aiwhariya Total 
                                                        Grid.SetRow(TotalGrid, empcount);
                                                        Grid.SetColumn(TotalGrid, 3);
                                                        EmpGrid.Children.Add(TotalGrid);
                                                        Grid.SetRow(TitleGrid, empcount);
                                                        Grid.SetColumn(TitleGrid, 1);
                                                        EmpGrid.Children.Add(TitleGrid);
                                                        #endregion

                                                        ERM_ProductionTimelineExistingEmP.Add(employee);
                                                        empcount++;
                                                    }

                                                }//[GEOS2-7641][gulab lakade][27 03 2025]

                                            }

                                            #endregion

                                            if (empcount > 0)//[GEOS2-7641][gulab lakade][27 03 2025]
                                            {
                                                Grid.SetRow(StageName, 0);
                                                Grid.SetColumn(StageName, 0);
                                                Border border = new Border()
                                                {
                                                    BorderThickness = new Thickness()
                                                    {
                                                        Bottom = 1,
                                                        Left = 1,
                                                        Right = 1,
                                                        Top = 1
                                                    },
                                                    //BorderBrush = new SolidColorBrush(Colors.Black) //[GEOS2-5129]
                                                };
                                                //Start [GEOS2-5129]
                                                if (ApplicationThemeHelper.ApplicationThemeName.ToString() == "BlackAndBlue")
                                                {
                                                    border.BorderBrush = new SolidColorBrush(Colors.White);
                                                }
                                                else
                                                {
                                                    border.BorderBrush = new SolidColorBrush(Colors.Black);
                                                }
                                                // end [GEOS2-5129]
                                                //var border = new Border();
                                                Grid.SetRow(border, 1);
                                                Grid.SetColumn(border, 0);
                                                Grid.SetRow(EmpGrid, 3);
                                                Grid.SetColumn(EmpGrid, 0);

                                                stageTempGrid.Children.Add(StageName);
                                                stageTempGrid.Children.Add(border);
                                                stageTempGrid.Children.Add(EmpGrid);

                                                Grid.SetRow(stageTempGrid, StageRow);
                                                Grid.SetColumn(stageTempGrid, 0);

                                                StageGrid.Children.Add(stageTempGrid);
                                                StageRow++;
                                            }//[GEOS2-7641][gulab lakade][27 03 2025]
                                        }



                                        #endregion
                                        if (StageRow > 0)//[GEOS2-7641][gulab lakade][27 03 2025]
                                        {
                                            Grid.SetRow(PlantName, 0);
                                            Grid.SetColumn(PlantName, 0);
                                            Grid.SetRow(DateLabel, 0);
                                            Grid.SetColumn(DateLabel, 1);
                                            Grid.SetRow(TooltipImage, 0);
                                            Grid.SetColumn(TooltipImage, 2);
                                            Grid.SetRow(StageGrid, 1);
                                            //Grid.SetColumn(StageGrid, 0);
                                            Grid.SetColumnSpan(StageGrid, 4);
                                            PlantTempGrid.Children.Add(PlantName);
                                            PlantTempGrid.Children.Add(DateLabel);
                                            PlantTempGrid.Children.Add(TooltipImage);
                                            PlantTempGrid.Children.Add(StageGrid);

                                            Grid.SetRow(PlantTempGrid, DateRow);
                                            Grid.SetColumn(PlantTempGrid, 0);
                                            DateGrid.Children.Add(PlantTempGrid);



                                            #endregion
                                            DateRow++;
                                        }//[GEOS2-7641][gulab lakade][27 03 2025]
                                    }
                                }
                            }
                            Grid.SetRow(DateGrid, Plantrow);
                            Grid.SetColumn(DateGrid, 0);
                            PlantGrid.Children.Add(DateGrid);
                            #endregion
                            Plantrow++;
                        }

                        Grid.SetRow(PlantGrid, 1);
                        Grid.SetColumn(PlantGrid, 0);
                        MainGrid.Children.Add(PlantGrid);

                        #endregion


                    }

                    #endregion
                }


                //#endregion

                if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }
                GeosApplication.Instance.Logger.Log("Method AllCustomData() executed successfully", category: Category.Info, priority: Priority.Low);
            }

            catch (Exception ex)
            {
                if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }
                GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
            }


            if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }

        }
        #region [GEOS2-9220][gulab lakade][12 08 2025][performance task]
        public async void AllCustomData(Grid MainGrid, List<ERM_ProductionTimeline> ProductionTimeList, List<int> TempPlantId, DateTime StartDates, DateTime EndDates)
        {

            try
            {
                GeosApplication.Instance.Logger.Log("Method AllCustomData ...", category: Category.Info, priority: Priority.Low);
                if (!DXSplashScreen.IsActive) { DXSplashScreen.Show<SplashScreenView>(); }

                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();//[gulab lakade][tool tips ][24 01 2024]
                Grid tempgrid = new Grid();
                #region [GEOS2-5040][gulab lakade][22 12 2023]
                ERMCommon.Instance.ProductionTimelineSprint = new System.Collections.ObjectModel.ObservableCollection<ERMProductionTimelineSprint>();
                ERMCommon.Instance.DataTableForProductionTimeLine = new DataTable();

                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Plant", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Week", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Date", typeof(DateTime));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Employee", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Stage", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Shift", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Logged", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Attendance", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("WOTime", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("DateHTMLColor", typeof(string));
                //ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Maintance11", typeof(string));
                //ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Meeting11", typeof(string));
                foreach (var item in ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Distinct())
                {
                    try
                    {
                        if (item.Name != "Working" && item.Name != "Planned Meeting" && item.Name != "Unplanned Meeting")
                        {

                            ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add(item.Name, typeof(TimeSpan));
                            #region //[pallavi jadhav][13 01 2025][GEOS2-6716] 
                            if (ERMCommon.Instance.DetailsList_IDLookup != null)
                            {
                                if (ERMCommon.Instance.DetailsList_IDLookup.Contains(item.IdLookupValue))
                                {
                                    #region [GEOS2-6573][rani dhamankar][07-05-2025]
                                    if (item.IdLookupValue == 1813)
                                    {
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Details_" + item.IdLookupValue, typeof(string));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("SwitchToStage", typeof(string));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Download", typeof(TimeSpan));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Transferred", typeof(TimeSpan));
                                    }
                                    else
                                    {
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Details_" + item.IdLookupValue, typeof(string)); //[pallavi jadhav][13 01 2025][GEOS2-6716] 
                                    }
                                    #endregion
                                }
                            }
                            #endregion
                        }
                    }
                    catch (Exception ex)
                    {
                        GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
                    }

                }

                //Aishwarya Ingale[Geos2-5883]
                foreach (var item1 in ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Distinct())
                {
                    try
                    {
                        if (item1.Name != "Working")
                        {
                            string uniqueColumnName = item1.Name + "_" + item1.IdLookupValue;
                            if (!ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Contains(uniqueColumnName))
                            {
                                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add(uniqueColumnName, typeof(TimeSpan));
                            }
                        }
                    }
                    catch (Exception ex)
                    {
                        GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
                    }
                }
                #endregion

                System.Windows.Controls.StackPanel EMPMainGrid = new System.Windows.Controls.StackPanel();
                if (MainGrid != null)
                {

                    EMPMainGrid = (System.Windows.Controls.StackPanel)MainGrid.Parent;
                    //MainGrid = new Grid();
                }

                if (ProductionTimeList == null)
                {
                    ProductionTimeList = new List<ERM_ProductionTimeline>();
                }

                #region RND
                if (MainGrid.Children.Count > 0)
                {
                    MainGrid.Children.RemoveAt(0);
                    MainGrid.Children.Clear();
                }

                string tempname = MainGrid.Name;

                #region ColumnDefinition
                for (var a = 0; a < 1; a++)
                {
                    var c = new ColumnDefinition();
                    c.Width = GridLength.Auto;
                    //c.Width = new GridLength(400, GridUnitType.Pixel);
                    MainGrid.ColumnDefinitions.Add(c);
                }

                #endregion
                //maingrid row creation
                #region RowDefinition 
                for (var mainrow = 0; mainrow < 1; mainrow++)
                {
                    var r = new RowDefinition();
                    r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                    //r.Height =new GridLength(400, GridUnitType.Pixel);
                    MainGrid.RowDefinitions.Add(r);
                }


                //MainGrid
                #endregion



                Grid PlantGrid = new Grid();
                PlantGrid.HorizontalAlignment = HorizontalAlignment.Stretch;
                PlantGrid.VerticalAlignment = VerticalAlignment.Stretch;



                if (ProductionTimeList.Count > 0)
                {
                    #region MainRowData 
                    //for (var maindata = 0; maindata < 1; maindata++)
                    //{
                    // plant  binding
                    var PlantList = ProductionTimeList.GroupBy(a => a.SiteName).ToList();
                    if (PlantList.Count > 0)
                    {
                        int plantCount = PlantList.Count();



                        PlantGrid.ShowGridLines = false;
                        //Plantgrid column creation
                        #region ColumnDefinition
                        for (var plantcolum = 0; plantcolum < 1; plantcolum++)
                        {
                            var c = new ColumnDefinition();
                            c.Width = GridLength.Auto;
                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                            PlantGrid.ColumnDefinitions.Add(c);
                        }

                        #endregion
                        //Plantgrid row creation
                        #region RowDefinition 
                        for (var plantrow = 0; plantrow < plantCount; plantrow++)
                        {
                            var r = new RowDefinition();
                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                            PlantGrid.RowDefinitions.Add(r);
                        }

                        #endregion
                        #region plantRowData 
                        //for (var plantdata = 0; plantdata < 4; plantdata++)
                        int Plantrow = 0;
                        foreach (var plantdata in PlantList)
                        {

                            #region Dates
                            Grid DateGrid = new Grid();
                            DateGrid.ShowGridLines = false;

                            #region [GEOS2-6965][rani dhamankar][12-03-2025]
                            var DateList = ProductionTimeList
                                             .Where(x =>
                                                 x.JobDescriptionStartDate.HasValue &&
                                                 (
                                                     (x.AttendanceStartDate.HasValue &&
                                                      x.AttendanceStartDate.Value.Date >= x.JobDescriptionStartDate.Value.Date &&
                                                      (!x.JobDescriptionEndDate.HasValue ||
                                                       (x.JobDescriptionEndDate.HasValue && x.AttendanceEndDate.HasValue &&
                                                        x.AttendanceEndDate.Value.Date <= x.JobDescriptionEndDate.Value.Date)))
                                                     ||
                                                     (x.AttendanceStartDate == null && x.CounterpartStartDate.HasValue &&
                                                      x.CounterpartStartDate.Value.Date >= x.JobDescriptionStartDate.Value.Date &&
                                                      (!x.JobDescriptionEndDate.HasValue ||
                                                       (x.JobDescriptionEndDate.HasValue && x.CounterpartEndDate.HasValue &&
                                                        x.CounterpartEndDate.Value.Date <= x.JobDescriptionEndDate.Value.Date)))
                                                        ||
                                                         (x.AttendanceStartDate == null && x.CounterpartStartDate == null &&
                                                      x.LeaveStartDate.Value.Date >= x.JobDescriptionStartDate.Value.Date &&
                                                      (!x.JobDescriptionEndDate.HasValue ||
                                                       (x.JobDescriptionEndDate.HasValue && x.LeaveStartDate.HasValue &&
                                                        x.LeaveStartDate.Value.Date <= x.JobDescriptionEndDate.Value.Date)))
                                                 )
                                             )
                                              .GroupBy(x => x.AttendanceStartDate == null
                                             ? x.CounterpartStartDate.HasValue ? x.CounterpartStartDate.Value.Date
                                             : (x.LeaveStartDate.HasValue ? x.LeaveStartDate.Value.Date : DateTime.MinValue)
                                             : x.AttendanceStartDate.HasValue ? x.AttendanceStartDate.Value.Date : DateTime.MinValue)
                                             .OrderByDescending(a => a.Key)
                                             .ToList();

                            #endregion

                            //Plantgrid column creation
                            #region ColumnDefinition
                            for (var Datescolumn = 0; Datescolumn < 1; Datescolumn++)
                            {
                                var c = new ColumnDefinition();
                                c.Width = GridLength.Auto;
                                //c.Width = new GridLength(50, GridUnitType.Pixel);
                                DateGrid.ColumnDefinitions.Add(c);
                            }

                            #endregion
                            //Plantgrid row creation
                            #region RowDefinition 
                            for (var Daterow = 0; Daterow < DateList.Count; Daterow++)
                            {
                                var r = new RowDefinition();
                                r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                DateGrid.RowDefinitions.Add(r);
                            }

                            #endregion
                            //  DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();
                            //   DataRow drs = ERMCommon.Instance.DataTableForProductionTimeLineGrid.NewRow();
                            if (DateList.Count > 0)
                            {
                                var FilterData = DateList.Where(a => a.Key.Date >= StartDates.Date && a.Key.Date <= EndDates.Date).ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                int DateRow = 0;
                                if (FilterData.Any())
                                {
                                    foreach (var itemDate in FilterData)
                                    {
                                        // DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();
                                        var index = DateList.IndexOf(itemDate);//[GEOS2-5235][pallavi jadhav]
                                        DateTime? NotNullShiftDate = DateTime.Now;//[GEOS2-5235][pallavi jadhav]
                                        Label PlantName = new Label();
                                        //[GEOS2-5235][pallavi jadhav]
                                        if (DateList.Count - 1 != index)
                                        {
                                            NotNullShiftDate = DateList[index + 1].Key;
                                        }
                                        DateTime? shiftStartDate = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                        DateTime? shiftEndDate = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                        DateTime? Shift_ST_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                        DateTime? Shift_ED_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                        DateTime? OrignalShift_ED_Date = new DateTime();//[GEOS2-8864[gulab lakade][30 07 2025]
                                        DateTime? OrignalShift_SD_Date = new DateTime();//[GEOS2-8864][gulab lakade][30 07 2025]
                                        //[GEOS2-5235][pallavi jadhav]
                                        // DateTime StartDate = Convert.ToDateTime(itemDate.Key.Date);//[GEOS2-5883][gulab lakade][274 06 2024]
                                        PlantName.Content = "Plant: " + Convert.ToString(plantdata.Key) + "        " + "Date: ";// + StartDate.Date.ToString("dd/MM/yyyy");
                                        PlantName.FontWeight = FontWeights.Bold;
                                        //PlantName.Width = 100;
                                        #region [GEOS2-5233][gulab lakade][16 01 2024]
                                        Label DateLabel = new Label();
                                        DateLabel.Content = itemDate.Key.Date.ToString("dd/MM/yyyy");// StartDate.Date.ToString("dd/MM/yyyy");[GEOS2-5883][gulab lakade][274 06 2024]
                                        DateLabel.FontWeight = FontWeights.Bold;
                                        //DateLabel.Width = 100;
                                        ToolTip HolidayTooltips = new ToolTip();
                                        //var TempHolidayRecord = ProductionTimeList.Where(x => x.AttendanceStartDate.Value.Date == StartDate.Date).FirstOrDefault();
                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                        //var TempHolidayRecord = ProductionTimeList.Where(x => x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.AttendanceStartDate.Value.Date == StartDate.Date).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                        //var TempHolidayRecord = itemDate.Where(x => x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == itemDate.Key.Date : x.AttendanceStartDate.Value.Date == itemDate.Key.Date).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]

                                        //[rani dhamankar] [12 - 03 - 2025][GEOS2 - 6965]
                                        var TempHolidayRecord = itemDate
                                         .Where(x =>
                                             (x.AttendanceStartDate == null && x.CounterpartStartDate.HasValue && x.CounterpartStartDate.Value.Date == itemDate.Key.Date)
                                             || (x.AttendanceStartDate.HasValue && x.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                             || (x.AttendanceStartDate == null && x.CounterpartStartDate == null && x.ISHolidayEvent == false && x.LeaveStartDate.HasValue && x.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                         )
                                         .FirstOrDefault();
                                        #endregion
                                        string HolidayType = string.Empty;
                                        string Holidayname = string.Empty;
                                        string HtmlColor = string.Empty;
                                        Image TooltipImage = new Image();
                                        TooltipImage.Visibility = Visibility.Hidden;


                                        if (TempHolidayRecord != null)
                                        {
                                            if (!string.IsNullOrWhiteSpace(TempHolidayRecord.HolidayType))
                                            {
                                                HolidayType = Convert.ToString(TempHolidayRecord.HolidayType);
                                            }
                                            if (!string.IsNullOrWhiteSpace(TempHolidayRecord.HolidayName))
                                            {
                                                Holidayname = Convert.ToString(TempHolidayRecord.HolidayName);
                                            }

                                        }

                                        //string DayName = StartDate.ToString("dddd", new CultureInfo("en-US"));//GEOS2-5883][gulab lakade][274 06 2024]
                                        string DayName = itemDate.Key.Date.ToString("dddd", new CultureInfo("en-US"));//GEOS2-5883][gulab lakade][274 06 2024]
                                        string ToolTipContent = string.Empty;
                                        if ((DayName == "Saturday" || DayName == "Sunday") && (!string.IsNullOrWhiteSpace(Holidayname)))
                                        {
                                            TimeSpan holidayStarttime = TempHolidayRecord.HolidayStartDate.Value.TimeOfDay;
                                            string holidayStarttimeInString = holidayStarttime.ToString("hh\\:mm");
                                            TimeSpan holidayEndtime = TempHolidayRecord.HolidayEndDate.Value.TimeOfDay;
                                            string holidayEndtimeInString = holidayEndtime.ToString("hh\\:mm");
                                            if (TempHolidayRecord.ISHolidayEvent == true)
                                            {
                                                ToolTipContent = "\r" + DayName + "\r\n" + Holidayname + "\r\n" + HolidayType;
                                            }
                                            else
                                            {
                                                ToolTipContent = "\r" + DayName + "\r\n" + Holidayname + " (" + holidayStarttimeInString + "-" + holidayEndtimeInString + ")\r\n" + HolidayType;
                                            }

                                            DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                            //  dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                            HtmlColor = Convert.ToString("#FF0000");
                                            TooltipImage.Visibility = Visibility.Visible;
                                        }
                                        else if ((DayName == "Saturday" || DayName == "Sunday") && string.IsNullOrWhiteSpace(Holidayname))
                                        {
                                            ToolTipContent = DayName;
                                            DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#808080"));
                                            // dr["DateHTMLColor"] = Convert.ToString("#808080");
                                            HtmlColor = Convert.ToString("#808080");
                                            TooltipImage.Visibility = Visibility.Visible;
                                        }
                                        else
                                            if ((!string.IsNullOrWhiteSpace(Holidayname)))
                                        {
                                            if (TempHolidayRecord.ISHolidayEvent == true)
                                            {
                                                ToolTipContent = "\r" + Holidayname + "\r\n " + HolidayType;
                                                DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                                //  dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                                HtmlColor = Convert.ToString("#FF0000");
                                                TooltipImage.Visibility = Visibility.Visible;
                                            }
                                            else
                                            {
                                                TimeSpan holidayStarttime = TempHolidayRecord.HolidayStartDate.Value.TimeOfDay;
                                                string holidayStarttimeInString = holidayStarttime.ToString("hh\\:mm");
                                                TimeSpan holidayEndtime = TempHolidayRecord.HolidayEndDate.Value.TimeOfDay;
                                                string holidayEndtimeInString = holidayEndtime.ToString("hh\\:mm");
                                                ToolTipContent = "\r" + Holidayname + " (" + holidayStarttimeInString + "-" + holidayEndtimeInString + ")\r\n" + HolidayType;
                                                DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                                // dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                                HtmlColor = Convert.ToString("#FF0000");
                                                TooltipImage.Visibility = Visibility.Visible;
                                            }

                                        }
                                        try
                                        {
                                            BitmapImage bitmapTooltip = new BitmapImage(new Uri(@"/Emdep.Geos.Modules.ERM;component/Assets/Images/INFO1.png", UriKind.Relative));

                                            TooltipImage.Source = bitmapTooltip;

                                            TooltipImage.Width = 20;
                                            TooltipImage.Height = 20;
                                            TooltipImage.ToolTip = ToolTipContent;
                                        }
                                        catch (Exception ex)
                                        {

                                        }


                                        #endregion
                                        #region StageGrid


                                        //if (plantdata == 0)
                                        //{



                                        Grid PlantTempGrid = new Grid();
                                        PlantTempGrid.ShowGridLines = false;

                                        //Stagegrid column creation
                                        #region ColumnDefinition
                                        for (var Stage1column = 0; Stage1column < 4; Stage1column++)
                                        {
                                            var c = new ColumnDefinition();
                                            if (Stage1column == 0)
                                            {
                                                c.Width = GridLength.Auto;
                                            }
                                            else if (Stage1column == 1)
                                            {
                                                c.Width = GridLength.Auto;
                                            }
                                            else if (Stage1column == 2)
                                            {
                                                c.Width = new GridLength(30, GridUnitType.Pixel);
                                            }
                                            else if (Stage1column == 3)
                                            {
                                                c.Width = new GridLength(1180, GridUnitType.Pixel);
                                            }

                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                            PlantTempGrid.ColumnDefinitions.Add(c);
                                        }

                                        #endregion
                                        //Plantgrid row creation
                                        #region RowDefinition 
                                        for (var Stage1row = 0; Stage1row < 2; Stage1row++)
                                        {
                                            var r = new RowDefinition();
                                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);

                                            PlantTempGrid.RowDefinitions.Add(r);
                                        }

                                        #endregion

                                        #region stage4

                                        Grid StageGrid = new Grid();
                                        StageGrid.ShowGridLines = false;

                                        #region [GEOS2-5883][gulab lakade][274 06 2024]

                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                        var IdJobdescriptionList = itemDate
                                         .Where(x => x.SiteName == plantdata.Key
                                                     && x.IsMainJobDescription == 1
                                                     && (
                                                         (x.AttendanceStartDate == null && x.CounterpartStartDate.HasValue && x.CounterpartStartDate.Value.Date == itemDate.Key.Date)
                                                         || (x.AttendanceStartDate.HasValue && x.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                         || (x.AttendanceStartDate == null && x.CounterpartStartDate == null && x.LeaveStartDate.HasValue && x.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                     )
                                                 )
                                         .GroupBy(a => a.IdJobDescription)
                                         .ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]

                                        List<PlanningDateReviewStages> TempStageList = new List<PlanningDateReviewStages>();
                                        if (IdJobdescriptionList != null && IdJobdescriptionList.Count() > 0)
                                        {
                                            foreach (var item in ERMCommon.Instance.WorkStageWiseJobDescription)
                                            {
                                                List<Int32> IdJobdescription = new List<int>();
                                                IdJobdescription = item.IdJobDescription.Select(int.Parse).ToList();
                                                var FindStage = IdJobdescriptionList.Where(x => IdJobdescription.Contains(x.Key)).ToList();
                                                if (FindStage.Count() > 0)
                                                {
                                                    var temp = ERMCommon.Instance.StageList.Where(x => x.IdStage == item.IdWorkStage).FirstOrDefault();
                                                    TempStageList.Add(temp);
                                                }
                                            }
                                        }

                                        if (ERMCommon.Instance.SelectedProductionTimeStagesList.Count() > 0)
                                        {
                                            List<Int32> TempSelectedIdStage = ERMCommon.Instance.SelectedProductionTimeStagesList.Cast<PlanningDateReviewStages>().Select(x => x.IdStage).ToList();

                                            TempStageList = TempStageList.Where(x => TempSelectedIdStage.Contains(x.IdStage)).ToList();
                                        }
                                        var StageList = TempStageList.OrderBy(x => x.Sequence).GroupBy(a => a.StageCode).ToList();

                                        int StageCount = StageList.Count();
                                        #endregion
                                        //Stagegrid column creation
                                        #region ColumnDefinition
                                        for (var Stagecolumn = 0; Stagecolumn < 1; Stagecolumn++)
                                        {
                                            var c = new ColumnDefinition();
                                            c.Width = GridLength.Auto;
                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                            StageGrid.ColumnDefinitions.Add(c);
                                        }

                                        #endregion
                                        //Plantgrid row creation
                                        #region RowDefinition 
                                        for (var Stagerow = 0; Stagerow < StageCount; Stagerow++)
                                        {
                                            var r = new RowDefinition();
                                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                            StageGrid.RowDefinitions.Add(r);
                                        }

                                        #endregion
                                        //for(int stagedata=0; stagedata< StageCount; stagedata++)
                                        int StageRow = 0;
                                        List<ERM_ProductionTimeline> ERM_ProductionTimelineExistingEmP = new List<ERM_ProductionTimeline>();

                                        foreach (var stagedata in StageList)
                                        {

                                            Grid stageTempGrid = new Grid();
                                            stageTempGrid.ShowGridLines = false;

                                            //Stagegrid column creation
                                            #region ColumnDefinition
                                            for (var Stage1column = 0; Stage1column < 1; Stage1column++)
                                            {
                                                var c = new ColumnDefinition();
                                                c.Width = GridLength.Auto;
                                                //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                stageTempGrid.ColumnDefinitions.Add(c);
                                            }

                                            #endregion
                                            //Plantgrid row creation
                                            #region RowDefinition 
                                            for (var Stage1row = 0; Stage1row < 4; Stage1row++)
                                            {
                                                var r = new RowDefinition();
                                                if (Stage1row == 2)
                                                {
                                                    r.Height = new GridLength(10, GridUnitType.Pixel);
                                                }
                                                else
                                                {
                                                    r.Height = GridLength.Auto;
                                                }

                                                stageTempGrid.RowDefinitions.Add(r);
                                            }

                                            #endregion

                                            //string StagesName = ProductionTimeList.Where(x => x.StageCode == stagedata.Key && x.SiteName == plantdata.Key).FirstOrDefault().StageName;
                                            string StagesName = TempStageList.Where(x => x.StageCode == stagedata.Key).FirstOrDefault().StageName;
                                            Label StageName = new Label();
                                            StageName.Content = Convert.ToString(stagedata.Key) + " - " + StagesName;
                                            StageName.FontWeight = FontWeights.Bold;
                                            //Grid.SetRow(StageName, 0);
                                            //Grid.SetColumn(StageName, 0);

                                            #region emp

                                            //var EmployeeCodeList = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && a.AttendanceStartDate.Value.Date == StartDate.Date).GroupBy(x => x.EmployeeCode).ToList();
                                            //var EmployeeCodeList11 = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && a.AttendanceStartDate == null && a.CounterpartStartDate.Value.Date == StartDate.Date).ToList();

                                            #region [GEOS2-5883][gulab lakade][274 06 2024]
                                            //var EmployeeCodeList11 = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).ToList();
                                            //var EmployeeCodeList = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).GroupBy(x => x.EmployeeCode).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                            var StageRecord = ERMCommon.Instance.StageList.Where(x => x.StageCode == stagedata.Key).FirstOrDefault();
                                            List<string> IdJobdescriptionINstring = ERMCommon.Instance.WorkStageWiseJobDescription.Where(a => a.IdWorkStage == StageRecord.IdStage).FirstOrDefault().IdJobDescription;
                                            List<Int32> IdJobdescription = new List<int>();
                                            IdJobdescription = IdJobdescriptionINstring.Select(int.Parse).ToList();


                                            var EmployeeCodeList = itemDate.Where(a => a.SiteName == plantdata.Key && IdJobdescription.Contains(a.IdJobDescription) && a.IsMainJobDescription == 1 && ((a.AttendanceStartDate == null && a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date) || (a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date) || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date))).GroupBy(x => x.EmployeeCode).ToList();////[GEOS2-6965][rani dhamankar][12-03-2025]
                                            #endregion
                                            int EmployeeCount = EmployeeCodeList.Count();
                                            Grid EmpGrid = new Grid();
                                            EmpGrid.ShowGridLines = false;

                                            //Stagegrid column creation
                                            #region ColumnDefinition
                                            for (var empcolumn = 0; empcolumn < 4; empcolumn++)
                                            {
                                                var c = new ColumnDefinition();
                                                if (empcolumn == 0)
                                                {
                                                    c.Width = new GridLength(220, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 1)
                                                {
                                                    c.Width = new GridLength(100, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 2)
                                                {
                                                    c.Width = GridLength.Auto; //new GridLength(600, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 3)
                                                {
                                                    c.Width = new GridLength(70, GridUnitType.Pixel);
                                                }
                                                //c.Width = GridLength.Auto;
                                                //c.Width = new GridLength(150, GridUnitType.Pixel);
                                                EmpGrid.ColumnDefinitions.Add(c);
                                            }

                                            #endregion
                                            //Plantgrid row creation
                                            #region RowDefinition 
                                            for (var emprow = 0; emprow < EmployeeCount; emprow++)
                                            {
                                                var r = new RowDefinition();
                                                r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                EmpGrid.RowDefinitions.Add(r);
                                            }

                                            #endregion



                                            //for(int i=0; i<2;i++)
                                            int empcount = 0;

                                            foreach (var emp in EmployeeCodeList)
                                            {
                                                TimeSpan Hours_24 = new TimeSpan();
                                                TimeSpan Hours_0 = new TimeSpan();
                                                Hours_24 = TimeSpan.FromMinutes(1440);//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                Hours_0 = TimeSpan.Zero;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_24 = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_0 = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_Night = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                DateTime? MinAtt_Date = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                                DateTime? MaxAtt_Date = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                                Shift_ST_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                Shift_ED_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                TimeSpan tmpStartTimeCheck = new TimeSpan(14, 00, 0);
                                                TimeSpan tmpENDTimeCheck = new TimeSpan(12, 00, 0);

                                                //var TmpMinMaxATT = ProductionTimeList.Where(a => a.StageCode == stagedata.Key && a.EmployeeCode == emp.Key && a.AttendanceStartDate != null
                                                //&& (a.IsNightShift == 1  ? (a.AttendanceStartDate.Value.Date >= itemDate.Key.Date && a.AttendanceEndDate.Value.Date <= itemDate.Key.Date.AddDays(1)) : (a.AttendanceStartDate.Value.Date == itemDate.Key.Date && a.AttendanceEndDate.Value.Date == itemDate.Key.Date))).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                var TmpMinMaxATT = ProductionTimeList.Where(a => a.EmployeeCode == emp.Key && a.AttendanceStartDate != null
                                                && (a.IsNightShift == 1 && a.ShiftStartTime >= tmpStartTimeCheck ? (a.AttendanceStartDate.Value >= itemDate.Key.Date.Add(a.ShiftStartTime.Subtract(TimeSpan.FromHours(2))) && a.AttendanceEndDate.Value <= itemDate.Key.Date.AddDays(1).Date.Add(tmpENDTimeCheck)) : (a.AttendanceStartDate.Value.Date == itemDate.Key.Date && a.AttendanceEndDate.Value.Date == itemDate.Key.Date))).ToList();// [GEOS2-7755][gulab lakade][08 04 2025]
                                                #endregion 
                                                ERM_ProductionTimeline employee = new ERM_ProductionTimeline();
                                                if (TmpMinMaxATT.Count() > 0)
                                                {
                                                    DateTime? Shift_std_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                    Shift_std_Date = itemDate.Key.Date.Add(tmpStartTimeCheck);
                                                    DateTime? Shift_edd_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]

                                                    var Tmpshift = TmpMinMaxATT.FirstOrDefault();
                                                    TimeSpan tmptimespan = new TimeSpan(2, 0, 0);
                                                    TimeSpan tmpShiftStartTime = new TimeSpan(Tmpshift.ShiftStartTime.Hours, 0, 0);
                                                    TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                    if (Tmpshift.ShiftEndTime.Minutes > 0)
                                                    {
                                                        tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                    }
                                                    Shift_ST_Date = Shift_ST_Date.Value.Date.Add(Tmpshift.ShiftStartTime); //[GEOS2-7755][gulab lakade] [08 04 2025]
                                                    OrignalShift_SD_Date = Shift_ST_Date; //[GEOS2-8864][gulab lakade][30 07 2025]

                                                    if (Tmpshift.IsNightShift == 1)
                                                    {

                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        Shift_edd_Date = itemDate.Key.Date.AddDays(1);
                                                        Shift_edd_Date = Shift_edd_Date.Value.Date.Add(tmpENDTimeCheck);
                                                        #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                        //MinAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceStartDate > Shift_std_Date).Min(a => a.AttendanceStartDate);
                                                        MinAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceStartDate > Shift_std_Date && x.AttendanceStartDate < Shift_edd_Date).Min(a => a.AttendanceStartDate);
                                                        #endregion 
                                                        MaxAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceEndDate < Shift_edd_Date).Max(a => a.AttendanceEndDate);

                                                        shiftStartDate = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                        //TimeSpan tmpStartTimeCheck = new TimeSpan(17, 00, 0);
                                                        //TimeSpan tmpENDTimeCheck = new TimeSpan(12, 00, 0);

                                                        if (tmpShiftStartTime >= tmpStartTimeCheck)
                                                        {
                                                            //[GEOS2-7092][gulab lakade][22 05 2025]
                                                            if (shiftStartDate > MinAtt_Date)
                                                            {
                                                                shiftStartDate = MinAtt_Date;
                                                            }
                                                            else
                                                            {
                                                                MinAtt_Date = shiftStartDate;

                                                            }
                                                            //end[GEOS2-7092][gulab lakade][22 05 2025]
                                                            if (tmpShiftEndTime >= tmpENDTimeCheck)
                                                            {
                                                                shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                                OrignalShift_ED_Date = itemDate.Key.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                            }
                                                            else
                                                            {
                                                                shiftEndDate = itemDate.Key.Date.AddDays(1);
                                                                OrignalShift_ED_Date = shiftEndDate.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                shiftEndDate = shiftEndDate.Value.Date.Add(tmpShiftEndTime);
                                                                //Shift_ED_Date = Shift_ED_Date.Value.Date.AddDays(1).Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                            }
                                                            if (MaxAtt_Date < shiftEndDate)
                                                            {
                                                                MaxAtt_Date = shiftEndDate;
                                                            }
                                                            else
                                                            {
                                                                TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                                if (tmpenddt.Minutes > 0)
                                                                {
                                                                    TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                                    tmpenddt = tmpenddt.Add(tmpspan);
                                                                    tmpspan = new TimeSpan(0, tmpenddt.Minutes, 0);
                                                                    tmpenddt = tmpenddt.Subtract(tmpspan);
                                                                }
                                                                shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                            }
                                                        }
                                                        else
                                                        {
                                                            MinAtt_Date = shiftStartDate;
                                                            shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                            OrignalShift_ED_Date = itemDate.Key.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                            if (MaxAtt_Date < shiftEndDate)
                                                            {
                                                                MaxAtt_Date = shiftEndDate;
                                                            }
                                                            else
                                                            {
                                                                TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                                if (tmpenddt.Minutes > 0)
                                                                {
                                                                    TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                                    tmpenddt = tmpenddt.Add(tmpspan);
                                                                    tmpspan = new TimeSpan(0, tmpenddt.Minutes, 0);
                                                                    tmpenddt = tmpenddt.Subtract(tmpspan);
                                                                }
                                                                shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                            }
                                                            //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                        }
                                                        #endregion 

                                                    }
                                                    else
                                                    {
                                                        MinAtt_Date = TmpMinMaxATT.Min(a => a.AttendanceStartDate);
                                                        MaxAtt_Date = TmpMinMaxATT.Max(a => a.AttendanceEndDate);
                                                        shiftStartDate = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                        shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                        OrignalShift_ED_Date = itemDate.Key.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                        if (MinAtt_Date <= shiftStartDate)
                                                        {
                                                            TimeSpan tmpenddt = MinAtt_Date.Value.TimeOfDay;
                                                            TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                            tmpenddt = tmpenddt.Add(-tmpspan);
                                                            tmpShiftStartTime = tmpenddt;
                                                            shiftStartDate = MinAtt_Date.Value.Date.Add(tmpenddt);
                                                        }


                                                        if (MaxAtt_Date.Value.TimeOfDay >= tmpShiftEndTime)
                                                        {
                                                            TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                            //TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                            //tmpenddt = tmpenddt.Add(tmpspan);
                                                            tmpShiftEndTime = tmpenddt;
                                                            shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                        }
                                                        //else
                                                        //{
                                                        //    shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                        //}


                                                        //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                    }

                                                }
                                                else
                                                {
                                                    var Tmpshift = emp.FirstOrDefault();
                                                    if (Tmpshift != null)
                                                    {
                                                        #region [GEOS2-7755][gulab lakade][16 04 2025]
                                                        OrignalShift_SD_Date = itemDate.Key.Date.Add(Tmpshift.ShiftStartTime); //[GEOS2-8864][gulab lakade][30 07 2025]
                                                        if (Tmpshift.IsNightShift == 1)
                                                        {
                                                            TimeSpan tmpShiftStartTime = Tmpshift.ShiftStartTime;


                                                            TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                            if (tmpShiftStartTime >= tmpStartTimeCheck)
                                                            {
                                                                if (tmpShiftEndTime >= tmpENDTimeCheck)
                                                                {
                                                                    shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                                    OrignalShift_ED_Date = itemDate.Key.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                }
                                                                else
                                                                {
                                                                    shiftEndDate = itemDate.Key.Date.AddDays(1);
                                                                    OrignalShift_ED_Date = shiftEndDate.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                    shiftEndDate = shiftEndDate.Value.Date.Add(tmpShiftEndTime);
                                                                }

                                                            }
                                                            else
                                                            {
                                                                shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                                OrignalShift_ED_Date = itemDate.Key.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                            }
                                                            shiftStartDate = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                            MinAtt_Date = shiftStartDate;
                                                            MaxAtt_Date = shiftEndDate;
                                                        }
                                                        else
                                                        {
                                                            TimeSpan tmpShiftStartTime = Tmpshift.ShiftStartTime;
                                                            TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                            MinAtt_Date = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                            MaxAtt_Date = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                            shiftStartDate = itemDate.Key.Date.Add(tmpShiftStartTime);
                                                            shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                            OrignalShift_ED_Date = itemDate.Key.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                        }

                                                        #endregion
                                                    }

                                                }
                                                #endregion

                                                #region [GEOS2-5883][gulab lakade][274 06 2024]


                                                if (MinAtt_Date >= shiftStartDate && MaxAtt_Date <= shiftEndDate)//[GEOS2-7641][gulab lakade][27 03 2025]
                                                {


                                                    //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                    #region [GEOS2-7755][gulab lakade][08 04 2025]



                                                    var employeelist = emp.Where(a => a.SiteName == plantdata.Key
                                                                                                               && a.EmployeeCode == emp.Key
                                                                                                               && (
                                                                                                                   (
                                                                                                                       a.IsNightShift == 1
                                                                                                                       ? (a.AttendanceStartDate == null
                                                                                                                           ? a.CounterpartStartDate.HasValue && (a.CounterpartStartDate >= MinAtt_Date && a.CounterpartStartDate <= MaxAtt_Date)
                                                                                                                           : (a.AttendanceStartDate >= MinAtt_Date && a.AttendanceStartDate <= MaxAtt_Date))
                                                                                                                       : (a.AttendanceStartDate == null
                                                                                                                           ? a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                                                                                           : a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                                                                                   )
                                                                                                                   || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                                                                               )
                                                                                                               && a.JobDescriptionStartDate.HasValue
                                                                                                               && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date
                                                                                                               && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate.HasValue && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))
                                                                                                   )
                                                                                                   .OrderBy(a => a.CounterPartStartTime == null ? TimeSpan.MaxValue : a.CounterPartStartTime)
                                                                                                   .ThenBy(a => a.LeaveStartDate == null ? DateTime.MinValue : a.LeaveStartDate)
                                                                                                   .ToList();


                                                    employee = emp
                                               .Where(a => a.SiteName == plantdata.Key
                                                                                                               && a.EmployeeCode == emp.Key
                                                                                                               && (
                                                                                                                   (
                                                                                                                       a.IsNightShift == 1
                                                                                                                       ? (a.AttendanceStartDate == null
                                                                                                                           ? a.CounterpartStartDate.HasValue && (a.CounterpartStartDate >= MinAtt_Date && a.CounterpartStartDate <= MaxAtt_Date)
                                                                                                                           : (a.AttendanceStartDate >= MinAtt_Date && a.AttendanceStartDate <= MaxAtt_Date))
                                                                                                                       : (a.AttendanceStartDate == null
                                                                                                                           ? a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                                                                                           : a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                                                                                   )
                                                                                                                   || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                                                                               )
                                                                                                               && a.JobDescriptionStartDate.HasValue
                                                                                                               && a.JobDescriptionStartDate.Value.Date <= itemDate.Key.Date
                                                                                                               && (a.JobDescriptionEndDate == null || (a.JobDescriptionEndDate.HasValue && a.JobDescriptionEndDate.Value.Date >= itemDate.Key.Date))
                                                                                                   )
                                               .FirstOrDefault();
                                                    #endregion
                                                    #endregion
                                                    //var employeelist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date) && a.CounterpartStartDate.Value.Date == StartDate.Date).OrderBy(a => a.CounterPartStartTime).ToList();
                                                    //employee = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key  && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).FirstOrDefault();
                                                    if (employee != null)
                                                    {
                                                        //  string detailsofmeetings = string.Empty; //[GEOS2-9197][pallavi jadhav][26-08-2025]
                                                        #region [GEOS2-6738][gulab lakade][01 02 2025]
                                                        List<string> Emp_Stage = new List<string>();
                                                        Emp_Stage = employeelist.GroupBy(a => a.StageCode).Select(b => b.Key).ToList();
                                                        Emp_Stage.AddRange(employeelist.GroupBy(a => a.NonOT_Code).Select(b => b.Key).ToList());
                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        #endregion
                                                        DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();//[GEOS2-5394][gulab lakade][19 02 2024]

                                                        //start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        double TotalShiftTime = 0;
                                                        //[GEOS2-8864][gulab lakade][30 07 2025]
                                                        TotalShiftTime = (OrignalShift_ED_Date.Value.TimeOfDay - OrignalShift_SD_Date.Value.TimeOfDay).TotalHours;
                                                        //[GEOS2-8864][gulab lakade][30 07 2025]
                                                        if (employee.IsNightShift == 1)
                                                        {
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                TimeSpan tmpdiff_shift = shiftEndDate.Value.TimeOfDay - shiftStartDate.Value.TimeOfDay;
                                                                //TotalShiftTime = tmpdiff_shift.TotalHours;
                                                                TotalHours_Night = tmpdiff_shift.TotalMinutes;
                                                            }
                                                            else
                                                            {

                                                                TotalHours_24 = (Hours_24 - shiftStartDate.Value.TimeOfDay).TotalHours;
                                                                TotalHours_0 = (shiftEndDate.Value.TimeOfDay - Hours_0).TotalHours;
                                                                TotalHours_0 = TotalHours_0 + 1;//[GEOS2-6771][gulab lakade][04 20 2025]
                                                                TotalHours_Night = TotalHours_24 + TotalHours_0;
                                                                TimeSpan totalHoursInTimespan = (Hours_24 - shiftStartDate.Value.TimeOfDay) + (shiftEndDate.Value.TimeOfDay - Hours_0);
                                                                //TotalShiftTime = Math.Round((Convert.ToDouble((totalHoursInTimespan).TotalMinutes) / 60), 4);
                                                                //[GEOS2-7755][gulab lakade][22 04 2025]
                                                            }
                                                            #endregion

                                                        }
                                                        else
                                                        {
                                                            //TotalShiftTime = ShiftEndTime - ShiftStartTime;
                                                            //TotalShiftTime = (shiftEndDate.Value.TimeOfDay - shiftStartDate.Value.TimeOfDay).TotalHours;
                                                        }
                                                        //end[GEOS2-5515][gulab lakade][28 03 2024]

                                                        double BreackTimeIndouble = Math.Round((Convert.ToDouble((employee.BreakTime).TotalMinutes) / 60), 4);

                                                        double TotalShiftInDouble = TotalShiftTime - BreackTimeIndouble;
                                                        //double TotalShiftInDouble = TotalShiftTime;
                                                        #region Attendance
                                                        double MaxEndLeaveTimeInDouuble = 0;
                                                        double AttendanceStartTimeDecimal = 0;
                                                        double AttenadnceEndTimeDecimal = 0;
                                                        TimeSpan AttendanceStartTime = new TimeSpan();
                                                        TimeSpan AttenadnceEndTime = new TimeSpan();
                                                        TimeSpan MaxEndLeaveTime = new TimeSpan();
                                                        string Week = string.Empty;
                                                        try
                                                        {



                                                            if (employeelist.Where(a => a.AttendanceStartDate != null).ToList().Count() > 0)
                                                            {
                                                                var tempStartAttendence = employeelist.OrderBy(a => a.AttendanceStartDate.Value.TimeOfDay).FirstOrDefault();
                                                                Week = tempStartAttendence.AttendanceWeek;
                                                                AttendanceStartTime = tempStartAttendence.AttendanceStartDate.Value.TimeOfDay;

                                                                //TimeSpan AttendanceStartTime = employee.AttendanceStartDate.Value.TimeOfDay;
                                                                //TimeSpan AttendanceStartTime = employee.AttendanceStartDate.Value.TimeOfDay;
                                                                AttendanceStartTimeDecimal = AttendanceStartTime.TotalHours;

                                                                var tempEndAttendence = employeelist.OrderByDescending(a => a.AttendanceEndDate.Value.TimeOfDay).FirstOrDefault();

                                                                AttenadnceEndTime = tempEndAttendence.AttendanceEndDate.Value.TimeOfDay;
                                                                //TimeSpan AttenadnceEndTime = employee.AttendanceEndDate.Value.TimeOfDay;
                                                                AttenadnceEndTimeDecimal = AttenadnceEndTime.TotalHours;
                                                                MaxEndLeaveTime = employeelist.OrderByDescending(a => a.LeaveEndTime).FirstOrDefault().LeaveEndTime;
                                                                MaxEndLeaveTimeInDouuble = MaxEndLeaveTime.TotalHours;
                                                            }
                                                            double TotalAttendanceHours = 0;// AttenadnceEndTimeDecimal - AttendanceStartTimeDecimal;
                                                                                            //double BreakTime = Math.Round((Convert.ToDouble((employee.BreakTime).TotalMinutes) / 60), 4);

                                                            //double BreakStartTime = Math.Round((Convert.ToDouble((employee.BreakStartTime).TotalMinutes)));

                                                            //double BreakEndTime = Math.Round((Convert.ToDouble((employee.BreakEndTime).TotalMinutes)));
                                                            //double TempBreakTime = BreakEndTime - BreakStartTime;

                                                            //double TempTotalShiftTime = ShiftEndTime - ShiftStartTime;
                                                            //double TotalWithoutBreak = Math.Round((((TempTotalShiftTime * 60) - TempBreakTime) / 60), 4);

                                                            #region [rani dhamankar][12-03-2025][GEOS2-6965]
                                                            if (employeelist.Where(a => a.LeaveStartDate != null && a.LeavesAllDayEvent == 1 && a.ISHolidayEvent == false).ToList().Count() > 0)
                                                            {
                                                                var tempStartAttendence = employeelist.Where(a => a.LeaveStartDate != null && a.LeavesAllDayEvent == 1 && a.ISHolidayEvent == false).OrderBy(a => a.LeaveStartDate.Value.TimeOfDay).FirstOrDefault();
                                                                Week = tempStartAttendence.AttendanceWeek;
                                                                AttendanceStartTime = tempStartAttendence.ShiftStartTime;
                                                                AttendanceStartTimeDecimal = AttendanceStartTime.TotalHours;

                                                                //var tempEndAttendence = employeelist.OrderByDescending(a => a.LeaveEndDate.Value.TimeOfDay).FirstOrDefault();

                                                                AttenadnceEndTime = tempStartAttendence.LeaveEndDate.Value.TimeOfDay;
                                                                //TimeSpan AttenadnceEndTime = employee.AttendanceEndDate.Value.TimeOfDay;
                                                                AttenadnceEndTimeDecimal = AttenadnceEndTime.TotalHours;
                                                                MaxEndLeaveTime = tempStartAttendence.ShiftEndTime;
                                                                MaxEndLeaveTimeInDouuble = MaxEndLeaveTime.TotalHours;
                                                            }
                                                            #endregion


                                                        }
                                                        catch (Exception ex)
                                                        {

                                                        }
                                                        TimeSpan TotalLoggedTime = new TimeSpan();
                                                        double TotalAttendanceWithoutLeave = 0;
                                                        #endregion

                                                        #region Logged
                                                        //TimeSpan loggedStartTime = employee.CounterpartStartDate.Value.TimeOfDay;
                                                        ////double LoggedStartTimeDecimal = loggedStartTime.TotalHours;
                                                        //double LoggedStartTimeDecimal = Math.Round(loggedStartTime.TotalHours, 2);

                                                        //TimeSpan LoggedEndTime = employee.CounterpartEndDate.Value.TimeOfDay;
                                                        //// double LoggedEndTimeDecimal = LoggedEndTime.TotalHours;
                                                        //double LoggedEndTimeDecimal = Math.Round(LoggedEndTime.TotalHours, 2);
                                                        Week = employee.AttendanceWeek;
                                                        #endregion


                                                        TextBox empName = new TextBox();

                                                        empName.Text = employee.EmployeeName;
                                                        empName.Width = 140;
                                                        empName.TextWrapping = TextWrapping.Wrap;
                                                        empName.TextAlignment = TextAlignment.Center;
                                                        empName.IsReadOnly = true;
                                                        empName.BorderBrush = new SolidColorBrush(Colors.Transparent);
                                                        var employeeImageKey = employee.EmployeeCode;
                                                        Image EmployeeImage = new Image();
                                                        BitmapImage bitmapImage = new BitmapImage();

                                                        #region [GEOS2-6693][rani dhamankar][28-02-2025]
                                                        if (!ERMCommon.Instance.ImagesDictionary.ContainsKey(employeeImageKey))
                                                        {
                                                            try
                                                            {
                                                                // Construct the URL for the rounded employee image
                                                                string tempEMPImageUrl = $"https://api.emdep.com/GEOS/Images.aspx?FilePath=/Images/Employees/Rounded/{employee.EmployeeCode}.png";

                                                                // Use the delegate to convert the image URL to a byte array
                                                                byte[] imageBytes = ImageUrlToByteArrayUsingDelegate(tempEMPImageUrl);
                                                                if (imageBytes.Length > 0)
                                                                {
                                                                    // Create the BitmapImage from the byte array
                                                                    using (MemoryStream ms = new MemoryStream(imageBytes))
                                                                    {
                                                                        bitmapImage.BeginInit();
                                                                        bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                                                                        bitmapImage.StreamSource = ms;
                                                                        bitmapImage.EndInit();
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    // Fallback image URL if the original image is empty
                                                                    string fallbackImageUrl = $"https://api.emdep.com/GEOS/Images.aspx?FilePath=/Images/Employees/{employee.EmployeeCode}.png";
                                                                    imageBytes = ImageUrlToByteArrayUsingDelegate(fallbackImageUrl);

                                                                    using (MemoryStream ms = new MemoryStream(imageBytes))
                                                                    {
                                                                        bitmapImage.BeginInit();
                                                                        bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                                                                        bitmapImage.StreamSource = ms;
                                                                        bitmapImage.EndInit();
                                                                    }
                                                                }

                                                                // Store the loaded image in the memory cache (ImagesDictionary) for future use
                                                                ERMCommon.Instance.ImagesDictionary.Add(employee.EmployeeCode, bitmapImage);
                                                            }
                                                            catch (Exception ex)
                                                            {
                                                                // Handle any exceptions that may occur during image loading
                                                                Console.WriteLine($"Error loading image: {ex.Message}");
                                                            }
                                                        }
                                                        else
                                                        {
                                                            // If the image exists in memory, retrieve it from the dictionary
                                                            bitmapImage = ERMCommon.Instance.ImagesDictionary[employee.EmployeeCode];
                                                        }
                                                        #endregion

                                                        #endregion
                                                        var images = ERMCommon.Instance.ImagesDictionary.Where(a => a.Key == employee.EmployeeCode).FirstOrDefault();
                                                        EmployeeImage.Source = images.Value;
                                                        EmployeeImage.Width = 100;
                                                        EmployeeImage.Height = 100;
                                                        #region Image and EMP Name
                                                        Grid ImageGrid = new Grid();
                                                        //Image and EMP Name column creation
                                                        //ImageGrid.ShowGridLines = true;
                                                        #region ColumnDefinition
                                                        for (var Imagecolumn = 0; Imagecolumn < 1; Imagecolumn++)
                                                        {
                                                            var c = new ColumnDefinition();
                                                            c.Width = GridLength.Auto;

                                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                            ImageGrid.ColumnDefinitions.Add(c);
                                                        }

                                                        #endregion
                                                        //Image and EMP Name row creation
                                                        #region RowDefinition 
                                                        for (var Imagerow = 0; Imagerow < 2; Imagerow++)
                                                        {
                                                            var r = new RowDefinition();
                                                            if (Imagerow == 0)
                                                            {
                                                                r.Height = new GridLength(120, GridUnitType.Pixel);
                                                            }
                                                            else
                                                            {
                                                                //r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                                r.Height = new GridLength(47, GridUnitType.Pixel);
                                                            }

                                                            ImageGrid.RowDefinitions.Add(r);


                                                        }
                                                        //ImageGrid.ShowGridLines = true;
                                                        ImageGrid.Width = 180;
                                                        //ImageGrid.Height = 120;
                                                        #endregion
                                                        //Border Imageborder = new Border()
                                                        //{
                                                        //    BorderThickness = new Thickness()
                                                        //    {
                                                        //        Bottom = 1,
                                                        //        Left = 1,
                                                        //        Right = 1,
                                                        //        Top = 1
                                                        //    },
                                                        //    BorderBrush = new SolidColorBrush(Colors.Black)
                                                        //};
                                                        //Grid.SetRow(Imageborder, 0);
                                                        //Grid.SetColumn(Imageborder, 0);

                                                        Grid.SetRow(EmployeeImage, 0);
                                                        Grid.SetColumn(EmployeeImage, 0);
                                                        Grid.SetRow(empName, 1);
                                                        Grid.SetColumn(empName, 0);
                                                        // ImageGrid.Children.Add(Imageborder);
                                                        ImageGrid.Children.Add(EmployeeImage);
                                                        ImageGrid.Children.Add(empName);



                                                        #endregion

                                                        #region Aishwarya [Geos2-5853]


                                                        var downloadTransferredTimes = ProductionTimeList.Where(x => x.PauseType == "Download" || x.PauseType == "Transferred" && x.SiteName == employee.SiteName && x.EmployeeCode == employee.EmployeeCode && x.StageCode == employee.StageCode).FirstOrDefault(); //&& (x.BreakStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.BreakStartDate .Value.Date == StartDate.Date)
                                                        TimeSpan totalDuration = TimeSpan.Zero;
                                                        if (downloadTransferredTimes != null)
                                                        {

                                                            TimeSpan duration = downloadTransferredTimes.CounterPartEndTime - downloadTransferredTimes.CounterPartStartTime;
                                                            totalDuration += duration;

                                                        }

                                                        #endregion


                                                        //EmployeeProfile.Source
                                                        #region Pallavi
                                                        LinearGaugeControl linearGauge = new LinearGaugeControl();
                                                        // linearGauge.bu = true;
                                                        LinearGaugeControl linearGauge_night = new LinearGaugeControl();
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        //if (employee.IsNightShift == 1 && shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        //{
                                                        //    linearGauge.MouseMove += LinearGauge_MouseMove;
                                                        //}
                                                        //else
                                                        //{
                                                        linearGauge.MouseMove += LinearGauge_MouseMove;
                                                        linearGauge_night.MouseMove += linearGauge_night_MouseMove;
                                                        // }

                                                        #endregion
                                                        //try
                                                        //{


                                                        //Int32 DayDate = (Int32)employee.AttendanceStartDate.Value.DayOfWeek;
                                                        //Int32 month = (Int32)employee.AttendanceStartDate.Value.Month;
                                                        //Int32 DayDate = (Int32)employee.CounterpartStartDate.Value.DayOfWeek;
                                                        //Int32 month = (Int32)employee.CounterpartStartDate.Value.Month;
                                                        //Int32 DayDate = (Int32)(employee.AttendanceStartDate == null ? employee.CounterpartStartDate.Value.DayOfWeek : employee.AttendanceStartDate.Value.DayOfWeek);
                                                        //Int32 month = (Int32)(employee.AttendanceStartDate == null ? employee.CounterpartStartDate.Value.Month : employee.AttendanceStartDate.Value.Month);

                                                        // Determine DayOfWeek, using LeaveStartDate if AttendanceStartDate and CounterpartStartDate are both null
                                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                        Int32 DayDate = (Int32)(
                                                            employee.AttendanceStartDate == null && employee.CounterpartStartDate == null && employee.ISHolidayEvent == false && employee.LeaveStartDate.HasValue
                                                            ? employee.LeaveStartDate.Value.DayOfWeek
                                                            : (employee.AttendanceStartDate == null ? employee.CounterpartStartDate.Value.DayOfWeek : employee.AttendanceStartDate.Value.DayOfWeek)
                                                        );

                                                        // Determine Month, using LeaveStartDate if AttendanceStartDate and CounterpartStartDate are both null
                                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                        Int32 month = (Int32)(
                                                            employee.AttendanceStartDate == null && employee.CounterpartStartDate == null && employee.ISHolidayEvent == false && employee.LeaveStartDate.HasValue
                                                            ? employee.LeaveStartDate.Value.Month
                                                            : (employee.AttendanceStartDate == null ? employee.CounterpartStartDate.Value.Month : employee.AttendanceStartDate.Value.Month)
                                                        );

                                                        linearGauge.Name = "D" + Convert.ToString(employee.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(employee.IdStage);
                                                        linearGauge_night.Name = "D" + Convert.ToString(employee.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(employee.IdStage);



                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        //linearGauge.Width = 1370;
                                                        //linearGauge.Height = 100;
                                                        if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                        {

                                                            int HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                linearGauge.Width = 1370;
                                                                //linearGauge_night.Width = (int)(HoursByTotalHours_night);
                                                            }
                                                            else
                                                            #endregion
                                                            if (TotalHours_24 > TotalHours_0)
                                                            {
                                                                #region [GEOS2-6662][gulab lakade][18 12 2024]
                                                                if (TotalHours_0 == 0)
                                                                {
                                                                    //[GEOS2-7755][gulab lakade][20 04 2025]
                                                                    TotalHours_0 = 2;
                                                                    TotalHours_Night = TotalHours_Night + 2;
                                                                    HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                                    int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                                    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0);
                                                                    //[GEOS2-7755][gulab lakade][20 04 2025]
                                                                }
                                                                else
                                                                {
                                                                    int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                                }

                                                                //int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                //linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                                //linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue + 25;
                                                                #endregion
                                                            }

                                                            else
                                                               if (TotalHours_24 < TotalHours_0)
                                                            {
                                                                int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                            }


                                                            //linearGauge.Width = 1060;
                                                            linearGauge.Height = 100;


                                                            linearGauge_night.Height = 100;
                                                        }
                                                        else
                                                        if ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date)
                                                        {
                                                            int StarttimeHours = (int)employee.AttendanceStartDate.Value.Hour;
                                                            int EndTimeHours = (int)employee.AttendanceEndDate.Value.Hour;
                                                            int EndTimeMinute = (int)employee.AttendanceEndDate.Value.Minute;
                                                            TotalHours_24 = (24 - StarttimeHours);
                                                            if (EndTimeMinute > 0)
                                                            {
                                                                TotalHours_0 = EndTimeHours + 1;
                                                            }
                                                            else
                                                            {
                                                                TotalHours_0 = EndTimeHours;
                                                            }
                                                            int TempTotalhours = (int)TotalHours_24 + (int)TotalHours_0;
                                                            TotalHours_Night = TempTotalhours;
                                                            int HoursByTotalHours_night = (int)(1430 / (TempTotalhours));
                                                            if (TotalHours_24 > TotalHours_0)
                                                            {
                                                                int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * (TotalHours_0 - 0)));
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                            }
                                                            else
                                                            {
                                                                int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * (TotalHours_0 - 0)));
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                            }


                                                            //linearGauge.Width = 1060;
                                                            linearGauge.Height = 100;


                                                            linearGauge_night.Height = 100;
                                                        }
                                                        else if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent == 1)//[GEOS2-8189][rani dhamankar][03-06-2025]
                                                        {
                                                            int HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                linearGauge.Width = 1370;
                                                                //linearGauge_night.Width = (int)(HoursByTotalHours_night);
                                                            }
                                                            else
                                                            if (TotalHours_24 > TotalHours_0)
                                                            {

                                                                if (TotalHours_0 == 0)
                                                                {

                                                                    TotalHours_0 = 2;
                                                                    TotalHours_Night = TotalHours_Night + 2;
                                                                    HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                                    int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;

                                                                }
                                                                else
                                                                {
                                                                    int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                                }

                                                            }

                                                            else
                                                               if (TotalHours_24 < TotalHours_0)
                                                            {
                                                                int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                            }


                                                            linearGauge.Height = 100;
                                                            linearGauge_night.Height = 100;



                                                        }
                                                        else
                                                        {
                                                            linearGauge.Width = 1370;
                                                            linearGauge.Height = 100;
                                                            linearGauge_night.Width = 0;
                                                            linearGauge_night.Height = 100;
                                                        }
                                                        #endregion



                                                        DefaultScaleLabelControl label;
                                                        // // Create a LinearScale
                                                        LinearScale linearScale = new LinearScale();
                                                        LinearScale linearnightScale = new LinearScale();
                                                        linearScale.LayoutMode = 0;
                                                        linearScale.Markers.Clear();
                                                        linearScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                        linearScale.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                        linearnightScale.LayoutMode = 0;
                                                        linearnightScale.Markers.Clear();
                                                        linearnightScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                        linearnightScale.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));

                                                        linearnightScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                        if (ApplicationThemeHelper.ApplicationThemeName.ToString() == "BlackAndBlue")
                                                        {
                                                            label = new DefaultScaleLabelControl()
                                                            {
                                                                Foreground = new SolidColorBrush(Colors.White)
                                                            };



                                                            var foregroundProperty = label.GetType().GetProperty("Foreground");
                                                            if (foregroundProperty != null)
                                                            {
                                                                foregroundProperty.SetValue(label, new SolidColorBrush(Colors.White));
                                                            }

                                                            linearScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")) };
                                                            linearScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                            {
                                                                MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")),
                                                                MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"))

                                                            };

                                                            linearnightScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")) };
                                                            linearnightScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                            {
                                                                MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")),
                                                                MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"))

                                                            };


                                                            #region RND
                                                            CustomScaleLabelPresentation customScaleLabelPresentation = new CustomScaleLabelPresentation();

                                                            ControlTemplate labelTemplate = new ControlTemplate();

                                                            FrameworkElementFactory textBlockFactory = new FrameworkElementFactory(typeof(TextBlock));
                                                            textBlockFactory.SetBinding(TextBlock.TextProperty, new Binding("Text"));
                                                            textBlockFactory.SetValue(TextBlock.ForegroundProperty, new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")));
                                                            textBlockFactory.SetValue(TextBlock.MarginProperty, new Thickness(-1, -10, 0, 0)); // Adjust the values as needed

                                                            labelTemplate.VisualTree = textBlockFactory;

                                                            // Set the LabelTemplate for CustomScaleLabelPresentation
                                                            customScaleLabelPresentation.LabelTemplate = labelTemplate;

                                                            // Set CustomScaleLabelPresentation for LinearScale.LabelPresentation
                                                            linearScale.LabelPresentation = customScaleLabelPresentation;
                                                            linearnightScale.LabelPresentation = customScaleLabelPresentation;
                                                            #endregion
                                                        }
                                                        else
                                                        {

                                                            label = new DefaultScaleLabelControl()
                                                            {
                                                                Foreground = new SolidColorBrush(Colors.Black)
                                                            };

                                                            var foregroundProperty = label.GetType().GetProperty("Foreground");
                                                            if (foregroundProperty != null)
                                                            {
                                                                foregroundProperty.SetValue(label, new SolidColorBrush(Colors.Black));
                                                            }
                                                            linearScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")) };
                                                            linearScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                            {
                                                                MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")),
                                                                MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000"))
                                                            };

                                                            linearnightScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")) };
                                                            linearnightScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                            {
                                                                MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")),
                                                                MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000"))
                                                            };
                                                            #region REND
                                                            CustomScaleLabelPresentation customScaleLabelPresentation = new CustomScaleLabelPresentation();

                                                            ControlTemplate labelTemplate = new ControlTemplate();

                                                            FrameworkElementFactory textBlockFactory = new FrameworkElementFactory(typeof(TextBlock));
                                                            textBlockFactory.SetBinding(TextBlock.TextProperty, new Binding("Text"));
                                                            textBlockFactory.SetValue(TextBlock.ForegroundProperty, new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")));
                                                            textBlockFactory.SetValue(TextBlock.MarginProperty, new Thickness(-1, -10, 0, 0));

                                                            labelTemplate.VisualTree = textBlockFactory;

                                                            // Set the LabelTemplate for CustomScaleLabelPresentation
                                                            customScaleLabelPresentation.LabelTemplate = labelTemplate;

                                                            // Set CustomScaleLabelPresentation for LinearScale.LabelPresentation
                                                            linearScale.LabelPresentation = customScaleLabelPresentation;
                                                            linearnightScale.LabelPresentation = customScaleLabelPresentation;


                                                            #endregion
                                                        }
                                                        double BarStartValue = 0;
                                                        double BarEndValue = 0;
                                                        BarStartValue = shiftStartDate.Value.Hour;
                                                        double endminute = shiftEndDate.Value.Minute;
                                                        BarEndValue = shiftEndDate.Value.Hour + 1;



                                                        TimeSpan BarStartTime = TimeSpan.FromHours(BarStartValue);
                                                        TimeSpan BarEndTime = TimeSpan.FromHours(BarEndValue);
                                                        //BarStartValue = 22;
                                                        //BarEndValue = 5;
                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        if ((employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date)) && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                        {
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                linearScale.StartValue = BarStartValue; // Start at 10.30 hours
                                                                linearScale.EndValue = BarEndValue; // End at 13.00 hours
                                                                linearScale.MajorIntervalCount = (int)Math.Round((BarEndValue - BarStartValue), 0);
                                                                //  linearScale.MinorIntervalCount = 4;
                                                                //linearnightScale.MinorIntervalCount = 4;

                                                            }
                                                            else
                                                            {

                                                                #endregion
                                                                // double LinearscaleStartTime = (employee.ShiftStartTime).TotalHours;
                                                                linearScale.StartValue = BarStartValue; // Start at 10.30 hours
                                                                linearScale.EndValue = 24; // End at 13.00 hours
                                                                linearnightScale.StartValue = 0;

                                                                //double LinearnightScaleEndTime = (employee.ShiftEndTime).TotalHours;

                                                                //[GEOS2-6662][gulab lakade][18 12 2024]
                                                                if (TotalHours_0 > BarEndValue)
                                                                {
                                                                    //[GEOS2-7755][gulab lakade ][22 04 2025]
                                                                    //TotalHours_0 = shiftEndDate.Value.TimeOfDay.TotalHours;
                                                                    BarEndValue = TotalHours_0;
                                                                }

                                                                //double LinearnightScaleEndTime = BarEndValue;
                                                                linearnightScale.EndValue = BarEndValue;


                                                                // TotalHours_24=24- BarStartValue;//[GEOS2-6662][gulab lakade][18 12 2024]
                                                                if ((int)Math.Round(TotalHours_24, 0) <= 0)
                                                                {
                                                                    linearScale.MajorIntervalCount = 1;
                                                                }
                                                                else
                                                                {
                                                                    //linearScale.MajorIntervalCount = (int)Math.Round(TotalHours_24, 0);
                                                                    linearScale.MajorIntervalCount = (int)Math.Round((24 - BarStartValue), 0);//[GEOS2-6662][gulab lakade][18 12 2024]
                                                                }

                                                                if ((int)Math.Round(TotalHours_0, 0) <= 0)
                                                                {
                                                                    linearnightScale.MajorIntervalCount = 1;
                                                                }
                                                                else
                                                                {
                                                                    linearnightScale.MajorIntervalCount = (int)Math.Round(TotalHours_0, 0);
                                                                }

                                                                linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                                {
                                                                    ShowFirst = false
                                                                };
                                                                linearScale.LabelOptions = new LinearScaleLabelOptions()
                                                                {

                                                                    Offset = -45


                                                                };
                                                                linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                                {
                                                                    ShowFirst = false,
                                                                    Offset = -45


                                                                };
                                                            }//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        }
                                                        else if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent == 1)//[GEOS2-8189][rani dhamankar][03-06-2025]//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                        {
                                                            linearScale.StartValue = BarStartValue; // Start at 16.00 hours
                                                            linearScale.EndValue = 24; // End at 00.30 hours
                                                            linearnightScale.StartValue = 0;
                                                            linearnightScale.StartValue = BarEndValue;


                                                            if ((int)Math.Round(TotalHours_24, 0) <= 0)
                                                            {
                                                                //linearScale.MajorIntervalCount = 1;
                                                                //linearScale.MajorIntervalCount = (int)ShiftEndTime - (int)ShiftStartTime;//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                                linearScale.MajorIntervalCount = (int)BarEndValue - (int)BarStartValue;//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                            }
                                                            else
                                                            {
                                                                linearScale.MajorIntervalCount = (int)Math.Round((24 - BarStartValue), 0);
                                                            }

                                                            if ((int)Math.Round(TotalHours_0, 0) <= 0)
                                                            {
                                                                //linearnightScale.MajorIntervalCount = 1;
                                                                //linearScale.MajorIntervalCount = (int)ShiftEndTime - (int)ShiftStartTime;//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                                linearScale.MajorIntervalCount = (int)BarEndValue - (int)BarStartValue;//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                            }
                                                            else
                                                            {
                                                                linearnightScale.MajorIntervalCount = (int)Math.Round(TotalHours_0, 0);
                                                            }

                                                            linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                ShowFirst = false
                                                            };
                                                            linearScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                Offset = -45
                                                            };
                                                            linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                ShowFirst = false,
                                                                Offset = -45
                                                            };
                                                        }
                                                        else
                                                        {

                                                            //linearScale.StartValue = ShiftStartTime; // Start at 10.30 hours
                                                            linearScale.StartValue = BarStartValue; // Start at 10.30 hours

                                                            //linearScale.EndValue = ShiftEndTime; // End at 13.00 hours
                                                            linearScale.EndValue = BarEndValue; // End at 13.00 hours

                                                            TimeSpan totalHours = new TimeSpan();

                                                            int timeInterval = 1;

                                                            if (BarStartValue != BarEndValue)
                                                            {
                                                                if (BarEndValue > BarStartValue)
                                                                {
                                                                    double TempTimeDifference = BarEndValue - BarStartValue;
                                                                    //double TempTimeDifference = Math.Round((Convert.ToDouble((totalHours).TotalMinutes) / 60), 0);
                                                                    timeInterval = Convert.ToInt32(Math.Round((TempTimeDifference), 0));
                                                                }
                                                            }
                                                            linearScale.MajorIntervalCount = timeInterval;

                                                            #region [pallavi jadhav] [GEOS2-5743][05-06-2024]

                                                            linearScale.MinorIntervalCount = 4;
                                                            linearnightScale.MinorIntervalCount = 4;

                                                            #endregion
                                                        }
                                                        #endregion


                                                        #region logged
                                                        TimeSpan OldStartTime = new TimeSpan();
                                                        TimeSpan OldEndTime = new TimeSpan();
                                                        TimeSpan NewStartTime = new TimeSpan();
                                                        TimeSpan NewEndTime = new TimeSpan();

                                                        double TotalBreakTimeForToolTip = 0;
                                                        double TotalLoggedTimeForToolTip = 0;
                                                        double TotalpauseTimeForToolTip = 0;


                                                        double OldEndTimeIndoble = 0;
                                                        double OldStartTimeIndoble = 0;
                                                        double MaintanceTimeIndouble = 0;

                                                        if (employeelist.Count() > 0)
                                                        {
                                                            #region pausetime
                                                            #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                            if ((employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date)) && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][03-06-2025]
                                                            {
                                                                #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                                {
                                                                    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                    UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                    UnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                    // UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                    linearScale.Ranges.Add(UnLoggBar);
                                                                }
                                                                else
                                                                {
                                                                    #endregion
                                                                    LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                    UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                    UnLoggBar.EndValue = new RangeValue(24);
                                                                    UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                    // UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                    UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                    linearScale.Ranges.Add(UnLoggBar);

                                                                    LinearScaleRange NightShiftUnLoggBar = new LinearScaleRange();
                                                                    NightShiftUnLoggBar.StartValue = new RangeValue(0);
                                                                    NightShiftUnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                    NightShiftUnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                    // UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                    NightShiftUnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                    linearnightScale.Ranges.Add(NightShiftUnLoggBar);
                                                                }// [GEOS2-7755][gulab lakade][08 04 2025]
                                                            }
                                                            else if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent == 1) //[GEOS2-8189][rani dhamankar] [03 - 06 - 2025]
                                                            {
                                                                double LeaveStartTimeIndouble = 0;
                                                                double LeaveEndTimeIndouble = 0;
                                                                LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(employee.LeaveStartTime.TotalMinutes) / 60), 4);
                                                                LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(employee.LeaveEndTime.TotalMinutes) / 60), 4);
                                                                LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                UnLoggBar.StartValue = new RangeValue(LeaveStartTimeIndouble);
                                                                UnLoggBar.EndValue = new RangeValue(24);
                                                                UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearScale.Ranges.Add(UnLoggBar);

                                                                LinearScaleRange NightShiftUnLoggBar = new LinearScaleRange();
                                                                NightShiftUnLoggBar.StartValue = new RangeValue(0);
                                                                NightShiftUnLoggBar.EndValue = new RangeValue(LeaveEndTimeIndouble);
                                                                NightShiftUnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                NightShiftUnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearnightScale.Ranges.Add(NightShiftUnLoggBar);
                                                            }
                                                            else
                                                            {
                                                                //                                                        if ( PauseType == "Download" || x.PauseType == "Transferred" && x.SiteName == employee.SiteName && x.EmployeeCode == employee.EmployeeCode && x.StageCode == employee.StageCode).FirstOrDefault(); //&& (x.BreakStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.BreakStartDate .Value.Date == StartDate.Date)
                                                                //)
                                                                LinearScaleRange UnLoggBar = new LinearScaleRange();


                                                                UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                UnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                // UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearScale.Ranges.Add(UnLoggBar);
                                                            }
                                                            #endregion
                                                            #endregion
                                                            #region [GEOS2-8862][gulab lakade][28 07 2025]
                                                            #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                            //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]

                                                            var employeeLogglist = emp
                                                             .Where(a => a.SiteName == plantdata.Key
                                                                         && a.EmployeeCode == emp.Key
                                                                         && (
                                                                             // Check if CounterpartStartDate is not null and follow the existing logic
                                                                             a.CounterpartStartDate != null && (
                                                                                 a.IsNightShift == 1
                                                                                 ? (
                                                                                 a.ShiftStartTime <= tmpStartTimeCheck ? a.CounterpartStartDate.Value.Date == itemDate.Key.Date :
                                                                                 (a.CounterpartStartDate.Value.Date == itemDate.Key.Date || a.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                                                 )
                                                                                 : a.CounterpartStartDate.Value.Date == itemDate.Key.Date
                                                                             )
                                                                             // If CounterpartStartDate is null, check LeaveStartDate
                                                                             || (a.CounterpartStartDate == null && a.ISHolidayEvent == false && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                                         )
                                                             )
                                                             .OrderBy(a => a.CounterpartStartDate == null ? TimeSpan.MaxValue : a.CounterPartStartTime)
                                                            .ThenBy(a => a.LeaveStartDate == null ? DateTime.MinValue : a.LeaveStartDate)
                                                            .ToList();
                                                            #endregion
                                                            #endregion
                                                            #region LoggedTime

                                                            #region [GEOS2-7902][gulab lakade][23 04 2025]

                                                            var LoggedTimeData = employeeLogglist
                                                             .Where(test => test.CounterPartStartTime != null)
                                                             .GroupBy(test => test.CounterPartStartTime)
                                                             .Select(grp => grp.OrderByDescending(t => t.CounterPartEndTime).FirstOrDefault())
                                                             .OrderBy(c => c.CounterpartStartDate)
                                                             .ToList();
                                                            #endregion



                                                            if (LoggedTimeData.Count() > 0)
                                                            {
                                                                int ttcount = 0;
                                                                int logCount = 0;
                                                                int TotallogCount = LoggedTimeData.Count() - 1;
                                                                //TimeSpan LastEndTime = new TimeSpan();//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                DateTime LastEndTime = new DateTime();
                                                                //LastEndTime = TimeSpan.Zero;
                                                                LastEndTime = Convert.ToDateTime("1900-01-01");//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                foreach (var logtime in LoggedTimeData)
                                                                {
                                                                    ttcount = ttcount + 1;
                                                                    bool checkDuplicateValue = true;
                                                                    //if (LastEndTime != TimeSpan.Zero)
                                                                    if (LastEndTime != Convert.ToDateTime("1900-01-01"))//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                    {

                                                                        //if (LastEndTime <= logtime.CounterPartStartTime)
                                                                        if (LastEndTime <= logtime.CounterpartStartDate)//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                        {
                                                                            checkDuplicateValue = false;
                                                                        }
                                                                        else
                                                                        if (LastEndTime >= logtime.CounterpartStartDate && LastEndTime < logtime.CounterpartEndDate)//[GEOS2-8862][gulab lakade][28 07 2025]
                                                                        {
                                                                            logtime.CounterpartStartDate = LastEndTime;//[GEOS2-8862][gulab lakade][28 07 2025]
                                                                            checkDuplicateValue = false;
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        checkDuplicateValue = false;
                                                                    }


                                                                    if (checkDuplicateValue == false)
                                                                    {
                                                                        //LastEndTime = logtime.CounterPartEndTime;//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                        {
                                                                            #region [GEOS2-6771][gulab lakade][05 04 2025]
                                                                            DateTime TempStartATDate = new DateTime();
                                                                            DateTime TempEndATDate = new DateTime();

                                                                            if (logtime.AttendanceStartDate == null)
                                                                            {
                                                                                //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                //TempStartATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftStartTime);
                                                                                //TempEndATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftEndTime);
                                                                                TempStartATDate = Convert.ToDateTime(shiftStartDate);
                                                                                TempEndATDate = Convert.ToDateTime(shiftEndDate);
                                                                                //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                            }
                                                                            else
                                                                            {
                                                                                //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                                TempStartATDate = Convert.ToDateTime(MinAtt_Date);
                                                                                TempEndATDate = Convert.ToDateTime(MaxAtt_Date);
                                                                                //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                            }
                                                                            DateTime CPTStartDate = logtime.CounterpartStartDate.Value;
                                                                            DateTime CPTEndDate = logtime.CounterpartEndDate.Value;
                                                                            #endregion

                                                                            //if ((logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date && logtime.CounterpartStartDate.Value.TimeOfDay >= logtime.ShiftStartTime) || (logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1) && logtime.CounterpartEndDate.Value.TimeOfDay <= logtime.ShiftEndTime))
                                                                            if (TempStartATDate <= CPTStartDate && TempEndATDate >= CPTEndDate)
                                                                            {
                                                                                //double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                                //double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                                double StartTimeIndouble = Math.Round(logtime.CounterpartStartDate.Value.TimeOfDay.TotalHours, 4);
                                                                                double EndTimeIndouble = Math.Round(logtime.CounterpartEndDate.Value.TimeOfDay.TotalHours, 4);



                                                                                #region Lineargauge 
                                                                                //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble >= (employee.ShiftEndTime).TotalHours)
                                                                                if (TempStartATDate.Date == CPTStartDate.Date && CPTStartDate.Date == CPTEndDate.Date)
                                                                                {
                                                                                    //if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                    //if (logtime.CounterpartEndDate.Value.TimeOfDay > logtime.CounterpartStartDate.Value.TimeOfDay)
                                                                                    if (CPTEndDate > CPTStartDate)
                                                                                    {
                                                                                        TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                        double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        #endregion
                                                                                        LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        #endregion
                                                                                        LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]

                                                                                    }


                                                                                    LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                    LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                    LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                    LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                                                    {
                                                                                        //logTimeColor = "#0000FF";
                                                                                        logTimeColor = "#00b54d";
                                                                                    }
                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                    LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                    //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                                                    //SelectedTooltips1.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    SelectedTooltips.ToolTipsType = "Working";
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                    {
                                                                                        SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    }
                                                                                    SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearScale.Ranges.Add(LoggBar);
                                                                                }
                                                                                #region [GEOS2-6771][gulab lakade][05 04 2025]
                                                                                else
                                                                                {

                                                                                    //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble <= (employee.ShiftEndTime).TotalHours)
                                                                                    if (CPTStartDate.Date < CPTEndDate.Date)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                    {
                                                                                        #region Linearscale
                                                                                        DateTime stdt = logtime.CounterpartStartDate.Value;
                                                                                        DateTime endt = logtime.CounterpartEndDate.Value;
                                                                                        TimeSpan LoggTimeDiffernce = Hours_24.Subtract(logtime.CounterpartStartDate.Value.TimeOfDay);
                                                                                        double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        #endregion

                                                                                        LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                        LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                        LoggBar.EndValue = new RangeValue(Hours_24.TotalHours);
                                                                                        LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                        string logTimeColor1 = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                        if (string.IsNullOrEmpty(logTimeColor1))
                                                                                        {
                                                                                            //logTimeColor = "#0000FF";
                                                                                            logTimeColor1 = "#00b54d";
                                                                                        }
                                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                        LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor1)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips1.ToolTipsStartTime = StartTimeIndouble;
                                                                                        //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                        SelectedTooltips1.ToolTipsEndTime = 1439; //Hours_24.TotalHours;
                                                                                        SelectedTooltips1.BarTypeName = "LoggedType";
                                                                                        //SelectedTooltips1.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips1.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        SelectedTooltips1.ToolTipsType = "Working";
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips1.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                        {
                                                                                            SelectedTooltips1.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        }
                                                                                        SelectedTooltips1.PauseTypeId = logtime.PauseTypeId;
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips1.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips1.IdStage = employee.IdStage;
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == Hours_24.TotalHours && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                        }

                                                                                        #endregion
                                                                                        linearScale.Ranges.Add(LoggBar);
                                                                                        #endregion

                                                                                        #region Linear_NightShit

                                                                                        TimeSpan LoggTimeDiffernce1 = logtime.CounterpartEndDate.Value.TimeOfDay.Subtract(Hours_0);
                                                                                        double LoggTimeDiffernceIndouble1 = Math.Round((Convert.ToDouble(LoggTimeDiffernce1.TotalMinutes) / 60), 4);
                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble1;

                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble1;
                                                                                        var tempsequence1 = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                        if (tempsequence1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence1.Sequence;
                                                                                        }
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        #endregion

                                                                                        LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                        NightShftLoggBar.StartValue = new RangeValue(0);
                                                                                        NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                        NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                        string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                        if (string.IsNullOrEmpty(logTimeColor))
                                                                                        {
                                                                                            //logTimeColor = "#0000FF";
                                                                                            logTimeColor = "#00b54d";
                                                                                        }
                                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                        NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips.ToolTipsStartTime = 0;
                                                                                        SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                        SelectedTooltips.BarTypeName = "LoggedType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        SelectedTooltips.ToolTipsType = "Working";
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                        {
                                                                                            SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        }
                                                                                        SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips.IdStage = employee.IdStage;
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }

                                                                                        #endregion
                                                                                        linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                        #endregion
                                                                                        LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        #region Linear_NightShit
                                                                                        if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                        {
                                                                                            TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                            double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                            TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            #endregion
                                                                                            LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            #endregion
                                                                                            LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                        }


                                                                                        LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                        NightShftLoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                        NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                        NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                        string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                        if (string.IsNullOrEmpty(logTimeColor))
                                                                                        {
                                                                                            //logTimeColor = "#0000FF";
                                                                                            logTimeColor = "#00b54d";
                                                                                        }
                                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                        NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                        SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                        SelectedTooltips.BarTypeName = "LoggedType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        SelectedTooltips.ToolTipsType = "Working";
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                        {
                                                                                            SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        }
                                                                                        SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                        //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                        SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips.IdStage = employee.IdStage;
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }

                                                                                        #endregion
                                                                                        linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                        #endregion
                                                                                    }

                                                                                }
                                                                                #endregion
                                                                                #endregion

                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            if (logtime.CounterPartStartTime != TimeSpan.Zero && logtime.CounterPartEndTime != TimeSpan.Zero)
                                                                            {
                                                                                //double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                                //double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                                double StartTimeIndouble = Math.Round(logtime.CounterpartStartDate.Value.TimeOfDay.TotalHours, 4);
                                                                                double EndTimeIndouble = Math.Round(logtime.CounterpartEndDate.Value.TimeOfDay.TotalHours, 4);
                                                                                if (BarEndValue >= EndTimeIndouble && BarStartValue <= StartTimeIndouble && logtime.CounterpartStartDate.Value.Date == logtime.CounterpartEndDate.Value.Date)
                                                                                {
                                                                                    if (logtime.CounterpartEndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                    {
                                                                                        TimeSpan LoggTimeDiffernce = logtime.CounterpartEndDate.Value.Subtract(logtime.CounterpartStartDate.Value);
                                                                                        double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        #endregion
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        #endregion
                                                                                    }

                                                                                    LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                    LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                    LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                    LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                                                    {
                                                                                        //logTimeColor = "#0000FF";
                                                                                        logTimeColor = "#00b54d";
                                                                                    }
                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                    LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    SelectedTooltips.ToolTipsType = "Working";
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    if (!string.IsNullOrEmpty(logtime.StageName))
                                                                                    {
                                                                                        SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageName);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    }
                                                                                    SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearScale.Ranges.Add(LoggBar);
                                                                                    LastEndTime = Convert.ToDateTime(logtime.CounterpartEndDate);//[GEOS2-7755][gulab lakade][08 04 2025]

                                                                                }
                                                                            }
                                                                        }

                                                                        #endregion

                                                                    }
                                                                }
                                                            }

                                                            #endregion
                                                            #endregion

                                                            #region Break Time
                                                            //var BreakTimeData = (from a in employeelist
                                                            //                         //where a.BreakStartTime>= employee.ShiftStartTime && a.BreakEndTime<= employee.ShiftEndTime
                                                            //                     where a.BreakStartTime >= BarStartTime && a.BreakEndTime <= BarEndTime && a.BreakStartDate.Value.Date == StartDate.Date
                                                            //                     select new
                                                            //                     {
                                                            //                         a.BreakStartTime,
                                                            //                         a.BreakEndTime,
                                                            //                         a.PauseType,
                                                            //                         a.PauseTypeColor

                                                            //                     }).Distinct().ToList();

                                                            //var employeeBreakNotnulllist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.BreakStartDate != null).OrderBy(a => a.BreakStartDate).ToList();
                                                            //var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.BreakStartDate.Value.Date == StartDate.Date).OrderBy(a => a.BreakStartDate).ToList();
                                                            #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                            //var employeeBreakNotnulllist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.BreakStartDate != null).OrderBy(a => a.BreakStartDate).ToList();
                                                            //var employeeBreakNotnulllist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.BreakStartDate != null).OrderBy(a => a.BreakStartDate).ToList();

                                                            var employeeBreakNotnulllist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.BreakStartDate != null).OrderBy(a => a.BreakStartDate).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                                            #endregion
                                                            //var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && (a.IsNightShift == 1 ? (a.BreakStartDate.Value.Date == itemDate.Key.Date || a.BreakStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.BreakStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.BreakStartDate).ToList();
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            //var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && (a.IsNightShift == 1 ? (a.BreakStartDate.Value.Date == itemDate.Key.Date || a.BreakStartDate.Value.Date == itemDate.Key.Date.AddDays(1)) : a.BreakStartDate.Value.Date == itemDate.Key.Date)).OrderBy(a => a.BreakStartDate).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                                            //var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key &&
                                                            //(
                                                            //a.IsNightShift == 1 ?
                                                            //(a.ShiftStartTime <= tmpStartTimeCheck ? a.BreakStartDate.Value.Date == itemDate.Key.Date :
                                                            //(a.BreakStartDate.Value.Date == itemDate.Key.Date || a.BreakStartDate.Value.Date == itemDate.Key.Date.AddDays(1))
                                                            //) : a.BreakStartDate.Value.Date == itemDate.Key.Date
                                                            //)
                                                            //).OrderBy(a => a.BreakStartDate).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                                            var employeeBreaklist = employeeBreakNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key &&
                                                          (a.IsNightShift == 1 ?
                                                            (a.BreakStartDate.Value >= itemDate.Key.Date.Add(a.ShiftStartTime.Subtract(TimeSpan.FromHours(2)))
                                                            && a.BreakEndDate.Value < itemDate.Key.Date.AddDays(1).Date.Add(a.ShiftStartTime))
                                                            : a.BreakStartDate.Value.Date == itemDate.Key.Date)
                                                           ).OrderBy(a => a.BreakStartDate).ToList();////[GEOS2-6554][gulab lakade][02 12 2024]
                                                            #endregion

                                                            //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            #region [GEOS2-7902][gulab lakade][23 04 2025]
                                                            //var BreakTimeData = employeeBreaklist.Where(test => test.BreakStartTime != null).GroupBy(test => test.BreakStartTime)
                                                            //                               .Select(grp => grp.FirstOrDefault())
                                                            //                               .OrderBy(a => a.BreakStartTime)
                                                            //                               .ToList();
                                                            var BreakTimeData = employeeBreaklist.Where(test => test.BreakStartTime != null).GroupBy(test => test.BreakStartTime)
                                                                                          .Select(grp => grp.FirstOrDefault())
                                                                                          .OrderBy(a => a.BreakStartDate)
                                                                                          .ToList();
                                                            #endregion 
                                                            if (BreakTimeData.Count() > 0)
                                                            {
                                                                #region [GEOS2-5394][gulab lakade][19 02 2024]
                                                                var GroupbyPouseType = BreakTimeData.GroupBy(x => x.PauseType).ToList();
                                                                if (GroupbyPouseType != null && GroupbyPouseType.Count() > 0)
                                                                {
                                                                    foreach (var pauseitem in GroupbyPouseType)
                                                                    {
                                                                        var RecordByPuaseType = BreakTimeData.Where(a => a.PauseType == pauseitem.Key).ToList();
                                                                        if (RecordByPuaseType != null && RecordByPuaseType.Count() > 0)
                                                                        {
                                                                            double TemppauseIndouble = 0;
                                                                            string Breakname = string.Empty;
                                                                            foreach (var record in RecordByPuaseType)
                                                                            {
                                                                                var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == record.PauseType).FirstOrDefault();
                                                                                if (TempBreakRecord != null)
                                                                                {
                                                                                    double pauseStartTimeIndouble = Math.Round((Convert.ToDouble(record.BreakStartTime.TotalMinutes) / 60), 4);
                                                                                    double pauseEndTimeIndouble = Math.Round((Convert.ToDouble(record.BreakEndTime.TotalMinutes) / 60), 4);
                                                                                    Breakname = TempBreakRecord.Name;
                                                                                    TemppauseIndouble = TemppauseIndouble + (pauseEndTimeIndouble - pauseStartTimeIndouble);

                                                                                }

                                                                            }

                                                                            double TemppauseIndouble1 = 0;
                                                                            string Breakname1 = string.Empty;

                                                                            foreach (var record in RecordByPuaseType)
                                                                            {

                                                                                var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == record.PauseType).FirstOrDefault();
                                                                                if (TempBreakRecord != null)
                                                                                {
                                                                                    double pauseStartTimeIndouble = Math.Round((Convert.ToDouble(record.BreakStartTime.TotalMinutes) / 60), 4);
                                                                                    double pauseEndTimeIndouble = Math.Round((Convert.ToDouble(record.BreakEndTime.TotalMinutes) / 60), 4);
                                                                                    Breakname1 = TempBreakRecord.Name + "_" + TempBreakRecord.IdLookupValue;//Aishwarya Ingale[Geos2-5853]
                                                                                    TemppauseIndouble1 = TemppauseIndouble1 + (pauseEndTimeIndouble - pauseStartTimeIndouble);

                                                                                }
                                                                            }


                                                                            if (!String.IsNullOrWhiteSpace(Breakname))
                                                                            {
                                                                                if (Breakname != "Planned Meeting")
                                                                                {


                                                                                    TimeSpan BreakTime = TimeSpan.FromHours(Convert.ToDouble(TemppauseIndouble));
                                                                                    dr[Breakname] = Convert.ToString(BreakTime.Add(-TimeSpan.FromMilliseconds(BreakTime.Milliseconds)));
                                                                                }
                                                                            }

                                                                            if (!String.IsNullOrWhiteSpace(Breakname1))
                                                                            {
                                                                                TimeSpan BreakTime1 = TimeSpan.FromHours(Convert.ToDouble(TemppauseIndouble1));
                                                                                dr[Breakname1] = Convert.ToString(BreakTime1.Add(-TimeSpan.FromMilliseconds(BreakTime1.Milliseconds)));

                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                                #endregion
                                                                // [GEOS2-7902][gulab lakade][23 04 2025]
                                                                //TimeSpan LastEndTime = new TimeSpan();
                                                                //LastEndTime = TimeSpan.Zero;
                                                                DateTime? LastEndTime = Convert.ToDateTime("1900-01-01");
                                                                //[GEOS2-7902][gulab lakade] [23 04 2025]
                                                                foreach (var breakitem in BreakTimeData)
                                                                {
                                                                    bool checkDuplicateValue = true;
                                                                    //if (LastEndTime != TimeSpan.Zero)
                                                                    if (LastEndTime == Convert.ToDateTime("1900-01-01"))
                                                                    {
                                                                        //if (LastEndTime <= breakitem.BreakStartTime)
                                                                        if (LastEndTime <= breakitem.BreakStartDate)
                                                                        {
                                                                            checkDuplicateValue = false;
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        checkDuplicateValue = false;
                                                                    }

                                                                    if (checkDuplicateValue == false)
                                                                    {
                                                                        //LastEndTime = breakitem.BreakEndTime;
                                                                        LastEndTime = breakitem.BreakEndDate;

                                                                        //TimeSpan totalDuration = TimeSpan.Zero;
                                                                        double BreakStartTimeIndouble = 0.0;
                                                                        double BreakEndTimeIndouble = 0.0;

                                                                        //var downloadTransferredTimes3 = BreakTimeData.Where(x => x.PauseType == "Download" || x.PauseType == "Transferred" && x.SiteName == employee.SiteName && x.EmployeeCode == employee.EmployeeCode && x.StageCode == employee.StageCode).ToList(); //&& (x.BreakStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.BreakStartDate .Value.Date == StartDate.Date)
                                                                        //if (downloadTransferredTimes3 != null)
                                                                        //{
                                                                        if (breakitem.PauseType == "Download" || breakitem.PauseType == "Transferred")
                                                                        {

                                                                            TimeSpan duration = breakitem.CounterPartEndTime - breakitem.CounterPartStartTime;
                                                                            BreakStartTimeIndouble = Math.Round((Convert.ToDouble(breakitem.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                            BreakEndTimeIndouble = Math.Round((Convert.ToDouble(breakitem.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                        }
                                                                        else
                                                                        {
                                                                            BreakStartTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakStartTime.TotalMinutes) / 60), 4);
                                                                            BreakEndTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakEndTime.TotalMinutes) / 60), 4);
                                                                        }
                                                                        //}
                                                                        //else
                                                                        //{
                                                                        //    BreakStartTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakStartTime.TotalMinutes) / 60), 4);
                                                                        //    BreakEndTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakEndTime.TotalMinutes) / 60), 4);
                                                                        //}

                                                                        //TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                        {
                                                                            #region Linear
                                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                                            {
                                                                                if (breakitem.PauseType == "Maintenance")
                                                                                {
                                                                                    MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                }
                                                                                LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                #region [wrong break time in EAMX Luis suggest][Gulab lakade][23 08 2024]
                                                                                if (BreakStartTimeIndouble <= BreakEndTimeIndouble)
                                                                                {
                                                                                    BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                }
                                                                                else
                                                                                {
                                                                                    BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                                }
                                                                                #endregion
                                                                                BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);

                                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                {
                                                                                    Pausetimecolor = "#00FF00";
                                                                                }
                                                                                BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "pauseType";
                                                                                //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                string BreakType = string.Empty;
                                                                                if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                {
                                                                                    BreakType = Convert.ToString(breakitem.PauseType);
                                                                                }
                                                                                else
                                                                                {
                                                                                    BreakType = "Break";
                                                                                }
                                                                                SelectedTooltips.ToolTipsType = BreakType;
                                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                                #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                {
                                                                                    SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                }
                                                                                if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                {
                                                                                    SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                }

                                                                                // detailsofmeetings = detailsofmeetings + SelectedTooltips.NonOtComment;

                                                                                #endregion
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearScale.Ranges.Add(BreakLoggBar);
                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                try
                                                                                {
                                                                                    var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                    var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                    if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                        var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        if (TempBreakRecord != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        }
                                                                                        else if (TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        }
                                                                                        #endregion

                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    }
                                                                                }
                                                                                catch (Exception ex)
                                                                                {
                                                                                    GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                }
                                                                                #endregion
                                                                            }
                                                                            #endregion
                                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                            //else

                                                                            //    if (BreakStartTimeIndouble >= (employee.ShiftEndTime).TotalHours && BreakEndTimeIndouble >= (employee.ShiftEndTime).TotalHours)
                                                                            //{
                                                                            //    if (breakitem.PauseType == "Maintenance")
                                                                            //    {
                                                                            //        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                            //    }


                                                                            //    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                            //    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                            //    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                            //    #region [wrong break time in EAMX Luis suggest][Gulab lakade][23 08 2024]
                                                                            //    //if (BarEndValue >= BreakEndTimeIndouble)
                                                                            //    //{
                                                                            //    //    BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                            //    //}
                                                                            //    //else 
                                                                            //    //{
                                                                            //    //    BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                            //    //}

                                                                            //    if (BreakStartTimeIndouble <= BreakEndTimeIndouble)
                                                                            //    {
                                                                            //        BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                            //    }
                                                                            //    else
                                                                            //    {
                                                                            //        BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                            //    }
                                                                            //    #endregion
                                                                            //    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                            //    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);

                                                                            //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                            //    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                            //    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                            //    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                            //    {
                                                                            //        Pausetimecolor = "#00FF00";
                                                                            //    }
                                                                            //    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                            //    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            //    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            //    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                            //    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                            //    SelectedTooltips.BarTypeName = "pauseType";
                                                                            //    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                            //    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                            //    string BreakType = string.Empty;
                                                                            //    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                            //    {
                                                                            //        BreakType = Convert.ToString(breakitem.PauseType);
                                                                            //    }
                                                                            //    else
                                                                            //    {
                                                                            //        BreakType = "Break";
                                                                            //    }
                                                                            //    SelectedTooltips.ToolTipsType = BreakType;
                                                                            //    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                            //    SelectedTooltips.IdStage = employee.IdStage;
                                                                            //    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                            //    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                            //    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                            //    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                            //    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                            //    {
                                                                            //        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                            //    }
                                                                            //    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                            //    {
                                                                            //        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                            //    }
                                                                            //    #endregion
                                                                            //    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            //    {
                                                                            //        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                            //        {
                                                                            //            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                            //            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                            //            if (Tooltipdata == null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            //            }
                                                                            //        }
                                                                            //        else
                                                                            //        {

                                                                            //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            //        }
                                                                            //    }
                                                                            //    else
                                                                            //    {
                                                                            //        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                            //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            //    }

                                                                            //    #endregion
                                                                            //    linearScale.Ranges.Add(BreakLoggBar);
                                                                            //    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                            //    try
                                                                            //    {
                                                                            //        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                            //        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                            //        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                            //        {
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                            //            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                            //            if (tempsequence != null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                            //            }
                                                                            //            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                            //            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                            //            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                            //            if (TempBreakRecord != null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                            //            }
                                                                            //            else if (TempBreakRecord1 != null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                            //            }
                                                                            //            #endregion

                                                                            //            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                            //            {
                                                                            //                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                            //            }
                                                                            //            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                            //        }
                                                                            //    }
                                                                            //    catch (Exception ex)
                                                                            //    {
                                                                            //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                            //    }
                                                                            //    #endregion

                                                                            //}
                                                                            #endregion
                                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                            else
                                                                            {
                                                                                if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftStartDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftStartDate.Value.Date))
                                                                                {
                                                                                    if (breakitem.PauseType == "Maintenance")
                                                                                    {
                                                                                        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                    }
                                                                                    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                    #region [wrong break time in EAMX Luis suggest][Gulab lakade][23 08 2024]
                                                                                    if (BreakStartTimeIndouble <= BreakEndTimeIndouble)
                                                                                    {
                                                                                        BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                                    }
                                                                                    #endregion
                                                                                    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);

                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                    {
                                                                                        Pausetimecolor = "#00FF00";
                                                                                    }
                                                                                    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "pauseType";
                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    string BreakType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                    {
                                                                                        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakType = "Break";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = BreakType;
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                    {
                                                                                        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                    }
                                                                                    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                    {
                                                                                        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                    }
                                                                                    #endregion
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearScale.Ranges.Add(BreakLoggBar);
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    try
                                                                                    {
                                                                                        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            if (TempBreakRecord != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            else if (TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            #endregion

                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                    #endregion
                                                                                }
                                                                                else
                                                                                {
                                                                                    if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftStartDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftEndDate.Value.Date))
                                                                                    {
                                                                                        #region LinearScale
                                                                                        if (breakitem.PauseType == "Maintenance")
                                                                                        {
                                                                                            MaintanceTimeIndouble = MaintanceTimeIndouble + (24 - BreakStartTimeIndouble);
                                                                                        }
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        try
                                                                                        {
                                                                                            var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                            var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                            if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((24 - BreakStartTimeIndouble), 4);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }

                                                                                                #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                                var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                if (TempBreakRecord != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                else if (TempBreakRecord1 != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                #endregion
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            }
                                                                                        }
                                                                                        catch (Exception ex)
                                                                                        {
                                                                                            GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                        }
                                                                                        #endregion

                                                                                        LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                        //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                        BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                        BreakLoggBar.EndValue = new RangeValue(24);
                                                                                        BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (24 - BreakStartTimeIndouble);
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                        string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                        if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                        {
                                                                                            Pausetimecolor = "#00FF00";
                                                                                        }
                                                                                        BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                        SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                        SelectedTooltips.BarTypeName = "pauseType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        string BreakType = string.Empty;
                                                                                        if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                        {
                                                                                            BreakType = Convert.ToString(breakitem.PauseType);
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            BreakType = "Break";
                                                                                        }
                                                                                        SelectedTooltips.ToolTipsType = BreakType;
                                                                                        SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips.IdStage = employee.IdStage;
                                                                                        #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                        SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                        SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                        SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                        if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                        {
                                                                                            SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                        }
                                                                                        if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                        {
                                                                                            SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                        }
                                                                                        #endregion
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == 24 && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }

                                                                                        #endregion
                                                                                        linearScale.Ranges.Add(BreakLoggBar);
                                                                                        #endregion
                                                                                        #region NightShift
                                                                                        if (breakitem.PauseType == "Maintenance")
                                                                                        {
                                                                                            MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - 0);
                                                                                        }
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        try
                                                                                        {
                                                                                            var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                            var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                            if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - 0), 4);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                                var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                if (TempBreakRecord != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                else if (TempBreakRecord1 != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                #endregion
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            }
                                                                                        }
                                                                                        catch (Exception ex)
                                                                                        {
                                                                                            GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                        }
                                                                                        #endregion

                                                                                        LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                        //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                        NightBreakLoggBar.StartValue = new RangeValue(0);
                                                                                        NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                        NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - 0);
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                        string Pausetimecolor1 = breakitem.PauseTypeColor;
                                                                                        if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                        {
                                                                                            Pausetimecolor = "#00FF00";
                                                                                        }
                                                                                        NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips1.ToolTipsStartTime = 0;
                                                                                        SelectedTooltips1.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                        SelectedTooltips1.BarTypeName = "pauseType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        string BreakType1 = string.Empty;
                                                                                        if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                        {
                                                                                            BreakType1 = Convert.ToString(breakitem.PauseType);
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            BreakType1 = "Break";
                                                                                        }
                                                                                        SelectedTooltips1.ToolTipsType = BreakType;
                                                                                        SelectedTooltips1.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips1.IdStage = employee.IdStage;
                                                                                        #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                        SelectedTooltips1.NonOT_Name = breakitem.NonOT_Name;
                                                                                        SelectedTooltips1.PauseTypeId = breakitem.PauseTypeId;
                                                                                        SelectedTooltips1.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                        if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                        {
                                                                                            SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                        }
                                                                                        if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                        {
                                                                                            SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                        }
                                                                                        #endregion
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == 0 && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType1 && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                        }
                                                                                        #endregion
                                                                                        linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                        #endregion
                                                                                    }
                                                                                    else if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftEndDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftEndDate.Value.Date))
                                                                                    {
                                                                                        #region NightShift
                                                                                        if (breakitem.PauseType == "Maintenance")
                                                                                        {
                                                                                            MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                        }

                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        try
                                                                                        {
                                                                                            var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                            var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                            if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                                var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                                if (tempsequence != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                                }
                                                                                                #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                                var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                if (TempBreakRecord != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                else if (TempBreakRecord1 != null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                                }
                                                                                                #endregion
                                                                                                if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                                }
                                                                                                ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                            }
                                                                                        }
                                                                                        catch (Exception ex)
                                                                                        {
                                                                                            GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                        }
                                                                                        #endregion
                                                                                        LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                        //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                        NightBreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                        NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                        NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                        TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                        //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                        //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                        string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                        if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                        {
                                                                                            Pausetimecolor = "#00FF00";
                                                                                        }
                                                                                        NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                        SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                        SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                        SelectedTooltips.BarTypeName = "pauseType";
                                                                                        //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                        SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        string BreakType = string.Empty;
                                                                                        if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                        {
                                                                                            BreakType = Convert.ToString(breakitem.PauseType);
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            BreakType = "Break";
                                                                                        }
                                                                                        SelectedTooltips.ToolTipsType = BreakType;
                                                                                        SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                        SelectedTooltips.IdStage = employee.IdStage;
                                                                                        #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                        SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                        SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                        SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                        if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                        {
                                                                                            SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                        }
                                                                                        if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                        {
                                                                                            SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                        }
                                                                                        #endregion
                                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                        {
                                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                            {
                                                                                                //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                                if (Tooltipdata == null)
                                                                                                {
                                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                                }
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                        #endregion
                                                                                        linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                        #endregion
                                                                                    }

                                                                                }
                                                                                #endregion
                                                                                #region [GEOS2-7755][gulab lakade][08 04 2025]




                                                                                //if (BreakStartTimeIndouble >= (employee.ShiftEndTime).TotalHours && BreakEndTimeIndouble <= (employee.ShiftEndTime).TotalHours)
                                                                                //{
                                                                                //    #region LinearScale
                                                                                //    if (breakitem.PauseType == "Maintenance")
                                                                                //    {
                                                                                //        MaintanceTimeIndouble = MaintanceTimeIndouble + (24 - BreakStartTimeIndouble);
                                                                                //    }
                                                                                //    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                //    try
                                                                                //    {
                                                                                //        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                //        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                //        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                //        {
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((24 - BreakStartTimeIndouble), 4);
                                                                                //            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                //            if (tempsequence != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                //            }

                                                                                //            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                //            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            if (TempBreakRecord != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            else if (TempBreakRecord1 != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            #endregion
                                                                                //            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                //            }
                                                                                //            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                //        }
                                                                                //    }
                                                                                //    catch (Exception ex)
                                                                                //    {
                                                                                //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                //    }
                                                                                //    #endregion

                                                                                //    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                //    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                //    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                //    BreakLoggBar.EndValue = new RangeValue(24);
                                                                                //    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                //    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (24 - BreakStartTimeIndouble);
                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                //    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                //    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                //    {
                                                                                //        Pausetimecolor = "#00FF00";
                                                                                //    }
                                                                                //    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                //    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                //    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                //    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                //    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                //    SelectedTooltips.BarTypeName = "pauseType";
                                                                                //    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                //    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //    string BreakType = string.Empty;
                                                                                //    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                //    {
                                                                                //        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        BreakType = "Break";
                                                                                //    }
                                                                                //    SelectedTooltips.ToolTipsType = BreakType;
                                                                                //    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                //    SelectedTooltips.IdStage = employee.IdStage;
                                                                                //    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                //    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                //    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                //    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                //    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                //    {
                                                                                //        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                //    }
                                                                                //    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                //    {
                                                                                //        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                //    }
                                                                                //    #endregion
                                                                                //    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                //    {
                                                                                //        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                //        {
                                                                                //            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                //            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == 24 && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //            if (Tooltipdata == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //            }
                                                                                //        }
                                                                                //        else
                                                                                //        {

                                                                                //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //        }
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //    }

                                                                                //    #endregion
                                                                                //    linearScale.Ranges.Add(BreakLoggBar);
                                                                                //    #endregion

                                                                                //    #region NightShift
                                                                                //    if (breakitem.PauseType == "Maintenance")
                                                                                //    {
                                                                                //        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - 0);
                                                                                //    }
                                                                                //    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                //    try
                                                                                //    {
                                                                                //        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                //        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                //        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                //        {
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - 0), 4);
                                                                                //            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                //            if (tempsequence != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                //            }
                                                                                //            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                //            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            if (TempBreakRecord != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            else if (TempBreakRecord1 != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            #endregion
                                                                                //            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                //            }
                                                                                //            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                //        }
                                                                                //    }
                                                                                //    catch (Exception ex)
                                                                                //    {
                                                                                //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                //    }
                                                                                //    #endregion

                                                                                //    LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                //    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                //    NightBreakLoggBar.StartValue = new RangeValue(0);
                                                                                //    NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                //    NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                //    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - 0);
                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                //    string Pausetimecolor1 = breakitem.PauseTypeColor;
                                                                                //    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                //    {
                                                                                //        Pausetimecolor = "#00FF00";
                                                                                //    }
                                                                                //    NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                //    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                //    ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                //    SelectedTooltips1.ToolTipsStartTime = 0;
                                                                                //    SelectedTooltips1.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                //    SelectedTooltips1.BarTypeName = "pauseType";
                                                                                //    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                //    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //    string BreakType1 = string.Empty;
                                                                                //    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                //    {
                                                                                //        BreakType1 = Convert.ToString(breakitem.PauseType);
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        BreakType1 = "Break";
                                                                                //    }
                                                                                //    SelectedTooltips1.ToolTipsType = BreakType;
                                                                                //    SelectedTooltips1.IdEmployee = employee.IdEmployee;
                                                                                //    SelectedTooltips1.IdStage = employee.IdStage;
                                                                                //    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                //    SelectedTooltips1.NonOT_Name = breakitem.NonOT_Name;
                                                                                //    SelectedTooltips1.PauseTypeId = breakitem.PauseTypeId;
                                                                                //    SelectedTooltips1.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                //    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                //    {
                                                                                //        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                //    }
                                                                                //    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                //    {
                                                                                //        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                //    }
                                                                                //    #endregion
                                                                                //    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                //    {
                                                                                //        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                //        {
                                                                                //            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                //            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == 0 && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType1 && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //            if (Tooltipdata == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                //            }
                                                                                //        }
                                                                                //        else
                                                                                //        {

                                                                                //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                //        }
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                //    }
                                                                                //    #endregion
                                                                                //    linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                //    #endregion


                                                                                //}
                                                                                //else
                                                                                //{
                                                                                //    #region NightShift
                                                                                //    if (breakitem.PauseType == "Maintenance")
                                                                                //    {
                                                                                //        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                //    }

                                                                                //    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                //    try
                                                                                //    {
                                                                                //        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                //        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                //        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                //        {
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                //            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                //            if (tempsequence != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                //            }
                                                                                //            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                //            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                //            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            if (TempBreakRecord != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            else if (TempBreakRecord1 != null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                //            }
                                                                                //            #endregion
                                                                                //            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                //            }
                                                                                //            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                //        }
                                                                                //    }
                                                                                //    catch (Exception ex)
                                                                                //    {
                                                                                //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                //    }
                                                                                //    #endregion
                                                                                //    LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                //    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                //    NightBreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                //    NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                //    NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                //    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                //    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                //    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                //    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                //    {
                                                                                //        Pausetimecolor = "#00FF00";
                                                                                //    }
                                                                                //    NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                //    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                //    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                //    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                //    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                //    SelectedTooltips.BarTypeName = "pauseType";
                                                                                //    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                //    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //    string BreakType = string.Empty;
                                                                                //    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                //    {
                                                                                //        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        BreakType = "Break";
                                                                                //    }
                                                                                //    SelectedTooltips.ToolTipsType = BreakType;
                                                                                //    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                //    SelectedTooltips.IdStage = employee.IdStage;
                                                                                //    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                //    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                //    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                //    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                //    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                //    {
                                                                                //        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                //    }
                                                                                //    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                //    {
                                                                                //        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                //    }
                                                                                //    #endregion
                                                                                //    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                //    {
                                                                                //        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                //        {
                                                                                //            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                //            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                //            if (Tooltipdata == null)
                                                                                //            {
                                                                                //                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //            }
                                                                                //        }
                                                                                //        else
                                                                                //        {

                                                                                //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //        }
                                                                                //    }
                                                                                //    else
                                                                                //    {
                                                                                //        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                //    }
                                                                                //    #endregion
                                                                                //    linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                //    #endregion
                                                                                //}  


                                                                                #endregion
                                                                            }

                                                                            #endregion

                                                                        }
                                                                        else
                                                                        {
                                                                            if (BarEndValue >= BreakEndTimeIndouble && BarStartValue <= BreakStartTimeIndouble)
                                                                            {

                                                                                if (breakitem.BreakStartTime <= breakitem.BreakEndTime)
                                                                                {
                                                                                    if (breakitem.PauseType == "Maintenance")
                                                                                    {
                                                                                        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                    }
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    try
                                                                                    {
                                                                                        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            if (TempBreakRecord != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            else if (TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            #endregion
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                    #endregion

                                                                                    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                    if (BarEndValue >= BreakEndTimeIndouble)
                                                                                    {
                                                                                        BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                                    }
                                                                                    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                    {
                                                                                        Pausetimecolor = "#00FF00";
                                                                                    }
                                                                                    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "pauseType";
                                                                                    //SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    string BreakType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                    {
                                                                                        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakType = "Break";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = BreakType;
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                    {
                                                                                        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                    }
                                                                                    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                    {
                                                                                        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                    }
                                                                                    //   detailsofmeetings = detailsofmeetings + SelectedTooltips.NonOtComment;
                                                                                    #endregion
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {

                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearScale.Ranges.Add(BreakLoggBar);
                                                                                }
                                                                            }
                                                                        }
                                                                        #endregion
                                                                    }
                                                                }
                                                            }
                                                            #endregion


                                                        }
                                                        #endregion

                                                        #region Attendance

                                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                        //var employeeAttendlist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == StartDate.Date).OrderBy(a => a.AttendanceStartDate).ToList();
                                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                        //var employeeAttendlist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == StartDate.Date).OrderBy(a => a.AttendanceStartDate).ToList();
                                                        #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                        //var employeeAttendlist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == itemDate.Key.Date).OrderBy(a => a.AttendanceStartDate).ToList();
                                                        var employeeAttendlist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.AttendanceStartDate != null && a.AttendanceStartDate >= shiftStartDate && a.AttendanceStartDate <= shiftEndDate).OrderBy(a => a.AttendanceStartDate).ToList();
                                                        #endregion

                                                        //var employeeAttendlist = emp
                                                        //    .Where(a => a.SiteName == plantdata.Key
                                                        //                && a.EmployeeCode == emp.Key
                                                        //                && IdJobdescription.Contains(a.IdJobDescription)
                                                        //                && (
                                                        //                    (a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                                        //                    || (a.AttendanceStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                                        //                ))
                                                        //    .OrderBy(a => a.AttendanceStartDate == null ? DateTime.MaxValue : a.AttendanceStartDate.Value)  // Handle null AttendanceStartDate
                                                        //    .ThenBy(a => a.LeaveStartDate == null ? DateTime.MaxValue : a.LeaveStartDate.Value)  // Handle null LeaveStartDate
                                                        //    .ToList();

                                                        #endregion
                                                        #endregion
                                                        //if (employeeAttendlist.Count() == 0)
                                                        //{

                                                        //}

                                                        if (employeeAttendlist.Count() > 0)
                                                        {
                                                            var CheckIdUser = employeeAttendlist.Where(a => a.IdUser == null || a.IdUser == 0 && ((a.LeavesAllDayEvent != 1 || a.LeavesAllDayEvent == null) && a.ISHolidayEvent == false)).ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            if (CheckIdUser.Count() == 0)
                                                            {
                                                                #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                                //var employeeLeaveNotnulllist = employeeAttendlist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.LeaveStartDate != null).OrderBy(a => a.LeaveStartDate).ToList();
                                                                //var employeeLeavelist = employeeLeaveNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && a.StageCode == stagedata.Key && a.LeaveStartDate.Value.Date == StartDate.Date).OrderBy(a => a.LeaveStartDate).ToList();
                                                                var employeeLeaveNotnulllist = employeeAttendlist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.LeaveStartDate != null).OrderBy(a => a.LeaveStartDate).ToList();
                                                                var employeeLeavelist = employeeLeaveNotnulllist.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.LeaveStartDate.Value.Date == itemDate.Key.Date && a.LeavesAllDayEvent == 0).OrderBy(a => a.LeaveStartDate).ToList();
                                                                #endregion
                                                                var Leavedata = employeeLeavelist.GroupBy(test => test.LeaveStartTime)
                                                                                               .Select(grp => grp.First())
                                                                                               .ToList();

                                                                //var Leavedata = (from a in employeeAttendlist
                                                                //                 select new
                                                                //                 {
                                                                //                     a.LeaveStartTime,
                                                                //                     a.LeaveEndTime,
                                                                //                     a.LeaveType,
                                                                //                     a.LeaveTypeColor
                                                                //                 }
                                                                //                ).Distinct().ToList();


                                                                if (Leavedata.Count() > 0)
                                                                {
                                                                    foreach (var leave in Leavedata)
                                                                    {
                                                                        bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                                        // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                                        double LeaveStartTimeIndouble = 0;
                                                                        double LeaveEndTimeIndouble = 0;
                                                                        if (!existTotalAttandance)
                                                                        {
                                                                            LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(leave.LeaveStartTime.TotalMinutes) / 60), 4);
                                                                            LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(leave.LeaveEndTime.TotalMinutes) / 60), 4);
                                                                        }
                                                                        else
                                                                        {
                                                                            LeaveStartTimeIndouble = 0;
                                                                            LeaveEndTimeIndouble = 0;
                                                                        }
                                                                        // double LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(leave.LeaveStartTime.TotalMinutes) / 60), 4);
                                                                        // double LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(leave.LeaveEndTime.TotalMinutes) / 60), 4);
                                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                        {
                                                                            if (LeaveStartTimeIndouble != null)
                                                                            {
                                                                                LinearScaleRangeBar AttendanceLeaveStart = new LinearScaleRangeBar();
                                                                                if (LeaveStartTimeIndouble > LeaveEndTimeIndouble)
                                                                                {
                                                                                    AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                                    AttendanceLeaveStart.AnchorValue = 24;
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = 24;
                                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    string LeaveType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                                    {
                                                                                        LeaveType = leave.LeaveType;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        LeaveType = "Leaves";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = LeaveType;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                }
                                                                                if (LeaveStartTimeIndouble < LeaveEndTimeIndouble)
                                                                                {
                                                                                    AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                                    AttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    string LeaveType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                                    {
                                                                                        LeaveType = leave.LeaveType;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        LeaveType = "Leaves";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = LeaveType;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                }

                                                                                AttendanceLeaveStart.Visible = true;
                                                                                AttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                                // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                string LeaveTimeColor = leave.LeaveTypeColor;
                                                                                if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                                {
                                                                                    LeaveTimeColor = "#000000";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };

                                                                                linearScale.RangeBars.Add(AttendanceLeaveStart);
                                                                            }
                                                                            if (LeaveStartTimeIndouble > LeaveEndTimeIndouble)
                                                                            {
                                                                                #region nightShift
                                                                                LinearScaleRangeBar NightAttendanceLeaveStart = new LinearScaleRangeBar();
                                                                                NightAttendanceLeaveStart.Value = 0;
                                                                                NightAttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                                NightAttendanceLeaveStart.Visible = true;
                                                                                NightAttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                                // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                                string LeaveTimeColor = leave.LeaveTypeColor;
                                                                                if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                                {
                                                                                    LeaveTimeColor = "#000000";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                NightAttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = 0;
                                                                                SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "LeaveType";
                                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                                SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                string LeaveType = string.Empty;
                                                                                if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                                {
                                                                                    LeaveType = leave.LeaveType;
                                                                                }
                                                                                else
                                                                                {
                                                                                    LeaveType = "Leaves";
                                                                                }
                                                                                SelectedTooltips.ToolTipsType = LeaveType;
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearnightScale.RangeBars.Add(NightAttendanceLeaveStart);
                                                                                #endregion
                                                                            }
                                                                        }
                                                                        else if (employee.LeavesAllDayEvent != 1)//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                                        {
                                                                            LinearScaleRangeBar AttendanceLeaveStart = new LinearScaleRangeBar();
                                                                            AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                            AttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                            AttendanceLeaveStart.Visible = true;
                                                                            AttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                            // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                            string LeaveTimeColor = leave.LeaveTypeColor;
                                                                            if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                            {
                                                                                LeaveTimeColor = "#000000";
                                                                            }
                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                            AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };
                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                            SelectedTooltips.BarTypeName = "LeaveType";
                                                                            SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                            SelectedTooltips.IdStage = employee.IdStage;
                                                                            SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                            string LeaveType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                            {
                                                                                LeaveType = leave.LeaveType;
                                                                            }
                                                                            else
                                                                            {
                                                                                LeaveType = "Leaves";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = LeaveType;
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }

                                                                            #endregion
                                                                            linearScale.RangeBars.Add(AttendanceLeaveStart);
                                                                        }

                                                                        #endregion

                                                                    }
                                                                }
                                                                var Attendancedata = employeeAttendlist
                                                                        .Where(a => a.AttendanceStartDate.HasValue)
                                                                        .GroupBy(test => test.AttendanceStartDate.Value.TimeOfDay)
                                                                        .Select(grp => grp.First())
                                                                        .ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                                if (Attendancedata.Count() > 0)
                                                                {
                                                                    foreach (var Attend in Attendancedata)
                                                                    {
                                                                        //TotalAttendanceWithoutLeave = TotalAttendanceHours;
                                                                        // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate!=null && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                                        bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                                        double AttenadnceStartTimeIndouble = 0;
                                                                        double AttenadnceEndTimeIndouble = 0;
                                                                        if (!existTotalAttandance)
                                                                        {
                                                                            AttenadnceStartTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceStartDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                            AttenadnceEndTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceEndDate.Value.TimeOfDay.TotalMinutes) / 60), 2);

                                                                        }

                                                                        // double AttenadnceStartTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceStartDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                        // double AttenadnceEndTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceEndDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                        //double AttenadnceStartTimeIndouble = Math.Round(Attend.AttendanceStartDate.Value.TimeOfDay.TotalHours,2);
                                                                        //double AttenadnceEndTimeIndouble = Math.Round(Attend.AttendanceEndDate.Value.TimeOfDay.TotalHours,2);
                                                                        //TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);
                                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                                        {
                                                                            if (AttenadnceStartTimeIndouble != null)
                                                                            {
                                                                                LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                                //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                                //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                                if (AttenadnceStartTimeIndouble < AttenadnceEndTimeIndouble)
                                                                                {
                                                                                    Attendance.Value = AttenadnceStartTimeIndouble;
                                                                                    Attendance.AnchorValue = AttenadnceEndTimeIndouble;

                                                                                    TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);


                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "AttendanceType";
                                                                                    SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    string AttendenceType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                                    {
                                                                                        AttendenceType = Attend.AttendanceType;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        AttendenceType = "Attendance";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = AttendenceType;
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                }
                                                                                if (AttenadnceStartTimeIndouble > AttenadnceEndTimeIndouble)
                                                                                {
                                                                                    Attendance.Value = AttenadnceStartTimeIndouble;
                                                                                    Attendance.AnchorValue = 24;

                                                                                    TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (24 - AttenadnceStartTimeIndouble);


                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = 24;
                                                                                    SelectedTooltips.BarTypeName = "AttendanceType";
                                                                                    SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                    string AttendenceType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                                    {
                                                                                        AttendenceType = Attend.AttendanceType;
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        AttendenceType = "Attendance";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = AttendenceType;
                                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                }
                                                                                Attendance.Visible = true;
                                                                                Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                                string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                                if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                                {
                                                                                    AttendanceTimeColor = "#000000";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                                #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                                                if (shiftStartDate.Value.Date == Attend.AttendanceStartDate.Value.Date)
                                                                                {
                                                                                    linearScale.RangeBars.Add(Attendance);
                                                                                }
                                                                                else if (shiftEndDate.Value.Date == Attend.AttendanceEndDate.Value.Date)
                                                                                {
                                                                                    linearnightScale.RangeBars.Add(Attendance);
                                                                                }

                                                                                #endregion

                                                                            }
                                                                            if (AttenadnceEndTimeIndouble < AttenadnceStartTimeIndouble)
                                                                            {
                                                                                #region Night

                                                                                TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - 0);


                                                                                LinearScaleRangeBar NightAttendance = new LinearScaleRangeBar();
                                                                                //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                                //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                                NightAttendance.Value = 0;
                                                                                NightAttendance.AnchorValue = AttenadnceEndTimeIndouble;
                                                                                NightAttendance.Visible = true;
                                                                                NightAttendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                                NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                                string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                                if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                                {
                                                                                    AttendanceTimeColor = "#000000";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = 0;
                                                                                SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "AttendanceType";
                                                                                SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                                string AttendenceType = string.Empty;
                                                                                if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                                {
                                                                                    AttendenceType = Attend.AttendanceType;
                                                                                }
                                                                                else
                                                                                {
                                                                                    AttendenceType = "Attendance";
                                                                                }
                                                                                SelectedTooltips.ToolTipsType = AttendenceType;
                                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearnightScale.RangeBars.Add(NightAttendance);
                                                                                #endregion
                                                                            }
                                                                        }
                                                                        else
                                                                        {

                                                                            TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);


                                                                            LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                            //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                            //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                            Attendance.Value = AttenadnceStartTimeIndouble;
                                                                            Attendance.AnchorValue = AttenadnceEndTimeIndouble;
                                                                            Attendance.Visible = true;
                                                                            Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                            Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                            string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                            if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                            {
                                                                                AttendanceTimeColor = "#000000";
                                                                            }
                                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                            Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                            SelectedTooltips.BarTypeName = "AttendanceType";
                                                                            SelectedTooltips.AttendanceStartDate = employee.AttendanceStartDate;
                                                                            string AttendenceType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                            {
                                                                                AttendenceType = Attend.AttendanceType;
                                                                            }
                                                                            else
                                                                            {
                                                                                AttendenceType = "Attendance";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = AttendenceType;
                                                                            SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                            SelectedTooltips.IdStage = employee.IdStage;
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == employee.AttendanceStartDate && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }

                                                                            #endregion
                                                                            linearScale.RangeBars.Add(Attendance);
                                                                        }
                                                                        #endregion

                                                                    }
                                                                }
                                                            }

                                                        }
                                                        else
                                                        {

                                                            #region if Attendance is null
                                                            if (employee.IsNightShift == 1 && employee.LeavesAllDayEvent != 1)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                            {
                                                                //ShiftEndTime - ShiftStartTime;

                                                                LinearScaleRangeBar Attendance = new LinearScaleRangeBar();


                                                                //if (ShiftStartTime > ShiftEndTime)//[GEOS2-7755][gulab lakade][16 04 2025]
                                                                //{
                                                                //Attendance.Value = ShiftStartTime;
                                                                Attendance.Value = shiftStartDate.Value.Hour;
                                                                //Attendance.AnchorValue = 24;
                                                                //TotalAttendanceWithoutLeave = (24 - ShiftStartTime);
                                                                //Attendance.AnchorValue = (ShiftStartTime + 0.10);
                                                                Attendance.AnchorValue = (shiftStartDate.Value.Hour + 0.10);
                                                                //TotalAttendanceWithoutLeave = (24 - ShiftStartTime);
                                                                TotalAttendanceWithoutLeave = (0);
                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                //SelectedTooltips.ToolTipsStartTime = ShiftStartTime;
                                                                SelectedTooltips.ToolTipsStartTime = shiftStartDate.Value.Hour;
                                                                //SelectedTooltips.ToolTipsEndTime = 24;
                                                                //SelectedTooltips.ToolTipsEndTime = (ShiftStartTime + 0.10);
                                                                SelectedTooltips.ToolTipsEndTime = (shiftStartDate.Value.Hour + 0.10);
                                                                SelectedTooltips.BarTypeName = "AttendanceType";
                                                                SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);
                                                                string AttendenceType = string.Empty;
                                                                AttendenceType = "Attendance";
                                                                SelectedTooltips.ToolTipsType = AttendenceType;
                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                {
                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                    {
                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == ShiftStartTime && x.ToolTipsEndTime == 24 && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == shiftStartDate.Value.Hour && x.ToolTipsEndTime == 24 && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                        if (Tooltipdata == null)
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                }

                                                                #endregion
                                                                Attendance.Visible = true;
                                                                Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                                string AttendanceTimeColor = "#000000";
                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };

                                                                linearScale.RangeBars.Add(Attendance);
                                                                // }//[GEOS2-7755][gulab lakade][16 04 2025]


                                                                //if (ShiftEndTime < ShiftStartTime)
                                                                //{
                                                                //#region Night
                                                                //TotalAttendanceWithoutLeave = (ShiftEndTime - 0);
                                                                //LinearScaleRangeBar NightAttendance = new LinearScaleRangeBar();
                                                                ////Attendance.Value = AttenadnceEndTimeIndouble;
                                                                ////Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                //NightAttendance.Value = 0;
                                                                //NightAttendance.AnchorValue = ShiftEndTime;
                                                                //NightAttendance.Visible = true;
                                                                //NightAttendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                //NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                //string AttendanceTimeColor = "#000000";
                                                                ////LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                //NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                //#region Tool Tips [Gulab lakade][24 01 2024]
                                                                //ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                //SelectedTooltips.ToolTipsStartTime = 0;
                                                                //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                //SelectedTooltips.BarTypeName = "AttendanceType";
                                                                //SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);
                                                                //string AttendenceType = string.Empty;
                                                                //AttendenceType = "Attendance";
                                                                //SelectedTooltips.ToolTipsType = AttendenceType;
                                                                //SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                //SelectedTooltips.IdStage = employee.IdStage;
                                                                //if (ERMCommon.Instance.ProductionToolTip != null)
                                                                //{
                                                                //    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                //    {
                                                                //        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == 0 && x.ToolTipsEndTime == ShiftEndTime && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                //        if (Tooltipdata == null)
                                                                //        {
                                                                //            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                //        }
                                                                //    }
                                                                //    else
                                                                //    {
                                                                //        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                //    }
                                                                //}
                                                                //else
                                                                //{
                                                                //    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                //    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                //}

                                                                //#endregion
                                                                //linearnightScale.RangeBars.Add(NightAttendance);
                                                                //#endregion
                                                                //}
                                                            }
                                                            #region [GEOS2-6965][rani dhamankar][12-03-2025]
                                                            else if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false)//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            {
                                                                if (employee.IsNightShift == 1)  //[GEOS2-8189][rani dhamankar] [03 - 06 - 2025]
                                                                {

                                                                    double LeaveStartTimeIndouble = 0;
                                                                    double LeaveEndTimeIndouble = 0;
                                                                    LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(employee.LeaveStartTime.TotalMinutes) / 60), 4);
                                                                    LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(employee.LeaveEndTime.TotalMinutes) / 60), 4);
                                                                    TotalAttendanceWithoutLeave = 0;
                                                                    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                    Attendance.Value = LeaveStartTimeIndouble;

                                                                    Attendance.AnchorValue = 24;
                                                                    Attendance.Visible = true;
                                                                    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                    string AttendanceTimeColor = employee.LeaveTypeColor;
                                                                    if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                    {
                                                                        AttendanceTimeColor = "#000000";
                                                                    }
                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    SelectedTooltips.ToolTipsEndTime = 24;
                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                    SelectedTooltips.AttendanceStartDate = (employee.LeaveStartDate == null ? employee.LeaveStartDate : employee.LeaveEndDate);
                                                                    string AttendenceType = string.Empty;
                                                                    AttendenceType = "Leave";
                                                                    SelectedTooltips.ToolTipsType = employee.LeaveType;
                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == AttendenceType && x.LeaveStartDate == (employee.LeaveStartDate == null ? employee.LeaveEndDate : employee.LeaveStartDate) && x.IdEmployee == employee.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }
                                                                    LinearScaleRangeBar NightAttendance = new LinearScaleRangeBar();
                                                                    NightAttendance.Value = 0;

                                                                    NightAttendance.AnchorValue = LeaveEndTimeIndouble;
                                                                    NightAttendance.Visible = true;
                                                                    NightAttendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    ProductionTimeLineToolTipdata NightShiftSelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    NightShiftSelectedTooltips.ToolTipsStartTime = 0;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    NightShiftSelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                    NightShiftSelectedTooltips.BarTypeName = "LeaveType";
                                                                    NightShiftSelectedTooltips.AttendanceStartDate = (employee.LeaveStartDate == null ? employee.LeaveStartDate : employee.LeaveEndDate);
                                                                    string NightShiftAttendenceType = string.Empty;
                                                                    NightShiftAttendenceType = "Leave";
                                                                    NightShiftSelectedTooltips.ToolTipsType = employee.LeaveType;
                                                                    NightShiftSelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                    NightShiftSelectedTooltips.IdStage = employee.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == NightShiftAttendenceType && x.LeaveStartDate == (employee.LeaveStartDate == null ? employee.LeaveEndDate : employee.LeaveStartDate) && x.IdEmployee == employee.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                    }

                                                                    linearScale.RangeBars.Add(Attendance);
                                                                    linearnightScale.RangeBars.Add(NightAttendance);

                                                                }
                                                                else
                                                                {

                                                                    double LeaveStartTimeIndouble = 0;
                                                                    double LeaveEndTimeIndouble = 0;
                                                                    LeaveStartTimeIndouble = Math.Round((Convert.ToDouble(employee.ShiftStartTime.TotalMinutes) / 60), 4);
                                                                    LeaveEndTimeIndouble = Math.Round((Convert.ToDouble(employee.ShiftEndTime.TotalMinutes) / 60), 4);
                                                                    TotalAttendanceWithoutLeave = 0;
                                                                    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                    Attendance.Value = LeaveStartTimeIndouble;

                                                                    Attendance.AnchorValue = LeaveEndTimeIndouble;
                                                                    Attendance.Visible = true;
                                                                    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                    string AttendanceTimeColor = employee.LeaveTypeColor;
                                                                    if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                    {
                                                                        AttendanceTimeColor = "#000000";
                                                                    }
                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                    SelectedTooltips.AttendanceStartDate = (employee.LeaveStartDate == null ? employee.LeaveStartDate : employee.LeaveEndDate);
                                                                    string AttendenceType = string.Empty;
                                                                    AttendenceType = "Leave";
                                                                    SelectedTooltips.ToolTipsType = employee.LeaveType;
                                                                    SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                    SelectedTooltips.IdStage = employee.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == AttendenceType && x.LeaveStartDate == (employee.LeaveStartDate == null ? employee.LeaveEndDate : employee.LeaveStartDate) && x.IdEmployee == employee.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }

                                                                    #endregion
                                                                    linearScale.RangeBars.Add(Attendance);
                                                                }
                                                            }
                                                            #endregion
                                                            else //if (employee.LeavesAllDayEvent != 1)//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                            {

                                                                //TotalAttendanceWithoutLeave = ShiftEndTime - ShiftStartTime;
                                                                TotalAttendanceWithoutLeave = 0;
                                                                LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                //Attendance.Value = ShiftStartTime; //[GEOS2 - 9022][gulab lakade][23 07 2025]
                                                                Attendance.Value = shiftStartDate.Value.Hour; //[GEOS2 - 9022][gulab lakade][23 07 2025]
                                                                                                              //Attendance.AnchorValue = ShiftEndTime;
                                                                                                              //Attendance.AnchorValue = ShiftStartTime + 0.10;//[GEOS2 - 9022][gulab lakade][23 07 2025]
                                                                Attendance.AnchorValue = shiftStartDate.Value.Hour + 0.10;//[GEOS2 - 9022][gulab lakade][23 07 2025]
                                                                Attendance.Visible = true;
                                                                Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                string AttendanceTimeColor = "#000000";
                                                                if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                {
                                                                    AttendanceTimeColor = "#000000";
                                                                }
                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                //SelectedTooltips.ToolTipsStartTime = ShiftStartTime;
                                                                SelectedTooltips.ToolTipsStartTime = shiftStartDate.Value.Hour; //[GEOS2 - 9022][gulab lakade][23 07 2025]
                                                                //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                SelectedTooltips.ToolTipsEndTime = shiftStartDate.Value.Hour + 0.10;
                                                                SelectedTooltips.BarTypeName = "AttendanceType";
                                                                SelectedTooltips.AttendanceStartDate = (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate);
                                                                string AttendenceType = string.Empty;
                                                                AttendenceType = "Attendance";
                                                                SelectedTooltips.ToolTipsType = AttendenceType;
                                                                SelectedTooltips.IdEmployee = employee.IdEmployee;
                                                                SelectedTooltips.IdStage = employee.IdStage;
                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                {
                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                    {
                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == ShiftStartTime && x.ToolTipsEndTime == ShiftEndTime && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == shiftStartDate.Value.Hour && x.ToolTipsEndTime == shiftEndDate.Value.Hour && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (employee.AttendanceStartDate == null ? employee.CounterpartStartDate : employee.AttendanceStartDate) && x.IdEmployee == employee.IdEmployee && x.IdStage == employee.IdStage).FirstOrDefault();
                                                                        if (Tooltipdata == null)
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                }

                                                                #endregion
                                                                linearScale.RangeBars.Add(Attendance);
                                                            }

                                                            #endregion



                                                        }



                                                        //TimeSpan tempLeaveStart = new TimeSpan();
                                                        //tempLeaveStart = TimeSpan.FromHours(0);
                                                        //if (employee.LeaveStartTime != tempLeaveStart)
                                                        //{
                                                        //    if (employee.AttendanceStartDate.Value.Date == employee.LeaveStartDate.Value.Date)
                                                        //    {


                                                        //        TimeSpan LeaveDifference = new TimeSpan();
                                                        //        LeaveDifference = employee.LeaveEndTime - employee.LeaveStartTime;
                                                        //        TotalAttendanceWithoutLeave = TotalAttendanceHours - LeaveDifference.TotalHours;
                                                        //        double LeaveStartTime = Math.Round((Convert.ToDouble(employee.LeaveStartTime.TotalMinutes) / 60), 4);
                                                        //        double LeaveEndTime = Math.Round((Convert.ToDouble(employee.LeaveEndTime.TotalMinutes) / 60), 4);
                                                        //        LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                        //        Attendance.Value = LeaveStartTime;
                                                        //        Attendance.AnchorValue = ShiftStartTime;
                                                        //        Attendance.Visible = true;
                                                        //        Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //        Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                        //        LinearScaleRangeBar AttendanceLeaveStart = new LinearScaleRangeBar();
                                                        //        AttendanceLeaveStart.Value = LeaveEndTime;
                                                        //        AttendanceLeaveStart.AnchorValue = LeaveStartTime;
                                                        //        AttendanceLeaveStart.Visible = true;
                                                        //        AttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //        AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };

                                                        //        LinearScaleRangeBar AttendanceLeaveend = new LinearScaleRangeBar();
                                                        //        AttendanceLeaveend.Value = ShiftEndTime;
                                                        //        AttendanceLeaveend.AnchorValue = LeaveEndTime;
                                                        //        AttendanceLeaveend.Visible = true;
                                                        //        AttendanceLeaveend.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //        AttendanceLeaveend.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                        //        linearScale.RangeBars.Add(Attendance);
                                                        //        linearScale.RangeBars.Add(AttendanceLeaveStart);
                                                        //        linearScale.RangeBars.Add(AttendanceLeaveend);
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        TotalAttendanceWithoutLeave = TotalAttendanceHours;
                                                        //        LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                        //        Attendance.Value = ShiftEndTime;
                                                        //        Attendance.AnchorValue = ShiftStartTime;
                                                        //        Attendance.Visible = true;
                                                        //        Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //        Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                        //        linearScale.RangeBars.Add(Attendance);
                                                        //    }
                                                        //}
                                                        //else
                                                        //{
                                                        //    TotalAttendanceWithoutLeave = TotalAttendanceHours;
                                                        //    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                        //    Attendance.Value = ShiftEndTime;
                                                        //    Attendance.AnchorValue = ShiftStartTime;
                                                        //    Attendance.Visible = true;
                                                        //    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                        //    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                        //    linearScale.RangeBars.Add(Attendance);
                                                        //}


                                                        #endregion


                                                        #region aishwariya
                                                        #region Total EMP grid
                                                        Grid TotalGrid = new Grid();
                                                        TotalGrid.ShowGridLines = false;


                                                        //Total EMP column creation
                                                        #region ColumnDefinition
                                                        for (var Totalcolumn = 0; Totalcolumn < 1; Totalcolumn++)
                                                        {
                                                            var c = new ColumnDefinition();
                                                            c.Width = GridLength.Auto;
                                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                            TotalGrid.ColumnDefinitions.Add(c);
                                                        }





                                                        #endregion
                                                        //Total EMP  row creation
                                                        #region RowDefinition 
                                                        for (var Totalrow = 0; Totalrow < 4; Totalrow++)
                                                        {
                                                            var r = new RowDefinition();
                                                            if (Totalrow == 0)
                                                            {
                                                                r.Height = new GridLength(35, GridUnitType.Pixel);
                                                            }
                                                            else
                                                           if (Totalrow == 1)
                                                            {
                                                                r.Height = new GridLength(33, GridUnitType.Pixel);
                                                            }
                                                            else
                                                            {
                                                                r.Height = GridLength.Auto;
                                                            }
                                                            TotalGrid.RowDefinitions.Add(r);
                                                        }






                                                        #endregion
                                                        //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalWithoutBreak));
                                                        //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalShiftTime - TotalBreakTimeForToolTip));
                                                        // TimeSpan TimespanTotalLoggedTime = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTime));
                                                        TimeSpan TimespanTotalAttendanceWithoutLeave = TimeSpan.FromHours(Convert.ToDouble(TotalAttendanceWithoutLeave));
                                                        Label totallabel = new Label();
                                                        totallabel.Content = "Total";
                                                        totallabel.FontWeight = FontWeights.Bold;
                                                        totallabel.Margin = new Thickness(10, 0, 10, 0);
                                                        //totallabel.fo
                                                        Label totalWithoutBreak = new Label();

                                                        //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip + TotalBreakTimeForToolTip)) - (employee.BreakTime);
                                                        TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalShiftInDouble));
                                                        totalWithoutBreak.Content = TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds));
                                                        totalWithoutBreak.Margin = new Thickness(10, 10, 10, 0);
                                                        Label loggedtime = new Label();
                                                        TotalLoggedTime = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip + TotalBreakTimeForToolTip));
                                                        loggedtime.Content = TotalLoggedTime.Add(-TimeSpan.FromMilliseconds(TotalLoggedTime.Milliseconds));
                                                        loggedtime.Margin = new Thickness(10, 5, 10, 0);
                                                        Label AttendanceWithoutLeavetime = new Label();
                                                        if (TimespanTotalAttendanceWithoutLeave != TimeSpan.Zero)
                                                        {

                                                            #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                            //if (TempPlantId.Count() == 0)
                                                            //{

                                                            //    TimespanTotalAttendanceWithoutLeave = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMinutes(employee.BreakTime.TotalMinutes));
                                                            //    // AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                            //    // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                            //    bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                            //    if (!existTotalAttandance)
                                                            //    {
                                                            //        AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));

                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        AttendanceWithoutLeavetime.Content = DBNull.Value;
                                                            //    }
                                                            //}
                                                            //else
                                                            //{
                                                            #endregion
                                                            AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                            // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                            bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                            if (!existTotalAttandance)
                                                            {
                                                                // AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                                AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                            }
                                                            else
                                                            {
                                                                AttendanceWithoutLeavetime.Content = "00:00:00";
                                                            }
                                                            //}
                                                        }
                                                        else
                                                        {
                                                            AttendanceWithoutLeavetime.Content = "00:00:00";
                                                        }
                                                        if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false)//[rani dhamankar][20-02-2025][GEOS2-6685]
                                                        {
                                                            AttendanceWithoutLeavetime.Content = "";
                                                        }
                                                        AttendanceWithoutLeavetime.Margin = new Thickness(10, -5, 10, 0);
                                                        Grid.SetRow(totallabel, 0);
                                                        Grid.SetColumn(totallabel, 0);
                                                        Grid.SetRow(totalWithoutBreak, 1);
                                                        Grid.SetColumn(totalWithoutBreak, 0);
                                                        Grid.SetRow(loggedtime, 2);
                                                        Grid.SetColumn(loggedtime, 0);
                                                        Grid.SetRow(AttendanceWithoutLeavetime, 3);
                                                        Grid.SetColumn(AttendanceWithoutLeavetime, 0);


                                                        // TotalGrid.Children.Add(EmployeeImage);
                                                        TotalGrid.Children.Add(totallabel);
                                                        TotalGrid.Children.Add(totalWithoutBreak);
                                                        TotalGrid.Children.Add(loggedtime);
                                                        TotalGrid.Children.Add(AttendanceWithoutLeavetime);






                                                        #endregion
                                                        #region Titles  Name
                                                        Label Titlelabel = new Label();
                                                        Titlelabel.Content = "";
                                                        Label Shift = new Label();
                                                        Shift.Content = "Shift";
                                                        Shift.Margin = new Thickness(10, 10, 10, 0);
                                                        Label logged = new Label();
                                                        logged.Content = "Logged";
                                                        logged.Margin = new Thickness(10, 5, 10, 0);
                                                        Label Attendance1 = new Label();
                                                        Attendance1.Content = "Att/Leaves";
                                                        Attendance1.Margin = new Thickness(10, -5, 10, 0);

                                                        Grid TitleGrid = new Grid();

                                                        //TitleGrid.ShowGridLines = false;


                                                        // Name column creation
                                                        #region ColumnDefinition
                                                        for (var Titlecolumn = 0; Titlecolumn < 2; Titlecolumn++)
                                                        {
                                                            var c = new ColumnDefinition();
                                                            c.Width = GridLength.Auto;
                                                            //c.Width = new GridLength(50, GridUnitType.Pixel);

                                                            TitleGrid.ColumnDefinitions.Add(c);
                                                        }




                                                        #endregion

                                                        #region RowDefinition 
                                                        for (var Titlerow = 0; Titlerow < 4; Titlerow++)
                                                        {
                                                            var r = new RowDefinition();
                                                            if (Titlerow == 0)
                                                            {
                                                                r.Height = new GridLength(35, GridUnitType.Pixel);
                                                            }
                                                            else
                                                            if (Titlerow == 1)
                                                            {
                                                                r.Height = new GridLength(33, GridUnitType.Pixel);
                                                            }
                                                            else
                                                            {
                                                                r.Height = GridLength.Auto;
                                                                //  r.Height = new GridLength(20, GridUnitType.Pixel);
                                                            }

                                                            TitleGrid.RowDefinitions.Add(r);
                                                        }


                                                        #endregion

                                                        Grid.SetRow(Titlelabel, 0);
                                                        Grid.SetColumn(Titlelabel, 0);
                                                        Grid.SetRow(Shift, 1);
                                                        Grid.SetColumn(Shift, 0);
                                                        Grid.SetRow(logged, 2);
                                                        Grid.SetColumn(logged, 0);
                                                        Grid.SetRow(Attendance1, 3);
                                                        Grid.SetColumn(Attendance1, 0);

                                                        TitleGrid.Children.Add(Titlelabel);
                                                        TitleGrid.Children.Add(Shift);
                                                        TitleGrid.Children.Add(logged);
                                                        TitleGrid.Children.Add(Attendance1);

                                                        #endregion

                                                        #endregion


                                                        TimeSpan BreakTimeForToolTip = new TimeSpan();
                                                        TimeSpan LoggedTimeForToolTip = new TimeSpan();
                                                        TimeSpan pauseTimeForToolTip = new TimeSpan();
                                                        LoggedTimeForToolTip = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip));
                                                        LoggedTimeForToolTip = LoggedTimeForToolTip.Add(-TimeSpan.FromMilliseconds(LoggedTimeForToolTip.Milliseconds));

                                                        //BreakTimeForToolTip = TimeSpan.FromHours(Convert.ToDouble(TotalBreakTimeForToolTip));
                                                        //BreakTimeForToolTip = BreakTimeForToolTip.Add(-TimeSpan.FromMilliseconds(BreakTimeForToolTip.Milliseconds));


                                                        BreakTimeForToolTip = employee.BreakTime.Add(-TimeSpan.FromMilliseconds(employee.BreakTime.Milliseconds));

                                                        pauseTimeForToolTip = TimeSpan.FromHours(Convert.ToDouble(TotalBreakTimeForToolTip));
                                                        pauseTimeForToolTip = pauseTimeForToolTip.Add(-TimeSpan.FromMilliseconds(pauseTimeForToolTip.Milliseconds));

                                                        linearGauge.ToolTip = " OT Registered Time: " + LoggedTimeForToolTip + "\n Pause Time: " + pauseTimeForToolTip + "\n Shift Break Time: " + BreakTimeForToolTip;

                                                        linearGauge.Scales.Add(linearScale);
                                                        //linearGauge.Scales.Add(linearnightScale);
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        if (employee.IsNightShift == 1 && shiftStartDate.Value.Date != shiftEndDate.Value.Date)
                                                        {
                                                            linearGauge_night.Scales.Add(linearnightScale);
                                                        }
                                                        #endregion 
                                                        //linearGauge_night.Scales.Add(linearnightScale);//temp
                                                        //var firstscale = linearGauge_night.Scales.FirstOrDefault();
                                                        //if(firstscale!=null)
                                                        //{
                                                        //    linearGauge_night.Scales.Remove(firstscale);
                                                        //}

                                                        #endregion
                                                        #region [GEOS2-5040][gulab lakade]
                                                        #region  [GEOS2-5394][gulab lakade][19 02 2024]
                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                        if (ERMCommon.Instance.Emp_Productiontime.GroupBy(a => a.StageName).Count() > 0)
                                                        {
                                                            string Detailsmeeting = string.Empty;
                                                            var groupbyGrid = ERMCommon.Instance.Emp_Productiontime.OrderBy(b => b.StageSequence).GroupBy(a => a.StageName);
                                                            // DataRow dr1 = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();//[GEOS2-5394][gulab lakade][19 02 2024]

                                                            foreach (var sd in groupbyGrid)
                                                            {
                                                                DataRow dr1 = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();//[GEOS2-5394][gulab lakade][19 02 2024]
                                                                                                                                         //dr["Plant"] = Convert.ToString(plantdata.Key);
                                                                                                                                         //dr["Week"] = Convert.ToString(Week);
                                                                                                                                         //dr["Date"] = Convert.ToString(itemDate.Key.Date);
                                                                                                                                         //dr["Employee"] = Convert.ToString(employee.EmployeeName);
                                                                                                                                         //dr["Stage"] = Convert.ToString(stagedata.Key);
                                                                                                                                         //dr["Total_Shift"] = Convert.ToString(TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds)));
                                                                                                                                         //dr["Total_Logged"] = Convert.ToString(TotalLoggedTime.Add(-TimeSpan.FromMilliseconds(TotalLoggedTime.Milliseconds)));
                                                                                                                                         // bool exists = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);
                                                                bool exists = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                                if (!exists)
                                                                {

                                                                    if (employee.AttendanceStartDate != null || employee.AttendanceEndDate != null)
                                                                    {


                                                                        double AttStartTime = employee.AttendanceStartDate.Value.Hour;
                                                                        double AttEndTime = employee.AttendanceEndDate.Value.Hour;
                                                                        double TotalTime = AttEndTime - AttStartTime;
                                                                        double Total1 = TotalAttendanceWithoutLeave;//Aishwarya Ingale[Geos2-6579]
                                                                        TimeSpan TimespanTotalAttendance = TimeSpan.FromHours(Convert.ToDouble(Total1));//Aishwarya Ingale[Geos2-6579]
                                                                        #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                                        //if (TempPlantId.Count() == 0)
                                                                        //{

                                                                        //    //TimespanTotalAttendanceWithoutLeave = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMinutes(employee.BreakTime.TotalMinutes));//[GEOS2-5886][gulab lakade][27 06 2024]

                                                                        //    //dr["Total_Attendance"] = Convert.ToString(TimespanTotalAttendance.Add(-TimeSpan.FromMinutes(employee.BreakTime.TotalMinutes)));
                                                                        //    dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave);
                                                                        //}
                                                                        //else
                                                                        //{
                                                                        #endregion
                                                                        dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendance);
                                                                        // }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    dr1["Total_Attendance"] = DBNull.Value;
                                                                }

                                                                //    if (TempPlantId.Count() == 0)
                                                                //{

                                                                //    //TimespanTotalAttendanceWithoutLeave = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMinutes(employee.BreakTime.TotalMinutes));//[GEOS2-5886][gulab lakade][27 06 2024]
                                                                //    dr["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds)));
                                                                //}
                                                                //else
                                                                //{
                                                                //    dr["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds)));
                                                                //}
                                                                //TimeSpan WOTime1 = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip));
                                                                //WOTime1 += totalDuration;//Aishwarya Ingale
                                                                double TotolWorkingTime = ERMCommon.Instance.Emp_Productiontime.Where(a => a.TimeType == "Working" && a.StageName == sd.Key).Sum(b => b.TimeValue);
                                                                TimeSpan WOTime1 = TimeSpan.FromHours(Convert.ToDouble(TotolWorkingTime));
                                                                // WOTime1 += totalDuration;//Aishwarya Ingale
                                                                dr1["WOTime"] = Convert.ToString(WOTime1.Add(-TimeSpan.FromMilliseconds(WOTime1.Milliseconds)));
                                                                //dr["DeliveryWeek"] = Convert.ToString(plantdata.Key);
                                                                //dr["DeliveryWeek"] = Convert.ToString(plantdata.Key);
                                                                #region [GEOS2-6573][rani dhamankar][07-05-2025]
                                                                var temprecord1 = employeelist.OrderBy(a => a.IdCounterpartTracking).ToList();
                                                                DataTable DataTableForGridLayout = new DataTable();
                                                                DataTableForGridLayout.Columns.Add("IdCounterpart", typeof(string));
                                                                DataTableForGridLayout.Columns.Add("IdCounterpartTracking", typeof(string));
                                                                if (temprecord1.Count() > 0)
                                                                {
                                                                    // var reorderedResult1 = temprecord1.OrderBy(r => r.AttendanceStartDate).ThenBy(r => r.AttendanceEndDate).ToList();

                                                                    var reorderedResult1 = temprecord1.OrderBy(a => a.AttendanceStartDate ?? a.CounterpartStartDate ?? a.JobDescriptionStartDate ?? DateTime.MaxValue).ToList();//[GEOS2-8124][rani dhamankar][16-05-2025]

                                                                    if (reorderedResult1.Count() > 0)
                                                                    {
                                                                        foreach (var item in reorderedResult1.Distinct().ToList())
                                                                        {
                                                                            bool checkexistIdCounterpartTrackingRecord = DataTableForGridLayout.Select().Any(a => a["IdCounterpartTracking"].ToString().ToUpper() == item.IdCounterpartTracking.ToString().ToUpper());
                                                                            if (checkexistIdCounterpartTrackingRecord == false)
                                                                            {

                                                                                int? checkIdstage_first = 0;
                                                                                string Production = string.Empty;
                                                                                //string Rework = string.Empty;

                                                                                string Rework_First = string.Empty;
                                                                                string Rework_Second = string.Empty;
                                                                                string Rework_Third = string.Empty;
                                                                                string Rework_Fourth = string.Empty;

                                                                                string POWS_First = string.Empty;
                                                                                string POWS_Second = string.Empty;
                                                                                string POWS_Third = string.Empty;
                                                                                string POWS_Fourth = string.Empty;


                                                                                string ROWS_First = string.Empty;
                                                                                string ROWS_Second = string.Empty;
                                                                                string ROWS_Third = string.Empty;
                                                                                string ROWS_Fourth = string.Empty;


                                                                                TimeSpan ProductionTime = new TimeSpan();
                                                                                TimeSpan Rework_Time = new TimeSpan();
                                                                                TimeSpan TotalProductiontime = new TimeSpan();
                                                                                TimeSpan TotalReworktime = new TimeSpan();


                                                                                int? DetectedIdStage_first = 0;

                                                                                string Rework = string.Empty;
                                                                                string POWS = string.Empty;
                                                                                string ROWS = string.Empty;
                                                                                TimeSpan TotalProductionOwstime = new TimeSpan();
                                                                                TimeSpan TotalReworkOwstime = new TimeSpan();
                                                                                TimeSpan OWSprodandReworkTime = new TimeSpan();
                                                                                List<TimeTrackingCurrentStage> ReworkTimeStageList = new List<TimeTrackingCurrentStage>();
                                                                                List<ERM_Timetracking_rework_ows> ReworkOWSList = new List<ERM_Timetracking_rework_ows>();

                                                                                List<TimeTrackingCurrentStage> TimeTrackingList = new List<TimeTrackingCurrentStage>();

                                                                                TimeTrackingList = item.TimeTrackingAddingPostServer.Where(x => x.TimeTrackIdCounterparttracking == item.IdCounterpartTracking && x.TimeTrackDifference > TimeSpan.Zero && x.Startdate.HasValue && x.Enddate.HasValue
                                                                                                   && x.Startdate.Value.Date == itemDate.Key.Date && x.Enddate.Value.Date == itemDate.Key.Date).ToList();

                                                                                if (item.IsNightShift == 1 && item.AttendanceStartDate > itemDate.Key.Date && item.AttendanceEndDate.Value.Date <= itemDate.Key.Date.AddDays(1) && item.ShiftStartTime != null && item.ShiftStartTime != TimeSpan.Zero)
                                                                                {
                                                                                    TimeTrackingList = item.TimeTrackingAddingPostServer.Where(x => x.TimeTrackIdCounterparttracking == item.IdCounterpartTracking && x.TimeTrackDifference > TimeSpan.Zero && x.Startdate.HasValue && x.Enddate.HasValue
                                                                                                   && x.Startdate.Value.Date == itemDate.Key.Date.AddDays(1) && x.Enddate.Value.Date == itemDate.Key.Date.AddDays(1)).ToList();
                                                                                }
                                                                                #region First Rework is true
                                                                                if (!DataTableForGridLayout.Columns.Contains("Production_" + Convert.ToString(item.IdStage)))
                                                                                    DataTableForGridLayout.Columns.Add("Production_" + Convert.ToString(item.IdStage), typeof(TimeSpan));
                                                                                if (!DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                    DataTableForGridLayout.Columns.Add("Download_" + Convert.ToString(item.IdStage), typeof(TimeSpan));
                                                                                if (!DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                    DataTableForGridLayout.Columns.Add("Transferred_" + Convert.ToString(item.IdStage), typeof(TimeSpan));
                                                                                DataRow drr = DataTableForGridLayout.NewRow();
                                                                                drr["IdCounterpart"] = item.IdCounterpart;
                                                                                drr["IdCounterpartTracking"] = item.IdCounterpartTracking;

                                                                                if (ReworkOWSList.Count() > 0)
                                                                                {
                                                                                    #region check reworkflag_Second 
                                                                                    //if (reworkflag_Second == false)
                                                                                    if (ReworkOWSList.Count() == 1)
                                                                                    {
                                                                                        var tempR_P_OWS = ReworkOWSList.Where(a => a.OWS_ID == 1).FirstOrDefault();
                                                                                        if (tempR_P_OWS != null)
                                                                                        {
                                                                                            checkIdstage_first = tempR_P_OWS.CheckStageId;
                                                                                            DetectedIdStage_first = tempR_P_OWS.DetectedStageId;
                                                                                        }
                                                                                        #region reworkflag_First data check and fill only
                                                                                        #region checkIdstage_first == item.IdStage
                                                                                        if (checkIdstage_first == item.IdStage)
                                                                                        {
                                                                                            try
                                                                                            {
                                                                                                #region reworkflag_First completed
                                                                                                string production_first = "Production_" + checkIdstage_first;
                                                                                                if (!DataTableForGridLayout.Columns.Contains(Production))
                                                                                                {
                                                                                                    drr[production_first] = TimeSpan.Zero;
                                                                                                }
                                                                                                if (DataTableForGridLayout.Columns.Contains(production_first))
                                                                                                {
                                                                                                    if (Convert.ToString(drr[production_first]) != null)
                                                                                                    {
                                                                                                        string reworkowsInstring = Convert.ToString(drr["Production_" + checkIdstage_first]);
                                                                                                        if (string.IsNullOrEmpty(Convert.ToString(reworkowsInstring)) || reworkowsInstring == "0" || reworkowsInstring == "00:00:00")
                                                                                                        {
                                                                                                            reworkowsInstring = "0.00:00:00";
                                                                                                        }
                                                                                                        string timeString = Convert.ToString(reworkowsInstring); // Example time format string
                                                                                                        string[] format = { @"hh\:mm\:ss", @"d\.hh\:mm\:ss" }; // Specify the format of the time string
                                                                                                        TimeSpan TempproductionTime = TimeSpan.ParseExact(timeString, format, null);

                                                                                                        if (DataTableForGridLayout.Columns.Contains(production_first))
                                                                                                        {

                                                                                                            TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                                            TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                                            DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                            TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                            if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                                            {
                                                                                                                drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                                            }
                                                                                                            if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                                            {
                                                                                                                drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                                            }

                                                                                                            //if (DataTableForGridLayout.Columns.Contains(Production))
                                                                                                            //{
                                                                                                            //    drr[production_first] = AddintotalTimeDifference + PostservertotalTimeDifference + ProductionTimeDifference;
                                                                                                            //}

                                                                                                        }

                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        if (DataTableForGridLayout.Columns.Contains(production_first))
                                                                                                        {
                                                                                                            TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                                            TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                                            DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                            TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                            if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                                            {
                                                                                                                drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                                            }
                                                                                                            if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                                            {
                                                                                                                drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                                            }
                                                                                                        }

                                                                                                    }
                                                                                                }

                                                                                                checkIdstage_first = 0;
                                                                                                // ReworkTimeIndouble = 0;
                                                                                                DetectedIdStage_first = 0;
                                                                                                ReworkOWSList.RemoveAll(a => a.OWS_ID == 1);
                                                                                                #endregion


                                                                                                #region reworkflag_First again true
                                                                                                if (item.Rework == true)
                                                                                                {
                                                                                                    ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                                    selected_rework_ows.OWS_ID = 1;
                                                                                                    selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);
                                                                                                    //reworkflag_First = true;
                                                                                                    checkIdstage_first = item.IdStage;
                                                                                                    var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                                    int lastindex = reorderedResult1.Count();
                                                                                                    if (lastindex - 1 > DetectedStageIndex)
                                                                                                    {
                                                                                                        var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                        if (Detectedrecord != null)
                                                                                                        {
                                                                                                            DetectedIdStage_first = Detectedrecord.IdStage;// detected rework stage
                                                                                                            selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);
                                                                                                        }
                                                                                                        TimeTrackingCurrentStage Temp_ReworkTime = new TimeTrackingCurrentStage();
                                                                                                        Temp_ReworkTime.IdStage = Detectedrecord.IdStage;
                                                                                                        Temp_ReworkTime.IdCounterparttracking = Convert.ToInt32(Detectedrecord.IdCounterpartTracking);
                                                                                                        Temp_ReworkTime.TimeDifference = Detectedrecord.CounterpartTimeDifference;
                                                                                                        ReworkTimeStageList.Add(Temp_ReworkTime);

                                                                                                    }

                                                                                                    if (checkIdstage_first == DetectedIdStage_first)
                                                                                                    {
                                                                                                        // reworkflag_First = false;
                                                                                                        checkIdstage_first = 0;
                                                                                                        DetectedIdStage_first = 0;
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ReworkOWSList.Add(selected_rework_ows);
                                                                                                    }

                                                                                                }
                                                                                                #endregion
                                                                                            }
                                                                                            catch (Exception ex)
                                                                                            {
                                                                                                GeosApplication.Instance.Logger.Log(string.Format("Error in method FillDashboard() - {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            try
                                                                                            {


                                                                                                #region only Add reworkflag_First data not other  
                                                                                                #region  if (item.Rework == 1) DetectedIdStage_Second
                                                                                                #region if(checkIdstage_Second==DetectedIdStage_Second)
                                                                                                Int32 Max_owsID = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                                selected_rework_ows.OWS_ID = Max_owsID + 1;
                                                                                                bool sameCheck_Detect = false;
                                                                                                if (item.Rework == true)
                                                                                                {
                                                                                                    var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                                    if ((reorderedResult1.Count() - 1) > DetectedStageIndex)
                                                                                                    {
                                                                                                        var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                        if (Detectedrecord != null)
                                                                                                        {
                                                                                                            selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);
                                                                                                        }
                                                                                                    }
                                                                                                    selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);

                                                                                                    if (selected_rework_ows.CheckStageId == selected_rework_ows.DetectedStageId)
                                                                                                    {
                                                                                                        sameCheck_Detect = true;
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        ReworkOWSList.Add(selected_rework_ows);

                                                                                                    }

                                                                                                }

                                                                                                #endregion

                                                                                                if (item.Rework == true && sameCheck_Detect == false)
                                                                                                {
                                                                                                    Int32 Max_owsID_Add = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                    Int32 Max_owsID_Add_minus = Max_owsID_Add - 1;
                                                                                                    var R_P_OWSMax = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add).FirstOrDefault();
                                                                                                    var R_P_OWSMax_minus = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add_minus).FirstOrDefault();

                                                                                                    #region Rework==1 and DetectedIdStage_first == item.IdStage
                                                                                                    if (R_P_OWSMax_minus.DetectedStageId == item.IdStage)
                                                                                                    {
                                                                                                        TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                    }
                                                                                                    #endregion
                                                                                                    else
                                                                                                    {
                                                                                                        #region Rework OWS
                                                                                                        string ROWS_second = "ROWS_" + R_P_OWSMax_minus.DetectedStageId;
                                                                                                        TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        #endregion
                                                                                                        #region Production OWS
                                                                                                        TotalProductionOwstime = TotalProductionOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        #endregion
                                                                                                    }
                                                                                                }
                                                                                                #endregion
                                                                                                else
                                                                                                {


                                                                                                    #region if (DetectedIdStage_first != item.IdStage)
                                                                                                    Int32 Max_owsID_Add = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                    //Int32 Max_owsID_Add_minus = Max_owsID_Add - 1;
                                                                                                    var R_P_OWSMax = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add).FirstOrDefault();
                                                                                                    //var R_P_OWSMax_minus = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add_minus).FirstOrDefault();

                                                                                                    //if (DetectedIdStage_first == item.IdStage)
                                                                                                    if (R_P_OWSMax.DetectedStageId == item.IdStage)
                                                                                                    {

                                                                                                        string Rework_second = "Rework_" + item.IdStage;
                                                                                                        TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        #region  rework ows and production ows
                                                                                                        POWS_First = "POWS_" + item.IdStage;
                                                                                                        ROWS_First = "ROWS_" + R_P_OWSMax.DetectedStageId;

                                                                                                        TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                        TotalProductionOwstime = TotalProductionOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        #endregion
                                                                                                    }

                                                                                                    #endregion
                                                                                                }
                                                                                                #endregion
                                                                                            }
                                                                                            catch (Exception ex)
                                                                                            {
                                                                                                GeosApplication.Instance.Logger.Log(string.Format("Error in method FillDashboard() - {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                                                                            }
                                                                                        }
                                                                                        #endregion
                                                                                        #endregion
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        try
                                                                                        {

                                                                                            #region check reworkflag_Third 
                                                                                            //if (reworkflag_Third == false)
                                                                                            if (ReworkOWSList.Count() > 1)
                                                                                            {
                                                                                                Int32 Max_owsID = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                Int32 Max_owsID_minus = Max_owsID - 1;
                                                                                                var tempR_P_OWSMax = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID).FirstOrDefault();
                                                                                                var tempR_P_OWSMax_minusone = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_minus).FirstOrDefault();
                                                                                                #region reworkflag_Second data check and fill only
                                                                                                #region checkIdstage_Second  == item.IdStage
                                                                                                //if (checkIdstage_Second == item.IdStage)
                                                                                                if (tempR_P_OWSMax.CheckStageId == item.IdStage)
                                                                                                {
                                                                                                    #region   if(checkIdstage_Second==DetectedIdStage_first)
                                                                                                    //if (checkIdstage_Second == DetectedIdStage_first)
                                                                                                    if (tempR_P_OWSMax.CheckStageId == tempR_P_OWSMax_minusone.DetectedStageId)
                                                                                                    {
                                                                                                        string Rework_second = "Rework_" + item.IdStage;
                                                                                                        TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                    }
                                                                                                    #endregion
                                                                                                    else
                                                                                                    {
                                                                                                        #region Rework OWS

                                                                                                        //string ROWS_second = "ROWS_" + DetectedIdStage_first;
                                                                                                        string ROWS_second = "ROWS_" + tempR_P_OWSMax_minusone.DetectedStageId;
                                                                                                        TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                        TotalProductionOwstime = TotalProductionOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        #endregion


                                                                                                    }
                                                                                                    #region reworkflag_Second completed
                                                                                                    ReworkOWSList.RemoveAll(a => a.OWS_ID == Max_owsID);

                                                                                                    #endregion


                                                                                                    #region reworkflag_Second again true

                                                                                                    if (item.Rework == true)
                                                                                                    {
                                                                                                        Int32 Max_owsID_Add = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                        var tempR_P_OWSMax_add = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_Add).FirstOrDefault();
                                                                                                        ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                                        selected_rework_ows.OWS_ID = Max_owsID_Add + 1;
                                                                                                        selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);
                                                                                                        //reworkflag_Second = true;
                                                                                                        //checkIdstage_Second = item.IdStage;
                                                                                                        var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                                        int lastindex = reorderedResult1.Count();
                                                                                                        if (lastindex - 1 > DetectedStageIndex)
                                                                                                        {
                                                                                                            var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                            if (Detectedrecord != null)
                                                                                                            {
                                                                                                                //DetectedIdStage_Second = Detectedrecord.IdStage;// detected rework stage
                                                                                                                selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);
                                                                                                            }
                                                                                                            TimeTrackingCurrentStage Temp_ReworkTime = new TimeTrackingCurrentStage();
                                                                                                            Temp_ReworkTime.IdStage = Detectedrecord.IdStage;
                                                                                                            Temp_ReworkTime.IdCounterparttracking = Convert.ToInt32(Detectedrecord.IdCounterpartTracking);
                                                                                                            Temp_ReworkTime.TimeDifference = Detectedrecord.CounterpartTimeDifference;
                                                                                                            ReworkTimeStageList.Add(Temp_ReworkTime);
                                                                                                        }
                                                                                                        ReworkOWSList.Add(selected_rework_ows);


                                                                                                    }
                                                                                                    #endregion

                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    #region only Add reworkflag_Second data not other  
                                                                                                    #region  if (item.Rework == 1) DetectedIdStage_Third
                                                                                                    #region if(checkIdstage_Second==DetectedIdStage_Second)
                                                                                                    Int32 Max_owsID_1 = ReworkOWSList.Max(a => a.OWS_ID);
                                                                                                    var tempR_P_OWSMax_1 = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_1).FirstOrDefault();
                                                                                                    Int32 Max_owsID_1_minus = Max_owsID_1 - 1;
                                                                                                    var tempR_P_OWSMax_1_minus = ReworkOWSList.Where(a => a.OWS_ID == Max_owsID_1_minus).FirstOrDefault();
                                                                                                    bool sameCheck_Detect = false;
                                                                                                    if (item.Rework == true)
                                                                                                    {
                                                                                                        ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                                        selected_rework_ows.OWS_ID = Max_owsID_1 + 1;
                                                                                                        var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                                        if ((reorderedResult1.Count() - 1) > DetectedStageIndex)
                                                                                                        {
                                                                                                            var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                            if (Detectedrecord != null)
                                                                                                            {
                                                                                                                //DetectedIdStage_Third = Detectedrecord.IdStage;
                                                                                                                selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);
                                                                                                            }
                                                                                                        }
                                                                                                        //checkIdstage_Third = item.IdStage;
                                                                                                        selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);
                                                                                                        //if (checkIdstage_Third == DetectedIdStage_Third )
                                                                                                        if (selected_rework_ows.CheckStageId == selected_rework_ows.DetectedStageId)
                                                                                                        {
                                                                                                            sameCheck_Detect = true;
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            ReworkOWSList.Add(selected_rework_ows);
                                                                                                        }

                                                                                                    }

                                                                                                    #endregion

                                                                                                    if (item.Rework == true && sameCheck_Detect == false)
                                                                                                    {
                                                                                                        #region item.Rework == 1 and  if (DetectedIdStage_Second != item.IdStage)
                                                                                                        //if (DetectedIdStage_Second == item.IdStage)
                                                                                                        if (tempR_P_OWSMax_1_minus.DetectedStageId == item.IdStage)
                                                                                                        {
                                                                                                            TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                            string Rework_third = "Rework_" + item.IdStage;


                                                                                                        }
                                                                                                        #endregion
                                                                                                        else
                                                                                                        {
                                                                                                            #region Rework OWS
                                                                                                            //string ROWS_second = "ROWS_" + DetectedIdStage_Second;
                                                                                                            string ROWS_second = "ROWS_" + tempR_P_OWSMax_1_minus.DetectedStageId;
                                                                                                            TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                            #endregion

                                                                                                        }
                                                                                                    }
                                                                                                    #endregion
                                                                                                    else
                                                                                                    {

                                                                                                        #region if (DetectedIdStage_Second != item.IdStage)
                                                                                                        //if (DetectedIdStage_Second == item.IdStage)
                                                                                                        if (tempR_P_OWSMax_1.DetectedStageId == item.IdStage)
                                                                                                        {

                                                                                                            string Rework_third = "Rework_" + item.IdStage;
                                                                                                            TotalReworktime = TotalReworktime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));

                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                            #region  rework ows and production ows


                                                                                                            POWS_Second = "POWS_" + item.IdStage;
                                                                                                            //ROWS_Second = "ROWS_" + DetectedIdStage_Second;
                                                                                                            ROWS_Second = "ROWS_" + tempR_P_OWSMax_1.DetectedStageId;

                                                                                                            TotalReworkOwstime = TotalReworkOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                            TotalProductionOwstime = TotalProductionOwstime + TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));


                                                                                                            #endregion
                                                                                                        }

                                                                                                        #endregion
                                                                                                    }
                                                                                                    #endregion
                                                                                                }

                                                                                                #endregion
                                                                                                #endregion
                                                                                            }

                                                                                            #endregion
                                                                                        }
                                                                                        catch (Exception ex)
                                                                                        {
                                                                                            GeosApplication.Instance.Logger.Log(string.Format("Error in method FillDashboard() - {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                                                                        }
                                                                                    }
                                                                                    #endregion
                                                                                }
                                                                                #endregion
                                                                                else
                                                                                {
                                                                                    try
                                                                                    {

                                                                                        #region if (item.Rework == 1) Firstrework==true
                                                                                        if (item.Rework == true)
                                                                                        {
                                                                                            ERM_Timetracking_rework_ows selected_rework_ows = new ERM_Timetracking_rework_ows();
                                                                                            selected_rework_ows.OWS_ID = 1;
                                                                                            var DetectedStageIndex = reorderedResult1.IndexOf(item);
                                                                                            int lastindex = reorderedResult1.Count();
                                                                                            if (lastindex - 1 > DetectedStageIndex)
                                                                                            {
                                                                                                try
                                                                                                {
                                                                                                    var Detectedrecord = reorderedResult1[DetectedStageIndex + 1];
                                                                                                    if (Detectedrecord != null)
                                                                                                    {
                                                                                                        selected_rework_ows.DetectedStageId = Convert.ToInt32(Detectedrecord.IdStage);// detected rework stage

                                                                                                    }

                                                                                                }
                                                                                                catch (Exception ex)
                                                                                                {

                                                                                                }
                                                                                                //end

                                                                                                // reworkflag_First = true;
                                                                                                // checkIdstage_first = item.IdStage;
                                                                                                selected_rework_ows.CheckStageId = Convert.ToInt32(item.IdStage);
                                                                                                ReworkOWSList.Add(selected_rework_ows);
                                                                                                Production = "Production_" + item.IdStage;
                                                                                                Rework_First = "Rework_" + selected_rework_ows.DetectedStageId;
                                                                                                POWS_First = "POWS_" + selected_rework_ows.DetectedStageId;
                                                                                                ROWS_First = "ROWS_" + selected_rework_ows.DetectedStageId;
                                                                                                ProductionTime = TimeSpan.FromSeconds(Convert.ToDouble(item.CounterpartTimeDifference));
                                                                                                TotalProductiontime += ProductionTime;
                                                                                                //drr[Production] = ProductionTime;
                                                                                                if (DataTableForGridLayout.Columns.Contains(Production))  // [Rupali Sarode][GEOS2-4347][05-05-2023]
                                                                                                {
                                                                                                    if (!string.IsNullOrEmpty(Convert.ToString(item.CounterpartTimeDifference)) && Convert.ToString(item.CounterpartTimeDifference) != "0")
                                                                                                    {
                                                                                                        //if (ProductionTime != TimeSpan.Zero)//Aishwarya Ingale[Geos2-6069]
                                                                                                        //{
                                                                                                        TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                                        TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                                        DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                        TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                        if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                                        {
                                                                                                            drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                                        }
                                                                                                        if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                                        {
                                                                                                            drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                                        }
                                                                                                        //}
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                        //if (ProductionTime != TimeSpan.Zero)//Aishwarya Ingale[Geos2-6069]
                                                                                                        //{
                                                                                                        TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                                        TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                                        DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                        TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                                        if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                                        {
                                                                                                            drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                                        }
                                                                                                        if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                                        {
                                                                                                            drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                                        }
                                                                                                        //}
                                                                                                    }
                                                                                                }

                                                                                            }
                                                                                        }
                                                                                        #endregion
                                                                                        else
                                                                                        {
                                                                                            TimeSpan DownloadTime = TimeSpan.Zero;
                                                                                            TimeSpan TransferredTime = TimeSpan.Zero;

                                                                                            DownloadTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1920).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                            TransferredTime = TimeTrackingList.Where(x => x.ProductionActivityTimeType == 1921).Select(a => a.TimeTrackDifference).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);
                                                                                            if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(item.IdStage)))
                                                                                            {
                                                                                                drr["Download_" + Convert.ToString(item.IdStage)] = DownloadTime;
                                                                                            }
                                                                                            if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(item.IdStage)))
                                                                                            {
                                                                                                drr["Transferred_" + Convert.ToString(item.IdStage)] = TransferredTime;
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log(string.Format("Error in method AllCustomData() - {0}", ex.Message), category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                }

                                                                                DataTableForGridLayout.Rows.Add(drr);

                                                                            }
                                                                        }

                                                                    }

                                                                }
                                                                #endregion

                                                                double Temp_Break = 0;

                                                                foreach (var grbyBreak in sd.Where(b => b.TimeType != "Working").GroupBy(a => a.TimeType).ToList())
                                                                {
                                                                    double t_break = grbyBreak.Sum(b => b.TimeValue);
                                                                    Temp_Break = Temp_Break + t_break;
                                                                    TimeSpan time_break = TimeSpan.FromHours(Convert.ToDouble(t_break));

                                                                    #region [GEOS2-6914][pallavi jadhav][03 02 2025]
                                                                    int idlookup = sd.Where(b => b.TimeType != "Working" && b.TimeType == grbyBreak.Key).Select(b => b.IdlookupValue).FirstOrDefault();
                                                                    if (grbyBreak.Key == "Assign WO")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Designers Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Production Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Commercial Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Trainer")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else
                                                                    {
                                                                        if (grbyBreak.Key == "Planned Meeting" || grbyBreak.Key == "Unplanned Meeting")
                                                                        {
                                                                            dr1["Meeting"] = Convert.ToString(time_break);
                                                                        }
                                                                        else
                                                                        {
                                                                            dr1[grbyBreak.Key] = Convert.ToString(time_break);
                                                                        }
                                                                    }
                                                                    #endregion


                                                                    #region //[pallavi jadhav][13 01 2025][GEOS2-6716] 


                                                                    foreach (var item in grbyBreak)
                                                                    {
                                                                        if (item.IdlookupValue != null)
                                                                        {
                                                                            int TempDetail = Convert.ToInt32(item.IdlookupValue);

                                                                            if (ERMCommon.Instance.DetailsList_IDLookup != null)
                                                                            {
                                                                                if (ERMCommon.Instance.DetailsList_IDLookup.Contains(TempDetail))
                                                                                {
                                                                                    if (TempDetail != 1725)
                                                                                    {
                                                                                        if (item.Details != null)
                                                                                        {
                                                                                            string TempComment = Convert.ToString(item.Details);

                                                                                            // ✅ Concatenate if already exists
                                                                                            string existing = dr1["Details_" + TempDetail] != DBNull.Value
                                                                                                ? dr1["Details_" + TempDetail].ToString()
                                                                                                : string.Empty;

                                                                                            dr1["Details_" + TempDetail] = string.IsNullOrEmpty(existing)
                                                                                                ? TempComment
                                                                                                : existing + ", " + TempComment;
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        TimeSpan formatted = TimeSpan.FromHours(Convert.ToDouble(item.TimeValue));
                                                                                        string meetingtime = formatted.ToString(@"hh\:mm\:ss");
                                                                                        string TempComment = Convert.ToString(item.Details);


                                                                                        string existing = dr1["Details_" + 1725] != DBNull.Value
                                                                                            ? dr1["Details_" + 1725].ToString()
                                                                                            : string.Empty;

                                                                                        dr1["Details_" + 1725] = string.IsNullOrEmpty(existing)
                                                                                            ? item.TimeType + ":" + TempComment + "(" + meetingtime + ")"
                                                                                            : existing + ", " + item.TimeType + ":" + TempComment + "(" + meetingtime + ")";

                                                                                        // dr1["Details_" + 1725] = detailsofmeetings;
                                                                                    }
                                                                                }
                                                                                else if (ERMCommon.Instance.DetailsList_IDLookup.Contains(1725))
                                                                                {
                                                                                    if (TempDetail == 2273 || TempDetail == 2274 || TempDetail == 1725)
                                                                                    {

                                                                                        if (item.Details != null)
                                                                                        {

                                                                                            //  dr1["Details_" + 1725] = detailsofmeetings;
                                                                                            TimeSpan formatted = TimeSpan.FromHours(Convert.ToDouble(item.TimeValue));
                                                                                            string meetingtime = formatted.ToString(@"hh\:mm\:ss");
                                                                                            string TempComment = Convert.ToString(item.Details);
                                                                                            // timeofmeeting += TempComment; // append details

                                                                                            string existing = dr1["Details_" + 1725] != DBNull.Value
                                                                                                ? dr1["Details_" + 1725].ToString()
                                                                                                : string.Empty;

                                                                                            dr1["Details_" + 1725] = string.IsNullOrEmpty(existing)
                                                                                                ? item.TimeType + ":" + TempComment + "(" + meetingtime + ")"
                                                                                                : existing + ", " + item.TimeType + ":" + TempComment + "(" + meetingtime + ")";
                                                                                        }
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }


                                                                    // if (grbyBreak.FirstOrDefault().IdlookupValue != null)
                                                                    //{
                                                                    //    int TempDetail = Convert.ToInt32(grbyBreak.FirstOrDefault().IdlookupValue);
                                                                    //    if (ERMCommon.Instance.DetailsList_IDLookup != null)
                                                                    //    {
                                                                    //        if (ERMCommon.Instance.DetailsList_IDLookup.Contains(TempDetail))
                                                                    //        {
                                                                    //            if (grbyBreak.FirstOrDefault().Details != null)
                                                                    //            {
                                                                    //                string TempComment = Convert.ToString(grbyBreak.FirstOrDefault().Details);
                                                                    //                dr1["Details_" + TempDetail] = TempComment;

                                                                    //            }

                                                                    //        }
                                                                    //        else if(ERMCommon.Instance.DetailsList_IDLookup.Contains(1725))
                                                                    //        {
                                                                    //            if (TempDetail== 2273 || TempDetail==2274)
                                                                    //            {
                                                                    //                if (grbyBreak.FirstOrDefault().Details != null)
                                                                    //                {
                                                                    //                    string TempComment = Convert.ToString(grbyBreak.FirstOrDefault().Details);
                                                                    //                     timeofmeeting = timeofmeeting + Convert.ToString(grbyBreak.FirstOrDefault().Details);
                                                                    //                    dr1["Details_" + 1725] = timeofmeeting;

                                                                    //                }
                                                                    //            }
                                                                    //        }
                                                                    //    }
                                                                    //}
                                                                    #endregion

                                                                }


                                                                #region [GEOS2-6573][rani dhamankar][07-05-2025]

                                                                if (DataTableForGridLayout.Columns.Contains("Download_" + Convert.ToString(StageRecord.IdStage)))
                                                                {
                                                                    //[GEOS2-8124][rani dhamankar][16-05-2025]
                                                                    TimeSpan DownloadtotalTime = DataTableForGridLayout.AsEnumerable().Select(row => row.Field<TimeSpan?>("Download_" + Convert.ToString(StageRecord.IdStage)) ?? TimeSpan.Zero).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);

                                                                    if (DownloadtotalTime > TimeSpan.Zero)
                                                                    {
                                                                        dr1["Download"] = DownloadtotalTime;
                                                                    }
                                                                }

                                                                if (DataTableForGridLayout.Columns.Contains("Transferred_" + Convert.ToString(StageRecord.IdStage)))
                                                                {
                                                                    //[GEOS2-8124][rani dhamankar][16-05-2025]
                                                                    TimeSpan TransferredtotalTime = DataTableForGridLayout.AsEnumerable().Select(row => row.Field<TimeSpan?>("Transferred_" + Convert.ToString(StageRecord.IdStage)) ?? TimeSpan.Zero).Aggregate(TimeSpan.Zero, (sum, next) => sum + next);

                                                                    if (TransferredtotalTime > TimeSpan.Zero)
                                                                    {
                                                                        dr1["Transferred"] = TransferredtotalTime;
                                                                    }
                                                                }

                                                                dr1["SwitchToStage"] = employee.SwitchToStage != null ? employee.SwitchToStage.ToString() : "";
                                                                #endregion
                                                                dr1["DateHTMLColor"] = HtmlColor;


                                                                dr1["Plant"] = Convert.ToString(plantdata.Key);
                                                                dr1["Week"] = Convert.ToString(Week);
                                                                dr1["Date"] = Convert.ToString(itemDate.Key.Date);
                                                                dr1["Employee"] = Convert.ToString(employee.EmployeeName);
                                                                dr1["Stage"] = Convert.ToString(sd.Key);
                                                                dr1["Total_Shift"] = Convert.ToString(TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds)));
                                                                //dr1["Total_Logged"] = Convert.ToString(TotalLoggedTime.Add(-TimeSpan.FromMilliseconds(TotalLoggedTime.Milliseconds)));
                                                                TimeSpan T_loggedTime = TimeSpan.FromHours(Convert.ToDouble(Temp_Break + TotolWorkingTime));
                                                                dr1["Total_Logged"] = Convert.ToString(T_loggedTime.Add(-TimeSpan.FromMilliseconds(T_loggedTime.Milliseconds)));

                                                                if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false)
                                                                {

                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr1);
                                                                }
                                                            }
                                                        }
                                                        #region [GEOS2-7641][gulab lakade][27 03 2025] 
                                                        else
                                                        {
                                                            bool exists = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && employee.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == employee.AttendanceStartDate.Value.Date && a.IdEmployee == employee.IdEmployee);

                                                            if (!exists)
                                                            {
                                                                DataRow dr1 = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();

                                                                if (TempPlantId.Count() == 0)
                                                                {
                                                                    dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave);
                                                                }
                                                                else
                                                                {
                                                                    double Total1 = TotalAttendanceWithoutLeave;
                                                                    TimeSpan TimespanTotalAttendance = TimeSpan.FromHours(Convert.ToDouble(Total1));
                                                                    dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendance);
                                                                }
                                                                dr1["DateHTMLColor"] = HtmlColor;
                                                                dr1["Plant"] = Convert.ToString(plantdata.Key);
                                                                dr1["Week"] = Convert.ToString(Week);
                                                                dr1["Date"] = Convert.ToString(itemDate.Key.Date);
                                                                dr1["Employee"] = Convert.ToString(employee.EmployeeName);
                                                                dr1["Stage"] = Convert.ToString(stagedata.Key);
                                                                dr1["Total_Shift"] = Convert.ToString(TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds)));
                                                                if (employee.LeavesAllDayEvent == 1 && employee.ISHolidayEvent == false)
                                                                {

                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr1);
                                                                }


                                                            }
                                                        }
                                                        #endregion
                                                        #endregion
                                                        //ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr);
                                                        #endregion
                                                        #region RND
                                                        Grid GaugeControlGrid = new Grid();
                                                        GaugeControlGrid.ShowGridLines = false;
                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                        {
                                                            //linearGauge.Margin = new Thickness(-12, 32, -50, 0);
                                                            //linearGauge_night.Margin = new Thickness(-55, 32, -15, 0);
                                                            linearGauge.Margin = new Thickness(20, 32, -45, 0);
                                                            linearGauge_night.Margin = new Thickness(-35, 32, -40, 0);
                                                            int HoursByTotalHours_night = 0;
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                var c = new ColumnDefinition();
                                                                c.Width = new GridLength(1370, GridUnitType.Pixel);
                                                                GaugeControlGrid.ColumnDefinitions.Add(c);
                                                            }
                                                            else
                                                            {
                                                                #endregion
                                                                HoursByTotalHours_night = (int)(1370 / TotalHours_Night);
                                                                int Column_0 = (int)(HoursByTotalHours_night * TotalHours_24);
                                                                int Column_1 = (int)(HoursByTotalHours_night * TotalHours_0);
                                                                int widthValue = 1370 - (Column_0 + Column_1);
                                                                Column_1 = Column_1 + widthValue;
                                                                //if (Column_0 > Column_1)
                                                                //{
                                                                //    Column_0 = Column_0;
                                                                //}
                                                                //else
                                                                //    if (Column_0 < Column_1)
                                                                //{
                                                                //    Column_1 = Column_1;
                                                                //}
                                                                //int NightLinearWidth = (int)(1370 / TotalHours_0);
                                                                #region ColumnDefinition
                                                                for (var empcolumn = 0; empcolumn < 2; empcolumn++)
                                                                {
                                                                    var c = new ColumnDefinition();
                                                                    if (empcolumn == 0)
                                                                    {
                                                                        c.Width = new GridLength(Column_0, GridUnitType.Pixel);
                                                                    }
                                                                    else if (empcolumn == 1)
                                                                    {
                                                                        c.Width = new GridLength(Column_1, GridUnitType.Pixel);//GridLength.Auto;

                                                                    }

                                                                    GaugeControlGrid.ColumnDefinitions.Add(c);
                                                                }

                                                                #endregion
                                                            }//[GEOS2-7755][gulab lakade][08 04 2025]
                                                        }
                                                        else
                                                        {
                                                            #region ColumnDefinition
                                                            linearGauge.Margin = new Thickness(-12, 32, -50, 0);
                                                            linearGauge_night.Margin = new Thickness(-50, 32, -15, 0);
                                                            for (var empcolumn = 0; empcolumn < 1; empcolumn++)
                                                            {
                                                                var c = new ColumnDefinition();
                                                                if (empcolumn == 0)
                                                                {
                                                                    c.Width = new GridLength(1370, GridUnitType.Pixel);
                                                                }
                                                                GaugeControlGrid.ColumnDefinitions.Add(c);
                                                            }

                                                            #endregion
                                                        }

                                                        #endregion
                                                        //Stagegrid column creation

                                                        //Plantgrid row creation
                                                        #region RowDefinition 
                                                        for (var emprow = 0; emprow < 1; emprow++)
                                                        {
                                                            var r = new RowDefinition();
                                                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                            GaugeControlGrid.RowDefinitions.Add(r);
                                                        }
                                                        //var first = linearnightScale.ShowMajorTickmarks.CompareTo(0);
                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        if (employee.IsNightShift == 1 || ((employee.AttendanceStartDate != null && employee.AttendanceEndDate != null) && employee.AttendanceStartDate.Value.Date < employee.AttendanceEndDate.Value.Date))
                                                        {

                                                            //Grid.SetRow(linearGauge, 0);
                                                            //Grid.SetColumn(linearGauge, 0);
                                                            //Grid.SetRow(linearGauge_night, 0);
                                                            //Grid.SetColumn(linearGauge_night, 1);
                                                            //GaugeControlGrid.Children.Add(linearGauge);
                                                            //GaugeControlGrid.Children.Add(linearGauge_night);
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (employee.IsNightShift == 1 && shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                Grid.SetRow(linearGauge, 0);
                                                                Grid.SetColumn(linearGauge, 0);
                                                                GaugeControlGrid.Children.Add(linearGauge);
                                                            }
                                                            else
                                                            {
                                                                Grid.SetRow(linearGauge, 0);
                                                                Grid.SetColumn(linearGauge, 0);
                                                                Grid.SetRow(linearGauge_night, 0);
                                                                Grid.SetColumn(linearGauge_night, 1);
                                                                GaugeControlGrid.Children.Add(linearGauge);
                                                                GaugeControlGrid.Children.Add(linearGauge_night);
                                                            }
                                                            #endregion
                                                        }
                                                        else
                                                        {
                                                            Grid.SetRow(linearGauge, 0);
                                                            Grid.SetColumn(linearGauge, 0);
                                                            //Grid.SetRow(linearGauge_night, 0);
                                                            //Grid.SetColumn(linearGauge_night, 1);
                                                            GaugeControlGrid.Children.Add(linearGauge);
                                                            //GaugeControlGrid.Children.Add(linearGauge_night);
                                                        }
                                                        #endregion

                                                        #endregion

                                                        #endregion

                                                        #endregion

                                                        Grid.SetRow(ImageGrid, empcount);
                                                        Grid.SetColumn(ImageGrid, 0);

                                                        //Grid.SetRow(empEndTime, empcount);
                                                        //Grid.SetColumn(empEndTime, 2);

                                                        //Grid.SetRow(linearGauge, empcount);
                                                        //Grid.SetColumn(linearGauge, 2);
                                                        Grid.SetRow(GaugeControlGrid, empcount);
                                                        Grid.SetColumn(GaugeControlGrid, 2);
                                                        //EmpGrid.Children.Add(empName);
                                                        EmpGrid.Children.Add(ImageGrid);
                                                        //EmpGrid.Children.Add(empEndTime);
                                                        // EmpGrid.Children.Add(linearGauge);
                                                        EmpGrid.Children.Add(GaugeControlGrid);
                                                        #region aiwhariya Total 
                                                        Grid.SetRow(TotalGrid, empcount);
                                                        Grid.SetColumn(TotalGrid, 3);
                                                        EmpGrid.Children.Add(TotalGrid);
                                                        Grid.SetRow(TitleGrid, empcount);
                                                        Grid.SetColumn(TitleGrid, 1);
                                                        EmpGrid.Children.Add(TitleGrid);
                                                        #endregion

                                                        ERM_ProductionTimelineExistingEmP.Add(employee);
                                                        empcount++;
                                                    }

                                                }//[GEOS2-7641][gulab lakade][27 03 2025]

                                            }

                                            #endregion

                                            if (empcount > 0)//[GEOS2-7641][gulab lakade][27 03 2025]
                                            {
                                                Grid.SetRow(StageName, 0);
                                                Grid.SetColumn(StageName, 0);
                                                Border border = new Border()
                                                {
                                                    BorderThickness = new Thickness()
                                                    {
                                                        Bottom = 1,
                                                        Left = 1,
                                                        Right = 1,
                                                        Top = 1
                                                    },
                                                    //BorderBrush = new SolidColorBrush(Colors.Black) //[GEOS2-5129]
                                                };
                                                //Start [GEOS2-5129]
                                                if (ApplicationThemeHelper.ApplicationThemeName.ToString() == "BlackAndBlue")
                                                {
                                                    border.BorderBrush = new SolidColorBrush(Colors.White);
                                                }
                                                else
                                                {
                                                    border.BorderBrush = new SolidColorBrush(Colors.Black);
                                                }
                                                // end [GEOS2-5129]
                                                //var border = new Border();
                                                Grid.SetRow(border, 1);
                                                Grid.SetColumn(border, 0);
                                                Grid.SetRow(EmpGrid, 3);
                                                Grid.SetColumn(EmpGrid, 0);

                                                stageTempGrid.Children.Add(StageName);
                                                stageTempGrid.Children.Add(border);
                                                stageTempGrid.Children.Add(EmpGrid);

                                                Grid.SetRow(stageTempGrid, StageRow);
                                                Grid.SetColumn(stageTempGrid, 0);

                                                StageGrid.Children.Add(stageTempGrid);
                                                StageRow++;
                                            }//[GEOS2-7641][gulab lakade][27 03 2025]
                                        }



                                        #endregion
                                        if (StageRow > 0)//[GEOS2-7641][gulab lakade][27 03 2025]
                                        {
                                            Grid.SetRow(PlantName, 0);
                                            Grid.SetColumn(PlantName, 0);
                                            Grid.SetRow(DateLabel, 0);
                                            Grid.SetColumn(DateLabel, 1);
                                            Grid.SetRow(TooltipImage, 0);
                                            Grid.SetColumn(TooltipImage, 2);
                                            Grid.SetRow(StageGrid, 1);
                                            //Grid.SetColumn(StageGrid, 0);
                                            Grid.SetColumnSpan(StageGrid, 4);
                                            PlantTempGrid.Children.Add(PlantName);
                                            PlantTempGrid.Children.Add(DateLabel);
                                            PlantTempGrid.Children.Add(TooltipImage);
                                            PlantTempGrid.Children.Add(StageGrid);

                                            Grid.SetRow(PlantTempGrid, DateRow);
                                            Grid.SetColumn(PlantTempGrid, 0);
                                            DateGrid.Children.Add(PlantTempGrid);



                                            #endregion
                                            DateRow++;
                                        }//[GEOS2-7641][gulab lakade][27 03 2025]
                                    }
                                }
                            }
                            Grid.SetRow(DateGrid, Plantrow);
                            Grid.SetColumn(DateGrid, 0);
                            PlantGrid.Children.Add(DateGrid);
                            #endregion
                            Plantrow++;
                        }

                        Grid.SetRow(PlantGrid, 1);
                        Grid.SetColumn(PlantGrid, 0);
                        MainGrid.Children.Add(PlantGrid);

                        #endregion


                    }

                    #endregion
                }







                if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }
                GeosApplication.Instance.Logger.Log("Method AllCustomData() executed successfully", category: Category.Info, priority: Priority.Low);
            }

            catch (Exception ex)
            {
                if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }
                GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
            }


            if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }

        }
        public async void AllCustomDataNew_GEOS2_9220(Grid MainGrid, List<int> TempPlantId, DateTime StartDates, DateTime EndDates)
        {
            try
            {
                
                GeosApplication.Instance.Logger.Log("Method AllCustomData ...", category: Category.Info, priority: Priority.Low);
                if (!DXSplashScreen.IsActive) { DXSplashScreen.Show<SplashScreenView>(); }
                GeosApplication.Instance.SplashScreenMessage = "Employee Data is loading ..";
                CheckempgridCount = false;
                EMPGridCount = 0;
                List<int> MeetingtypeId = new List<int>(ERMCommon.Instance.MeetingsList.Keys);//[GEOS2-9197][pallavi jadhav][2025-09-02]
                List<int> MaintenanceId = new List<int>(ERMCommon.Instance.MaintenanceList.Keys);//[GEOS2-9197][pallavi jadhav][2025-09-02]
                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();//[gulab lakade][tool tips ][24 01 2024]
                Grid tempgrid = new Grid();
                #region [GEOS2-5040][gulab lakade][22 12 2023]
                ERMCommon.Instance.ProductionTimelineSprint = new System.Collections.ObjectModel.ObservableCollection<ERMProductionTimelineSprint>();
                ERMCommon.Instance.DataTableForProductionTimeLine = new DataTable();

                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Plant", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Week", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Date", typeof(DateTime));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Employee", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Stage", typeof(string));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Shift", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Logged", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Total_Attendance", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("WOTime", typeof(TimeSpan));
                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("DateHTMLColor", typeof(string));

                //ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Maintance11", typeof(string));
                //ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Meeting11", typeof(string));
                foreach (var item in ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Distinct())
                {
                    try
                    {
                        if (item.Name != "Working" && !ERMCommon.Instance.MeetingsList.Values.Contains(item.Name) && !ERMCommon.Instance.MaintenanceList.Values.Contains(item.Name) )//[GEOS2-9197][pallavi jadhav][2025-09-02] //[GEOS2-9419][pallavi jadhav][2025-10-30]
                        {

                            ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add(item.Name, typeof(TimeSpan));
                            #region //[pallavi jadhav][13 01 2025][GEOS2-6716] 
                            if (ERMCommon.Instance.DetailsList_IDLookup != null)
                            {
                                if (ERMCommon.Instance.DetailsList_IDLookup.Contains(item.IdLookupValue))
                                {
                                    #region [GEOS2-6573][rani dhamankar][07-05-2025]
                                    if (item.IdLookupValue == 1813)
                                    {
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Details_" + item.IdLookupValue, typeof(string));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("SwitchToStage", typeof(string));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Download", typeof(TimeSpan));
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Transferred", typeof(TimeSpan));
                                    }
                                    else
                                    {
                                        ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add("Details_" + item.IdLookupValue, typeof(string)); //[pallavi jadhav][13 01 2025][GEOS2-6716] 
                                    }
                                    #endregion
                                }
                            }
                            #endregion
                        }
                    }
                    catch (Exception ex)
                    {
                        GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
                    }

                }

                //Aishwarya Ingale[Geos2-5883]
                foreach (var item1 in ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Distinct())
                {
                    try
                    {
                        if (item1.Name != "Working")
                        {
                            string uniqueColumnName = item1.Name + "_" + item1.IdLookupValue;
                            if (!ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Contains(uniqueColumnName))
                            {
                                ERMCommon.Instance.DataTableForProductionTimeLine.Columns.Add(uniqueColumnName, typeof(TimeSpan));
                            }
                        }
                    }
                    catch (Exception ex)
                    {
                        GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
                    }
                }
                #endregion

                System.Windows.Controls.StackPanel EMPMainGrid = new System.Windows.Controls.StackPanel();
                if (MainGrid != null)
                {

                    EMPMainGrid = (System.Windows.Controls.StackPanel)MainGrid.Parent;
                    //MainGrid = new Grid();
                }
                #region [GEOS2-9220][gulab lakade][12 08 2025]
                List<int> EmployeeIds = ERMCommon.Instance.SelectedEmployee.OfType<ERM_EmployeeDetails>().Select(i => i.IdEmployee).Distinct().ToList();
                List<ERM_EmployeeDetails> ERM_EmployeeDetails = new List<ERM_EmployeeDetails>();
                ERM_EmployeeDetails = ERMCommon.Instance.ERM_EmployeeDetails.Where(a => EmployeeIds.Contains(a.IdEmployee)).ToList();
                List<Int32> EMP_IdOperator = ERM_EmployeeDetails.GroupBy(a => a.IdUser).Select(g => g.Key).ToList();
                List<ERM_Employee_Attendance> ERM_Employee_Attendance = new List<ERM_Employee_Attendance>();
                ERM_Employee_Attendance = ERMCommon.Instance.ERM_Employee_Attendance.Where(a => EmployeeIds.Contains(a.IdEmployee)).ToList();
                List<ERM_Employee_Attendance> ERM_Employee_MAX_Attendance = new List<ERM_Employee_Attendance>();
                ERM_Employee_MAX_Attendance = ERMCommon.Instance.ERM_Employee_MAX_Attendance.Where(a => EmployeeIds.Contains(a.IdEmployee)).ToList();
                List<ERMEmployeeLeave> ERMEmployeeLeave = new List<ERMEmployeeLeave>();
                ERMEmployeeLeave = ERMCommon.Instance.ERMEmployeeLeave.Where(a => EmployeeIds.Contains(a.IdEmployee)).ToList();
                List<Counterpartstracking> ERM_Counterpartstracking = new List<Counterpartstracking>();
                ERM_Counterpartstracking = ERMCommon.Instance.ERM_Counterpartstracking.Where(a => EMP_IdOperator.Contains(a.IdOperator)).ToList();
                List<ERM_NO_OT_Time> ERM_NO_OT_Time = new List<ERM_NO_OT_Time>();
                ERM_NO_OT_Time = ERMCommon.Instance.ERM_NO_OT_Time.Where(a => EMP_IdOperator.Contains(a.IdOperator)).ToList();
                List<ERMCompanyHoliday> ERMCompanyHoliday = new List<ERMCompanyHoliday>();
                ERMCompanyHoliday = ERMCommon.Instance.ERMCompanyHoliday.Where(a => a.StartDate.Value.Date >= StartDates.Date && a.StartDate.Value.Date <= EndDates.Date).ToList();

                #region OT_Working_Time [GEOS2-9393][pallavi jadhav][12 11 2025]
                List<ERM_OT_Working_Times> ERM_OT_Working_Time = new List<ERM_OT_Working_Times>();
                ERM_OT_Working_Time = ERMCommon.Instance.ERM_OT_Working_Times.Where(a => EMP_IdOperator.Contains(a.IdOperator)).ToList();
                #endregion

                #region [GEOS2-7091][rani dhamankar] [11-09-2025]
                //List<DesignSharedItemsEmployeeDetails> DesignSharedItemsEmployeeDetails = new List<DesignSharedItemsEmployeeDetails>();
                //DesignSharedItemsEmployeeDetails = ERMCommon.Instance.DesignSharedItemsEmployeeDetails.ToList();
                //List<Counterpartstracking> ERM_SharedOtCounterpartstracking = new List<Counterpartstracking>();
                //ERM_SharedOtCounterpartstracking = ERMCommon.Instance.ERM_SharedOtCounterpartstracking.ToList();
                #endregion

                //if (ProductionTimeList == null)
                //{
                //    ProductionTimeList = new List<ERM_ProductionTimeline>();
                //}
                //Main_ProductionTimeList.ERM_EmployeeDetails
                #endregion
                #region RND
                if (MainGrid.Children.Count > 0)
                {
                    MainGrid.Children.RemoveAt(0);
                    MainGrid.Children.Clear();
                }

                string tempname = MainGrid.Name;

                #region ColumnDefinition
                for (var a = 0; a < 1; a++)
                {
                    var c = new ColumnDefinition();
                    c.Width = GridLength.Auto;
                    //c.Width = new GridLength(400, GridUnitType.Pixel);
                    MainGrid.ColumnDefinitions.Add(c);
                }

                #endregion
                //maingrid row creation
                #region RowDefinition 
                for (var mainrow = 0; mainrow < 1; mainrow++)
                {
                    var r = new RowDefinition();
                    r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                    //r.Height =new GridLength(400, GridUnitType.Pixel);
                    MainGrid.RowDefinitions.Add(r);
                }


                //MainGrid
                #endregion
                Grid PlantGrid = new Grid();
                PlantGrid.HorizontalAlignment = HorizontalAlignment.Stretch;
                PlantGrid.VerticalAlignment = VerticalAlignment.Stretch;

                //if (ProductionTimeList.Count > 0)
                if (ERM_EmployeeDetails.Count > 0)
                {
                    #region MainRowData 
                    //for (var maindata = 0; maindata < 1; maindata++)
                    //{
                    // plant  binding
                    //var PlantList = ProductionTimeList.GroupBy(a => a.SiteName).ToList();
                    var PlantList = ERM_EmployeeDetails.GroupBy(a => a.SiteName).ToList();

                    if (PlantList.Count > 0)
                    {
                        int plantCount = PlantList.Count();
                        PlantGrid.ShowGridLines = false;
                        //Plantgrid column creation
                        #region ColumnDefinition
                        for (var plantcolum = 0; plantcolum < 1; plantcolum++)
                        {
                            var c = new ColumnDefinition();
                            c.Width = GridLength.Auto;
                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                            PlantGrid.ColumnDefinitions.Add(c);
                        }

                        #endregion
                        //Plantgrid row creation
                        #region RowDefinition 
                        for (var plantrow = 0; plantrow < plantCount; plantrow++)
                        {
                            var r = new RowDefinition();
                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                            PlantGrid.RowDefinitions.Add(r);
                        }

                        #endregion
                        #region plantRowData 
                        //for (var plantdata = 0; plantdata < 4; plantdata++)
                        int Plantrow = 0;
                        foreach (var plantdata in PlantList)
                        {

                            #region Dates
                            Grid DateGrid = new Grid();
                            DateGrid.ShowGridLines = false;
                            #region //[GEOS2-9220][gulab lakade][12 08 2025]

                            List<DateTime> DateList = new List<DateTime>();
                            if (ERMCommon.Instance.ProductionTimelineWeek.Count > 0)
                            {
                                List<ProductionTimelineAccordian> DateWeek = new List<ProductionTimelineAccordian>();
                                if (ERMCommon.Instance.SelectedproductionTimeline != null && ERMCommon.Instance.SelectedproductionTimeline != "All")
                                {
                                    if (ERMCommon.Instance.SelectedproductionTimeline.Contains("CW") == true)
                                    {
                                        DateWeek = ERMCommon.Instance.ProductionTimelineWeek.Where(a => a.logWeek == ERMCommon.Instance.SelectedproductionTimeline).ToList();
                                    }
                                    else
                                    {
                                        DateWeek = ERMCommon.Instance.ProductionTimelineWeek.Where(a => a.LogDate.Contains(ERMCommon.Instance.SelectedproductionTimeline)).ToList();
                                    }
                                }
                                else
                                {
                                    DateWeek = ERMCommon.Instance.ProductionTimelineWeek.ToList();
                                }
                                foreach (var item in DateWeek)
                                {
                                    if (item.LogDate.Count() > 0)
                                    {
                                        if (ERMCommon.Instance.SelectedproductionTimeline != null && ERMCommon.Instance.SelectedproductionTimeline != "All" && !ERMCommon.Instance.SelectedproductionTimeline.Contains("CW") == true)
                                        {
                                            foreach (var item1 in item.LogDate.Where(a => a == ERMCommon.Instance.SelectedproductionTimeline).ToList())
                                            {
                                                DateList.Add(Convert.ToDateTime(item1));
                                            }
                                        }
                                        else
                                        {
                                            foreach (var item1 in item.LogDate)
                                            {
                                                DateList.Add(Convert.ToDateTime(item1));
                                            }
                                        }

                                    }
                                }
                            }
                            // var DateList = ERMCommon.Instance.ProductionTimelineWeek.Select(a => Convert.ToDateTime(a.LogDate)).ToList();
                            #endregion
                            //Plantgrid column creation
                            #region ColumnDefinition
                            for (var Datescolumn = 0; Datescolumn < 1; Datescolumn++)
                            {
                                var c = new ColumnDefinition();
                                c.Width = GridLength.Auto;
                                //c.Width = new GridLength(50, GridUnitType.Pixel);
                                DateGrid.ColumnDefinitions.Add(c);
                            }

                            #endregion
                            //Plantgrid row creation
                            #region RowDefinition 
                            for (var Daterow = 0; Daterow < DateList.Count; Daterow++)
                            {
                                var r = new RowDefinition();
                                r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                DateGrid.RowDefinitions.Add(r);
                            }

                            #endregion
                            //  DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();
                            //   DataRow drs = ERMCommon.Instance.DataTableForProductionTimeLineGrid.NewRow();
                            if (DateList.Count > 0)
                            {
                                //var FilterData = DateList.Where(a => a.Key.Date >= StartDates.Date && a.Key.Date <= EndDates.Date).ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                var FilterData = DateList.Where(a => a >= StartDates.Date && a <= EndDates.Date).OrderByDescending(a => a).ToList();//[GEOS2-9220][gulab lakade][12 08 2025]
                                int DateRow = 0;
                                if (FilterData.Any())
                                {
                                    foreach (var itemDate in FilterData)
                                    {
                                        // DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();
                                        var index = DateList.IndexOf(itemDate);//[GEOS2-5235][pallavi jadhav]
                                        DateTime? NotNullShiftDate = DateTime.Now;//[GEOS2-5235][pallavi jadhav]
                                        Label PlantName = new Label();

                                        //[GEOS2-9220][gulab lakade][12 08 2025]
                                        DateTime? shiftStartDate = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                        DateTime? shiftEndDate = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                        DateTime? Shift_ST_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                        DateTime? Shift_ED_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                        DateTime? OrignalShift_ED_Date = new DateTime();//[GEOS2-8864[gulab lakade][30 07 2025]
                                        DateTime? OrignalShift_SD_Date = new DateTime();//[GEOS2-8864][gulab lakade][30 07 2025]
                                        //[GEOS2-5235][pallavi jadhav]
                                        // DateTime StartDate = Convert.ToDateTime(itemDate.Key.Date);//[GEOS2-5883][gulab lakade][274 06 2024]
                                        PlantName.Content = "Plant: " + Convert.ToString(plantdata.Key) + "        " + "Date: ";// + StartDate.Date.ToString("dd/MM/yyyy");
                                        PlantName.FontWeight = FontWeights.Bold;
                                        //PlantName.Width = 100;
                                        #region [GEOS2-5233][gulab lakade][16 01 2024]
                                        Label DateLabel = new Label();
                                        //DateLabel.Content = itemDate.Key.Date.ToString("dd/MM/yyyy");// StartDate.Date.ToString("dd/MM/yyyy");[GEOS2-5883][gulab lakade][274 06 2024]
                                        DateLabel.Content = itemDate.Date.ToString("dd/MM/yyyy");
                                        DateLabel.FontWeight = FontWeights.Bold;
                                        //DateLabel.Width = 100;
                                        ToolTip HolidayTooltips = new ToolTip();
                                        //var TempHolidayRecord = ProductionTimeList.Where(x => x.AttendanceStartDate.Value.Date == StartDate.Date).FirstOrDefault();
                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                        //var TempHolidayRecord = ProductionTimeList.Where(x => x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == StartDate.Date : x.AttendanceStartDate.Value.Date == StartDate.Date).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                        //var TempHolidayRecord = itemDate.Where(x => x.AttendanceStartDate == null ? x.CounterpartStartDate.Value.Date == itemDate.Key.Date : x.AttendanceStartDate.Value.Date == itemDate.Key.Date).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]

                                        //[rani dhamankar] [12 - 03 - 2025][GEOS2 - 6965]
                                        #region //[GEOS2-9220][gulab lakade][12 08 2025]
                                        var TempHolidayRecord = ERMCompanyHoliday.Where(x => x.StartDate.Value.Date == itemDate.Date).FirstOrDefault();
                                        #endregion
                                        #endregion
                                        string HolidayType = string.Empty;
                                        string Holidayname = string.Empty;
                                        string HtmlColor = string.Empty;
                                        Image TooltipImage = new Image();
                                        TooltipImage.Visibility = Visibility.Hidden;


                                        if (TempHolidayRecord != null)
                                        {
                                            if (!string.IsNullOrWhiteSpace(TempHolidayRecord.HolidayType))
                                            {
                                                HolidayType = Convert.ToString(TempHolidayRecord.HolidayType);
                                            }
                                            if (!string.IsNullOrWhiteSpace(TempHolidayRecord.Name))
                                            {
                                                Holidayname = Convert.ToString(TempHolidayRecord.Name);
                                            }

                                        }
                                        string DayName = itemDate.Date.ToString("dddd", new CultureInfo("en-US"));//GEOS2-5883][gulab lakade][274 06 2024]
                                        string ToolTipContent = string.Empty;
                                        if ((DayName == "Saturday" || DayName == "Sunday") && (!string.IsNullOrWhiteSpace(Holidayname)))
                                        {
                                            TimeSpan holidayStarttime = TempHolidayRecord.StartDate.Value.TimeOfDay;
                                            string holidayStarttimeInString = holidayStarttime.ToString("hh\\:mm");
                                            TimeSpan holidayEndtime = TempHolidayRecord.EndDate.Value.TimeOfDay;
                                            string holidayEndtimeInString = holidayEndtime.ToString("hh\\:mm");
                                            if (TempHolidayRecord.IsAllDayEvent == 1)
                                            {
                                                ToolTipContent = "\r" + DayName + "\r\n" + Holidayname + "\r\n" + HolidayType;
                                            }
                                            else
                                            {
                                                ToolTipContent = "\r" + DayName + "\r\n" + Holidayname + " (" + holidayStarttimeInString + "-" + holidayEndtimeInString + ")\r\n" + HolidayType;
                                            }

                                            DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                            //  dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                            HtmlColor = Convert.ToString("#FF0000");
                                            TooltipImage.Visibility = Visibility.Visible;
                                        }
                                        else if ((DayName == "Saturday" || DayName == "Sunday") && string.IsNullOrWhiteSpace(Holidayname))
                                        {
                                            ToolTipContent = DayName;
                                            DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#808080"));
                                            // dr["DateHTMLColor"] = Convert.ToString("#808080");
                                            HtmlColor = Convert.ToString("#808080");
                                            TooltipImage.Visibility = Visibility.Visible;
                                        }
                                        else
                                            if ((!string.IsNullOrWhiteSpace(Holidayname)))
                                        {
                                            if (TempHolidayRecord.IsAllDayEvent == 1)
                                            {
                                                ToolTipContent = "\r" + Holidayname + "\r\n " + HolidayType;
                                                DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                                //  dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                                HtmlColor = Convert.ToString("#FF0000");
                                                TooltipImage.Visibility = Visibility.Visible;
                                            }
                                            else
                                            {
                                                TimeSpan holidayStarttime = TempHolidayRecord.StartDate.Value.TimeOfDay;
                                                string holidayStarttimeInString = holidayStarttime.ToString("hh\\:mm");
                                                TimeSpan holidayEndtime = TempHolidayRecord.EndDate.Value.TimeOfDay;
                                                string holidayEndtimeInString = holidayEndtime.ToString("hh\\:mm");
                                                ToolTipContent = "\r" + Holidayname + " (" + holidayStarttimeInString + "-" + holidayEndtimeInString + ")\r\n" + HolidayType;
                                                DateLabel.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FF0000"));
                                                // dr["DateHTMLColor"] = Convert.ToString("#FF0000");
                                                HtmlColor = Convert.ToString("#FF0000");
                                                TooltipImage.Visibility = Visibility.Visible;
                                            }

                                        }
                                        try
                                        {
                                            BitmapImage bitmapTooltip = new BitmapImage(new Uri(@"/Emdep.Geos.Modules.ERM;component/Assets/Images/INFO1.png", UriKind.Relative));

                                            TooltipImage.Source = bitmapTooltip;

                                            TooltipImage.Width = 20;
                                            TooltipImage.Height = 20;
                                            TooltipImage.ToolTip = ToolTipContent;
                                            //TooltipImage.ToolTip = "";
                                        }
                                        catch (Exception ex)
                                        {

                                        }


                                        #endregion
                                        #region StageGrid


                                        //if (plantdata == 0)
                                        //{



                                        Grid PlantTempGrid = new Grid();
                                        PlantTempGrid.ShowGridLines = false;

                                        //Stagegrid column creation
                                        #region ColumnDefinition
                                        for (var Stage1column = 0; Stage1column < 4; Stage1column++)
                                        {
                                            var c = new ColumnDefinition();
                                            if (Stage1column == 0)
                                            {
                                                c.Width = GridLength.Auto;
                                            }
                                            else if (Stage1column == 1)
                                            {
                                                c.Width = GridLength.Auto;
                                            }
                                            else if (Stage1column == 2)
                                            {
                                                c.Width = new GridLength(30, GridUnitType.Pixel);
                                            }
                                            else if (Stage1column == 3)
                                            {
                                                c.Width = new GridLength(1180, GridUnitType.Pixel);
                                            }

                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                            PlantTempGrid.ColumnDefinitions.Add(c);
                                        }

                                        #endregion
                                        //Plantgrid row creation
                                        #region RowDefinition 
                                        for (var Stage1row = 0; Stage1row < 2; Stage1row++)
                                        {
                                            var r = new RowDefinition();
                                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);

                                            PlantTempGrid.RowDefinitions.Add(r);
                                        }

                                        #endregion

                                        #region stage4

                                        Grid StageGrid = new Grid();
                                        StageGrid.ShowGridLines = false;

                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                        #region [GEOS2-9220][gulab lakade][12 08 2025]
                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                        //var IdJobdescriptionList = itemDate
                                        // .Where(x => x.SiteName == plantdata.Key
                                        //             && x.IsMainJobDescription == 1
                                        //             && (
                                        //                 (x.AttendanceStartDate == null && x.CounterpartStartDate.HasValue && x.CounterpartStartDate.Value.Date == itemDate.Key.Date)
                                        //                 || (x.AttendanceStartDate.HasValue && x.AttendanceStartDate.Value.Date == itemDate.Key.Date)
                                        //                 || (x.AttendanceStartDate == null && x.CounterpartStartDate == null && x.LeaveStartDate.HasValue && x.LeaveStartDate.Value.Date == itemDate.Key.Date)
                                        //             )
                                        //         )
                                        // .GroupBy(a => a.IdJobDescription)
                                        // .ToList();//[GEOS2-6965][rani dhamankar][12-03-2025]
                                        var IdJobdescriptionList = ERM_EmployeeDetails.GroupBy(a => a.IdJobDescription).ToList();
                                        #endregion
                                        List<PlanningDateReviewStages> TempStageList = new List<PlanningDateReviewStages>();
                                        if (IdJobdescriptionList != null && IdJobdescriptionList.Count() > 0)
                                        {
                                            foreach (var item in ERMCommon.Instance.WorkStageWiseJobDescription)
                                            {
                                                List<Int32> IdJobdescription = new List<int>();
                                                IdJobdescription = item.IdJobDescription.Select(int.Parse).ToList();
                                                var FindStage = IdJobdescriptionList.Where(x => IdJobdescription.Contains(x.Key)).ToList();
                                                if (FindStage.Count() > 0)
                                                {
                                                    var temp = ERMCommon.Instance.StageList.Where(x => x.IdStage == item.IdWorkStage).FirstOrDefault();
                                                    TempStageList.Add(temp);
                                                }
                                            }
                                        }

                                        if (ERMCommon.Instance.SelectedProductionTimeStagesList.Count() > 0)
                                        {
                                            List<Int32> TempSelectedIdStage = ERMCommon.Instance.SelectedProductionTimeStagesList.Cast<PlanningDateReviewStages>().Select(x => x.IdStage).ToList();

                                            TempStageList = TempStageList.Where(x => TempSelectedIdStage.Contains(x.IdStage)).ToList();
                                        }
                                        var StageList = TempStageList.OrderBy(x => x.Sequence).GroupBy(a => a.StageCode).ToList();

                                        int StageCount = StageList.Count();
                                        #endregion
                                        //Stagegrid column creation
                                        #region ColumnDefinition
                                        for (var Stagecolumn = 0; Stagecolumn < 1; Stagecolumn++)
                                        {
                                            var c = new ColumnDefinition();
                                            c.Width = GridLength.Auto;
                                            //c.Width = new GridLength(50, GridUnitType.Pixel);
                                            StageGrid.ColumnDefinitions.Add(c);
                                        }

                                        #endregion
                                        //Plantgrid row creation
                                        #region RowDefinition 
                                        for (var Stagerow = 0; Stagerow < StageCount; Stagerow++)
                                        {
                                            var r = new RowDefinition();
                                            r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                            StageGrid.RowDefinitions.Add(r);
                                        }

                                        #endregion
                                        //for(int stagedata=0; stagedata< StageCount; stagedata++)
                                        int StageRow = 0;
                                        List<ERM_ProductionTimeline> ERM_ProductionTimelineExistingEmP = new List<ERM_ProductionTimeline>();

                                        foreach (var stagedata in StageList)
                                        {

                                            Grid stageTempGrid = new Grid();
                                            stageTempGrid.ShowGridLines = false;

                                            //Stagegrid column creation
                                            #region ColumnDefinition
                                            for (var Stage1column = 0; Stage1column < 1; Stage1column++)
                                            {
                                                var c = new ColumnDefinition();
                                                c.Width = GridLength.Auto;
                                                //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                stageTempGrid.ColumnDefinitions.Add(c);
                                            }

                                            #endregion
                                            //Plantgrid row creation
                                            #region RowDefinition 
                                            for (var Stage1row = 0; Stage1row < 4; Stage1row++)
                                            {
                                                var r = new RowDefinition();
                                                if (Stage1row == 2)
                                                {
                                                    r.Height = new GridLength(10, GridUnitType.Pixel);
                                                }
                                                else
                                                {
                                                    r.Height = GridLength.Auto;
                                                }

                                                stageTempGrid.RowDefinitions.Add(r);
                                            }

                                            #endregion

                                            //string StagesName = ProductionTimeList.Where(x => x.StageCode == stagedata.Key && x.SiteName == plantdata.Key).FirstOrDefault().StageName;
                                            string StagesName = TempStageList.Where(x => x.StageCode == stagedata.Key).FirstOrDefault().StageName;
                                            Label StageName = new Label();
                                            StageName.Content = Convert.ToString(stagedata.Key) + " - " + StagesName;
                                            StageName.FontWeight = FontWeights.Bold;
                                            //Grid.SetRow(StageName, 0);
                                            //Grid.SetColumn(StageName, 0);

                                            #region emp

                                            //var EmployeeCodeList = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && a.AttendanceStartDate.Value.Date == StartDate.Date).GroupBy(x => x.EmployeeCode).ToList();
                                            //var EmployeeCodeList11 = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && a.AttendanceStartDate == null && a.CounterpartStartDate.Value.Date == StartDate.Date).ToList();

                                            #region [GEOS2-5883][gulab lakade][274 06 2024]
                                            //var EmployeeCodeList11 = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).ToList();
                                            //var EmployeeCodeList = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.StageCode == stagedata.Key && (a.AttendanceStartDate == null ? a.CounterpartStartDate.Value.Date == StartDate.Date : a.AttendanceStartDate.Value.Date == StartDate.Date)).GroupBy(x => x.EmployeeCode).ToList();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                            var StageRecord = ERMCommon.Instance.StageList.Where(x => x.StageCode == stagedata.Key).FirstOrDefault();
                                            List<string> IdJobdescriptionINstring = ERMCommon.Instance.WorkStageWiseJobDescription.Where(a => a.IdWorkStage == StageRecord.IdStage).FirstOrDefault().IdJobDescription;
                                            List<Int32> IdJobdescription = new List<int>();
                                            IdJobdescription = IdJobdescriptionINstring.Select(int.Parse).ToList();


                                            //var EmployeeCodeList = itemDate.Where(a => a.SiteName == plantdata.Key && IdJobdescription.Contains(a.IdJobDescription) && a.IsMainJobDescription == 1 && ((a.AttendanceStartDate == null && a.CounterpartStartDate.HasValue && a.CounterpartStartDate.Value.Date == itemDate.Key.Date) || (a.AttendanceStartDate.HasValue && a.AttendanceStartDate.Value.Date == itemDate.Key.Date) || (a.AttendanceStartDate == null && a.CounterpartStartDate == null && a.LeaveStartDate.HasValue && a.LeaveStartDate.Value.Date == itemDate.Key.Date))).GroupBy(x => x.EmployeeCode).ToList();////[GEOS2-6965][rani dhamankar][12-03-2025]
                                            #endregion
                                            var EmployeeCodeList = ERM_EmployeeDetails.Where(a => IdJobdescription.Contains(a.IdJobDescription) && a.IsMainJobDescription == 1 && (a.JobDescriptionStartDate.Value.Date <= itemDate.Date && (a.JobDescriptionEndDate == null || a.JobDescriptionEndDate.Value.Date >= itemDate.Date))).OrderBy(x => x.EmployeeName).GroupBy(a => a.IdEmployee).ToList();
                                            int EmployeeCount = EmployeeCodeList.Count();
                                            Grid EmpGrid = new Grid();
                                            EmpGrid.ShowGridLines = false;

                                            //Stagegrid column creation
                                            #region ColumnDefinition
                                            for (var empcolumn = 0; empcolumn < 4; empcolumn++)
                                            {
                                                var c = new ColumnDefinition();
                                                if (empcolumn == 0)
                                                {
                                                    c.Width = new GridLength(220, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 1)
                                                {
                                                    c.Width = new GridLength(100, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 2)
                                                {
                                                    c.Width = GridLength.Auto; //new GridLength(600, GridUnitType.Pixel);
                                                }
                                                else if (empcolumn == 3)
                                                {
                                                    c.Width = new GridLength(70, GridUnitType.Pixel);
                                                }
                                                //c.Width = GridLength.Auto;
                                                //c.Width = new GridLength(150, GridUnitType.Pixel);
                                                EmpGrid.ColumnDefinitions.Add(c);
                                            }

                                            #endregion
                                            //Plantgrid row creation
                                            #region RowDefinition 
                                            for (var emprow = 0; emprow < EmployeeCount; emprow++)
                                            {
                                                var r = new RowDefinition();
                                                r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                EmpGrid.RowDefinitions.Add(r);
                                            }

                                            #endregion



                                            //for(int i=0; i<2;i++)
                                            int empcount = 0;

                                            foreach (var emp in EmployeeCodeList)
                                            {
                                                var employee_MainDetail = ERM_EmployeeDetails.Where(a => a.IdEmployee == emp.Key).FirstOrDefault();
                                                TimeSpan Hours_24 = new TimeSpan();
                                                TimeSpan Hours_0 = new TimeSpan();
                                                Hours_24 = TimeSpan.FromMinutes(1440);//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                Hours_0 = TimeSpan.Zero;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_24 = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_0 = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                double TotalHours_Night = 0;//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                DateTime? MinAtt_Date = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                                DateTime? MaxAtt_Date = new DateTime();//[GEOS2-7641][gulab lakade][27 03 2025]
                                                Shift_ST_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                Shift_ED_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                TimeSpan tmpStartTimeCheck = new TimeSpan(14, 00, 0);
                                                TimeSpan tmpENDTimeCheck = new TimeSpan(12, 00, 0);
                                                int EmpIsNightShift = 0;
                                                bool IsAttendance = false;
                                                bool IsAllDayLeave = false;
                                                bool Isholidays = false;
                                                TimeSpan StandardBreakTime = new TimeSpan();
                                                #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                var TmpMinMaxATT = ERM_Employee_Attendance.Where(a => a.IdEmployee == emp.Key && a.AttendanceStartDate != null
                                               && (a.IsNightShift == 1 && a.ShiftStartTime >= tmpStartTimeCheck ? (a.AttendanceStartDate.Value >= itemDate.Date.Add(a.ShiftStartTime.Subtract(TimeSpan.FromHours(2))) && a.AttendanceEndDate.Value <= itemDate.Date.AddDays(1).Date.Add(tmpENDTimeCheck)) : (a.AttendanceStartDate.Value.Date == itemDate.Date && a.AttendanceEndDate.Value.Date == itemDate.Date))).ToList();// [GEOS2-7755][gulab lakade][08 04 2025]
                                                #endregion

                                                #region [GEOS2-9220][gulab lakade][12 08 2025]
                                                var tmpLeavedata = ERMEmployeeLeave.Where(a => a.IdEmployee == employee_MainDetail.IdEmployee && a.StartDate != null
                                                && (a.IsNightShift == 1 && a.ShiftStartTime >= tmpStartTimeCheck ? (a.StartDate.Value >= itemDate.Date.Add(a.ShiftStartTime.Subtract(TimeSpan.FromHours(2))) && a.EndDate.Value <= itemDate.Date.AddDays(1).Date.Add(tmpENDTimeCheck)) : (a.StartDate.Value.Date == itemDate.Date && a.EndDate.Value.Date == itemDate.Date))).ToList();
                                                #endregion
                                                // ERM_ProductionTimeline employee = new ERM_ProductionTimeline();
                                                if (TmpMinMaxATT.Count() > 0)
                                                {
                                                    IsAttendance = true;
                                                    DateTime? Shift_std_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]
                                                    Shift_std_Date = itemDate.Date.Add(tmpStartTimeCheck);
                                                    DateTime? Shift_edd_Date = new DateTime();//[GEOS2-7755][gulab lakade][08 04 2025]

                                                    var Tmpshift = TmpMinMaxATT.FirstOrDefault();
                                                    StandardBreakTime = Tmpshift.BreakTime;
                                                    TimeSpan tmptimespan = new TimeSpan(2, 0, 0);
                                                    TimeSpan tmpShiftStartTime = new TimeSpan(Tmpshift.ShiftStartTime.Hours, 0, 0);
                                                    TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                    if (Tmpshift.ShiftEndTime.Minutes > 0)
                                                    {
                                                        tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                    }
                                                    Shift_ST_Date = itemDate.Date.Add(Tmpshift.ShiftStartTime); //[GEOS2-7755][gulab lakade] [08 04 2025]
                                                    OrignalShift_SD_Date = Shift_ST_Date; //[GEOS2-8864][gulab lakade][30 07 2025]
                                                    EmpIsNightShift = Tmpshift.IsNightShift;
                                                    if (Tmpshift.IsNightShift == 1)
                                                    {
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        Shift_edd_Date = itemDate.Date.AddDays(1);
                                                        Shift_edd_Date = Shift_edd_Date.Value.Date.Add(tmpENDTimeCheck);
                                                        #region [GEOS2-7092][gulab lakade][22 05 2025]
                                                        //MinAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceStartDate > Shift_std_Date).Min(a => a.AttendanceStartDate);
                                                        MinAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceStartDate > Shift_std_Date && x.AttendanceStartDate < Shift_edd_Date).Min(a => a.AttendanceStartDate);
                                                        #endregion 
                                                        MaxAtt_Date = TmpMinMaxATT.Where(x => x.AttendanceEndDate < Shift_edd_Date).Max(a => a.AttendanceEndDate);

                                                        shiftStartDate = itemDate.Date.Add(tmpShiftStartTime);
                                                        //TimeSpan tmpStartTimeCheck = new TimeSpan(17, 00, 0);
                                                        //TimeSpan tmpENDTimeCheck = new TimeSpan(12, 00, 0);

                                                        if (tmpShiftStartTime >= tmpStartTimeCheck)
                                                        {
                                                            //[GEOS2-7092][gulab lakade][22 05 2025]
                                                            if (shiftStartDate > MinAtt_Date)
                                                            {
                                                                shiftStartDate = MinAtt_Date;
                                                            }
                                                            else
                                                            {
                                                                MinAtt_Date = shiftStartDate;

                                                            }
                                                            //end[GEOS2-7092][gulab lakade][22 05 2025]
                                                            if (tmpShiftEndTime >= tmpENDTimeCheck)
                                                            {
                                                                shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                                OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                            }
                                                            else
                                                            {
                                                                shiftEndDate = itemDate.Date.AddDays(1);
                                                                OrignalShift_ED_Date = shiftEndDate.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                shiftEndDate = shiftEndDate.Value.Date.Add(tmpShiftEndTime);
                                                                //Shift_ED_Date = Shift_ED_Date.Value.Date.AddDays(1).Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                            }
                                                            if (MaxAtt_Date < shiftEndDate)
                                                            {
                                                                MaxAtt_Date = shiftEndDate;
                                                            }
                                                            else
                                                            {
                                                                TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                                if (tmpenddt.Minutes > 0)
                                                                {
                                                                    TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                                    tmpenddt = tmpenddt.Add(tmpspan);
                                                                    tmpspan = new TimeSpan(0, tmpenddt.Minutes, 0);
                                                                    tmpenddt = tmpenddt.Subtract(tmpspan);
                                                                }
                                                                shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                            }
                                                        }
                                                        else
                                                        {
                                                            MinAtt_Date = shiftStartDate;
                                                            shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                            OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                            if (MaxAtt_Date < shiftEndDate)
                                                            {
                                                                MaxAtt_Date = shiftEndDate;
                                                            }
                                                            else
                                                            {
                                                                TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                                if (tmpenddt.Minutes > 0)
                                                                {
                                                                    TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                                    tmpenddt = tmpenddt.Add(tmpspan);
                                                                    tmpspan = new TimeSpan(0, tmpenddt.Minutes, 0);
                                                                    tmpenddt = tmpenddt.Subtract(tmpspan);
                                                                }
                                                                shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                            }
                                                            //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                        }
                                                        #endregion 

                                                    }
                                                    else
                                                    {
                                                        MinAtt_Date = TmpMinMaxATT.Min(a => a.AttendanceStartDate);
                                                        MaxAtt_Date = TmpMinMaxATT.Max(a => a.AttendanceEndDate);
                                                        shiftStartDate = itemDate.Date.Add(tmpShiftStartTime);
                                                        shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                        OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                        if (MinAtt_Date <= shiftStartDate)
                                                        {
                                                            TimeSpan tmpenddt = MinAtt_Date.Value.TimeOfDay;
                                                            TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                            tmpenddt = tmpenddt.Add(-tmpspan);
                                                            tmpShiftStartTime = tmpenddt;
                                                            shiftStartDate = MinAtt_Date.Value.Date.Add(tmpenddt);
                                                        }


                                                        if (MaxAtt_Date.Value.TimeOfDay >= tmpShiftEndTime)
                                                        {
                                                            TimeSpan tmpenddt = MaxAtt_Date.Value.TimeOfDay;
                                                            //TimeSpan tmpspan = new TimeSpan(1, 0, 0);
                                                            //tmpenddt = tmpenddt.Add(tmpspan);
                                                            tmpShiftEndTime = tmpenddt;
                                                            shiftEndDate = MaxAtt_Date.Value.Date.Add(tmpenddt);
                                                        }
                                                        //else
                                                        //{
                                                        //    shiftEndDate = itemDate.Key.Date.Add(tmpShiftEndTime);
                                                        //}


                                                        //Shift_ED_Date = Shift_ED_Date.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-7755][gulab lakade][08 04 2025]
                                                    }

                                                }
                                                else
                                                {
                                                    IsAttendance = false;
                                                    if (tmpLeavedata.Count() > 0)
                                                    {
                                                        var Tmpshift = tmpLeavedata.Where(a => a.IdEmployee == emp.Key).FirstOrDefault();

                                                        if (Tmpshift != null)
                                                        {
                                                            EmpIsNightShift = Tmpshift.IsNightShift;
                                                            //StandardBreakTime = Tmpshift.BreakTime;
                                                            #region [GEOS2-7755][gulab lakade][16 04 2025]
                                                            OrignalShift_SD_Date = itemDate.Date.Add(Tmpshift.ShiftStartTime); //[GEOS2-8864][gulab lakade][30 07 2025]
                                                            if (Tmpshift.IsNightShift == 1)
                                                            {
                                                                TimeSpan tmpShiftStartTime = Tmpshift.ShiftStartTime;


                                                                TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                                if (tmpShiftStartTime >= tmpStartTimeCheck)
                                                                {
                                                                    if (tmpShiftEndTime >= tmpENDTimeCheck)
                                                                    {
                                                                        shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                                        OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                    }
                                                                    else
                                                                    {
                                                                        shiftEndDate = itemDate.Date.AddDays(1);
                                                                        OrignalShift_ED_Date = shiftEndDate.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                        shiftEndDate = shiftEndDate.Value.Date.Add(tmpShiftEndTime);
                                                                    }

                                                                }
                                                                else
                                                                {
                                                                    shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                                    OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                }
                                                                shiftStartDate = itemDate.Date.Add(tmpShiftStartTime);
                                                                MinAtt_Date = shiftStartDate;
                                                                MaxAtt_Date = shiftEndDate;
                                                            }
                                                            else
                                                            {
                                                                TimeSpan tmpShiftStartTime = Tmpshift.ShiftStartTime;
                                                                TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                                MinAtt_Date = itemDate.Date.Add(tmpShiftStartTime);
                                                                MaxAtt_Date = itemDate.Date.Add(tmpShiftEndTime);
                                                                shiftStartDate = itemDate.Date.Add(tmpShiftStartTime);
                                                                shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                                OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                            }
                                                        }
                                                    }
                                                    else
                                                    {
                                                        var Tmpshift = ERM_Employee_MAX_Attendance.Where(a => a.IdEmployee == emp.Key).FirstOrDefault();

                                                        if (Tmpshift != null)
                                                        {
                                                            EmpIsNightShift = Tmpshift.IsNightShift;
                                                            StandardBreakTime = Tmpshift.BreakTime;
                                                            #region [GEOS2-7755][gulab lakade][16 04 2025]
                                                            OrignalShift_SD_Date = itemDate.Date.Add(Tmpshift.ShiftStartTime); //[GEOS2-8864][gulab lakade][30 07 2025]
                                                            if (Tmpshift.IsNightShift == 1)
                                                            {
                                                                TimeSpan tmpShiftStartTime = Tmpshift.ShiftStartTime;


                                                                TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime;
                                                                if (tmpShiftStartTime >= tmpStartTimeCheck)
                                                                {
                                                                    if (tmpShiftEndTime >= tmpENDTimeCheck)
                                                                    {
                                                                        shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                                        OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                    }
                                                                    else
                                                                    {
                                                                        shiftEndDate = itemDate.Date.AddDays(1);
                                                                        OrignalShift_ED_Date = shiftEndDate.Value.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                        shiftEndDate = shiftEndDate.Value.Date.Add(tmpShiftEndTime);
                                                                    }

                                                                }
                                                                else
                                                                {
                                                                    shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                                    OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                                }
                                                                shiftStartDate = itemDate.Date.Add(tmpShiftStartTime);
                                                                MinAtt_Date = shiftStartDate;
                                                                MaxAtt_Date = shiftEndDate;
                                                            }
                                                            else
                                                            {
                                                                TimeSpan tmphours = new TimeSpan(01, 00, 0);
                                                                TimeSpan tmpShiftStartTime = Tmpshift.ShiftStartTime.Subtract(tmphours);
                                                                TimeSpan tmpShiftEndTime = Tmpshift.ShiftEndTime.Add(tmphours);
                                                                MinAtt_Date = itemDate.Date.Add(tmpShiftStartTime);
                                                                MaxAtt_Date = itemDate.Date.Add(tmpShiftEndTime);
                                                                shiftStartDate = itemDate.Date.Add(tmpShiftStartTime);
                                                                shiftEndDate = itemDate.Date.Add(tmpShiftEndTime);
                                                                OrignalShift_ED_Date = itemDate.Date.Add(Tmpshift.ShiftEndTime);//[GEOS2-8864[gulab lakade][30 07 2025]
                                                            }

                                                            #endregion
                                                        }
                                                    }
                                                    //var Tmpshift = emp.FirstOrDefault();


                                                }
                                                #endregion

                                                #region [GEOS2-9220][gulab lakade][12 08 2025]
                                                var tmpTrackingData = ERM_Counterpartstracking.Where(a => a.IdOperator == employee_MainDetail.IdUser && a.StartDate >= MinAtt_Date && a.EndDate <= MaxAtt_Date).ToList();
                                                var tmpNO_OTdata = ERM_NO_OT_Time.Where(a => a.IdOperator == employee_MainDetail.IdUser && a.BreakStartDate >= MinAtt_Date && a.BreakEndDate <= MaxAtt_Date).ToList();
                                                var tmpAttendance = ERM_Employee_Attendance.Where(a => a.IdEmployee == employee_MainDetail.IdEmployee && a.AttendanceStartDate >= MinAtt_Date && a.AttendanceEndDate <= MaxAtt_Date).ToList();
                                                var tmpOT_Workingdata = ERM_OT_Working_Time.Where(a => a.IdOperator == employee_MainDetail.IdUser && a.StartDate >= MinAtt_Date && a.EndDate <= MaxAtt_Date).ToList(); // [GEOS2-9393][pallavi jadhav][12 11 2025]
                                                #endregion
                                                #region [GEOS2-5883][gulab lakade][274 06 2024]


                                                if (MinAtt_Date >= shiftStartDate && MaxAtt_Date <= shiftEndDate)//[GEOS2-7641][gulab lakade][27 03 2025]
                                                {
                                                    #endregion

                                                    #region [GEOS2-6738][gulab lakade][01 02 2025]
                                                    ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                    #endregion
                                                    DataRow dr = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();//[GEOS2-5394][gulab lakade][19 02 2024]

                                                    //start[GEOS2-5515][gulab lakade][28 03 2024]
                                                    double TotalShiftTime = 0;
                                                    //[GEOS2-8864][gulab lakade][30 07 2025]
                                                    //TotalShiftTime = (OrignalShift_ED_Date.Value.TimeOfDay - OrignalShift_SD_Date.Value.TimeOfDay).TotalHours;
                                                    TotalShiftTime = (OrignalShift_ED_Date.Value - OrignalShift_SD_Date.Value).TotalHours;
                                                    //[GEOS2-8864][gulab lakade][30 07 2025]
                                                    //if (EmpIsNightShift == 1)

                                                    if (EmpIsNightShift == 1)
                                                    {
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        {
                                                            TimeSpan tmpdiff_shift = shiftEndDate.Value.TimeOfDay - shiftStartDate.Value.TimeOfDay;
                                                            //TotalShiftTime = tmpdiff_shift.TotalHours;
                                                            TotalHours_Night = tmpdiff_shift.TotalMinutes;
                                                        }
                                                        else
                                                        {

                                                            TotalHours_24 = (Hours_24 - shiftStartDate.Value.TimeOfDay).TotalHours;
                                                            TotalHours_0 = (shiftEndDate.Value.TimeOfDay - Hours_0).TotalHours;
                                                            TotalHours_0 = TotalHours_0 + 1;//[GEOS2-6771][gulab lakade][04 20 2025]
                                                            TotalHours_Night = TotalHours_24 + TotalHours_0;
                                                            TimeSpan totalHoursInTimespan = (Hours_24 - shiftStartDate.Value.TimeOfDay) + (shiftEndDate.Value.TimeOfDay - Hours_0);
                                                            //[GEOS2-7755][gulab lakade][22 04 2025]
                                                        }
                                                        #endregion

                                                    }
                                                    else
                                                    {
                                                        //TotalShiftTime = ShiftEndTime - ShiftStartTime;
                                                        //TotalShiftTime = (shiftEndDate.Value.TimeOfDay - shiftStartDate.Value.TimeOfDay).TotalHours;
                                                    }
                                                    //end[GEOS2-5515][gulab lakade][28 03 2024]


                                                    double BreackTimeIndouble = 0;
                                                    if (tmpAttendance.Count() > 0)
                                                    {
                                                        var tmpbreaktime = tmpAttendance.FirstOrDefault();
                                                        BreackTimeIndouble = Math.Round((Convert.ToDouble((tmpbreaktime.BreakTime).TotalMinutes) / 60), 4);
                                                    }
                                                    double TotalShiftInDouble = TotalShiftTime - BreackTimeIndouble;
                                                    //double TotalShiftInDouble = TotalShiftTime;
                                                    #region Attendance
                                                    double MaxEndLeaveTimeInDouuble = 0;
                                                    double AttendanceStartTimeDecimal = 0;
                                                    double AttenadnceEndTimeDecimal = 0;
                                                    TimeSpan AttendanceStartTime = new TimeSpan();
                                                    TimeSpan AttenadnceEndTime = new TimeSpan();
                                                    TimeSpan MaxEndLeaveTime = new TimeSpan();
                                                    string Week = string.Empty;
                                                    TimeSpan TotalLoggedTime = new TimeSpan();
                                                    double TotalAttendanceWithoutLeave = 0;
                                                    #endregion
                                                    TextBox empName = new TextBox();
                                                    //empName.Text = employee.EmployeeName;
                                                    empName.Text = employee_MainDetail.EmployeeName;
                                                    empName.Width = 140;
                                                    empName.TextWrapping = TextWrapping.Wrap;
                                                    empName.TextAlignment = TextAlignment.Center;
                                                    empName.IsReadOnly = true;
                                                    empName.BorderBrush = new SolidColorBrush(Colors.Transparent);
                                                    //var employeeImageKey = employee.EmployeeCode;
                                                    var employeeImageKey = employee_MainDetail.EmployeeCode;
                                                    #region  tmp comment
                                                    Image EmployeeImage = new Image();
                                                    BitmapImage bitmapImage = new BitmapImage();

                                                    #region [GEOS2-6693][rani dhamankar][28-02-2025]
                                                    if (!ERMCommon.Instance.ImagesDictionary.ContainsKey(employeeImageKey))
                                                    {
                                                        try
                                                        {
                                                            // Construct the URL for the rounded employee image
                                                            string tempEMPImageUrl = $"https://api.emdep.com/GEOS/Images.aspx?FilePath=/Images/Employees/Rounded/{employee_MainDetail.EmployeeCode}.png";

                                                            // Use the delegate to convert the image URL to a byte array
                                                            byte[] imageBytes = ImageUrlToByteArrayUsingDelegate(tempEMPImageUrl);
                                                            if (imageBytes.Length > 0)
                                                            {
                                                                // Create the BitmapImage from the byte array
                                                                using (MemoryStream ms = new MemoryStream(imageBytes))
                                                                {
                                                                    bitmapImage.BeginInit();
                                                                    bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                                                                    bitmapImage.StreamSource = ms;
                                                                    bitmapImage.EndInit();
                                                                }
                                                            }
                                                            else
                                                            {
                                                                // Fallback image URL if the original image is empty
                                                                string fallbackImageUrl = $"https://api.emdep.com/GEOS/Images.aspx?FilePath=/Images/Employees/{employee_MainDetail.EmployeeCode}.png";
                                                                imageBytes = ImageUrlToByteArrayUsingDelegate(fallbackImageUrl);

                                                                using (MemoryStream ms = new MemoryStream(imageBytes))
                                                                {
                                                                    bitmapImage.BeginInit();
                                                                    bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                                                                    bitmapImage.StreamSource = ms;
                                                                    bitmapImage.EndInit();
                                                                }
                                                            }

                                                            // Store the loaded image in the memory cache (ImagesDictionary) for future use
                                                            ERMCommon.Instance.ImagesDictionary.Add(employee_MainDetail.EmployeeCode, bitmapImage);
                                                        }
                                                        catch (Exception ex)
                                                        {
                                                            // Handle any exceptions that may occur during image loading
                                                            Console.WriteLine($"Error loading image: {ex.Message}");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        // If the image exists in memory, retrieve it from the dictionary
                                                        bitmapImage = ERMCommon.Instance.ImagesDictionary[employee_MainDetail.EmployeeCode];
                                                    }
                                                    #endregion
                                                    #endregion
                                                    #endregion
                                                    var images = ERMCommon.Instance.ImagesDictionary.Where(a => a.Key == employee_MainDetail.EmployeeCode).FirstOrDefault();
                                                    EmployeeImage.Source = images.Value;
                                                    EmployeeImage.Width = 100;
                                                    EmployeeImage.Height = 100;
                                                    #region Image and EMP Name
                                                    Grid ImageGrid = new Grid();
                                                    //Image and EMP Name column creation
                                                    //ImageGrid.ShowGridLines = true;
                                                    #region ColumnDefinition
                                                    for (var Imagecolumn = 0; Imagecolumn < 1; Imagecolumn++)
                                                    {
                                                        var c = new ColumnDefinition();
                                                        c.Width = GridLength.Auto;

                                                        //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                        ImageGrid.ColumnDefinitions.Add(c);
                                                    }

                                                    #endregion
                                                    //Image and EMP Name row creation
                                                    #region RowDefinition 
                                                    for (var Imagerow = 0; Imagerow < 2; Imagerow++)
                                                    {
                                                        var r = new RowDefinition();
                                                        if (Imagerow == 0)
                                                        {
                                                            r.Height = new GridLength(120, GridUnitType.Pixel);
                                                        }
                                                        else
                                                        {
                                                            //r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                            r.Height = new GridLength(47, GridUnitType.Pixel);
                                                        }

                                                        ImageGrid.RowDefinitions.Add(r);


                                                    }
                                                    //ImageGrid.ShowGridLines = true;
                                                    ImageGrid.Width = 180;
                                                    //ImageGrid.Height = 120;
                                                    #endregion
                                                    //Border Imageborder = new Border()
                                                    //{
                                                    //    BorderThickness = new Thickness()
                                                    //    {
                                                    //        Bottom = 1,
                                                    //        Left = 1,
                                                    //        Right = 1,
                                                    //        Top = 1
                                                    //    },
                                                    //    BorderBrush = new SolidColorBrush(Colors.Black)
                                                    //};
                                                    //Grid.SetRow(Imageborder, 0);
                                                    //Grid.SetColumn(Imageborder, 0);

                                                    Grid.SetRow(EmployeeImage, 0);
                                                    Grid.SetColumn(EmployeeImage, 0);
                                                    Grid.SetRow(empName, 1);
                                                    Grid.SetColumn(empName, 0);
                                                    // ImageGrid.Children.Add(Imageborder);
                                                    ImageGrid.Children.Add(EmployeeImage);
                                                    ImageGrid.Children.Add(empName);
                                                    #endregion
                                                    #region Pallavi
                                                    LinearGaugeControl linearGauge = new LinearGaugeControl();
                                                    // linearGauge.bu = true;
                                                    LinearGaugeControl linearGauge_night = new LinearGaugeControl();
                                                    #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                    linearGauge.MouseMove += LinearGauge_MouseMove;
                                                    linearGauge_night.MouseMove += linearGauge_night_MouseMove;
                                                    #endregion
                                                    //try
                                                    //{
                                                    Int32 DayDate = new Int32();
                                                    Int32 month = new Int32();

                                                    if (IsAttendance == true)
                                                    {
                                                        Week = tmpAttendance.FirstOrDefault().CalenderWeek;
                                                        DayDate = (Int32)tmpAttendance.FirstOrDefault().AttendanceStartDate.Value.DayOfWeek;
                                                        month = (Int32)tmpAttendance.FirstOrDefault().AttendanceStartDate.Value.Month;
                                                    }
                                                    else if (tmpLeavedata.Count() > 0)
                                                    {
                                                        Week = tmpLeavedata.FirstOrDefault().CalenderWeek;
                                                        DayDate = (Int32)tmpLeavedata.FirstOrDefault().StartDate.Value.DayOfWeek;
                                                        month = (Int32)tmpLeavedata.FirstOrDefault().StartDate.Value.Month;
                                                    }
                                                    else
                                                    {
                                                        if (tmpNO_OTdata.Count() > 0)
                                                        {
                                                            Week = tmpNO_OTdata.FirstOrDefault().CalenderWeek;
                                                            DayDate = (Int32)tmpNO_OTdata.FirstOrDefault().BreakStartDate.Value.DayOfWeek;
                                                            month = (Int32)tmpNO_OTdata.FirstOrDefault().BreakStartDate.Value.Month;
                                                        }
                                                        else if (tmpTrackingData.Count() > 0)
                                                        {
                                                            Week = tmpTrackingData.FirstOrDefault().CalenderWeek;
                                                            DayDate = (Int32)tmpTrackingData.FirstOrDefault().StartDate.Value.DayOfWeek;
                                                            month = (Int32)tmpTrackingData.FirstOrDefault().StartDate.Value.Month;
                                                        }
                                                        else if (tmpOT_Workingdata.Count()>0)
                                                        {
                                                            Week = tmpOT_Workingdata.FirstOrDefault().CalenderWeek;
                                                            DayDate = (Int32)tmpOT_Workingdata.FirstOrDefault().StartDate.Value.DayOfWeek;
                                                            month = (Int32)tmpOT_Workingdata.FirstOrDefault().StartDate.Value.Month;
                                                        }
                                                    }
                                                    linearGauge.Name = "D" + Convert.ToString(employee_MainDetail.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(StageRecord.IdStage);
                                                    linearGauge_night.Name = "D" + Convert.ToString(employee_MainDetail.IdEmployee) + "D" + DayDate + "D" + month + "D" + Convert.ToString(StageRecord.IdStage);
                                                    #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                    //linearGauge.Width = 1370;
                                                    //linearGauge.Height = 100;
                                                    //if (EmpIsNightShift == 1 && IsAttendance==true)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                    if (EmpIsNightShift == 1 && IsAttendance == true)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                    {

                                                        int HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        {
                                                            linearGauge.Width = 1370;
                                                            //linearGauge_night.Width = (int)(HoursByTotalHours_night);
                                                        }
                                                        else
                                                        {
                                                            if (TotalHours_0 == 0)
                                                            {

                                                                TotalHours_0 = 2;
                                                                TotalHours_Night = TotalHours_Night + 2;
                                                                HoursByTotalHours_night = (int)(1454 / TotalHours_Night);
                                                                int widthValue = 1454 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                double TotalHr = (TotalHours_24 + TotalHours_0);
                                                                int width_linear = (int)(widthValue / (TotalHr / TotalHours_24)) + 1;
                                                                int width_night = (int)(widthValue / (TotalHr / TotalHours_0)) + 1;
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + width_linear;
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + width_night;

                                                            }
                                                            else
                                                            {
                                                                int widthValue = 1454 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                double TotalHr = (TotalHours_24 + TotalHours_0);
                                                                int width_linear = (int)(widthValue / (TotalHr / TotalHours_24)) + 1;
                                                                int width_night = (int)(widthValue / (TotalHr / TotalHours_0)) + 1;
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + width_linear;
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + width_night;
                                                            }
                                                        }
                                                        #endregion
                                                        //if (TotalHours_24 > TotalHours_0)
                                                        //{
                                                        //    #region [GEOS2-6662][gulab lakade][18 12 2024]
                                                        //    if (TotalHours_0 == 0)
                                                        //    {
                                                        //        //[GEOS2-7755][gulab lakade][20 04 2025]
                                                        //        TotalHours_0 = 2;
                                                        //        TotalHours_Night = TotalHours_Night + 2;
                                                        //        HoursByTotalHours_night = (int)(1430 / TotalHours_Night);
                                                        //        int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                        //        linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                        //        linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0);
                                                        //        //[GEOS2-7755][gulab lakade][20 04 2025]
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        int widthValue = (1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0)))+5;
                                                        //        //double TotalHr = (TotalHours_24 + TotalHours_0);
                                                        //        //int width_linear = (int)(widthValue / (TotalHr/TotalHours_24))+1;
                                                        //        //int width_night = (int)(widthValue / (TotalHr/TotalHours_0)) + 1;
                                                        //        linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) ;
                                                        //        linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue;
                                                        //    }

                                                        //    //int widthValue = 1430 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                        //    //linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                        //    //linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + widthValue + 25;
                                                        //    #endregion
                                                        //}

                                                        //else
                                                        //   if (TotalHours_24 < TotalHours_0)
                                                        //{
                                                        //    int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                        //    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + widthValue;
                                                        //    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) ;
                                                        //}


                                                        //linearGauge.Width = 1060;
                                                        linearGauge.Height = 100;


                                                        linearGauge_night.Height = 100;
                                                    }
                                                    //else if (EmpIsNightShift == 1 && IsAttendance == false && (tmpLeavedata.FirstOrDefault() != null && tmpLeavedata.FirstOrDefault().IsAllDayEvent == 1))//[GEOS2-8189][rani dhamankar][03-06-2025]
                                                    else if (EmpIsNightShift == 1 && IsAttendance == false)//[GEOS2-8189][rani dhamankar][03-06-2025]
                                                    {
                                                        int HoursByTotalHours_night = (int)(1370 / TotalHours_Night);
                                                        if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        {
                                                            linearGauge.Width = 1370;
                                                            //linearGauge_night.Width = (int)(HoursByTotalHours_night);
                                                        }
                                                        else
                                                        {
                                                            if (TotalHours_0 == 0)
                                                            {

                                                                TotalHours_0 = 2;
                                                                TotalHours_Night = TotalHours_Night + 2;
                                                                HoursByTotalHours_night = (int)(1454 / TotalHours_Night);
                                                                int widthValue = 1454 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                double TotalHr = (TotalHours_24 + TotalHours_0);
                                                                int width_linear = (int)(widthValue / (TotalHr / TotalHours_24)) + 1;
                                                                int width_night = (int)(widthValue / (TotalHr / TotalHours_0)) + 1;
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + width_linear;
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + width_night;

                                                            }
                                                            else
                                                            {
                                                                int widthValue = 1454 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                                double TotalHr = (TotalHours_24 + TotalHours_0);
                                                                int width_linear = (int)(widthValue / (TotalHr / TotalHours_24)) + 1;
                                                                int width_night = (int)(widthValue / (TotalHr / TotalHours_0)) + 1;
                                                                linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + width_linear;
                                                                linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + width_night;
                                                            }
                                                        }

                                                        //if (TotalHours_24 > TotalHours_0)
                                                        //{

                                                        //    if (TotalHours_0 == 0)
                                                        //    {

                                                        //        TotalHours_0 = 2;
                                                        //        TotalHours_Night = TotalHours_Night + 2;
                                                        //        HoursByTotalHours_night = (int)(1460 / TotalHours_Night);
                                                        //        int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                        //        double TotalHr = (TotalHours_24 + TotalHours_0);
                                                        //        int width_linear = (int)(widthValue / (TotalHr / TotalHours_24)) + 1;
                                                        //        int width_night = (int)(widthValue / (TotalHr / TotalHours_0)) + 1;
                                                        //        linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + width_linear;
                                                        //        linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0)+ width_night;

                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        int widthValue = 1460 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                        //        double TotalHr = (TotalHours_24 + TotalHours_0);
                                                        //        int width_linear = (int)(widthValue / (TotalHr / TotalHours_24)) + 1;
                                                        //        int width_night = (int)(widthValue / (TotalHr / TotalHours_0)) + 1;
                                                        //        linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + width_linear;
                                                        //        linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0) + width_night;
                                                        //    }

                                                        //}

                                                        //else
                                                        //   if (TotalHours_24 < TotalHours_0)
                                                        //{
                                                        //    int widthValue = 1454 - ((int)(HoursByTotalHours_night * TotalHours_24) + (int)(HoursByTotalHours_night * TotalHours_0));
                                                        //    double TotalHr = (TotalHours_24 + TotalHours_0);
                                                        //    int width_linear = (int)(widthValue / (TotalHr / TotalHours_24)) + 1;
                                                        //    int width_night = (int)(widthValue / (TotalHr / TotalHours_0)) + 1;
                                                        //    linearGauge.Width = (int)(HoursByTotalHours_night * TotalHours_24) + width_linear;
                                                        //    linearGauge_night.Width = (int)(HoursByTotalHours_night * TotalHours_0)+ width_night;
                                                        //}


                                                        linearGauge.Height = 100;
                                                        linearGauge_night.Height = 100;



                                                    }

                                                    else
                                                     if (IsAttendance == true && EmpIsNightShift == 0 && MinAtt_Date < MaxAtt_Date)
                                                    {
                                                        linearGauge.Width = 1370;
                                                        linearGauge.Height = 100;
                                                    }
                                                    else
                                                    {
                                                        linearGauge.Width = 1370;
                                                        linearGauge.Height = 100;
                                                        linearGauge_night.Width = 0;
                                                        linearGauge_night.Height = 100;
                                                    }
                                                    #endregion



                                                    DefaultScaleLabelControl label;
                                                    // // Create a LinearScale
                                                    LinearScale linearScale = new LinearScale();
                                                    LinearScale linearnightScale = new LinearScale();
                                                    linearScale.LayoutMode = 0;
                                                    linearScale.Markers.Clear();
                                                    linearScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                    linearScale.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                    linearnightScale.LayoutMode = 0;
                                                    linearnightScale.Markers.Clear();
                                                    linearnightScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                    linearnightScale.Foreground = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));

                                                    linearnightScale.Background = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"));
                                                    if (ApplicationThemeHelper.ApplicationThemeName.ToString() == "BlackAndBlue")
                                                    {
                                                        label = new DefaultScaleLabelControl()
                                                        {
                                                            Foreground = new SolidColorBrush(Colors.White)
                                                        };



                                                        var foregroundProperty = label.GetType().GetProperty("Foreground");
                                                        if (foregroundProperty != null)
                                                        {
                                                            foregroundProperty.SetValue(label, new SolidColorBrush(Colors.White));
                                                        }

                                                        linearScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")) };
                                                        linearScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                        {
                                                            MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")),
                                                            MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"))

                                                        };

                                                        linearnightScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")) };
                                                        linearnightScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                        {
                                                            MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")),
                                                            MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF"))

                                                        };


                                                        #region RND
                                                        CustomScaleLabelPresentation customScaleLabelPresentation = new CustomScaleLabelPresentation();

                                                        ControlTemplate labelTemplate = new ControlTemplate();

                                                        FrameworkElementFactory textBlockFactory = new FrameworkElementFactory(typeof(TextBlock));
                                                        textBlockFactory.SetBinding(TextBlock.TextProperty, new Binding("Text"));
                                                        textBlockFactory.SetValue(TextBlock.ForegroundProperty, new SolidColorBrush((Color)ColorConverter.ConvertFromString("#FFFFFF")));
                                                        textBlockFactory.SetValue(TextBlock.MarginProperty, new Thickness(-1, -10, 0, 0)); // Adjust the values as needed

                                                        labelTemplate.VisualTree = textBlockFactory;

                                                        // Set the LabelTemplate for CustomScaleLabelPresentation
                                                        customScaleLabelPresentation.LabelTemplate = labelTemplate;

                                                        // Set CustomScaleLabelPresentation for LinearScale.LabelPresentation
                                                        linearScale.LabelPresentation = customScaleLabelPresentation;
                                                        linearnightScale.LabelPresentation = customScaleLabelPresentation;
                                                        #endregion
                                                    }
                                                    else
                                                    {

                                                        label = new DefaultScaleLabelControl()
                                                        {
                                                            Foreground = new SolidColorBrush(Colors.Black)
                                                        };

                                                        var foregroundProperty = label.GetType().GetProperty("Foreground");
                                                        if (foregroundProperty != null)
                                                        {
                                                            foregroundProperty.SetValue(label, new SolidColorBrush(Colors.Black));
                                                        }
                                                        linearScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")) };
                                                        linearScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                        {
                                                            MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")),
                                                            MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000"))
                                                        };

                                                        linearnightScale.LinePresentation = new DefaultLinearScaleLinePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")) };
                                                        linearnightScale.TickmarksPresentation = new DefaultTickmarksPresentation()
                                                        {
                                                            MajorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")),
                                                            MinorTickBrush = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000"))
                                                        };
                                                        #region REND
                                                        CustomScaleLabelPresentation customScaleLabelPresentation = new CustomScaleLabelPresentation();

                                                        ControlTemplate labelTemplate = new ControlTemplate();

                                                        FrameworkElementFactory textBlockFactory = new FrameworkElementFactory(typeof(TextBlock));
                                                        textBlockFactory.SetBinding(TextBlock.TextProperty, new Binding("Text"));
                                                        textBlockFactory.SetValue(TextBlock.ForegroundProperty, new SolidColorBrush((Color)ColorConverter.ConvertFromString("#000000")));
                                                        textBlockFactory.SetValue(TextBlock.MarginProperty, new Thickness(-1, -10, 0, 0));

                                                        labelTemplate.VisualTree = textBlockFactory;

                                                        // Set the LabelTemplate for CustomScaleLabelPresentation
                                                        customScaleLabelPresentation.LabelTemplate = labelTemplate;

                                                        // Set CustomScaleLabelPresentation for LinearScale.LabelPresentation
                                                        linearScale.LabelPresentation = customScaleLabelPresentation;
                                                        linearnightScale.LabelPresentation = customScaleLabelPresentation;


                                                        #endregion
                                                    }
                                                    double BarStartValue = 0;
                                                    double BarEndValue = 0;
                                                    BarStartValue = shiftStartDate.Value.Hour;
                                                    double endminute = shiftEndDate.Value.Minute;
                                                    BarEndValue = shiftEndDate.Value.Hour + 1;



                                                    TimeSpan BarStartTime = TimeSpan.FromHours(BarStartValue);
                                                    TimeSpan BarEndTime = TimeSpan.FromHours(BarEndValue);
                                                    //BarStartValue = 22;
                                                    //BarEndValue = 5;
                                                    #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                    //if ((EmpIsNightShift == 1 || ((MinAtt_Date != null && MaxAtt_Date != null) && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date)) && IsAttendance==true)//[GEOS2-8189][rani dhamankar][04-06-2025]
                                                    if ((EmpIsNightShift == 1 || (IsAttendance == true && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date)) && IsAttendance == true)
                                                    {
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        {
                                                            linearScale.StartValue = BarStartValue; // Start at 10.30 hours
                                                            linearScale.EndValue = BarEndValue; // End at 13.00 hours
                                                            linearScale.MajorIntervalCount = (int)Math.Round((BarEndValue - BarStartValue), 0);
                                                        }
                                                        else
                                                        {

                                                            #endregion
                                                            // double LinearscaleStartTime = (employee.ShiftStartTime).TotalHours;
                                                            linearScale.StartValue = BarStartValue; // Start at 10.30 hours
                                                            linearScale.EndValue = 24; // End at 13.00 hours
                                                            linearnightScale.StartValue = 0;

                                                            //double LinearnightScaleEndTime = (employee.ShiftEndTime).TotalHours;

                                                            //[GEOS2-6662][gulab lakade][18 12 2024]
                                                            if (TotalHours_0 > BarEndValue)
                                                            {
                                                                //[GEOS2-7755][gulab lakade ][22 04 2025]
                                                                //TotalHours_0 = shiftEndDate.Value.TimeOfDay.TotalHours;
                                                                BarEndValue = TotalHours_0;
                                                            }

                                                            //double LinearnightScaleEndTime = BarEndValue;
                                                            linearnightScale.EndValue = BarEndValue;


                                                            // TotalHours_24=24- BarStartValue;//[GEOS2-6662][gulab lakade][18 12 2024]
                                                            if ((int)Math.Round(TotalHours_24, 0) <= 0)
                                                            {
                                                                linearScale.MajorIntervalCount = 1;
                                                            }
                                                            else
                                                            {
                                                                //linearScale.MajorIntervalCount = (int)Math.Round(TotalHours_24, 0);
                                                                linearScale.MajorIntervalCount = (int)Math.Round((24 - BarStartValue), 0);//[GEOS2-6662][gulab lakade][18 12 2024]
                                                            }

                                                            if ((int)Math.Round(TotalHours_0, 0) <= 0)
                                                            {
                                                                linearnightScale.MajorIntervalCount = 1;
                                                            }
                                                            else
                                                            {
                                                                linearnightScale.MajorIntervalCount = (int)Math.Round(TotalHours_0, 0);
                                                            }

                                                            linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                ShowFirst = false
                                                            };
                                                            linearScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {

                                                                Offset = -45


                                                            };
                                                            linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                ShowFirst = false,
                                                                Offset = -45


                                                            };
                                                        }//start[GEOS2-5515][gulab lakade][28 03 2024]
                                                    }
                                                    /* else if (EmpIsNightShift == 1 && employee.LeavesAllDayEvent == 1)//[GEOS2-8189][rani dhamankar][03-06-2025]//[GEOS2-8781] [ra*/
                                                    else if (EmpIsNightShift == 1 && IsAttendance == false)//[GEOS2-8189][rani dhamankar][03-06-2025]//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                    {
                                                        if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        {
                                                            linearScale.StartValue = BarStartValue; // Start at 10.30 hours
                                                            linearScale.EndValue = BarEndValue; // End at 13.00 hours
                                                            linearScale.MajorIntervalCount = (int)Math.Round((BarEndValue - BarStartValue), 0);
                                                        }
                                                        else
                                                        {
                                                            linearScale.StartValue = BarStartValue; // Start at 16.00 hours
                                                            linearScale.EndValue = 24; // End at 00.30 hours
                                                            linearnightScale.StartValue = 0;
                                                            linearnightScale.EndValue = BarEndValue;
                                                            if ((int)Math.Round(TotalHours_24, 0) <= 0)
                                                            {
                                                                linearScale.MajorIntervalCount = (int)BarEndValue - (int)BarStartValue;//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                            }
                                                            else
                                                            {
                                                                linearScale.MajorIntervalCount = (int)Math.Round((24 - BarStartValue), 0);
                                                            }

                                                            if ((int)Math.Round(TotalHours_0, 0) <= 0)
                                                            {
                                                                linearScale.MajorIntervalCount = (int)BarEndValue - (int)BarStartValue;//[GEOS2-8781] [rani dhamankar][03-07-2025]
                                                            }
                                                            else
                                                            {
                                                                linearnightScale.MajorIntervalCount = (int)Math.Round(TotalHours_0, 0);
                                                            }

                                                            linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                ShowFirst = false
                                                            };
                                                            linearScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                Offset = -45
                                                            };
                                                            linearnightScale.LabelOptions = new LinearScaleLabelOptions()
                                                            {
                                                                ShowFirst = false,
                                                                Offset = -45
                                                            };
                                                        }

                                                    }
                                                    else
                                                    {

                                                        //linearScale.StartValue = ShiftStartTime; // Start at 10.30 hours
                                                        linearScale.StartValue = BarStartValue; // Start at 10.30 hours

                                                        //linearScale.EndValue = ShiftEndTime; // End at 13.00 hours
                                                        linearScale.EndValue = BarEndValue; // End at 13.00 hours

                                                        TimeSpan totalHours = new TimeSpan();

                                                        int timeInterval = 1;

                                                        if (BarStartValue != BarEndValue)
                                                        {
                                                            if (BarEndValue > BarStartValue)
                                                            {
                                                                double TempTimeDifference = BarEndValue - BarStartValue;
                                                                //double TempTimeDifference = Math.Round((Convert.ToDouble((totalHours).TotalMinutes) / 60), 0);
                                                                timeInterval = Convert.ToInt32(Math.Round((TempTimeDifference), 0));
                                                            }
                                                        }
                                                        linearScale.MajorIntervalCount = timeInterval;

                                                        #region [pallavi jadhav] [GEOS2-5743][05-06-2024]

                                                        linearScale.MinorIntervalCount = 4;
                                                        linearnightScale.MinorIntervalCount = 4;

                                                        #endregion
                                                    }
                                                    #endregion


                                                    #region logged and Pause type(break time)
                                                    TimeSpan OldStartTime = new TimeSpan();
                                                    TimeSpan OldEndTime = new TimeSpan();
                                                    TimeSpan NewStartTime = new TimeSpan();
                                                    TimeSpan NewEndTime = new TimeSpan();

                                                    double TotalBreakTimeForToolTip = 0;
                                                    double TotalLoggedTimeForToolTip = 0;
                                                    double TotalpauseTimeForToolTip = 0;


                                                    double OldEndTimeIndoble = 0;
                                                    double OldStartTimeIndoble = 0;
                                                    double MaintanceTimeIndouble = 0;

                                                    //if (employeelist.Count() > 0)
                                                    if (ERM_EmployeeDetails.Count() > 0)
                                                    {
                                                        #region pausetime
                                                        #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                        //if ((EmpIsNightShift == 1 || ((MinAtt_Date != null && MaxAtt_Date != null) && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date)) && IsAttendance==true)//[GEOS2-8189][rani dhamankar][03-06-2025]
                                                        if ((EmpIsNightShift == 1 || (IsAttendance == true && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date)) && IsAttendance == true)
                                                        {
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                UnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearScale.Ranges.Add(UnLoggBar);
                                                            }
                                                            else
                                                            {
                                                                #endregion
                                                                LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                UnLoggBar.EndValue = new RangeValue(24);
                                                                UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearScale.Ranges.Add(UnLoggBar);
                                                                LinearScaleRange NightShiftUnLoggBar = new LinearScaleRange();
                                                                NightShiftUnLoggBar.StartValue = new RangeValue(0);
                                                                NightShiftUnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                NightShiftUnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                NightShiftUnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearnightScale.Ranges.Add(NightShiftUnLoggBar);
                                                            }// [GEOS2-7755][gulab lakade][08 04 2025]
                                                        }
                                                        else if (EmpIsNightShift == 1 && IsAttendance == false)
                                                        {
                                                            #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                            if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                            {
                                                                LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                UnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearScale.Ranges.Add(UnLoggBar);
                                                            }
                                                            else
                                                            {
                                                                #endregion
                                                                LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                                UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                                UnLoggBar.EndValue = new RangeValue(24);
                                                                UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearScale.Ranges.Add(UnLoggBar);
                                                                LinearScaleRange NightShiftUnLoggBar = new LinearScaleRange();
                                                                NightShiftUnLoggBar.StartValue = new RangeValue(0);
                                                                NightShiftUnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                NightShiftUnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                NightShiftUnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                                linearnightScale.Ranges.Add(NightShiftUnLoggBar);
                                                            }// [GEOS2-7755][gulab lakade][08 04 2025]
                                                        }
                                                        else
                                                        {
                                                            LinearScaleRange UnLoggBar = new LinearScaleRange();
                                                            UnLoggBar.StartValue = new RangeValue(BarStartValue);
                                                            UnLoggBar.EndValue = new RangeValue(BarEndValue);
                                                            UnLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                            UnLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString("#ea2b1f")) };
                                                            linearScale.Ranges.Add(UnLoggBar);
                                                        }
                                                        #endregion
                                                        #endregion
                                                        #region LoggedTime
                                                        #region [GEOS2-8862][gulab lakade][28 07 2025]
                                                        #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]

                                                        var LoggedTimeData = tmpTrackingData
                                                            .GroupBy(x => x.StartDate)
                                                            .Select(grp => grp.OrderByDescending(t => t.EndDate).FirstOrDefault())
                                                            .OrderBy(a => a.StartDate).ToList();
                                                        #endregion
                                                        #endregion
                                                        #region OT_Working_Time [GEOS2-9393][pallavi jadhav][12 11 2025]
                                                        if (tmpOT_Workingdata.Count() > 0)
                                                        {


                                                            var LoggedTimeDataOTWorkingTime = tmpOT_Workingdata
                                                                .GroupBy(x => x.StartDate)
                                                                .Select(grp => grp.OrderByDescending(t => t.EndDate).FirstOrDefault())
                                                                .OrderBy(a => a.StartDate).ToList();
                                                            if (LoggedTimeDataOTWorkingTime.Count() > 0)
                                                            {
                                                                LoggedTimeData.AddRange(
                                                                 LoggedTimeDataOTWorkingTime.Select(x => new Counterpartstracking
                                                                 {
                                                                     IdStage = Convert.ToInt32(x.OTWorking_IdStage),
                                                                     StageCode = x.StageCode,
                                                                     IdOperator = x.IdOperator,
                                                                     StartDate = x.StartDate,
                                                                     EndDate = x.EndDate,
                                                                     CounterPartStartTime = x.StartTime,
                                                                     CounterPartEndTime = x.EndTime,
                                                                     CalenderWeek = x.CalenderWeek

                                                                 })
                                                             );

                                                            }
                                                        }
                                                        #endregion

                                                        if (LoggedTimeData.Count() > 0)
                                                        {
                                                            int ttcount = 0;
                                                            int logCount = 0;
                                                            int TotallogCount = LoggedTimeData.Count() - 1;
                                                            //TimeSpan LastEndTime = new TimeSpan();//[GEOS2-6771][gulab lakade][04 2 2025]
                                                            DateTime LastEndTime = new DateTime();
                                                            //LastEndTime = TimeSpan.Zero;
                                                            LastEndTime = Convert.ToDateTime("1900-01-01");//[GEOS2-6771][gulab lakade][04 2 2025]
                                                            foreach (var logtime in LoggedTimeData)
                                                            {
                                                                ttcount = ttcount + 1;
                                                                bool checkDuplicateValue = true;
                                                                //if (LastEndTime != TimeSpan.Zero)
                                                                if (LastEndTime != Convert.ToDateTime("1900-01-01"))//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                {

                                                                    //if (LastEndTime <= logtime.CounterPartStartTime)
                                                                    if (LastEndTime <= logtime.StartDate)//[GEOS2-6771][gulab lakade][04 2 2025]
                                                                    {
                                                                        checkDuplicateValue = false;
                                                                    }
                                                                    else
                                                                    if (LastEndTime >= logtime.StartDate && LastEndTime < logtime.EndDate)//[GEOS2-8862][gulab lakade][28 07 2025]
                                                                    {
                                                                        logtime.StartDate = LastEndTime;//[GEOS2-8862][gulab lakade][28 07 2025]
                                                                        checkDuplicateValue = false;
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    checkDuplicateValue = false;
                                                                }


                                                                if (checkDuplicateValue == false)
                                                                {
                                                                    //LastEndTime = logtime.CounterPartEndTime;//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                    #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                    //if (EmpIsNightShift == 1 || ((MinAtt_Date != null && MaxAtt_Date != null) && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date))
                                                                    if (EmpIsNightShift == 1 || (IsAttendance == true && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date))
                                                                    {
                                                                        #region [GEOS2-6771][gulab lakade][05 04 2025]
                                                                        DateTime TempStartATDate = new DateTime();
                                                                        DateTime TempEndATDate = new DateTime();

                                                                        //if (logtime.AttendanceStartDate == null)
                                                                        if (IsAttendance == false)
                                                                        {
                                                                            //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                            //TempStartATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftStartTime);
                                                                            //TempEndATDate = Convert.ToDateTime(itemDate.Key.Date + logtime.ShiftEndTime);
                                                                            TempStartATDate = Convert.ToDateTime(shiftStartDate);
                                                                            TempEndATDate = Convert.ToDateTime(shiftEndDate);
                                                                            //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                        }
                                                                        else
                                                                        {
                                                                            //[GEOS2-7755][gulab lakade][17 04 2025]
                                                                            TempStartATDate = Convert.ToDateTime(MinAtt_Date);
                                                                            TempEndATDate = Convert.ToDateTime(MaxAtt_Date);
                                                                            //end[GEOS2-7755][gulab lakade][17 04 2025]
                                                                        }
                                                                        DateTime CPTStartDate = logtime.StartDate.Value;
                                                                        DateTime CPTEndDate = logtime.EndDate.Value;
                                                                        #endregion

                                                                        //if ((logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date && logtime.CounterpartStartDate.Value.TimeOfDay >= logtime.ShiftStartTime) || (logtime.CounterpartStartDate.Value.Date == itemDate.Key.Date.AddDays(1) && logtime.EndDate.Value.TimeOfDay <= logtime.ShiftEndTime))
                                                                        if (TempStartATDate <= CPTStartDate && TempEndATDate >= CPTEndDate)
                                                                        {
                                                                            //double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                            //double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                            double StartTimeIndouble = Math.Round(logtime.StartDate.Value.TimeOfDay.TotalHours, 4);
                                                                            double EndTimeIndouble = Math.Round(logtime.EndDate.Value.TimeOfDay.TotalHours, 4);



                                                                            #region Lineargauge 
                                                                            //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble >= (employee.ShiftEndTime).TotalHours)
                                                                            if (TempStartATDate.Date == CPTStartDate.Date && CPTStartDate.Date == CPTEndDate.Date)
                                                                            {
                                                                                //if (logtime.EndDate.Value.Date > logtime.CounterpartStartDate.Value.Date)
                                                                                //if (logtime.EndDate.Value.TimeOfDay > logtime.CounterpartStartDate.Value.TimeOfDay)
                                                                                if (CPTEndDate > CPTStartDate)
                                                                                {
                                                                                    TimeSpan LoggTimeDiffernce = logtime.EndDate.Value.Subtract(logtime.StartDate.Value);
                                                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = logtime.ProductionActivityTimeType;
                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                    if (tempsequence != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                    }
                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                    {
                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                    }
                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    #endregion
                                                                                    LastEndTime = Convert.ToDateTime(logtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                }
                                                                                else
                                                                                {
                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = logtime.ProductionActivityTimeType;
                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                    if (tempsequence != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                    }
                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                    {
                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                    }
                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    #endregion
                                                                                    LastEndTime = Convert.ToDateTime(logtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]

                                                                                }


                                                                                LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                if (string.IsNullOrEmpty(logTimeColor))
                                                                                {
                                                                                    //logTimeColor = "#0000FF";
                                                                                    logTimeColor = "#00b54d";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "LoggedType";
                                                                                //SelectedTooltips1.AttendanceStartDate = MinAtt_Date;
                                                                                /* SelectedTooltips.AttendanceStartDate = (IsAttendance==false  ? employee.CounterpartStartDate : MinAtt_Date);//[GEOS2-5418]*/
                                                                                SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? logtime.StartDate : MinAtt_Date);
                                                                                SelectedTooltips.ToolTipsType = "Working";
                                                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                if (!string.IsNullOrEmpty(logtime.StageCode))
                                                                                {
                                                                                    SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                }
                                                                                // SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                SelectedTooltips.IdStage = logtime.IdStage;
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? logtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == logtime.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearScale.Ranges.Add(LoggBar);
                                                                            }
                                                                            #region [GEOS2-6771][gulab lakade][05 04 2025]
                                                                            else
                                                                            {

                                                                                //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble <= (employee.ShiftEndTime).TotalHours)
                                                                                if (CPTStartDate.Date < CPTEndDate.Date)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                                                {
                                                                                    #region Linearscale
                                                                                    DateTime stdt = logtime.StartDate.Value;
                                                                                    DateTime endt = logtime.EndDate.Value;
                                                                                    TimeSpan LoggTimeDiffernce = Hours_24.Subtract(logtime.StartDate.Value.TimeOfDay);
                                                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = logtime.ProductionActivityTimeType;
                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                    if (tempsequence != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                    }
                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                    {
                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                    }
                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    #endregion

                                                                                    LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                    LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                    LoggBar.EndValue = new RangeValue(Hours_24.TotalHours);
                                                                                    LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                                                    string logTimeColor1 = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                    if (string.IsNullOrEmpty(logTimeColor1))
                                                                                    {
                                                                                        //logTimeColor = "#0000FF";
                                                                                        logTimeColor1 = "#00b54d";
                                                                                    }
                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                    LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor1)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips1.ToolTipsStartTime = StartTimeIndouble;
                                                                                    //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                                                    SelectedTooltips1.ToolTipsEndTime = 1439; //Hours_24.TotalHours;
                                                                                    SelectedTooltips1.BarTypeName = "LoggedType";
                                                                                    //SelectedTooltips1.AttendanceStartDate = MinAtt_Date;
                                                                                    SelectedTooltips1.AttendanceStartDate = (IsAttendance == false ? logtime.StartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    SelectedTooltips1.ToolTipsType = "Working";
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips1.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    if (!string.IsNullOrEmpty(logtime.StageCode))
                                                                                    {
                                                                                        SelectedTooltips1.LogStationStage = Convert.ToString(logtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    }
                                                                                    //SelectedTooltips1.PauseTypeId = logtime.PauseTypeId;
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips1.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                    SelectedTooltips1.IdStage = logtime.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == Hours_24.TotalHours && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? logtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == logtime.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                    }

                                                                                    #endregion
                                                                                    linearScale.Ranges.Add(LoggBar);
                                                                                    #endregion

                                                                                    #region Linear_NightShit

                                                                                    TimeSpan LoggTimeDiffernce1 = logtime.EndDate.Value.TimeOfDay.Subtract(Hours_0);
                                                                                    double LoggTimeDiffernceIndouble1 = Math.Round((Convert.ToDouble(LoggTimeDiffernce1.TotalMinutes) / 60), 4);
                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble1;

                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble1;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = logtime.ProductionActivityTimeType;
                                                                                    var tempsequence1 = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                    if (tempsequence1 != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence1.Sequence;
                                                                                    }
                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                    {
                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                    }
                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    #endregion

                                                                                    LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                    NightShftLoggBar.StartValue = new RangeValue(0);
                                                                                    NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                    NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                                                    {
                                                                                        //logTimeColor = "#0000FF";
                                                                                        logTimeColor = "#00b54d";
                                                                                    }
                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                    NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = 0;
                                                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                                                    //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                                    SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? logtime.StartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    SelectedTooltips.ToolTipsType = "Working";
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    if (!string.IsNullOrEmpty(logtime.StageCode))
                                                                                    {
                                                                                        SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    }
                                                                                    //SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                    SelectedTooltips.IdStage = logtime.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? logtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == logtime.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                    #endregion
                                                                                    LastEndTime = Convert.ToDateTime(logtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                }
                                                                                else
                                                                                {
                                                                                    #region Linear_NightShit
                                                                                    if (logtime.EndDate.Value.Date > logtime.StartDate.Value.Date)
                                                                                    {
                                                                                        TimeSpan LoggTimeDiffernce = logtime.EndDate.Value.Subtract(logtime.StartDate.Value);
                                                                                        double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = logtime.ProductionActivityTimeType;
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        #endregion
                                                                                        LastEndTime = Convert.ToDateTime(logtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                        #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = logtime.ProductionActivityTimeType;
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        #endregion
                                                                                        LastEndTime = Convert.ToDateTime(logtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                                                    }


                                                                                    LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                                                    NightShftLoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                    NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                    NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                                                    {
                                                                                        //logTimeColor = "#0000FF";
                                                                                        logTimeColor = "#00b54d";
                                                                                    }
                                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                    NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                                                    //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                                    SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? logtime.StartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    SelectedTooltips.ToolTipsType = "Working";
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    if (!string.IsNullOrEmpty(logtime.StageCode))
                                                                                    {
                                                                                        SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    }
                                                                                    //SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                    SelectedTooltips.IdStage = logtime.IdStage;
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? logtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == logtime.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearnightScale.Ranges.Add(NightShftLoggBar);
                                                                                    #endregion
                                                                                }

                                                                            }
                                                                            #endregion
                                                                            #endregion

                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        if (logtime.StartDate != null && logtime.EndDate != null)
                                                                        {
                                                                            //double StartTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartStartTime.TotalMinutes) / 60), 4);
                                                                            //double EndTimeIndouble = Math.Round((Convert.ToDouble(logtime.CounterPartEndTime.TotalMinutes) / 60), 4);
                                                                            double StartTimeIndouble = Math.Round(logtime.StartDate.Value.TimeOfDay.TotalHours, 4);
                                                                            double EndTimeIndouble = Math.Round(logtime.EndDate.Value.TimeOfDay.TotalHours, 4);
                                                                            if (BarEndValue >= EndTimeIndouble && BarStartValue <= StartTimeIndouble && logtime.StartDate.Value.Date == logtime.EndDate.Value.Date)
                                                                            {
                                                                                if (logtime.EndDate.Value.Date > logtime.StartDate.Value.Date)
                                                                                {
                                                                                    TimeSpan LoggTimeDiffernce = logtime.EndDate.Value.Subtract(logtime.StartDate.Value);
                                                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = logtime.ProductionActivityTimeType;
                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                    if (tempsequence != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                    }
                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                    {
                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                    }
                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    #endregion
                                                                                }
                                                                                else
                                                                                {
                                                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = logtime.StageCode;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = logtime.ProductionActivityTimeType;
                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == logtime.StageCode).FirstOrDefault();
                                                                                    if (tempsequence != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                    }
                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                    {
                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                    }
                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    #endregion
                                                                                }

                                                                                LinearScaleRange LoggBar = new LinearScaleRange();
                                                                                LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                                                LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                                                LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                                                string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;

                                                                                if (string.IsNullOrEmpty(logTimeColor))
                                                                                {
                                                                                    //logTimeColor = "#0000FF";
                                                                                    logTimeColor = "#00b54d";
                                                                                }
                                                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                                LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                                                SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "LoggedType";
                                                                                //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                                SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? logtime.StartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                SelectedTooltips.ToolTipsType = "Working";
                                                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                if (!string.IsNullOrEmpty(logtime.StageCode))
                                                                                {
                                                                                    SelectedTooltips.LogStationStage = Convert.ToString(logtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                }
                                                                                //SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                                                SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                SelectedTooltips.IdStage = logtime.IdStage;
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? logtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == logtime.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearScale.Ranges.Add(LoggBar);
                                                                                LastEndTime = Convert.ToDateTime(logtime.EndDate);//[GEOS2-7755][gulab lakade][08 04 2025]

                                                                            }
                                                                        }
                                                                    }

                                                                    #endregion

                                                                }
                                                            }
                                                        }

                                                        #endregion
                                                        #endregion

                                                        #region [GEOS2-7091][rani dhamankar][11 09 2025] LoggedTime for design shared OT time 
                                                        //List<Counterpartstracking> SharedItemTimeTrackinglist = new List<Counterpartstracking>();
                                                        //var empuserid = ERM_EmployeeDetails.Where(a => a.IdEmployee == emp.Key).Select(x => x.IdUser).SingleOrDefault();
                                                        //if (empuserid != 0)
                                                        //{
                                                        //    try
                                                        //    {
                                                        //        //var desDetails = DesignSharedItemsEmployeeDetails.Where(a => a.SharedDate.Value.Date >= itemDate.Date && a.ReturnedDate.Value.Date <= itemDate.Date && a.IdDesignerFromConsumerPlant == Convert.ToInt32(empuserid)).FirstOrDefault();
                                                        //        var desDetails = DesignSharedItemsEmployeeDetails
                                                        //                .Where(a => a.SharedDate.HasValue
                                                        //                         && a.ReturnedDate.HasValue
                                                        //                         && a.SharedDate.Value.Date <= itemDate.Date
                                                        //                         && a.ReturnedDate.Value.Date >= itemDate.Date
                                                        //                         && a.IdDesignerFromConsumerPlant == Convert.ToInt32(empuserid))
                                                        //                .FirstOrDefault();
                                                        //        if (desDetails != null)
                                                        //        {
                                                        //            try
                                                        //            {
                                                        //                //SharedItemTimeTrackinglist = ERM_SharedOtCounterpartstracking.Where(a => a.StartDate.Value.Date == itemDate.Date && a.EndDate.Value.Date == itemDate.Date && a.IdOperator == Convert.ToInt16(empuserid) && a.IdSite == desDetails.IdSiteConsumerPlant ).ToList();
                                                        //                SharedItemTimeTrackinglist = ERM_SharedOtCounterpartstracking
                                                        //                                      .Where(a => a.StartDate.HasValue
                                                        //                                               && a.EndDate.HasValue
                                                        //                                               && a.StartDate.Value.Date <= itemDate.Date
                                                        //                                               && a.EndDate.Value.Date >= itemDate.Date
                                                        //                                               && a.IdOperator == Convert.ToInt16(empuserid)
                                                        //                                               && a.IdSite == desDetails.IdSiteOwnersPlant)
                                                        //                                      .ToList();
                                                        //                if (SharedItemTimeTrackinglist != null && SharedItemTimeTrackinglist.Count > 0)
                                                        //                {
                                                        //                    List<Counterpartstracking> DesignSharedOtTimeData = null;
                                                        //                    DesignSharedOtTimeData = SharedItemTimeTrackinglist
                                                        //                       .GroupBy(x => x.StartDate)
                                                        //                       .Select(grp => grp.OrderByDescending(t => t.EndDate).FirstOrDefault())
                                                        //                       .OrderBy(a => a.StartDate).ToList();
                                                        //                    if (DesignSharedOtTimeData.Count() > 0)
                                                        //                    {
                                                        //                        int ttcount = 0;
                                                        //                        int logCount = 0;
                                                        //                        int TotallogCount = DesignSharedOtTimeData.Count() - 1;
                                                        //                        DateTime LastEndTime = new DateTime();
                                                        //                        LastEndTime = Convert.ToDateTime("1900-01-01");
                                                        //                        foreach (var Dslogtime in DesignSharedOtTimeData)
                                                        //                        {
                                                        //                            try
                                                        //                            {
                                                        //                                ttcount = ttcount + 1;
                                                        //                                bool checkDuplicateValue = true;
                                                        //                                //if (LastEndTime != TimeSpan.Zero)
                                                        //                                if (LastEndTime != Convert.ToDateTime("1900-01-01"))
                                                        //                                {
                                                        //                                    if (LastEndTime <= Dslogtime.StartDate)
                                                        //                                    {
                                                        //                                        checkDuplicateValue = false;
                                                        //                                    }
                                                        //                                    else
                                                        //                                    if (LastEndTime >= Dslogtime.StartDate && LastEndTime < Dslogtime.EndDate)
                                                        //                                    {
                                                        //                                        Dslogtime.StartDate = LastEndTime;
                                                        //                                        checkDuplicateValue = false;
                                                        //                                    }
                                                        //                                }
                                                        //                                else
                                                        //                                {
                                                        //                                    checkDuplicateValue = false;
                                                        //                                }


                                                        //                                if (checkDuplicateValue == false)
                                                        //                                {
                                                        //                                    if (EmpIsNightShift == 1 || (IsAttendance == true && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date))
                                                        //                                    {

                                                        //                                        DateTime TempStartATDate = new DateTime();
                                                        //                                        DateTime TempEndATDate = new DateTime();

                                                        //                                        if (IsAttendance == false)
                                                        //                                        {
                                                        //                                            TempStartATDate = Convert.ToDateTime(shiftStartDate);
                                                        //                                            TempEndATDate = Convert.ToDateTime(shiftEndDate);
                                                        //                                        }
                                                        //                                        else
                                                        //                                        {
                                                        //                                            TempStartATDate = Convert.ToDateTime(MinAtt_Date);
                                                        //                                            TempEndATDate = Convert.ToDateTime(MaxAtt_Date);
                                                        //                                        }
                                                        //                                        DateTime CPTStartDate = Dslogtime.StartDate.Value;
                                                        //                                        DateTime CPTEndDate = Dslogtime.EndDate.Value;



                                                        //                                        if (TempStartATDate <= CPTStartDate && TempEndATDate >= CPTEndDate)
                                                        //                                        {
                                                        //                                            double StartTimeIndouble = Math.Round(Dslogtime.StartDate.Value.TimeOfDay.TotalHours, 4);
                                                        //                                            double EndTimeIndouble = Math.Round(Dslogtime.EndDate.Value.TimeOfDay.TotalHours, 4);
                                                        //                                            #region Lineargauge 
                                                        //                                            //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble >= (employee.ShiftEndTime).TotalHours)
                                                        //                                            if (TempStartATDate.Date == CPTStartDate.Date && CPTStartDate.Date == CPTEndDate.Date)
                                                        //                                            {
                                                        //                                                if (CPTEndDate > CPTStartDate)
                                                        //                                                {
                                                        //                                                    TimeSpan LoggTimeDiffernce = Dslogtime.EndDate.Value.Subtract(Dslogtime.StartDate.Value);
                                                        //                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                        //                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;

                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = Dslogtime.StageCode;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = Dslogtime.ProductionActivityTimeType;
                                                        //                                                    var tempsequence = TempStageList.Where(x => x.StageCode == Dslogtime.StageCode).FirstOrDefault();
                                                        //                                                    if (tempsequence != null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                        //                                                    }
                                                        //                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        //                                                    }
                                                        //                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);

                                                        //                                                    LastEndTime = Convert.ToDateTime(Dslogtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                        //                                                }
                                                        //                                                else
                                                        //                                                {
                                                        //                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);

                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = Dslogtime.StageCode;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = Dslogtime.ProductionActivityTimeType;
                                                        //                                                    var tempsequence = TempStageList.Where(x => x.StageCode == Dslogtime.StageCode).FirstOrDefault();
                                                        //                                                    if (tempsequence != null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                        //                                                    }
                                                        //                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        //                                                    }
                                                        //                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);

                                                        //                                                    LastEndTime = Convert.ToDateTime(Dslogtime.EndDate);

                                                        //                                                }


                                                        //                                                LinearScaleRange LoggBar = new LinearScaleRange();
                                                        //                                                LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                        //                                                LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                        //                                                LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                        //                                                string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;
                                                        //                                                                                //string logTimeColor = "#00a0b5";//temp color
                                                        //                                                if (string.IsNullOrEmpty(logTimeColor))
                                                        //                                                {
                                                        //                                                    logTimeColor = "#00b54d";
                                                        //                                                }
                                                        //                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                        //                                                LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };

                                                        //                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                        //                                                SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                        //                                                //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                        //                                                SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                        //                                                SelectedTooltips.BarTypeName = "LoggedType";
                                                        //                                                //SelectedTooltips1.AttendanceStartDate = MinAtt_Date;
                                                        //                                                /* SelectedTooltips.AttendanceStartDate = (IsAttendance==false  ? employee.CounterpartStartDate : MinAtt_Date);//[GEOS2-5418]*/
                                                        //                                                SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date);
                                                        //                                                SelectedTooltips.ToolTipsType = "Working";
                                                        //                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                if (!string.IsNullOrEmpty(Dslogtime.StageCode))
                                                        //                                                {
                                                        //                                                    SelectedTooltips.LogStationStage = Convert.ToString(Dslogtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                }
                                                        //                                                // SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                        //                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                        //                                                SelectedTooltips.IdStage = Convert.ToInt32(Dslogtime.IdStage);
                                                        //                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                        //                                                {
                                                        //                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                        //                                                    {
                                                        //                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                        //                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == Convert.ToInt32(Dslogtime.IdStage)).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                        if (Tooltipdata == null)
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                        }
                                                        //                                                    }
                                                        //                                                    else
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                    }
                                                        //                                                }
                                                        //                                                else
                                                        //                                                {
                                                        //                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                        //                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                }


                                                        //                                                linearScale.Ranges.Add(LoggBar);
                                                        //                                            }

                                                        //                                            else
                                                        //                                            {

                                                        //                                                //if (StartTimeIndouble >= (employee.ShiftEndTime).TotalHours && EndTimeIndouble <= (employee.ShiftEndTime).TotalHours)
                                                        //                                                if (CPTStartDate.Date < CPTEndDate.Date)//[GEOS2-6771][gulab lakade][05 04 2025]
                                                        //                                                {
                                                        //                                                    #region Linearscale
                                                        //                                                    DateTime stdt = Dslogtime.StartDate.Value;
                                                        //                                                    DateTime endt = Dslogtime.EndDate.Value;
                                                        //                                                    TimeSpan LoggTimeDiffernce = Hours_24.Subtract(Dslogtime.StartDate.Value.TimeOfDay);
                                                        //                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                        //                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;

                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = Dslogtime.StageCode;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = Dslogtime.ProductionActivityTimeType;
                                                        //                                                    var tempsequence = TempStageList.Where(x => x.StageCode == Dslogtime.StageCode).FirstOrDefault();
                                                        //                                                    if (tempsequence != null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                        //                                                    }
                                                        //                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        //                                                    }
                                                        //                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);


                                                        //                                                    LinearScaleRange LoggBar = new LinearScaleRange();
                                                        //                                                    LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                        //                                                    LoggBar.EndValue = new RangeValue(Hours_24.TotalHours);
                                                        //                                                    LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };

                                                        //                                                    string logTimeColor1 = "#00b54d";//logtime.AttendanceTypeColor;
                                                        //                                                                                     //string logTimeColor1 = "#00a0b5";
                                                        //                                                    if (string.IsNullOrEmpty(logTimeColor1))
                                                        //                                                    {
                                                        //                                                        //logTimeColor = "#0000FF";
                                                        //                                                        logTimeColor1 = "#00b54d";
                                                        //                                                    }
                                                        //                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                        //                                                    LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor1)) };

                                                        //                                                    ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                        //                                                    SelectedTooltips1.ToolTipsStartTime = StartTimeIndouble;
                                                        //                                                    //SelectedTooltips1.ToolTipsEndTime = EndTimeIndouble;
                                                        //                                                    SelectedTooltips1.ToolTipsEndTime = 1439; //Hours_24.TotalHours;
                                                        //                                                    SelectedTooltips1.BarTypeName = "LoggedType";
                                                        //                                                    //SelectedTooltips1.AttendanceStartDate = MinAtt_Date;
                                                        //                                                    SelectedTooltips1.AttendanceStartDate = (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                    SelectedTooltips1.ToolTipsType = "Working";
                                                        //                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    SelectedTooltips1.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    if (!string.IsNullOrEmpty(Dslogtime.StageCode))
                                                        //                                                    {
                                                        //                                                        SelectedTooltips1.LogStationStage = Convert.ToString(Dslogtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    }
                                                        //                                                    //SelectedTooltips1.PauseTypeId = logtime.PauseTypeId;
                                                        //                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    SelectedTooltips1.IdEmployee = employee_MainDetail.IdEmployee;
                                                        //                                                    SelectedTooltips1.IdStage = Convert.ToInt32(Dslogtime.IdStage);
                                                        //                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                        //                                                    {
                                                        //                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                        //                                                        {
                                                        //                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                        //                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == Hours_24.TotalHours && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == Convert.ToInt32(Dslogtime.IdStage)).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                            if (Tooltipdata == null)
                                                        //                                                            {
                                                        //                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                        //                                                            }
                                                        //                                                        }
                                                        //                                                        else
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                        //                                                        }
                                                        //                                                    }
                                                        //                                                    else
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                        //                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                        //                                                    }


                                                        //                                                    linearScale.Ranges.Add(LoggBar);
                                                        //                                                    #endregion

                                                        //                                                    #region Linear_NightShit

                                                        //                                                    TimeSpan LoggTimeDiffernce1 = Dslogtime.EndDate.Value.TimeOfDay.Subtract(Hours_0);
                                                        //                                                    double LoggTimeDiffernceIndouble1 = Math.Round((Convert.ToDouble(LoggTimeDiffernce1.TotalMinutes) / 60), 4);
                                                        //                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble1;


                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = Dslogtime.StageCode;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble1;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = Dslogtime.ProductionActivityTimeType;
                                                        //                                                    var tempsequence1 = TempStageList.Where(x => x.StageCode == Dslogtime.StageCode).FirstOrDefault();
                                                        //                                                    if (tempsequence1 != null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence1.Sequence;
                                                        //                                                    }
                                                        //                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        //                                                    }
                                                        //                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);


                                                        //                                                    LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                        //                                                    NightShftLoggBar.StartValue = new RangeValue(0);
                                                        //                                                    NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                        //                                                    NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                        //                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                        //                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                        //                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;
                                                        //                                                                                    //string logTimeColor = "#00a0b5";
                                                        //                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                        //                                                    {
                                                        //                                                        //logTimeColor = "#0000FF";
                                                        //                                                        logTimeColor = "#00b54d";
                                                        //                                                    }
                                                        //                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                        //                                                    NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };

                                                        //                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                        //                                                    SelectedTooltips.ToolTipsStartTime = 0;
                                                        //                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                        //                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                        //                                                    //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                        //                                                    SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                    SelectedTooltips.ToolTipsType = "Working";
                                                        //                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    if (!string.IsNullOrEmpty(Dslogtime.StageCode))
                                                        //                                                    {
                                                        //                                                        SelectedTooltips.LogStationStage = Convert.ToString(Dslogtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    }
                                                        //                                                    //SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                        //                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                        //                                                    SelectedTooltips.IdStage = Convert.ToInt32(Dslogtime.IdStage);
                                                        //                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                        //                                                    {
                                                        //                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                        //                                                        {
                                                        //                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                        //                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == Convert.ToInt32(Dslogtime.IdStage)).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                            if (Tooltipdata == null)
                                                        //                                                            {
                                                        //                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                            }
                                                        //                                                        }
                                                        //                                                        else
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                        }
                                                        //                                                    }
                                                        //                                                    else
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                        //                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                    }


                                                        //                                                    linearnightScale.Ranges.Add(NightShftLoggBar);
                                                        //                                                    #endregion
                                                        //                                                    LastEndTime = Convert.ToDateTime(Dslogtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                        //                                                }
                                                        //                                                else
                                                        //                                                {
                                                        //                                                    #region Linear_NightShit
                                                        //                                                    if (Dslogtime.EndDate.Value.Date > Dslogtime.StartDate.Value.Date)
                                                        //                                                    {
                                                        //                                                        TimeSpan LoggTimeDiffernce = Dslogtime.EndDate.Value.Subtract(Dslogtime.StartDate.Value);
                                                        //                                                        double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                        //                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;

                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = Dslogtime.StageCode;
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = Dslogtime.ProductionActivityTimeType;
                                                        //                                                        var tempsequence = TempStageList.Where(x => x.StageCode == Dslogtime.StageCode).FirstOrDefault();
                                                        //                                                        if (tempsequence != null)
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                        //                                                        }
                                                        //                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        //                                                        }
                                                        //                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);

                                                        //                                                        LastEndTime = Convert.ToDateTime(Dslogtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                        //                                                    }
                                                        //                                                    else
                                                        //                                                    {
                                                        //                                                        TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);

                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = Dslogtime.StageCode;
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = Dslogtime.ProductionActivityTimeType;
                                                        //                                                        var tempsequence = TempStageList.Where(x => x.StageCode == Dslogtime.StageCode).FirstOrDefault();
                                                        //                                                        if (tempsequence != null)
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                        //                                                        }
                                                        //                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        //                                                        }
                                                        //                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);

                                                        //                                                        LastEndTime = Convert.ToDateTime(Dslogtime.EndDate);//[GEOS2-6771][gulab lakade][04 02 2025]
                                                        //                                                    }


                                                        //                                                    LinearScaleRange NightShftLoggBar = new LinearScaleRange();
                                                        //                                                    NightShftLoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                        //                                                    NightShftLoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                        //                                                    NightShftLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                        //                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                        //                                                    //string logTimeColor = "#0000FF";//logtime.AttendanceTypeColor;
                                                        //                                                    string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;
                                                        //                                                                                    //string logTimeColor = "#00a0b5";
                                                        //                                                    if (string.IsNullOrEmpty(logTimeColor))
                                                        //                                                    {
                                                        //                                                        //logTimeColor = "#0000FF";
                                                        //                                                        logTimeColor = "#00b54d";
                                                        //                                                    }
                                                        //                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                        //                                                    NightShftLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };

                                                        //                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                        //                                                    SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                        //                                                    SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                        //                                                    SelectedTooltips.BarTypeName = "LoggedType";
                                                        //                                                    //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                        //                                                    SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                    SelectedTooltips.ToolTipsType = "Working";
                                                        //                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    if (!string.IsNullOrEmpty(Dslogtime.StageCode))
                                                        //                                                    {
                                                        //                                                        SelectedTooltips.LogStationStage = Convert.ToString(Dslogtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    }
                                                        //                                                    //SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                        //                                                    //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                        //                                                    SelectedTooltips.IdStage = Convert.ToInt32(Dslogtime.IdStage);
                                                        //                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                        //                                                    {
                                                        //                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                        //                                                        {
                                                        //                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                        //                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == Convert.ToInt32(Dslogtime.IdStage)).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                            if (Tooltipdata == null)
                                                        //                                                            {
                                                        //                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                            }
                                                        //                                                        }
                                                        //                                                        else
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                        }
                                                        //                                                    }
                                                        //                                                    else
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                        //                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                    }


                                                        //                                                    linearnightScale.Ranges.Add(NightShftLoggBar);
                                                        //                                                    #endregion
                                                        //                                                }

                                                        //                                            }

                                                        //                                            #endregion

                                                        //                                        }
                                                        //                                    }
                                                        //                                    else
                                                        //                                    {
                                                        //                                        if (Dslogtime.StartDate != null && Dslogtime.EndDate != null)
                                                        //                                        {

                                                        //                                            double StartTimeIndouble = Math.Round(Dslogtime.StartDate.Value.TimeOfDay.TotalHours, 4);
                                                        //                                            double EndTimeIndouble = Math.Round(Dslogtime.EndDate.Value.TimeOfDay.TotalHours, 4);
                                                        //                                            if (BarEndValue >= EndTimeIndouble && BarStartValue <= StartTimeIndouble && Dslogtime.StartDate.Value.Date == Dslogtime.EndDate.Value.Date)
                                                        //                                            {
                                                        //                                                if (Dslogtime.EndDate.Value.Date > Dslogtime.StartDate.Value.Date)
                                                        //                                                {
                                                        //                                                    TimeSpan LoggTimeDiffernce = Dslogtime.EndDate.Value.Subtract(Dslogtime.StartDate.Value);
                                                        //                                                    double LoggTimeDiffernceIndouble = Math.Round((Convert.ToDouble(LoggTimeDiffernce.TotalMinutes) / 60), 4);
                                                        //                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + LoggTimeDiffernceIndouble;
                                                        //                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = Dslogtime.StageCode;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = LoggTimeDiffernceIndouble;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = Dslogtime.ProductionActivityTimeType;
                                                        //                                                    var tempsequence = TempStageList.Where(x => x.StageCode == Dslogtime.StageCode).FirstOrDefault();
                                                        //                                                    if (tempsequence != null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                        //                                                    }
                                                        //                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        //                                                    }
                                                        //                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                        //                                                    #endregion
                                                        //                                                }
                                                        //                                                else
                                                        //                                                {
                                                        //                                                    TotalLoggedTimeForToolTip = TotalLoggedTimeForToolTip + (EndTimeIndouble - StartTimeIndouble);
                                                        //                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = Dslogtime.StageCode;
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = "Working";
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((EndTimeIndouble - StartTimeIndouble), 4);
                                                        //                                                    ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = Dslogtime.ProductionActivityTimeType;
                                                        //                                                    var tempsequence = TempStageList.Where(x => x.StageCode == Dslogtime.StageCode).FirstOrDefault();
                                                        //                                                    if (tempsequence != null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                        //                                                    }
                                                        //                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                        //                                                    }
                                                        //                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                        //                                                    #endregion
                                                        //                                                }

                                                        //                                                LinearScaleRange LoggBar = new LinearScaleRange();
                                                        //                                                LoggBar.StartValue = new RangeValue(StartTimeIndouble);
                                                        //                                                LoggBar.EndValue = new RangeValue(EndTimeIndouble);
                                                        //                                                LoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 }; ;
                                                        //                                                string logTimeColor = "#00b54d";//logtime.AttendanceTypeColor;
                                                        //                                                                                //string logTimeColor = "#00a0b5";
                                                        //                                                if (string.IsNullOrEmpty(logTimeColor))
                                                        //                                                {
                                                        //                                                    //logTimeColor = "#0000FF";
                                                        //                                                    logTimeColor = "#00b54d";
                                                        //                                                }
                                                        //                                                //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                        //                                                LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(logTimeColor)) };
                                                        //                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                        //                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                        //                                                SelectedTooltips.ToolTipsStartTime = StartTimeIndouble;
                                                        //                                                SelectedTooltips.ToolTipsEndTime = EndTimeIndouble;
                                                        //                                                SelectedTooltips.BarTypeName = "LoggedType";
                                                        //                                                //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                        //                                                SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                SelectedTooltips.ToolTipsType = "Working";
                                                        //                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                SelectedTooltips.LogStationName = "Logged Station";//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                if (!string.IsNullOrEmpty(Dslogtime.StageCode))
                                                        //                                                {
                                                        //                                                    SelectedTooltips.LogStationStage = Convert.ToString(Dslogtime.StageCode);//[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                }
                                                        //                                                //SelectedTooltips.PauseTypeId = logtime.PauseTypeId;
                                                        //                                                //[GEOS2-6554][gulab lakade][28 11 2024]
                                                        //                                                SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                        //                                                SelectedTooltips.IdStage = Convert.ToInt32(Dslogtime.IdStage);
                                                        //                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                        //                                                {
                                                        //                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                        //                                                    {
                                                        //                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                        //                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartTimeIndouble && x.ToolTipsEndTime == EndTimeIndouble && x.ToolTipsType == "Working" && x.AttendanceStartDate == (IsAttendance == false ? Dslogtime.StartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == Convert.ToInt32(Dslogtime.IdStage)).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                        //                                                        if (Tooltipdata == null)
                                                        //                                                        {
                                                        //                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                        }
                                                        //                                                    }
                                                        //                                                    else
                                                        //                                                    {
                                                        //                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                    }
                                                        //                                                }
                                                        //                                                else
                                                        //                                                {
                                                        //                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                        //                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                        //                                                }

                                                        //                                                #endregion
                                                        //                                                linearScale.Ranges.Add(LoggBar);
                                                        //                                                LastEndTime = Convert.ToDateTime(Dslogtime.EndDate);

                                                        //                                            }
                                                        //                                        }
                                                        //                                    }
                                                        //                                }
                                                        //                            }
                                                        //                            catch (Exception ex)
                                                        //                            {
                                                        //                                GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove() - Display DesignSharedOtTimeData", category: Category.Exception, priority: Priority.Low);
                                                        //                            }


                                                        //                        }
                                                        //                    }
                                                        //                }
                                                        //            }
                                                        //            catch (Exception ex)
                                                        //            {
                                                        //                GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()-Get Shared Design Tracking Details", category: Category.Exception, priority: Priority.Low);
                                                        //            }
                                                        //        }
                                                        //    }
                                                        //    catch (Exception ex)
                                                        //    {
                                                        //        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()-Get Shared Design Tracking Details", category: Category.Exception, priority: Priority.Low);
                                                        //    }
                                                        //}

                                                       

                                                        #endregion design shared OT time

                                                        #region Break Time
                                                        //[GEOS2-6965][rani dhamankar][12-03-2025]
                                                        #region [GEOS2-7902][gulab lakade][23 04 2025]
                                                        // [GEOS2-9197][pallavi jadhav][2025-09-02]

                                                        var onlyMeetingdata = tmpNO_OTdata;
                                                        if (onlyMeetingdata.Where(a => MeetingtypeId.Contains(a.PauseTypeId)).ToList().Count() > 0)
                                                        {
                                                            tmpNO_OTdata = tmpNO_OTdata.Where(a => a.PauseTypeId != 1725).ToList();
                                                        }
                                                        // [GEOS2-9197][pallavi jadhav][2025-09-02]

                                                        if (onlyMeetingdata.Where(a => MaintenanceId.Contains(a.PauseTypeId)).ToList().Count() > 0)
                                                        {
                                                            tmpNO_OTdata = tmpNO_OTdata.Where(a => a.PauseTypeId != 1724).ToList();
                                                        }
                                                        var BreakTimeData = tmpNO_OTdata.GroupBy(a => a.BreakStartDate)
                                                            .Select(grp => grp.FirstOrDefault())
                                                                                        .OrderBy(a => a.BreakStartDate)
                                                                                        .ToList();
                                                        #region OT_Working_Time [GEOS2-9393][pallavi jadhav][12 11 2025]
                                                       
                                                            //var tmpOT_Workingdatamatched = tmpNO_OTdata
                                                            //            .Where(x => tmpOT_Workingdata.Any(a => a.IdOperator == x.IdOperator&& a.OTWorking_IdStage==x.NonOT_IdStage&& a.StartDate==x.BreakStartDate&&a.EndDate==x.BreakEndDate))
                                                            //            .ToList();

                                                        #endregion
                                                        #endregion
                                                        if (BreakTimeData.Count() > 0)
                                                        {
                                                            #region [GEOS2-5394][gulab lakade][19 02 2024]
                                                            var GroupbyPouseType = BreakTimeData.GroupBy(x => x.PauseType).ToList();
                                                            if (GroupbyPouseType != null && GroupbyPouseType.Count() > 0)
                                                            {
                                                                foreach (var pauseitem in GroupbyPouseType)
                                                                {
                                                                    var RecordByPuaseType = BreakTimeData.Where(a => a.PauseType == pauseitem.Key).ToList();
                                                                    if (RecordByPuaseType != null && RecordByPuaseType.Count() > 0)
                                                                    {
                                                                        double TemppauseIndouble = 0;
                                                                        string Breakname = string.Empty;
                                                                        foreach (var record in RecordByPuaseType)
                                                                        {
                                                                            var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == record.PauseType).FirstOrDefault();
                                                                            if (TempBreakRecord != null)
                                                                            {
                                                                                double pauseStartTimeIndouble = Math.Round((Convert.ToDouble(record.BreakStartTime.TotalMinutes) / 60), 4);
                                                                                double pauseEndTimeIndouble = Math.Round((Convert.ToDouble(record.BreakEndTime.TotalMinutes) / 60), 4);
                                                                                Breakname = TempBreakRecord.Name;
                                                                                if (MeetingtypeId.Contains(TempBreakRecord.IdLookupValue))
                                                                                {
                                                                                    Breakname = "Meeting";
                                                                                }
                                                                                if (MaintenanceId.Contains(TempBreakRecord.IdLookupValue))
                                                                                {
                                                                                    Breakname = "Maintenance";
                                                                                }
                                                                                TemppauseIndouble = TemppauseIndouble + (pauseEndTimeIndouble - pauseStartTimeIndouble);
                                                                            }
                                                                        }
                                                                        double TemppauseIndouble1 = 0;
                                                                        string Breakname1 = string.Empty;

                                                                        foreach (var record in RecordByPuaseType)
                                                                        {
                                                                            var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == record.PauseType).FirstOrDefault();
                                                                            if (TempBreakRecord != null)
                                                                            {
                                                                                double pauseStartTimeIndouble = Math.Round((Convert.ToDouble(record.BreakStartTime.TotalMinutes) / 60), 4);
                                                                                double pauseEndTimeIndouble = Math.Round((Convert.ToDouble(record.BreakEndTime.TotalMinutes) / 60), 4);
                                                                                if (MeetingtypeId.Contains(TempBreakRecord.IdLookupValue))
                                                                                {
                                                                                    Breakname1 = "Meeting";
                                                                                }
                                                                                else if (MaintenanceId.Contains(TempBreakRecord.IdLookupValue))
                                                                                {
                                                                                    Breakname = "Maintenance";
                                                                                }
                                                                                else
                                                                                {
                                                                                    Breakname1 = TempBreakRecord.Name + "_" + TempBreakRecord.IdLookupValue;//Aishwarya Ingale[Geos2-5853]
                                                                                }

                                                                                TemppauseIndouble1 = TemppauseIndouble1 + (pauseEndTimeIndouble - pauseStartTimeIndouble);
                                                                            }
                                                                        }
                                                                        if (!String.IsNullOrWhiteSpace(Breakname))
                                                                        {
                                                                            TimeSpan BreakTime = TimeSpan.FromHours(Convert.ToDouble(TemppauseIndouble));
                                                                            dr[Breakname] = Convert.ToString(BreakTime.Add(-TimeSpan.FromMilliseconds(BreakTime.Milliseconds)));
                                                                        }

                                                                        if (!String.IsNullOrWhiteSpace(Breakname1))
                                                                        {
                                                                            TimeSpan BreakTime1 = TimeSpan.FromHours(Convert.ToDouble(TemppauseIndouble1));
                                                                            dr[Breakname1] = Convert.ToString(BreakTime1.Add(-TimeSpan.FromMilliseconds(BreakTime1.Milliseconds)));
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            #endregion
                                                            DateTime? LastEndTime = Convert.ToDateTime("1900-01-01");
                                                            //[GEOS2-7902][gulab lakade] [23 04 2025]
                                                            foreach (var breakitem in BreakTimeData)
                                                            {
                                                                bool checkDuplicateValue = true;
                                                                //if (LastEndTime != TimeSpan.Zero)
                                                                if (LastEndTime == Convert.ToDateTime("1900-01-01"))
                                                                {
                                                                    //if (LastEndTime <= breakitem.BreakStartTime)
                                                                    if (LastEndTime <= breakitem.BreakStartDate)
                                                                    {
                                                                        checkDuplicateValue = false;
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    checkDuplicateValue = false;
                                                                }

                                                                if (checkDuplicateValue == false)
                                                                {
                                                                    //LastEndTime = breakitem.BreakEndTime;
                                                                    LastEndTime = breakitem.BreakEndDate;

                                                                    //TimeSpan totalDuration = TimeSpan.Zero;
                                                                    double BreakStartTimeIndouble = 0.0;
                                                                    double BreakEndTimeIndouble = 0.0;
                                                                    BreakStartTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakStartTime.TotalMinutes) / 60), 4);
                                                                    BreakEndTimeIndouble = Math.Round((Convert.ToDouble(breakitem.BreakEndTime.TotalMinutes) / 60), 4);
                                                                    #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                    if (EmpIsNightShift == 1 || ((MinAtt_Date != null && MaxAtt_Date != null) && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date))
                                                                    {
                                                                        #region Linear
                                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                        if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                                        {
                                                                            if (breakitem.PauseType == "Maintenance"|| ERMCommon.Instance.MaintenanceList.Values.Contains(breakitem.PauseType))//[pallavi jadhav][GEOS2-9419][2025 10 30]
                                                                            {
                                                                                MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                            }
                                                                            LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                            BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                            #region [wrong break time in EAMX Luis suggest][Gulab lakade][23 08 2024]
                                                                            if (BreakStartTimeIndouble <= BreakEndTimeIndouble)
                                                                            {
                                                                                BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                            }
                                                                            else
                                                                            {
                                                                                BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                            }
                                                                            #endregion
                                                                            BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                            TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);

                                                                            //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                            //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                            string Pausetimecolor = breakitem.PauseTypeColor;
                                                                            if (string.IsNullOrEmpty(Pausetimecolor))
                                                                            {
                                                                                Pausetimecolor = "#00FF00";
                                                                            }
                                                                            BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                            SelectedTooltips.BarTypeName = "pauseType";
                                                                            //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                            SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                            string BreakType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                            {
                                                                                BreakType = Convert.ToString(breakitem.PauseType);
                                                                               
                                                                            }
                                                                            else
                                                                            {
                                                                                BreakType = "Break";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = BreakType;
                                                                            SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                            SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                            #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                            SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                            SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                            SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                            if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                            {
                                                                                SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                            }
                                                                            if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                            {
                                                                                SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                            }
                                                                            #endregion
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                            #endregion
                                                                            linearScale.Ranges.Add(BreakLoggBar);
                                                                            #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                            try
                                                                            {
                                                                                var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                {
                                                                                    ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                    var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                    if (tempsequence != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                    }
                                                                                    #region [GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                    var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                    ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                    if (TempBreakRecord != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                    }
                                                                                    else if (TempBreakRecord1 != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                    }
                                                                                    #endregion
                                                                                    if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                    {
                                                                                        ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                    }
                                                                                    ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                }
                                                                            }
                                                                            catch (Exception ex)
                                                                            {
                                                                                GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                            }
                                                                            #endregion
                                                                        }
                                                                        #endregion
                                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                                        else
                                                                        {
                                                                            if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftStartDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftStartDate.Value.Date))
                                                                            {
                                                                                if (breakitem.PauseType == "Maintenance" || ERMCommon.Instance.MaintenanceList.Values.Contains(breakitem.PauseType))//[pallavi jadhav][GEOS2-9419][2025 10 30]
                                                                                {
                                                                                    MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                }
                                                                                LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                #region [wrong break time in EAMX Luis suggest][Gulab lakade][23 08 2024]
                                                                                if (BreakStartTimeIndouble <= BreakEndTimeIndouble)
                                                                                {
                                                                                    BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                }
                                                                                else
                                                                                {
                                                                                    BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                                }
                                                                                #endregion
                                                                                BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                {
                                                                                    Pausetimecolor = "#00FF00";
                                                                                }
                                                                                BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "pauseType";
                                                                                //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                                SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                string BreakType = string.Empty;
                                                                                if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                {
                                                                                    BreakType = Convert.ToString(breakitem.PauseType);
                                                                                }
                                                                                else
                                                                                {
                                                                                    BreakType = "Break";
                                                                                }
                                                                                SelectedTooltips.ToolTipsType = BreakType;
                                                                                SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                                #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                {
                                                                                    SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                }
                                                                                if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                {
                                                                                    SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                }
                                                                                #endregion
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }

                                                                                #endregion
                                                                                linearScale.Ranges.Add(BreakLoggBar);
                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                try
                                                                                {
                                                                                    var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                    var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                    if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        #region [GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        if (TempBreakRecord != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        }
                                                                                        else if (TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        }
                                                                                        #endregion

                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    }
                                                                                }
                                                                                catch (Exception ex)
                                                                                {
                                                                                    GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                }
                                                                                #endregion
                                                                            }
                                                                            else
                                                                            {
                                                                                if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftStartDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftEndDate.Value.Date))
                                                                                {
                                                                                    #region LinearScale
                                                                                    if (breakitem.PauseType == "Maintenance" || ERMCommon.Instance.MaintenanceList.Values.Contains(breakitem.PauseType))
                                                                                    {
                                                                                        MaintanceTimeIndouble = MaintanceTimeIndouble + (24 - BreakStartTimeIndouble);
                                                                                    }
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    try
                                                                                    {
                                                                                        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((24 - BreakStartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            #region [GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            if (TempBreakRecord != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            else if (TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            #endregion
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                    #endregion

                                                                                    LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                    BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                    BreakLoggBar.EndValue = new RangeValue(24);
                                                                                    BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (24 - BreakStartTimeIndouble);
                                                                                    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                    {
                                                                                        Pausetimecolor = "#00FF00";
                                                                                    }
                                                                                    BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "pauseType";
                                                                                    //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                                    SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    string BreakType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                    {
                                                                                        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakType = "Break";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = BreakType;
                                                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                    SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                                    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                    {
                                                                                        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;
                                                                                    }
                                                                                    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                    {
                                                                                        SelectedTooltips.NonOtComment = breakitem.NonOtComment;
                                                                                    }
                                                                                    #endregion
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == 24 && x.ToolTipsType == BreakType && x.AttendanceStartDate == (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {

                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }

                                                                                    #endregion
                                                                                    linearScale.Ranges.Add(BreakLoggBar);
                                                                                    #endregion
                                                                                    #region NightShift
                                                                                    if (breakitem.PauseType == "Maintenance" || ERMCommon.Instance.MaintenanceList.Values.Contains(breakitem.PauseType))//[pallavi jadhav][GEOS2-9419][2025 10 30]
                                                                                    {
                                                                                        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - 0);
                                                                                    }
                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    try
                                                                                    {
                                                                                        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - 0), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            if (TempBreakRecord != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            else if (TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            #endregion
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                    #endregion
                                                                                    LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                    NightBreakLoggBar.StartValue = new RangeValue(0);
                                                                                    NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                    NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - 0);
                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                    string Pausetimecolor1 = breakitem.PauseTypeColor;
                                                                                    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                    {
                                                                                        Pausetimecolor = "#00FF00";
                                                                                    }
                                                                                    NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips1 = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips1.ToolTipsStartTime = 0;
                                                                                    SelectedTooltips1.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                    SelectedTooltips1.BarTypeName = "pauseType";
                                                                                    //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                                    SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    string BreakType1 = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                    {
                                                                                        BreakType1 = Convert.ToString(breakitem.PauseType);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakType1 = "Break";
                                                                                    }
                                                                                    SelectedTooltips1.ToolTipsType = BreakType;
                                                                                    SelectedTooltips1.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                    SelectedTooltips1.IdStage = StageRecord.IdStage;
                                                                                    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                    SelectedTooltips1.NonOT_Name = breakitem.NonOT_Name;
                                                                                    SelectedTooltips1.PauseTypeId = breakitem.PauseTypeId;
                                                                                    SelectedTooltips1.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                    {
                                                                                        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                    }
                                                                                    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                    {
                                                                                        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                    }
                                                                                    #endregion
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == 0 && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType1 && x.AttendanceStartDate == (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {

                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips1);
                                                                                    }
                                                                                    #endregion
                                                                                    linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                    #endregion
                                                                                }
                                                                                else if ((breakitem.BreakStartDate >= shiftStartDate && breakitem.BreakEndDate <= shiftEndDate) && (breakitem.BreakStartDate.Value.Date == shiftEndDate.Value.Date && breakitem.BreakEndDate.Value.Date == shiftEndDate.Value.Date))
                                                                                {
                                                                                    #region NightShift
                                                                                    if (breakitem.PauseType == "Maintenance" || ERMCommon.Instance.MaintenanceList.Values.Contains(breakitem.PauseType))//[pallavi jadhav][GEOS2-9419][2025 10 30]
                                                                                    {
                                                                                        MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                    }

                                                                                    #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                    try
                                                                                    {
                                                                                        var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                        if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                            var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                            if (tempsequence != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                            }
                                                                                            #region [GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            if (TempBreakRecord != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            else if (TempBreakRecord1 != null)
                                                                                            {
                                                                                                ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                            }
                                                                                            #endregion
                                                                                            if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                            {
                                                                                                ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                            }
                                                                                            ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                        }
                                                                                    }
                                                                                    catch (Exception ex)
                                                                                    {
                                                                                        GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                    }
                                                                                    #endregion
                                                                                    LinearScaleRange NightBreakLoggBar = new LinearScaleRange();
                                                                                    //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                    NightBreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                    NightBreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                    NightBreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                    TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                    //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                    //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                    string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                    if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                    {
                                                                                        Pausetimecolor = "#00FF00";
                                                                                    }
                                                                                    NightBreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                    SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                    SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                    SelectedTooltips.BarTypeName = "pauseType";
                                                                                    //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                                    SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                    string BreakType = string.Empty;
                                                                                    if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                    {
                                                                                        BreakType = Convert.ToString(breakitem.PauseType);
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        BreakType = "Break";
                                                                                    }
                                                                                    SelectedTooltips.ToolTipsType = BreakType;
                                                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                    SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                                    #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                    SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                    SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                    SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                    if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                    {
                                                                                        SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                    }
                                                                                    if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                    {
                                                                                        SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                    }
                                                                                    #endregion
                                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                    {
                                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                        {
                                                                                            //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                            if (Tooltipdata == null)
                                                                                            {
                                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                    #endregion
                                                                                    linearnightScale.Ranges.Add(NightBreakLoggBar);
                                                                                    #endregion
                                                                                }

                                                                            }
                                                                            #endregion
                                                                    }

                                                                        #endregion
                                                                    }
                                                                    else
                                                                    {
                                                                        if (BarEndValue >= BreakEndTimeIndouble && BarStartValue <= BreakStartTimeIndouble)
                                                                        {

                                                                            if (breakitem.BreakStartTime <= breakitem.BreakEndTime)
                                                                            {
                                                                                if (breakitem.PauseType == "Maintenance" || ERMCommon.Instance.MaintenanceList.Values.Contains(breakitem.PauseType))//[pallavi jadhav][GEOS2-9419][2025 10 30]
                                                                                {
                                                                                    MaintanceTimeIndouble = MaintanceTimeIndouble + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                }
                                                                                #region [GEOS2-6738][gulab lakade][02 01 2025]
                                                                                try
                                                                                {
                                                                                    var TempBreakRecord = ERMCommon.Instance.ProductionTimeReportLegendloggedColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();

                                                                                    var TempBreakRecord1 = ERMCommon.Instance.ProductionTimeReportManagementLegendColorList.Where(x => x.Name == breakitem.PauseType).FirstOrDefault();
                                                                                    if (TempBreakRecord != null || TempBreakRecord1 != null)
                                                                                    {
                                                                                        ERMCommon.Instance.Select_emp_Productiontime = new ERM_EMP_ProductionTimeline();
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.StageName = breakitem.NonOT_Code;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeType = breakitem.PauseType;
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.TimeValue = Math.Round((BreakEndTimeIndouble - BreakStartTimeIndouble), 4);
                                                                                        var tempsequence = TempStageList.Where(x => x.StageCode == breakitem.NonOT_Code).FirstOrDefault();
                                                                                        if (tempsequence != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.StageSequence = tempsequence.Sequence;
                                                                                        }
                                                                                        #region [GEOS2-6716][pallavi jadhav][13 01 2025]

                                                                                        var NonOtComment = string.Join("; ", BreakTimeData.AsEnumerable().Where(x => x.PauseType == breakitem.PauseType && !string.IsNullOrEmpty(x.NonOtComment)).Select(x => x.NonOtComment));
                                                                                        ERMCommon.Instance.Select_emp_Productiontime.Details = NonOtComment;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        if (TempBreakRecord != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        }
                                                                                        else if (TempBreakRecord1 != null)
                                                                                        {
                                                                                            ERMCommon.Instance.Select_emp_Productiontime.IdlookupValue = TempBreakRecord1.IdLookupValue;//[GEOS2-6716][pallavi jadhav][13 01 2025]
                                                                                        }
                                                                                        #endregion
                                                                                        if (ERMCommon.Instance.Emp_Productiontime == null)
                                                                                        {
                                                                                            ERMCommon.Instance.Emp_Productiontime = new List<ERM_EMP_ProductionTimeline>();
                                                                                        }
                                                                                        ERMCommon.Instance.Emp_Productiontime.Add(ERMCommon.Instance.Select_emp_Productiontime);
                                                                                    }
                                                                                }
                                                                                catch (Exception ex)
                                                                                {
                                                                                    GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
                                                                                }
                                                                                #endregion

                                                                                LinearScaleRange BreakLoggBar = new LinearScaleRange();
                                                                                //BreakLoggBar.StartValue = new RangeValue(OldEndTimeIndoble);
                                                                                BreakLoggBar.StartValue = new RangeValue(BreakStartTimeIndouble);
                                                                                if (BarEndValue >= BreakEndTimeIndouble)
                                                                                {
                                                                                    BreakLoggBar.EndValue = new RangeValue(BreakEndTimeIndouble);
                                                                                }
                                                                                else
                                                                                {
                                                                                    BreakLoggBar.EndValue = new RangeValue(BarEndValue);
                                                                                }
                                                                                BreakLoggBar.Options = new RangeOptions() { Offset = 4, Thickness = 14 };
                                                                                TotalBreakTimeForToolTip = TotalBreakTimeForToolTip + (BreakEndTimeIndouble - BreakStartTimeIndouble);
                                                                                //    range1.Presentation.Fill = new SolidColorBrush(Colors.Green);
                                                                                //BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.Gray) };
                                                                                string Pausetimecolor = breakitem.PauseTypeColor;
                                                                                if (string.IsNullOrEmpty(Pausetimecolor))
                                                                                {
                                                                                    Pausetimecolor = "#00FF00";
                                                                                }
                                                                                BreakLoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(Pausetimecolor)) };
                                                                                #region Tool Tips [Gulab lakade][24 01 2024]
                                                                                ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                                SelectedTooltips.ToolTipsStartTime = BreakStartTimeIndouble;
                                                                                SelectedTooltips.ToolTipsEndTime = BreakEndTimeIndouble;
                                                                                SelectedTooltips.BarTypeName = "pauseType";
                                                                                //SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                                SelectedTooltips.AttendanceStartDate = (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date);//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                string BreakType = string.Empty;
                                                                                if (!string.IsNullOrWhiteSpace(breakitem.PauseType))
                                                                                {
                                                                                    BreakType = Convert.ToString(breakitem.PauseType);
                                                                                }
                                                                                else
                                                                                {
                                                                                    BreakType = "Break";
                                                                                }
                                                                                SelectedTooltips.ToolTipsType = BreakType;
                                                                                SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                                SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                                #region  [GEOS2-6554][gulab lakade][02 12 2024]
                                                                                SelectedTooltips.NonOT_Name = breakitem.NonOT_Name;
                                                                                SelectedTooltips.PauseTypeId = breakitem.PauseTypeId;
                                                                                SelectedTooltips.NonOT_IdStage = breakitem.NonOT_IdStage;
                                                                                if (!string.IsNullOrEmpty(breakitem.SW_Place_Name))
                                                                                {
                                                                                    SelectedTooltips.SW_Place_Name = breakitem.SW_Place_Name;

                                                                                }
                                                                                if (!string.IsNullOrEmpty(breakitem.NonOtComment))
                                                                                {
                                                                                    SelectedTooltips.NonOtComment = breakitem.NonOtComment;

                                                                                }
                                                                                #endregion
                                                                                if (ERMCommon.Instance.ProductionToolTip != null)
                                                                                {
                                                                                    if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                    {
                                                                                        //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                        var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == BreakStartTimeIndouble && x.ToolTipsEndTime == BreakEndTimeIndouble && x.ToolTipsType == BreakType && x.AttendanceStartDate == (IsAttendance == false ? breakitem.BreakStartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();//[GEOS2-5418] [gulab lakade] [23 02 2024]
                                                                                        if (Tooltipdata == null)
                                                                                        {
                                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {

                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                                #endregion
                                                                                linearScale.Ranges.Add(BreakLoggBar);
                                                                            }
                                                                        }
                                                                    }
                                                                    #endregion
                                                                }
                                                            }
                                                        }
                                                        #endregion

                                                        
                                                    }
                                                    #endregion

                                                    #region Attendance

                                                    #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                    #region [GEOS2-5883][gulab lakade][274 06 2024]
                                                    #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                    //var employeeAttendlist = emp.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == itemDate.Key.Date).OrderBy(a => a.AttendanceStartDate).ToList();
                                                    // var employeeAttendlist = ProductionTimeList.Where(a => a.SiteName == plantdata.Key && a.EmployeeCode == emp.Key && IdJobdescription.Contains(a.IdJobDescription) && a.AttendanceStartDate != null && a.AttendanceStartDate >= shiftStartDate && a.AttendanceStartDate <= shiftEndDate).OrderBy(a => a.AttendanceStartDate).ToList();
                                                    #endregion
                                                    #endregion
                                                    #endregion
                                                    if (tmpAttendance.Count() > 0)
                                                    {
                                                        #region Half Day Leave
                                                        #region [GEOS2-9220][gulab lakade][12 08 2025]
                                                        var Leavedata = tmpLeavedata.Where(a => a.IsAllDayEvent == 0).GroupBy(test => test.StartDate)
                                                                                       .Select(grp => grp.First())
                                                                                       .ToList();
                                                        if (Leavedata.Count() > 0)
                                                        {
                                                            foreach (var leave in Leavedata)
                                                            {
                                                                double LeaveStartTimeIndouble = 0;
                                                                double LeaveEndTimeIndouble = 0;
                                                                LeaveStartTimeIndouble = Math.Round(Convert.ToDouble(leave.StartDate.Value.TimeOfDay.TotalHours), 4);
                                                                LeaveEndTimeIndouble = Math.Round(Convert.ToDouble(leave.EndDate.Value.TimeOfDay.TotalHours), 4);
                                                                #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                if (EmpIsNightShift == 1 || ((MinAtt_Date != null && MaxAtt_Date != null) && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date))
                                                                {
                                                                    if (LeaveStartTimeIndouble != null)
                                                                    {
                                                                        LinearScaleRangeBar AttendanceLeaveStart = new LinearScaleRangeBar();
                                                                        if (LeaveStartTimeIndouble > LeaveEndTimeIndouble)
                                                                        {
                                                                            AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                            AttendanceLeaveStart.AnchorValue = 24;
                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = 24;
                                                                            SelectedTooltips.BarTypeName = "LeaveType";
                                                                            SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                            SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                            SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                            string LeaveType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                            {
                                                                                LeaveType = leave.LeaveType;
                                                                            }
                                                                            else
                                                                            {
                                                                                LeaveType = "Leaves";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = LeaveType;
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }

                                                                            #endregion
                                                                        }
                                                                        if (LeaveStartTimeIndouble < LeaveEndTimeIndouble)
                                                                        {
                                                                            AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                            AttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                            SelectedTooltips.BarTypeName = "LeaveType";
                                                                            SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                            SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                            SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                            string LeaveType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                            {
                                                                                LeaveType = leave.LeaveType;
                                                                            }
                                                                            else
                                                                            {
                                                                                LeaveType = "Leaves";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = LeaveType;
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }

                                                                            #endregion
                                                                        }

                                                                        AttendanceLeaveStart.Visible = true;
                                                                        AttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                        // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                        string LeaveTimeColor = leave.LeaveTypeColor;
                                                                        if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                        {
                                                                            LeaveTimeColor = "#000000";
                                                                        }
                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                        AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };

                                                                        linearScale.RangeBars.Add(AttendanceLeaveStart);
                                                                    }
                                                                    if (LeaveStartTimeIndouble > LeaveEndTimeIndouble)
                                                                    {
                                                                        #region nightShift
                                                                        LinearScaleRangeBar NightAttendanceLeaveStart = new LinearScaleRangeBar();
                                                                        NightAttendanceLeaveStart.Value = 0;
                                                                        NightAttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                        NightAttendanceLeaveStart.Visible = true;
                                                                        NightAttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                        // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                        string LeaveTimeColor = leave.LeaveTypeColor;
                                                                        if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                        {
                                                                            LeaveTimeColor = "#000000";
                                                                        }
                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                        NightAttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };
                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                        SelectedTooltips.ToolTipsStartTime = 0;
                                                                        SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                        SelectedTooltips.BarTypeName = "LeaveType";
                                                                        SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                        SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                        SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                        string LeaveType = string.Empty;
                                                                        if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                        {
                                                                            LeaveType = leave.LeaveType;
                                                                        }
                                                                        else
                                                                        {
                                                                            LeaveType = "Leaves";
                                                                        }
                                                                        SelectedTooltips.ToolTipsType = LeaveType;
                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                        {
                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                            {
                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                if (Tooltipdata == null)
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }

                                                                        #endregion
                                                                        linearnightScale.RangeBars.Add(NightAttendanceLeaveStart);
                                                                        #endregion
                                                                    }
                                                                }
                                                                else if (IsAttendance == true)//[GEOS2-6965][rani dhamankar][12-03-2025]
                                                                {
                                                                    LinearScaleRangeBar AttendanceLeaveStart = new LinearScaleRangeBar();
                                                                    AttendanceLeaveStart.Value = LeaveStartTimeIndouble;
                                                                    AttendanceLeaveStart.AnchorValue = LeaveEndTimeIndouble;
                                                                    AttendanceLeaveStart.Visible = true;
                                                                    AttendanceLeaveStart.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    // AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Red) };
                                                                    string LeaveTimeColor = leave.LeaveTypeColor;
                                                                    if (string.IsNullOrEmpty(LeaveTimeColor))
                                                                    {
                                                                        LeaveTimeColor = "#000000";
                                                                    }
                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    AttendanceLeaveStart.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(LeaveTimeColor)) };
                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                    SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                    SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                    SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                    string LeaveType = string.Empty;
                                                                    if (!string.IsNullOrWhiteSpace(leave.LeaveType))
                                                                    {
                                                                        LeaveType = leave.LeaveType;
                                                                    }
                                                                    else
                                                                    {
                                                                        LeaveType = "Leaves";
                                                                    }
                                                                    SelectedTooltips.ToolTipsType = LeaveType;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == LeaveType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }

                                                                    #endregion
                                                                    linearScale.RangeBars.Add(AttendanceLeaveStart);
                                                                }

                                                                #endregion

                                                            }
                                                        }

                                                        #endregion
                                                        #endregion

                                                        var Attendancedata = tmpAttendance
                                                            .Where(a => a.AttendanceStartDate.HasValue)
                                                                    .GroupBy(test => test.AttendanceStartDate.Value.TimeOfDay)
                                                                    .Select(grp => grp.First())
                                                                    .ToList();
                                                        if (Attendancedata.Count() > 0)
                                                        {
                                                            foreach (var Attend in Attendancedata)
                                                            {
                                                                //TotalAttendanceWithoutLeave = TotalAttendanceHours;
                                                                // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate!=null && a.AttendanceStartDate.Value.Date == MinAtt_Date.Value.Date && a.IdEmployee == employee_MainDetail.IdEmployee);
                                                                bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && MinAtt_Date.HasValue && a.AttendanceStartDate.Value.Date == MinAtt_Date.Value.Date && a.IdEmployee == employee_MainDetail.IdEmployee);

                                                                double AttenadnceStartTimeIndouble = 0;
                                                                double AttenadnceEndTimeIndouble = 0;
                                                                if (!existTotalAttandance)
                                                                {
                                                                    AttenadnceStartTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceStartDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                    AttenadnceEndTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceEndDate.Value.TimeOfDay.TotalMinutes) / 60), 2);

                                                                }

                                                                // double AttenadnceStartTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceStartDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                // double AttenadnceEndTimeIndouble = Math.Round((Convert.ToDouble(Attend.AttendanceEndDate.Value.TimeOfDay.TotalMinutes) / 60), 2);
                                                                //double AttenadnceStartTimeIndouble = Math.Round(Attend.AttendanceStartDate.Value.TimeOfDay.TotalHours,2);
                                                                //double AttenadnceEndTimeIndouble = Math.Round(Attend.AttendanceEndDate.Value.TimeOfDay.TotalHours,2);
                                                                //TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);
                                                                #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                                if (EmpIsNightShift == 1 || ((MinAtt_Date != null && MaxAtt_Date != null) && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date))
                                                                {
                                                                    if (AttenadnceStartTimeIndouble != null)
                                                                    {
                                                                        LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                        //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                        //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                        if (AttenadnceStartTimeIndouble < AttenadnceEndTimeIndouble)
                                                                        {
                                                                            Attendance.Value = AttenadnceStartTimeIndouble;
                                                                            Attendance.AnchorValue = AttenadnceEndTimeIndouble;

                                                                            TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);


                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                            SelectedTooltips.BarTypeName = "AttendanceType";
                                                                            SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                            string AttendenceType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                            {
                                                                                AttendenceType = Attend.AttendanceType;
                                                                            }
                                                                            else
                                                                            {
                                                                                AttendenceType = "Attendance";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = AttendenceType;
                                                                            SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                            SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }

                                                                            #endregion
                                                                        }
                                                                        if (AttenadnceStartTimeIndouble > AttenadnceEndTimeIndouble)
                                                                        {
                                                                            Attendance.Value = AttenadnceStartTimeIndouble;
                                                                            Attendance.AnchorValue = 24;

                                                                            TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (24 - AttenadnceStartTimeIndouble);


                                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                            SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                            SelectedTooltips.ToolTipsEndTime = 24;
                                                                            SelectedTooltips.BarTypeName = "AttendanceType";
                                                                            SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                            string AttendenceType = string.Empty;
                                                                            if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                            {
                                                                                AttendenceType = Attend.AttendanceType;
                                                                            }
                                                                            else
                                                                            {
                                                                                AttendenceType = "Attendance";
                                                                            }
                                                                            SelectedTooltips.ToolTipsType = AttendenceType;
                                                                            SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                            SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                                            {
                                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                                {
                                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                    if (Tooltipdata == null)
                                                                                    {
                                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                    }
                                                                                }
                                                                                else
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }

                                                                            #endregion
                                                                        }
                                                                        Attendance.Visible = true;
                                                                        Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                        Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                        string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                        if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                        {
                                                                            AttendanceTimeColor = "#000000";
                                                                        }
                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                        Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                        #region [GEOS2-7641][gulab lakade][27 03 2025]
                                                                        if (shiftStartDate.Value.Date == Attend.AttendanceStartDate.Value.Date)
                                                                        {
                                                                            linearScale.RangeBars.Add(Attendance);
                                                                        }
                                                                        else if (shiftEndDate.Value.Date == Attend.AttendanceEndDate.Value.Date)
                                                                        {
                                                                            linearnightScale.RangeBars.Add(Attendance);
                                                                        }

                                                                        #endregion

                                                                    }
                                                                    if (AttenadnceEndTimeIndouble < AttenadnceStartTimeIndouble)
                                                                    {
                                                                        #region Night

                                                                        TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - 0);


                                                                        LinearScaleRangeBar NightAttendance = new LinearScaleRangeBar();
                                                                        //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                        //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                        NightAttendance.Value = 0;
                                                                        NightAttendance.AnchorValue = AttenadnceEndTimeIndouble;
                                                                        NightAttendance.Visible = true;
                                                                        NightAttendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                        NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                        string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                        if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                        {
                                                                            AttendanceTimeColor = "#000000";
                                                                        }
                                                                        //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                        NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                        #region Tool Tips [Gulab lakade][24 01 2024]
                                                                        ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                        SelectedTooltips.ToolTipsStartTime = 0;
                                                                        SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                        SelectedTooltips.BarTypeName = "AttendanceType";
                                                                        SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                        string AttendenceType = string.Empty;
                                                                        if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                        {
                                                                            AttendenceType = Attend.AttendanceType;
                                                                        }
                                                                        else
                                                                        {
                                                                            AttendenceType = "Attendance";
                                                                        }
                                                                        SelectedTooltips.ToolTipsType = AttendenceType;
                                                                        SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                        SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                        if (ERMCommon.Instance.ProductionToolTip != null)
                                                                        {
                                                                            if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                            {
                                                                                var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                                if (Tooltipdata == null)
                                                                                {
                                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }

                                                                        #endregion
                                                                        linearnightScale.RangeBars.Add(NightAttendance);
                                                                        #endregion
                                                                    }
                                                                }
                                                                else
                                                                {

                                                                    TotalAttendanceWithoutLeave = TotalAttendanceWithoutLeave + (AttenadnceEndTimeIndouble - AttenadnceStartTimeIndouble);


                                                                    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                    //Attendance.Value = AttenadnceEndTimeIndouble;
                                                                    //Attendance.AnchorValue = AttenadnceStartTimeIndouble;
                                                                    Attendance.Value = AttenadnceStartTimeIndouble;
                                                                    Attendance.AnchorValue = AttenadnceEndTimeIndouble;
                                                                    Attendance.Visible = true;
                                                                    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                    string AttendanceTimeColor = Attend.AttendanceTypeColor;
                                                                    if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                    {
                                                                        AttendanceTimeColor = "#000000";
                                                                    }
                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    SelectedTooltips.ToolTipsStartTime = AttenadnceStartTimeIndouble;
                                                                    SelectedTooltips.ToolTipsEndTime = AttenadnceEndTimeIndouble;
                                                                    SelectedTooltips.BarTypeName = "AttendanceType";
                                                                    SelectedTooltips.AttendanceStartDate = MinAtt_Date;
                                                                    string AttendenceType = string.Empty;
                                                                    if (!string.IsNullOrWhiteSpace(Attend.AttendanceType))
                                                                    {
                                                                        AttendenceType = Attend.AttendanceType;
                                                                    }
                                                                    else
                                                                    {
                                                                        AttendenceType = "Attendance";
                                                                    }
                                                                    SelectedTooltips.ToolTipsType = AttendenceType;
                                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                    SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == AttenadnceStartTimeIndouble && x.ToolTipsEndTime == AttenadnceEndTimeIndouble && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }

                                                                    #endregion
                                                                    linearScale.RangeBars.Add(Attendance);
                                                                }
                                                                #endregion

                                                            }
                                                        }
                                                        // }

                                                    }
                                                    else
                                                    {
                                                        #region Full Day Leave
                                                        if (tmpLeavedata.Count() > 0 && IsAttendance == false)
                                                        {
                                                            foreach (var leaveitem in tmpLeavedata)
                                                            {
                                                                if (EmpIsNightShift == 1)  //[GEOS2-8189][rani dhamankar] [03 - 06 - 2025]
                                                                {
                                                                    if (leaveitem.IsAllDayEvent == 1)
                                                                    {
                                                                        IsAllDayLeave = true;
                                                                    }
                                                                    double LeaveStartTimeIndouble = 0;
                                                                    double LeaveEndTimeIndouble = 0;
                                                                    LeaveStartTimeIndouble = Math.Round(Convert.ToDouble(leaveitem.StartDate.Value.TimeOfDay.TotalHours), 4);
                                                                    LeaveEndTimeIndouble = Math.Round(Convert.ToDouble(leaveitem.EndDate.Value.TimeOfDay.TotalHours), 4);
                                                                    TotalAttendanceWithoutLeave = 0;
                                                                    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                    Attendance.Value = LeaveStartTimeIndouble;

                                                                    Attendance.AnchorValue = 24;
                                                                    Attendance.Visible = true;
                                                                    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                    string AttendanceTimeColor = leaveitem.LeaveTypeColor;
                                                                    if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                    {
                                                                        AttendanceTimeColor = "#000000";
                                                                    }
                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    SelectedTooltips.ToolTipsEndTime = 24;
                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                    SelectedTooltips.AttendanceStartDate = (leaveitem.StartDate);
                                                                    string AttendenceType = string.Empty;
                                                                    AttendenceType = "Leave";
                                                                    SelectedTooltips.ToolTipsType = leaveitem.LeaveType;
                                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                    SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == AttendenceType && x.LeaveStartDate == leaveitem.StartDate && x.IdEmployee == employee_MainDetail.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }
                                                                    LinearScaleRangeBar NightAttendance = new LinearScaleRangeBar();
                                                                    NightAttendance.Value = 0;

                                                                    NightAttendance.AnchorValue = LeaveEndTimeIndouble;
                                                                    NightAttendance.Visible = true;
                                                                    NightAttendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };

                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    NightAttendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    ProductionTimeLineToolTipdata NightShiftSelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    NightShiftSelectedTooltips.ToolTipsStartTime = 0;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    NightShiftSelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                    NightShiftSelectedTooltips.BarTypeName = "LeaveType";
                                                                    NightShiftSelectedTooltips.AttendanceStartDate = leaveitem.StartDate;
                                                                    string NightShiftAttendenceType = string.Empty;
                                                                    NightShiftAttendenceType = "Leave";
                                                                    NightShiftSelectedTooltips.ToolTipsType = leaveitem.LeaveType;
                                                                    NightShiftSelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                    NightShiftSelectedTooltips.IdStage = StageRecord.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == NightShiftAttendenceType && x.LeaveStartDate == leaveitem.StartDate && x.IdEmployee == employee_MainDetail.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(NightShiftSelectedTooltips);
                                                                    }

                                                                    linearScale.RangeBars.Add(Attendance);
                                                                    linearnightScale.RangeBars.Add(NightAttendance);

                                                                }
                                                                else
                                                                {

                                                                    double LeaveStartTimeIndouble = 0;
                                                                    double LeaveEndTimeIndouble = 0;
                                                                    LeaveStartTimeIndouble = Math.Round(Convert.ToDouble(leaveitem.StartDate.Value.TimeOfDay.TotalHours), 4);
                                                                    LeaveEndTimeIndouble = Math.Round(Convert.ToDouble(leaveitem.EndDate.Value.TimeOfDay.TotalHours), 4);
                                                                    TotalAttendanceWithoutLeave = 0;
                                                                    LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                                    Attendance.Value = LeaveStartTimeIndouble;

                                                                    Attendance.AnchorValue = LeaveEndTimeIndouble;
                                                                    Attendance.Visible = true;
                                                                    Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                                    string AttendanceTimeColor = leaveitem.LeaveTypeColor;
                                                                    if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                                    {
                                                                        AttendanceTimeColor = "#000000";
                                                                    }
                                                                    //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                                    Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                                    #region Tool Tips [Gulab lakade][24 01 2024]
                                                                    ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                                    SelectedTooltips.ToolTipsStartTime = LeaveStartTimeIndouble;
                                                                    //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                                    SelectedTooltips.ToolTipsEndTime = LeaveEndTimeIndouble;
                                                                    SelectedTooltips.BarTypeName = "LeaveType";
                                                                    SelectedTooltips.AttendanceStartDate = (leaveitem.StartDate);
                                                                    string AttendenceType = string.Empty;
                                                                    AttendenceType = "Leave";
                                                                    SelectedTooltips.ToolTipsType = leaveitem.LeaveType;
                                                                    SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                                    SelectedTooltips.IdStage = StageRecord.IdStage;
                                                                    if (ERMCommon.Instance.ProductionToolTip != null)
                                                                    {
                                                                        if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                        {
                                                                            var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == LeaveStartTimeIndouble && x.ToolTipsEndTime == LeaveEndTimeIndouble && x.ToolTipsType == AttendenceType && x.LeaveStartDate == leaveitem.StartDate && x.IdEmployee == employee_MainDetail.IdEmployee).FirstOrDefault();
                                                                            if (Tooltipdata == null)
                                                                            {
                                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }

                                                                    #endregion
                                                                    linearScale.RangeBars.Add(Attendance);
                                                                }
                                                            }
                                                        }
                                                        #endregion
                                                        #region Not Attandance/Leave
                                                        else
                                                        {
                                                            TotalAttendanceWithoutLeave = 0;
                                                            LinearScaleRangeBar Attendance = new LinearScaleRangeBar();
                                                            Attendance.Value = shiftStartDate.Value.Hour; //[GEOS2 - 9022][gulab lakade][23 07 2025]
                                                            Attendance.AnchorValue = shiftStartDate.Value.Hour + 0.10;//[GEOS2 - 9022][gulab lakade][23 07 2025]
                                                            Attendance.Visible = true;
                                                            Attendance.Options = new LinearScaleRangeBarOptions() { Offset = 20, Thickness = 14 };
                                                            Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush(Colors.Green) };
                                                            string AttendanceTimeColor = "#000000";
                                                            if (string.IsNullOrEmpty(AttendanceTimeColor))
                                                            {
                                                                AttendanceTimeColor = "#000000";
                                                            }
                                                            //LoggBar.Presentation = new DefaultLinearScaleRangePresentation() { Fill = new SolidColorBrush(Colors.LightBlue) };
                                                            Attendance.Presentation = new DefaultLinearScaleRangeBarPresentation() { Fill = new SolidColorBrush((Color)ColorConverter.ConvertFromString(AttendanceTimeColor)) };
                                                            #region Tool Tips [Gulab lakade][24 01 2024]
                                                            ProductionTimeLineToolTipdata SelectedTooltips = new ProductionTimeLineToolTipdata();
                                                            //SelectedTooltips.ToolTipsStartTime = ShiftStartTime;
                                                            SelectedTooltips.ToolTipsStartTime = shiftStartDate.Value.Hour; //[GEOS2 - 9022][gulab lakade][23 07 2025]
                                                                                                                            //SelectedTooltips.ToolTipsEndTime = ShiftEndTime;
                                                            SelectedTooltips.ToolTipsEndTime = shiftStartDate.Value.Hour + 0.10;
                                                            SelectedTooltips.BarTypeName = "AttendanceType";
                                                            SelectedTooltips.AttendanceStartDate = (MinAtt_Date);
                                                            string AttendenceType = string.Empty;
                                                            AttendenceType = "Attendance";
                                                            SelectedTooltips.ToolTipsType = AttendenceType;
                                                            SelectedTooltips.IdEmployee = employee_MainDetail.IdEmployee;
                                                            SelectedTooltips.IdStage = StageRecord.IdStage;
                                                            if (ERMCommon.Instance.ProductionToolTip != null)
                                                            {
                                                                if (ERMCommon.Instance.ProductionToolTip.Count() > 0)
                                                                {
                                                                    //var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == ShiftStartTime && x.ToolTipsEndTime == ShiftEndTime && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == (IsAttendance==false  ? employee.CounterpartStartDate : MinAtt_Date) && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                    var Tooltipdata = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == shiftStartDate.Value.Hour && x.ToolTipsEndTime == shiftEndDate.Value.Hour && x.ToolTipsType == AttendenceType && x.AttendanceStartDate == MinAtt_Date && x.IdEmployee == employee_MainDetail.IdEmployee && x.IdStage == StageRecord.IdStage).FirstOrDefault();
                                                                    if (Tooltipdata == null)
                                                                    {
                                                                        ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                                }
                                                            }
                                                            else
                                                            {
                                                                ERMCommon.Instance.ProductionToolTip = new List<ProductionTimeLineToolTipdata>();
                                                                ERMCommon.Instance.ProductionToolTip.Add(SelectedTooltips);
                                                            }

                                                            #endregion
                                                            linearScale.RangeBars.Add(Attendance);
                                                        }
                                                        #endregion

                                                    }
                                                    #endregion
                                                    #region aishwariya
                                                    #region Total EMP grid
                                                    Grid TotalGrid = new Grid();
                                                    TotalGrid.ShowGridLines = false;


                                                    //Total EMP column creation
                                                    #region ColumnDefinition
                                                    for (var Totalcolumn = 0; Totalcolumn < 1; Totalcolumn++)
                                                    {
                                                        var c = new ColumnDefinition();
                                                        c.Width = GridLength.Auto;
                                                        //c.Width = new GridLength(50, GridUnitType.Pixel);
                                                        TotalGrid.ColumnDefinitions.Add(c);
                                                    }





                                                    #endregion
                                                    //Total EMP  row creation
                                                    #region RowDefinition 
                                                    for (var Totalrow = 0; Totalrow < 4; Totalrow++)
                                                    {
                                                        var r = new RowDefinition();
                                                        if (Totalrow == 0)
                                                        {
                                                            r.Height = new GridLength(35, GridUnitType.Pixel);
                                                        }
                                                        else
                                                       if (Totalrow == 1)
                                                        {
                                                            r.Height = new GridLength(33, GridUnitType.Pixel);
                                                        }
                                                        else
                                                        {
                                                            r.Height = GridLength.Auto;
                                                        }
                                                        TotalGrid.RowDefinitions.Add(r);
                                                    }






                                                    #endregion
                                                    //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalWithoutBreak));
                                                    //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalShiftTime - TotalBreakTimeForToolTip));
                                                    // TimeSpan TimespanTotalLoggedTime = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTime));
                                                    TimeSpan TimespanTotalAttendanceWithoutLeave = TimeSpan.FromHours(Convert.ToDouble(TotalAttendanceWithoutLeave));
                                                    Label totallabel = new Label();
                                                    totallabel.Content = "Total";
                                                    totallabel.FontWeight = FontWeights.Bold;
                                                    totallabel.Margin = new Thickness(10, 0, 10, 0);
                                                    //totallabel.fo
                                                    Label totalWithoutBreak = new Label();

                                                    //TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip + TotalBreakTimeForToolTip)) - (StandardBreakTime);
                                                    TimeSpan TimespanTotalWithoutBreak = TimeSpan.FromHours(Convert.ToDouble(TotalShiftInDouble));
                                                    totalWithoutBreak.Content = TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds));
                                                    totalWithoutBreak.Margin = new Thickness(10, 10, 10, 0);
                                                    Label loggedtime = new Label();
                                                    TotalLoggedTime = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip + TotalBreakTimeForToolTip));
                                                    loggedtime.Content = TotalLoggedTime.Add(-TimeSpan.FromMilliseconds(TotalLoggedTime.Milliseconds));
                                                    loggedtime.Margin = new Thickness(10, 5, 10, 0);
                                                    Label AttendanceWithoutLeavetime = new Label();
                                                    if (TimespanTotalAttendanceWithoutLeave != TimeSpan.Zero)
                                                    {
                                                        AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                        // bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate != null && a.AttendanceStartDate.Value.Date == MinAtt_Date.Value.Date && a.IdEmployee == employee_MainDetail.IdEmployee);
                                                        bool existTotalAttandance = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && MinAtt_Date.HasValue && a.AttendanceStartDate.Value.Date == MinAtt_Date.Value.Date && a.IdEmployee == employee_MainDetail.IdEmployee);

                                                        if (!existTotalAttandance)
                                                        {
                                                            // AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                            AttendanceWithoutLeavetime.Content = TimespanTotalAttendanceWithoutLeave.Add(-TimeSpan.FromMilliseconds(TimespanTotalAttendanceWithoutLeave.Milliseconds));
                                                        }
                                                        else
                                                        {
                                                            AttendanceWithoutLeavetime.Content = "00:00:00";
                                                        }
                                                        //}
                                                    }
                                                    else
                                                    {
                                                        AttendanceWithoutLeavetime.Content = "00:00:00";
                                                    }

                                                    AttendanceWithoutLeavetime.Margin = new Thickness(10, -5, 10, 0);
                                                    Grid.SetRow(totallabel, 0);
                                                    Grid.SetColumn(totallabel, 0);
                                                    Grid.SetRow(totalWithoutBreak, 1);
                                                    Grid.SetColumn(totalWithoutBreak, 0);
                                                    Grid.SetRow(loggedtime, 2);
                                                    Grid.SetColumn(loggedtime, 0);
                                                    Grid.SetRow(AttendanceWithoutLeavetime, 3);
                                                    Grid.SetColumn(AttendanceWithoutLeavetime, 0);


                                                    // TotalGrid.Children.Add(EmployeeImage);
                                                    TotalGrid.Children.Add(totallabel);
                                                    TotalGrid.Children.Add(totalWithoutBreak);
                                                    TotalGrid.Children.Add(loggedtime);
                                                    TotalGrid.Children.Add(AttendanceWithoutLeavetime);






                                                    #endregion
                                                    #region Titles  Name
                                                    Label Titlelabel = new Label();
                                                    Titlelabel.Content = "";
                                                    Label Shift = new Label();
                                                    Shift.Content = "Shift";
                                                    Shift.Margin = new Thickness(10, 10, 10, 0);
                                                    Label logged = new Label();
                                                    logged.Content = "Logged";
                                                    logged.Margin = new Thickness(10, 5, 10, 0);
                                                    Label Attendance1 = new Label();
                                                    Attendance1.Content = "Att/Leaves";
                                                    Attendance1.Margin = new Thickness(10, -5, 10, 0);

                                                    Grid TitleGrid = new Grid();

                                                    //TitleGrid.ShowGridLines = false;


                                                    // Name column creation
                                                    #region ColumnDefinition
                                                    for (var Titlecolumn = 0; Titlecolumn < 2; Titlecolumn++)
                                                    {
                                                        var c = new ColumnDefinition();
                                                        c.Width = GridLength.Auto;
                                                        //c.Width = new GridLength(50, GridUnitType.Pixel);

                                                        TitleGrid.ColumnDefinitions.Add(c);
                                                    }




                                                    #endregion

                                                    #region RowDefinition 
                                                    for (var Titlerow = 0; Titlerow < 4; Titlerow++)
                                                    {
                                                        var r = new RowDefinition();
                                                        if (Titlerow == 0)
                                                        {
                                                            r.Height = new GridLength(35, GridUnitType.Pixel);
                                                        }
                                                        else
                                                        if (Titlerow == 1)
                                                        {
                                                            r.Height = new GridLength(33, GridUnitType.Pixel);
                                                        }
                                                        else
                                                        {
                                                            r.Height = GridLength.Auto;
                                                            //  r.Height = new GridLength(20, GridUnitType.Pixel);
                                                        }

                                                        TitleGrid.RowDefinitions.Add(r);
                                                    }


                                                    #endregion

                                                    Grid.SetRow(Titlelabel, 0);
                                                    Grid.SetColumn(Titlelabel, 0);
                                                    Grid.SetRow(Shift, 1);
                                                    Grid.SetColumn(Shift, 0);
                                                    Grid.SetRow(logged, 2);
                                                    Grid.SetColumn(logged, 0);
                                                    Grid.SetRow(Attendance1, 3);
                                                    Grid.SetColumn(Attendance1, 0);

                                                    TitleGrid.Children.Add(Titlelabel);
                                                    TitleGrid.Children.Add(Shift);
                                                    TitleGrid.Children.Add(logged);
                                                    TitleGrid.Children.Add(Attendance1);

                                                    #endregion

                                                    #endregion
                                                    TimeSpan BreakTimeForToolTip = new TimeSpan();
                                                    TimeSpan LoggedTimeForToolTip = new TimeSpan();
                                                    TimeSpan pauseTimeForToolTip = new TimeSpan();
                                                    LoggedTimeForToolTip = TimeSpan.FromHours(Convert.ToDouble(TotalLoggedTimeForToolTip));
                                                    LoggedTimeForToolTip = LoggedTimeForToolTip.Add(-TimeSpan.FromMilliseconds(LoggedTimeForToolTip.Milliseconds));
                                                    BreakTimeForToolTip = StandardBreakTime.Add(-TimeSpan.FromMilliseconds(StandardBreakTime.Milliseconds));
                                                    pauseTimeForToolTip = TimeSpan.FromHours(Convert.ToDouble(TotalBreakTimeForToolTip));
                                                    pauseTimeForToolTip = pauseTimeForToolTip.Add(-TimeSpan.FromMilliseconds(pauseTimeForToolTip.Milliseconds));
                                                    linearGauge.ToolTip = " OT Registered Time: " + LoggedTimeForToolTip + "\n Pause Time: " + pauseTimeForToolTip + "\n Shift Break Time: " + BreakTimeForToolTip;
                                                    linearGauge.Scales.Add(linearScale);
                                                    #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                    if (EmpIsNightShift == 1 && shiftStartDate.Value.Date != shiftEndDate.Value.Date)
                                                    {
                                                        linearGauge_night.Scales.Add(linearnightScale);
                                                    }
                                                    #endregion
                                                    #endregion
                                                    #region [GEOS2-5040][gulab lakade]
                                                    #region  [GEOS2-5394][gulab lakade][19 02 2024]
                                                    #region //[GEOS2-9220][gulab lakade][12 08 2025] temp comment grid
                                                    //#region [GEOS2-6738][gulab lakade][02 01 2025]
                                                    if (ERMCommon.Instance.Emp_Productiontime.GroupBy(a => a.StageName).Count() > 0)
                                                    {

                                                        var groupbyGrid = ERMCommon.Instance.Emp_Productiontime.OrderBy(b => b.StageSequence).GroupBy(a => a.StageName);
                                                        foreach (var sd in groupbyGrid)
                                                        {
                                                            DataRow dr1 = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();//[GEOS2-5394][gulab lakade][19 02 2024]
                                                            bool exists = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && MinAtt_Date.HasValue && a.AttendanceStartDate.Value.Date == MinAtt_Date.Value.Date && a.IdEmployee == employee_MainDetail.IdEmployee);
                                                            if (!exists)
                                                            {
                                                                if (MinAtt_Date != null || MaxAtt_Date != null)
                                                                {
                                                                    double AttStartTime = MinAtt_Date.Value.Hour;
                                                                    double AttEndTime = MaxAtt_Date.Value.Hour;
                                                                    double TotalTime = AttEndTime - AttStartTime;
                                                                    double Total1 = TotalAttendanceWithoutLeave;//Aishwarya Ingale[Geos2-6579]
                                                                    TimeSpan TimespanTotalAttendance = TimeSpan.FromHours(Convert.ToDouble(Total1));//Aishwarya Ingale[Geos2-6579]
                                                                    dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendance);
                                                                }
                                                            }
                                                            else
                                                            {
                                                                dr1["Total_Attendance"] = DBNull.Value;
                                                            }
                                                            #region [GEOS2-9804][gulab lakade][09 10 2025]
                                                            var Breark_lunchType = ERMCommon.Instance.Emp_Productiontime.Where(a => a.IdlookupValue == 1727 || a.IdlookupValue == 1728).FirstOrDefault();
                                                            if (Breark_lunchType != null)
                                                            {
                                                                double t_break = ERMCommon.Instance.Emp_Productiontime.Where(a => a.TimeType == Breark_lunchType.TimeType).Sum(b => b.TimeValue);
                                                                TimeSpan time_break = TimeSpan.FromHours(Convert.ToDouble(t_break));
                                                                dr1[Breark_lunchType.TimeType] = Convert.ToString(time_break);
                                                            }
                                                            #endregion 
                                                            double TotolWorkingTime = ERMCommon.Instance.Emp_Productiontime.Where(a => a.TimeType == "Working" && a.StageName == sd.Key).Sum(b => b.TimeValue);
                                                            TimeSpan WOTime1 = TimeSpan.FromHours(Convert.ToDouble(TotolWorkingTime));
                                                            // WOTime1 += totalDuration;//Aishwarya Ingale
                                                            dr1["WOTime"] = Convert.ToString(WOTime1.Add(-TimeSpan.FromMilliseconds(WOTime1.Milliseconds)));
                                                            double TotolDownloadTime = ERMCommon.Instance.Emp_Productiontime.Where(a => a.TimeType == "Working" && a.StageName == sd.Key && a.IdlookupValue == 1920).Sum(b => b.TimeValue);
                                                            TimeSpan DownloadTime = TimeSpan.FromHours(Convert.ToDouble(TotolDownloadTime));
                                                            if (DownloadTime > TimeSpan.Zero)
                                                            {
                                                                dr1["Download"] = DownloadTime;
                                                            }
                                                            double TotolTransferTime = ERMCommon.Instance.Emp_Productiontime.Where(a => a.TimeType == "Working" && a.StageName == sd.Key && a.IdlookupValue == 1921).Sum(b => b.TimeValue);
                                                            TimeSpan TransferTime = TimeSpan.FromHours(Convert.ToDouble(TotolTransferTime));
                                                            if (TransferTime > TimeSpan.Zero)
                                                            {
                                                                dr1["Transferred"] = TransferTime;
                                                            }
                                                            double Temp_Break = 0;
                                                            try
                                                            {


                                                                foreach (var grbyBreak in sd.Where(b => b.TimeType != "Working").GroupBy(a => a.TimeType).ToList())
                                                                {
                                                                    double t_break = grbyBreak.Sum(b => b.TimeValue);
                                                                    Temp_Break = Temp_Break + t_break;
                                                                    TimeSpan time_break = TimeSpan.FromHours(Convert.ToDouble(t_break)); 

                                                                    var parts = grbyBreak.Select(x =>                 //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                    {
                                                                        TimeSpan ts = TimeSpan.FromHours(x.TimeValue);
                                                                        string timeStr = $"{ts.Hours:D2}:{ts.Minutes:D2}:{ts.Seconds:D2}";
                                                                        return $"{x.Details} ({timeStr})";
                                                                    });

                                                                    string combined = $"{grbyBreak.Key}: {string.Join("; ", parts)}";


                                                                    #region [GEOS2-6914][pallavi jadhav][03 02 2025]
                                                                    int idlookup = sd.Where(b => b.TimeType != "Working" && b.TimeType == grbyBreak.Key).Select(b => b.IdlookupValue).FirstOrDefault();
                                                                    if (grbyBreak.Key == "Assign WO")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Designers Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Production Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Commercial Support")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else if (grbyBreak.Key == "Trainer")
                                                                    {
                                                                        dr1[grbyBreak.Key + "_" + idlookup] = Convert.ToString(time_break);
                                                                    }
                                                                    else
                                                                    {
                                                                        //start[GEOS2-9197][pallavi jadhav][2025-09-02]
                                                                        if (MeetingtypeId.Contains(idlookup))
                                                                        {
                                                                            if (dr1["Meeting"] != DBNull.Value)
                                                                            {
                                                                                TimeSpan meetingTime = TimeSpan.Parse(dr1["Meeting"].ToString());
                                                                                dr1["Meeting"] = Convert.ToString(time_break + meetingTime);
                                                                            }
                                                                            else
                                                                            {
                                                                                dr1["Meeting"] = Convert.ToString(time_break);
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            if (MaintenanceId.Contains(idlookup))
                                                                            {
                                                                                if (dr1["Maintenance"] != DBNull.Value)
                                                                                {
                                                                                    TimeSpan MaintenanceTime = TimeSpan.Parse(dr1["Maintenance"].ToString());
                                                                                    dr1["Maintenance"] = Convert.ToString(time_break + MaintenanceTime);
                                                                                }
                                                                                else
                                                                                {
                                                                                    dr1["Maintenance"] = Convert.ToString(time_break);
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                dr1[grbyBreak.Key] = Convert.ToString(time_break);
                                                                            }
                                                                        }
                                                                        //end[GEOS2-9197][pallavi jadhav][2025-09-02] 
                                                                    }
                                                                    #endregion


                                                                    #region //[pallavi jadhav][13 01 2025][GEOS2-6716] 
                                                                    if (grbyBreak.FirstOrDefault().IdlookupValue != null)
                                                                    {
                                                                        int TempDetail = Convert.ToInt32(grbyBreak.FirstOrDefault().IdlookupValue);
                                                                        if (ERMCommon.Instance.DetailsList_IDLookup != null)
                                                                        {
                                                                            if (ERMCommon.Instance.DetailsList_IDLookup.Contains(TempDetail))
                                                                            {
                                                                                if (grbyBreak.FirstOrDefault().Details != null)
                                                                                {
                                                                                    string TempComment = Convert.ToString(grbyBreak.FirstOrDefault().Details);

                                                                                    //start[GEOS2-9197][pallavi jadhav][2025-09-02]
                                                                                    string meetingtime = time_break.ToString(@"hh\:mm\:ss");
                                                                                    if (MeetingtypeId.Contains(idlookup))
                                                                                    {
                                                                                        if (dr1["Details_1725"] != DBNull.Value)
                                                                                        {
                                                                                            string MeetingTimeDetail = dr1["Details_1725"].ToString();
                                                                                           // dr1["Details_1725"] = Convert.ToString(MeetingTimeDetail + "\n" + grbyBreak.Key + ":" + TempComment + "(" + meetingtime + ")");
                                                                                            dr1["Details_1725"] = Convert.ToString(MeetingTimeDetail + "\n" + combined+ ")"); //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                                        }
                                                                                        else
                                                                                        {

                                                                                           // dr1["Details_1725"] = Convert.ToString(grbyBreak.Key + ":" + TempComment + "(" + meetingtime + ")");
                                                                                            dr1["Details_1725"] = Convert.ToString(combined); //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                                        }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        if (MaintenanceId.Contains(idlookup))
                                                                                        {
                                                                                            if (dr1["Details_1724"] != DBNull.Value)
                                                                                            {
                                                                                                string MaintenanceTimeDetail = dr1["Details_1724"].ToString();
                                                                                                // dr1["Details_1725"] = Convert.ToString(MeetingTimeDetail + "\n" + grbyBreak.Key + ":" + TempComment + "(" + meetingtime + ")");
                                                                                                dr1["Details_1724"] = Convert.ToString(MaintenanceTimeDetail + "\n" + combined + ")"); //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                                            }
                                                                                            else
                                                                                            {

                                                                                                // dr1["Details_1725"] = Convert.ToString(grbyBreak.Key + ":" + TempComment + "(" + meetingtime + ")");
                                                                                                dr1["Details_1724"] = Convert.ToString(combined); //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                                            }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            dr1["Details_" + TempDetail] = TempComment;
                                                                                        }
                                                                                    }
                                                                                    //end[GEOS2-9197][pallavi jadhav][2025-09-02] 
                                                                                }

                                                                            }
                                                                            else
                                                                            {
                                                                                if (MeetingtypeId.Contains(idlookup))
                                                                                {
                                                                                    string TempComment = Convert.ToString(grbyBreak.FirstOrDefault().Details);
                                                                                    string meetingtime = time_break.ToString(@"hh\:mm\:ss");
                                                                                    if (dr1["Details_1725"] != DBNull.Value)
                                                                                    {
                                                                                        string MeetingTimeDetail = dr1["Details_1725"].ToString();
                                                                                        dr1["Details_1725"] = Convert.ToString(MeetingTimeDetail + "\n" + combined); //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                                    }
                                                                                    else
                                                                                    {

                                                                                        dr1["Details_1725"] = Convert.ToString(combined); //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                                    }
                                                                                }

                                                                                if (MaintenanceId.Contains(idlookup))
                                                                                {
                                                                                    string TempComment = Convert.ToString(grbyBreak.FirstOrDefault().Details);
                                                                                    string Maintenancetime = time_break.ToString(@"hh\:mm\:ss");
                                                                                    if (dr1["Details_1724"] != DBNull.Value)
                                                                                    {
                                                                                        string MaintenanceTimeDetail = dr1["Details_1724"].ToString();
                                                                                        dr1["Details_1724"] = Convert.ToString(MaintenanceTimeDetail + "\n" + combined); //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                                    }
                                                                                    else
                                                                                    {

                                                                                        dr1["Details_1724"] = Convert.ToString(combined); //[pallavi.jadhav][GEOS2-9197][17 09 2025]
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                    #endregion

                                                                }
                                                            }
                                                            catch (Exception ex)
                                                            {

                                                            }
                                                            dr1["DateHTMLColor"] = HtmlColor;


                                                            dr1["Plant"] = Convert.ToString(plantdata.Key);
                                                            dr1["Week"] = Convert.ToString(Week);
                                                            dr1["Date"] = Convert.ToString(itemDate.Date);
                                                            dr1["Employee"] = Convert.ToString(employee_MainDetail.EmployeeName);
                                                            dr1["Stage"] = Convert.ToString(sd.Key);
                                                            dr1["Total_Shift"] = Convert.ToString(TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds)));
                                                            //dr1["Total_Logged"] = Convert.ToString(TotalLoggedTime.Add(-TimeSpan.FromMilliseconds(TotalLoggedTime.Milliseconds)));
                                                            TimeSpan T_loggedTime = TimeSpan.FromHours(Convert.ToDouble(Temp_Break + TotolWorkingTime));
                                                            dr1["Total_Logged"] = Convert.ToString(T_loggedTime.Add(-TimeSpan.FromMilliseconds(T_loggedTime.Milliseconds)));
                                                            if (IsAllDayLeave == false && Isholidays == false)
                                                            {
                                                                ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr1);
                                                            }

                                                        }
                                                    }
                                                    #region [GEOS2-7641][gulab lakade][27 03 2025] 
                                                    else
                                                    {
                                                        bool exists = ERM_ProductionTimelineExistingEmP.Any(a => a.AttendanceStartDate.HasValue && MinAtt_Date.HasValue && a.AttendanceStartDate.Value.Date == MinAtt_Date.Value.Date && a.IdEmployee == employee_MainDetail.IdEmployee);

                                                        if (!exists)
                                                        {
                                                            DataRow dr1 = ERMCommon.Instance.DataTableForProductionTimeLine.NewRow();

                                                            if (TempPlantId.Count() == 0)
                                                            {
                                                                dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendanceWithoutLeave);
                                                            }
                                                            else
                                                            {
                                                                double Total1 = TotalAttendanceWithoutLeave;
                                                                TimeSpan TimespanTotalAttendance = TimeSpan.FromHours(Convert.ToDouble(Total1));
                                                                dr1["Total_Attendance"] = Convert.ToString(TimespanTotalAttendance);
                                                            }
                                                            dr1["DateHTMLColor"] = HtmlColor;
                                                            dr1["Plant"] = Convert.ToString(plantdata.Key);
                                                            dr1["Week"] = Convert.ToString(Week);
                                                            dr1["Date"] = Convert.ToString(itemDate.Date);
                                                            dr1["Employee"] = Convert.ToString(employee_MainDetail.EmployeeName);
                                                            dr1["Stage"] = Convert.ToString(stagedata.Key);
                                                            dr1["Total_Shift"] = Convert.ToString(TimespanTotalWithoutBreak.Add(-TimeSpan.FromMilliseconds(TimespanTotalWithoutBreak.Milliseconds)));
                                                            if (IsAllDayLeave == false && Isholidays == false)
                                                            {
                                                                ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr1);
                                                            }

                                                        }
                                                    }
                                                    #endregion
                                                    #endregion
                                                    #endregion
                                                    //ERMCommon.Instance.DataTableForProductionTimeLine.Rows.Add(dr);
                                                    #endregion
                                                    #region RND
                                                    Grid GaugeControlGrid = new Grid();
                                                    GaugeControlGrid.ShowGridLines = false;
                                                    //GaugeControlGrid.ShowGridLines = true;
                                                    #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                    if (EmpIsNightShift == 1 || ((MinAtt_Date != null && MaxAtt_Date != null) && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date))
                                                    {
                                                        //linearGauge.Margin = new Thickness(-12, 32, -50, 0);
                                                        //linearGauge_night.Margin = new Thickness(-55, 32, -15, 0);
                                                        //linearGauge.Margin = new Thickness(20, 32, -45, 0);
                                                        //linearGauge_night.Margin = new Thickness(-35, 32, -40, 0);
                                                        int HoursByTotalHours_night = 0;
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        if (shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        {
                                                            linearGauge.Margin = new Thickness(20, 32, 0, 0);
                                                            //linearGauge_night.Margin = new Thickness(-35, 32, -40, 0);
                                                            var c = new ColumnDefinition();
                                                            //c.Width = new GridLength(1370, GridUnitType.Pixel);
                                                            c.Width = new GridLength(1, GridUnitType.Auto);
                                                            GaugeControlGrid.ColumnDefinitions.Add(c);
                                                        }
                                                        else
                                                        {
                                                            #endregion
                                                            //HoursByTotalHours_night = (int)(1370 / TotalHours_Night);
                                                            //int Column_0 = (int)(HoursByTotalHours_night * TotalHours_24);
                                                            //int Column_1 = (int)(HoursByTotalHours_night * TotalHours_0);
                                                            //int widthValue = 1370 - (Column_0 + Column_1);
                                                            //Column_1 = Column_1 + widthValue;
                                                            //if (Column_0 > Column_1)
                                                            //{
                                                            //    Column_0 = Column_0;
                                                            //}
                                                            //else
                                                            //    if (Column_0 < Column_1)
                                                            //{
                                                            //    Column_1 = Column_1;
                                                            //}
                                                            //int NightLinearWidth = (int)(1370 / TotalHours_0);
                                                            linearGauge.Margin = new Thickness(20, 32, -42, 0);
                                                            linearGauge_night.Margin = new Thickness(-42, 32, 0, 0);
                                                            #region ColumnDefinition
                                                            for (var empcolumn = 0; empcolumn < 2; empcolumn++)
                                                            {

                                                                var c = new ColumnDefinition();
                                                                //if (empcolumn == 0)
                                                                //{
                                                                //    c.Width = new GridLength(Column_0, GridUnitType.Pixel);
                                                                //}
                                                                //else if (empcolumn == 1)
                                                                //{
                                                                //    c.Width = new GridLength(Column_1, GridUnitType.Pixel);//GridLength.Auto;

                                                                //}
                                                                if (empcolumn == 0)
                                                                {
                                                                    c.Width = new GridLength(1, GridUnitType.Auto);
                                                                }
                                                                else if (empcolumn == 1)
                                                                {
                                                                    c.Width = new GridLength(1, GridUnitType.Auto);//GridLength.Auto;

                                                                }

                                                                GaugeControlGrid.ColumnDefinitions.Add(c);
                                                            }

                                                            #endregion
                                                        }//[GEOS2-7755][gulab lakade][08 04 2025]
                                                    }
                                                    else
                                                    {
                                                        linearGauge.Margin = new Thickness(20, 32, 0, 0);
                                                        #region ColumnDefinition
                                                        //linearGauge.Margin = new Thickness(-12, 32, -50, 0);
                                                        //linearGauge_night.Margin = new Thickness(-50, 32, -15, 0);
                                                        for (var empcolumn = 0; empcolumn < 1; empcolumn++)
                                                        {
                                                            var c = new ColumnDefinition();
                                                            if (empcolumn == 0)
                                                            {
                                                                //c.Width = new GridLength(1370, GridUnitType.Pixel);
                                                                c.Width = new GridLength(1, GridUnitType.Auto);
                                                            }
                                                            GaugeControlGrid.ColumnDefinitions.Add(c);
                                                        }

                                                        #endregion
                                                    }

                                                    #endregion
                                                    //Stagegrid column creation

                                                    //Plantgrid row creation
                                                    #region RowDefinition 
                                                    for (var emprow = 0; emprow < 1; emprow++)
                                                    {
                                                        var r = new RowDefinition();
                                                        r.Height = GridLength.Auto;//new GridLength(40, GridUnitType.Pixel);
                                                        GaugeControlGrid.RowDefinitions.Add(r);
                                                    }
                                                    //var first = linearnightScale.ShowMajorTickmarks.CompareTo(0);
                                                    #region start[GEOS2-5515][gulab lakade][28 03 2024]
                                                    if (EmpIsNightShift == 1 || ((MinAtt_Date != null && MaxAtt_Date != null) && MinAtt_Date.Value.Date < MaxAtt_Date.Value.Date))
                                                    {

                                                        //Grid.SetRow(linearGauge, 0);
                                                        //Grid.SetColumn(linearGauge, 0);
                                                        //Grid.SetRow(linearGauge_night, 0);
                                                        //Grid.SetColumn(linearGauge_night, 1);
                                                        //GaugeControlGrid.Children.Add(linearGauge);
                                                        //GaugeControlGrid.Children.Add(linearGauge_night);
                                                        #region [GEOS2-7755][gulab lakade][08 04 2025]
                                                        if (EmpIsNightShift == 1 && shiftStartDate.Value.Date == shiftEndDate.Value.Date)
                                                        {
                                                            Grid.SetRow(linearGauge, 0);
                                                            Grid.SetColumn(linearGauge, 0);
                                                            GaugeControlGrid.Children.Add(linearGauge);
                                                        }
                                                        else
                                                        {
                                                            Grid.SetRow(linearGauge, 0);
                                                            Grid.SetColumn(linearGauge, 0);
                                                            Grid.SetRow(linearGauge_night, 0);
                                                            Grid.SetColumn(linearGauge_night, 1);
                                                            GaugeControlGrid.Children.Add(linearGauge);
                                                            GaugeControlGrid.Children.Add(linearGauge_night);
                                                        }
                                                        #endregion
                                                    }
                                                    else
                                                    {
                                                        Grid.SetRow(linearGauge, 0);
                                                        Grid.SetColumn(linearGauge, 0);
                                                        //Grid.SetRow(linearGauge_night, 0);
                                                        //Grid.SetColumn(linearGauge_night, 1);
                                                        GaugeControlGrid.Children.Add(linearGauge);
                                                        //GaugeControlGrid.Children.Add(linearGauge_night);
                                                    }
                                                    #endregion

                                                    #endregion

                                                    #endregion

                                                    #endregion

                                                    Grid.SetRow(ImageGrid, empcount);
                                                    Grid.SetColumn(ImageGrid, 0);

                                                    //Grid.SetRow(empEndTime, empcount);
                                                    //Grid.SetColumn(empEndTime, 2);

                                                    //Grid.SetRow(linearGauge, empcount);
                                                    //Grid.SetColumn(linearGauge, 2);
                                                    Grid.SetRow(GaugeControlGrid, empcount);
                                                    Grid.SetColumn(GaugeControlGrid, 2);
                                                    //EmpGrid.Children.Add(empName);
                                                    EmpGrid.Children.Add(ImageGrid);
                                                    //EmpGrid.Children.Add(empEndTime);
                                                    // EmpGrid.Children.Add(linearGauge);
                                                    EmpGrid.Children.Add(GaugeControlGrid);
                                                    // EmpGrid.ShowGridLines = true;
                                                    #region aiwhariya Total 
                                                    Grid.SetRow(TotalGrid, empcount);
                                                    Grid.SetColumn(TotalGrid, 3);
                                                    EmpGrid.Children.Add(TotalGrid);
                                                    Grid.SetRow(TitleGrid, empcount);
                                                    Grid.SetColumn(TitleGrid, 1);
                                                    EmpGrid.Children.Add(TitleGrid);
                                                    EMPGridCount = EMPGridCount + 1;
                                                    EmpGrid.Loaded += EMPLoad;
                                                    #endregion

                                                    //ERM_ProductionTimelineExistingEmP.Add(employee);//[GEOS2-9220][gulab lakade][12 08 2025] temp comment
                                                    empcount++;
                                                    //}

                                                }//[GEOS2-7641][gulab lakade][27 03 2025]

                                            }

                                            #endregion

                                            if (empcount > 0)//[GEOS2-7641][gulab lakade][27 03 2025]
                                            {
                                                Grid.SetRow(StageName, 0);
                                                Grid.SetColumn(StageName, 0);
                                                Border border = new Border()
                                                {
                                                    BorderThickness = new Thickness()
                                                    {
                                                        Bottom = 1,
                                                        Left = 1,
                                                        Right = 1,
                                                        Top = 1
                                                    },
                                                    //BorderBrush = new SolidColorBrush(Colors.Black) //[GEOS2-5129]
                                                };
                                                //Start [GEOS2-5129]
                                                if (ApplicationThemeHelper.ApplicationThemeName.ToString() == "BlackAndBlue")
                                                {
                                                    border.BorderBrush = new SolidColorBrush(Colors.White);
                                                }
                                                else
                                                {
                                                    border.BorderBrush = new SolidColorBrush(Colors.Black);
                                                }
                                                // end [GEOS2-5129]
                                                //var border = new Border();
                                                Grid.SetRow(border, 1);
                                                Grid.SetColumn(border, 0);
                                                Grid.SetRow(EmpGrid, 3);
                                                Grid.SetColumn(EmpGrid, 0);

                                                stageTempGrid.Children.Add(StageName);
                                                stageTempGrid.Children.Add(border);
                                                stageTempGrid.Children.Add(EmpGrid);

                                                Grid.SetRow(stageTempGrid, StageRow);
                                                Grid.SetColumn(stageTempGrid, 0);

                                                StageGrid.Children.Add(stageTempGrid);
                                                //StageGrid.Loaded += LoadFroAllGrid;
                                                StageRow++;
                                            }//[GEOS2-7641][gulab lakade][27 03 2025]
                                        }



                                        #endregion
                                        if (StageRow > 0)//[GEOS2-7641][gulab lakade][27 03 2025]
                                        {
                                            Grid.SetRow(PlantName, 0);
                                            Grid.SetColumn(PlantName, 0);
                                            Grid.SetRow(DateLabel, 0);
                                            Grid.SetColumn(DateLabel, 1);
                                            Grid.SetRow(TooltipImage, 0);
                                            Grid.SetColumn(TooltipImage, 2);
                                            Grid.SetRow(StageGrid, 1);
                                            //Grid.SetColumn(StageGrid, 0);
                                            Grid.SetColumnSpan(StageGrid, 4);
                                            PlantTempGrid.Children.Add(PlantName);
                                            PlantTempGrid.Children.Add(DateLabel);
                                            PlantTempGrid.Children.Add(TooltipImage);
                                            PlantTempGrid.Children.Add(StageGrid);

                                            Grid.SetRow(PlantTempGrid, DateRow);
                                            Grid.SetColumn(PlantTempGrid, 0);
                                            DateGrid.Children.Add(PlantTempGrid);
                                            // DateGrid.Loaded += LoadFroAllGrid;


                                            #endregion
                                            DateRow++;
                                        }//[GEOS2-7641][gulab lakade][27 03 2025]
                                    }
                                }
                            }

                            Grid.SetRow(DateGrid, Plantrow);
                            Grid.SetColumn(DateGrid, 0);
                            PlantGrid.Children.Add(DateGrid);
                            //PlantGrid.Loaded += LoadFroAllGrid;
                            #endregion
                            Plantrow++;
                        }

                        Grid.SetRow(PlantGrid, 1);
                        Grid.SetColumn(PlantGrid, 0);
                        MainGrid.Children.Add(PlantGrid);

                        #endregion


                    }

                    #endregion
                }
                else
                {
                    ERMCommon.Instance.ERM_EmployeeDetailsList = new List<ERM_EmployeeDetails>();
                    ERMCommon.Instance.SelectedEmployee = new List<object>();
                }


                //#endregion
                if (EMPGridCount == 0)
                {
                    if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }
                }
                //if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }
                GeosApplication.Instance.Logger.Log("Method AllCustomData() executed successfully", category: Category.Info, priority: Priority.Low);
            }

            catch (Exception ex)
            {
                if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }
                GeosApplication.Instance.Logger.Log("Get an error in AllCustomData()", category: Category.Exception, priority: Priority.Low);
            }


            //if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }

        }
        private async void EMPLoad(object sender, RoutedEventArgs e)
        {
            //if(CheckempgridCount == false)
            //{
            //    int TotalEMPGrid = EMPGridCount;
            //    CheckempgridCount = true;
            //}
            EMPGridCount--;
            if (EMPGridCount == 0)
            {

                await Task.Delay(800);
                if (DXSplashScreen.IsActive) { DXSplashScreen.Close(); }
                GeosApplication.Instance.SplashScreenMessage = "";
            }
            // if (!DXSplashScreen.IsActive) { DXSplashScreen.Show<SplashScreenView>(); }

        }
        #endregion
        #endregion
        //private void ComboBox_EditValueChanged(object sender, EditValueChangedEventArgs e)
        //{
        //    ProductionTimelineViewModel ProductionTimelineViewModel = new ProductionTimelineViewModel();
        //    ProductionTimelineViewModel.SelectedItems(sender);
        //}


        private void LinearGauge_MouseMove(object sender, MouseEventArgs e)
        {
            try
            {

                LinearGaugeControl linearGauge = (LinearGaugeControl)sender;
                System.Windows.Input.MouseEventArgs t = (System.Windows.Input.MouseEventArgs)e;
                LinearScaleRange range = linearGauge.CalcHitInfo(t.GetPosition(linearGauge))?.Range as LinearScaleRange;
                LinearGaugeHitInfo range1 = linearGauge.CalcHitInfo(t.GetPosition(linearGauge));

                //linearGauge.ToolTip = "test";
                if (range != null)
                {
                    // linearGauge.ToolTip = range.EndValue.Value;

                    double StartValue = range.StartValue.Value;
                    double EndValue = range.EndValue.Value;
                    string Name = linearGauge.Name.Remove(0, 1);
                    List<Int32> Temp = Name.Split('D').Select(Int32.Parse).ToList();
                    if (Temp.Count() > 0)
                    {
                        Int32 IDEmployee = Temp[0];
                        int Day = Temp[1];
                        int Month = Temp[2];
                        Int32 IdStage = Temp[3];
                        var tooltipData = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartValue && x.ToolTipsEndTime == EndValue && x.IdEmployee == IDEmployee && x.IdStage == IdStage && (int)x.AttendanceStartDate.Value.DayOfWeek == Day && x.AttendanceStartDate.Value.Month == Month).FirstOrDefault();


                        if (tooltipData != null)
                        {
                            TimeSpan TimespanStartValue = TimeSpan.FromHours(Convert.ToDouble(StartValue));
                            TimeSpan TimespanEndValue = TimeSpan.FromHours(Convert.ToDouble(EndValue));
                            TimespanStartValue = TimespanStartValue.Add(-TimeSpan.FromMilliseconds(TimespanStartValue.Milliseconds));
                            TimespanEndValue = TimespanEndValue.Add(-TimeSpan.FromMilliseconds(TimespanEndValue.Milliseconds));
                            string BarType = tooltipData.BarTypeName;
                            switch (BarType)
                            {
                                case "pauseType":
                                    //linearGauge.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    //[GEOS2-6554][gulab lakade][02 12 2024]
                                    if (tooltipData.PauseTypeId == 1813)
                                    {
                                        string SwitchPlaceName = Convert.ToString(tooltipData.SW_Place_Name);
                                        if (string.IsNullOrEmpty(SwitchPlaceName))
                                        {
                                            SwitchPlaceName = "ND";
                                        }
                                        linearGauge.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + " '" + SwitchPlaceName + "'" + "\r\n Comments: '" + tooltipData.NonOtComment + "'" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    }
                                    else
                                    {

                                        linearGauge.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                        #region[pallavi jadhav][GEOS2-9419][2025 10 30]

                                        if (ERMCommon.Instance.MaintenanceList.Values.Contains(tooltipData.ToolTipsType))
                                        {
                                            string MaintenanceType = tooltipData.ToolTipsType;

                                            tooltipData.ToolTipsType = "Scheduled Maintenance";
                                            linearGauge.ToolTip = " Pause Type: " + "Maintenance" + "\r\n Maintenance Type: " + "(" + tooltipData.NonOtComment + ")" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                        }
                                        else if (ERMCommon.Instance.MaintenanceList.Values.Contains(tooltipData.ToolTipsType))
                                        {
                                            linearGauge.ToolTip = " Pause Type: " + "Maintenance" + "\r\n Maintenance Type: " + "(" + tooltipData.NonOtComment + ")" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;

                                        }
                                        #endregion
                                    }

                                    //end[GEOS2-6554][gulab lakade][02 12 2024]
                                    break;
                                case "LoggedType":
                                    //linearGauge.ToolTip = " Logged Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    linearGauge.ToolTip = " Logged Type: " + tooltipData.ToolTipsType + "\r\n Logged Station: " + tooltipData.LogStationStage + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;//[GEOS2-6554][gulab lakade][02 12 2024]
                                    break;
                                case "LeaveType":
                                    linearGauge.ToolTip = " Leave Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    break;
                                case "AttendanceType":
                                    linearGauge.ToolTip = " Attendance Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    break;
                                default:
                                    break;
                            }

                        }
                    }
                    else
                    {
                        linearGauge.ToolTip = "";
                    }
                    //linearGauge.Scales.FirstOrDefault().ToolTip = test.SelectedCityList.FirstOrDefault(i => i.PopulationFrom == range.StartValue.Value && i.PopulationTo == range.EndValue.Value).CityName;
                    //linearGauge.ToolTip = test.SelectedCityList.FirstOrDefault(i => i.PopulationFrom == range.StartValue.Value && i.PopulationTo == range.EndValue.Value).CityName;
                }
                else
                        if (range1.RangeBar != null)
                {
                    double StartValue = range1.RangeBar.Value;
                    double EndValue = range1.RangeBar.AnchorValue;
                    string Name = linearGauge.Name.Remove(0, 1);
                    List<Int32> Temp = Name.Split('D').Select(Int32.Parse).ToList();
                    if (Temp.Count() > 0)
                    {
                        Int32 IDEmployee = Temp[0];
                        int Day = Temp[1];
                        int Month = Temp[2];
                        Int32 IdStage = Temp[3];
                        var tooltipData = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartValue && x.ToolTipsEndTime == EndValue && x.IdEmployee == IDEmployee && x.IdStage == IdStage && (int)x.AttendanceStartDate.Value.DayOfWeek == Day && x.AttendanceStartDate.Value.Month == Month).FirstOrDefault();
                        //var tooltipData = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartValue && x.ToolTipsEndTime == EndValue && x.IdEmployee == IDEmployee && x.IdStage == IdStage && (x.AttendanceStartDate == null ? x..Value.DayOfWeek == Day : x.AttendanceStartDate.Value.Date == StartDate.Date)).FirstOrDefault();


                        if (tooltipData != null)
                        {
                            string BarType = tooltipData.BarTypeName;
                            TimeSpan TimespanStartValue = TimeSpan.FromHours(Convert.ToDouble(StartValue));
                            TimeSpan TimespanEndValue = TimeSpan.FromHours(Convert.ToDouble(EndValue));
                            TimespanStartValue = TimespanStartValue.Add(-TimeSpan.FromMilliseconds(TimespanStartValue.Milliseconds));
                            TimespanEndValue = TimespanEndValue.Add(-TimeSpan.FromMilliseconds(TimespanEndValue.Milliseconds));
                            switch (BarType)
                            {
                                case "pauseType":
                                    //linearGauge.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    //[GEOS2-6554][gulab lakade][02 12 2024]
                                    if (tooltipData.PauseTypeId == 1813)
                                    {
                                        string SwitchPlaceName = Convert.ToString(tooltipData.SW_Place_Name);
                                        if (string.IsNullOrEmpty(SwitchPlaceName))
                                        {
                                            SwitchPlaceName = "ND";
                                        }
                                        linearGauge.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + " '" + SwitchPlaceName + "'" + "\r\n Comments: '" + tooltipData.NonOtComment + "'" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    }
                                    else
                                    {
                                        linearGauge.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                        #region[pallavi jadhav][GEOS2-9419][2025 10 30]
                                        if (ERMCommon.Instance.MaintenanceList.Values.Contains(tooltipData.ToolTipsType))
                                        {
                                            string MaintenanceType = tooltipData.ToolTipsType;

                                            tooltipData.ToolTipsType = "Scheduled Maintenance";
                                            linearGauge.ToolTip = " Pause Type: " + "Maintenance" + "\r\n Maintenance Type: " + "(" + tooltipData.NonOtComment + ")" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                        }
                                        else if (ERMCommon.Instance.MaintenanceList.Values.Contains(tooltipData.ToolTipsType))
                                        {
                                            linearGauge.ToolTip = " Pause Type: " + "Maintenance" + "\r\n Maintenance Type: " + "(" + tooltipData.NonOtComment + ")" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;

                                        }
                                        #endregion
                                    }

                                    //end[GEOS2-6554][gulab lakade][02 12 2024]
                                    break;
                                case "LoggedType":
                                    //linearGauge.ToolTip = " Logged Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    linearGauge.ToolTip = " Logged Type: " + tooltipData.ToolTipsType + "\r\n Logged Station: " + tooltipData.LogStationStage + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;//[GEOS2-6554][gulab lakade][02 12 2024]
                                    break;
                                case "LeaveType":
                                    linearGauge.ToolTip = " Leave Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    break;
                                case "AttendanceType":
                                    linearGauge.ToolTip = " Attendance Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    break;
                                default:
                                    break;
                            }

                        }
                    }
                    else
                    {
                        linearGauge.ToolTip = "";
                    }
                }
                else
                {
                    linearGauge.ToolTip = "";

                }

            }
            catch (Exception ex)
            {
                GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
            }
        }

        private void linearGauge_night_MouseMove(object sender, MouseEventArgs e)
        {
            try
            {

                LinearGaugeControl linearGauge_night = (LinearGaugeControl)sender;
                System.Windows.Input.MouseEventArgs t = (System.Windows.Input.MouseEventArgs)e;
                LinearScaleRange range = linearGauge_night.CalcHitInfo(t.GetPosition(linearGauge_night))?.Range as LinearScaleRange;
                LinearGaugeHitInfo range1 = linearGauge_night.CalcHitInfo(t.GetPosition(linearGauge_night));

                //linearGauge.ToolTip = "test";
                if (range != null)
                {
                    // linearGauge.ToolTip = range.EndValue.Value;

                    double StartValue = range.StartValue.Value;
                    double EndValue = range.EndValue.Value;
                    string Name = linearGauge_night.Name.Remove(0, 1);
                    List<Int32> Temp = Name.Split('D').Select(Int32.Parse).ToList();
                    if (Temp.Count() > 0)
                    {
                        Int32 IDEmployee = Temp[0];
                        int Day = Temp[1];
                        int Month = Temp[2];
                        Int32 IdStage = Temp[3];
                        var tooltipData = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartValue && x.ToolTipsEndTime == EndValue && x.IdEmployee == IDEmployee && x.IdStage == IdStage && (int)x.AttendanceStartDate.Value.DayOfWeek == Day && x.AttendanceStartDate.Value.Month == Month).FirstOrDefault();


                        if (tooltipData != null)
                        {
                            TimeSpan TimespanStartValue = TimeSpan.FromHours(Convert.ToDouble(StartValue));
                            TimeSpan TimespanEndValue = TimeSpan.FromHours(Convert.ToDouble(EndValue));
                            TimespanStartValue = TimespanStartValue.Add(-TimeSpan.FromMilliseconds(TimespanStartValue.Milliseconds));
                            TimespanEndValue = TimespanEndValue.Add(-TimeSpan.FromMilliseconds(TimespanEndValue.Milliseconds));
                            string BarType = tooltipData.BarTypeName;
                            switch (BarType)
                            {
                                case "pauseType":
                                    //linearGauge_night.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    //[GEOS2-6554][gulab lakade][02 12 2024]
                                    if (tooltipData.PauseTypeId == 1813)
                                    {
                                        string SwitchPlaceName = Convert.ToString(tooltipData.SW_Place_Name);
                                        if (string.IsNullOrEmpty(SwitchPlaceName))
                                        {
                                            SwitchPlaceName = "ND";
                                        }
                                        linearGauge_night.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + " '" + SwitchPlaceName + "'" + "\r\n Comments: '" + tooltipData.NonOtComment + "'" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    }
                                    else
                                    {
                                        linearGauge_night.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                        #region[pallavi jadhav][GEOS2-9419][2025 10 30]
                                        if (ERMCommon.Instance.MaintenanceList.Values.Contains(tooltipData.ToolTipsType))
                                        {
                                            string MaintenanceType = tooltipData.ToolTipsType;

                                            tooltipData.ToolTipsType = "Scheduled Maintenance";
                                            linearGauge_night.ToolTip = " Pause Type: " + "Maintenance" + "\r\n Maintenance Type: " + "(" + tooltipData.NonOtComment + ")" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                        }
                                        else if (ERMCommon.Instance.MaintenanceList.Values.Contains(tooltipData.ToolTipsType))
                                        {
                                            linearGauge_night.ToolTip = " Pause Type: " + "Maintenance" + "\r\n Maintenance Type: " + "(" + tooltipData.NonOtComment + ")" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;

                                        }
                                        #endregion
                                    }

                                    //end[GEOS2-6554][gulab lakade][02 12 2024]
                                    break;
                                case "LoggedType":
                                    //linearGauge_night.ToolTip = " Logged Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    linearGauge_night.ToolTip = " Logged Type: " + tooltipData.ToolTipsType + "\r\n Logged Station: " + tooltipData.LogStationStage + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;//[GEOS2-6554][gulab lakade][02 12 2024]
                                    break;
                                case "LeaveType":
                                    linearGauge_night.ToolTip = " Leave Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    break;
                                case "AttendanceType":
                                    linearGauge_night.ToolTip = " Attendance Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    break;
                                default:
                                    break;
                            }

                        }
                    }
                    else
                    {
                        linearGauge_night.ToolTip = "";
                    }
                    //linearGauge.Scales.FirstOrDefault().ToolTip = test.SelectedCityList.FirstOrDefault(i => i.PopulationFrom == range.StartValue.Value && i.PopulationTo == range.EndValue.Value).CityName;
                    //linearGauge.ToolTip = test.SelectedCityList.FirstOrDefault(i => i.PopulationFrom == range.StartValue.Value && i.PopulationTo == range.EndValue.Value).CityName;
                }
                else
                        if (range1.RangeBar != null)
                {
                    double StartValue = range1.RangeBar.Value;
                    double EndValue = range1.RangeBar.AnchorValue;
                    string Name = linearGauge_night.Name.Remove(0, 1);
                    List<Int32> Temp = Name.Split('D').Select(Int32.Parse).ToList();
                    if (Temp.Count() > 0)
                    {
                        Int32 IDEmployee = Temp[0];
                        int Day = Temp[1];
                        int Month = Temp[2];
                        Int32 IdStage = Temp[3];
                        var tooltipData = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartValue && x.ToolTipsEndTime == EndValue && x.IdEmployee == IDEmployee && x.IdStage == IdStage && (int)x.AttendanceStartDate.Value.DayOfWeek == Day && x.AttendanceStartDate.Value.Month == Month).FirstOrDefault();
                        //var tooltipData = ERMCommon.Instance.ProductionToolTip.Where(x => x.ToolTipsStartTime == StartValue && x.ToolTipsEndTime == EndValue && x.IdEmployee == IDEmployee && x.IdStage == IdStage && (x.AttendanceStartDate == null ? x..Value.DayOfWeek == Day : x.AttendanceStartDate.Value.Date == StartDate.Date)).FirstOrDefault();


                        if (tooltipData != null)
                        {
                            string BarType = tooltipData.BarTypeName;
                            TimeSpan TimespanStartValue = TimeSpan.FromHours(Convert.ToDouble(StartValue));
                            TimeSpan TimespanEndValue = TimeSpan.FromHours(Convert.ToDouble(EndValue));
                            TimespanStartValue = TimespanStartValue.Add(-TimeSpan.FromMilliseconds(TimespanStartValue.Milliseconds));
                            TimespanEndValue = TimespanEndValue.Add(-TimeSpan.FromMilliseconds(TimespanEndValue.Milliseconds));
                            switch (BarType)
                            {
                                case "pauseType":
                                    //linearGauge_night.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    //[GEOS2-6554][gulab lakade][02 12 2024]
                                    if (tooltipData.PauseTypeId == 1813)
                                    {
                                        string SwitchPlaceName = Convert.ToString(tooltipData.SW_Place_Name);
                                        if (string.IsNullOrEmpty(SwitchPlaceName))
                                        {
                                            SwitchPlaceName = "ND";
                                        }
                                        linearGauge_night.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + " '" + SwitchPlaceName + "'" + "\r\n Comments: '" + tooltipData.NonOtComment + "'" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    }
                                    else
                                    {
                                        linearGauge_night.ToolTip = " Pause Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                        #region[pallavi jadhav][GEOS2-9419][2025 10 30]
                                        if (ERMCommon.Instance.MaintenanceList.Values.Contains(tooltipData.ToolTipsType))
                                        {
                                            string MaintenanceType = tooltipData.ToolTipsType;

                                            tooltipData.ToolTipsType = "Scheduled Maintenance";
                                            linearGauge_night.ToolTip = " Pause Type: " + "Maintenance" + "\r\n Maintenance Type: " + "(" + tooltipData.NonOtComment + ")" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                        }
                                        else if (ERMCommon.Instance.MaintenanceList.Values.Contains(tooltipData.ToolTipsType))
                                        {
                                            linearGauge_night.ToolTip = " Pause Type: " + "Maintenance" + "\r\n Maintenance Type: " + "(" + tooltipData.NonOtComment + ")" + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;

                                        }
                                        #endregion
                                    }

                                    //end[GEOS2-6554][gulab lakade][02 12 2024]
                                    break;
                                case "LoggedType":
                                    //linearGauge_night.ToolTip = " Logged Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    linearGauge_night.ToolTip = " Logged Type: " + tooltipData.ToolTipsType + "\r\n Logged Station: " + tooltipData.LogStationStage + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;//[GEOS2-6554][gulab lakade][02 12 2024]
                                    break;
                                case "LeaveType":
                                    linearGauge_night.ToolTip = " Leave Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    break;
                                case "AttendanceType":
                                    linearGauge_night.ToolTip = " Attendance Type: " + tooltipData.ToolTipsType + "\r\n Start Time: " + TimespanStartValue + "\r\n End Time: " + TimespanEndValue;
                                    break;
                                default:
                                    break;
                            }

                        }
                    }
                    else
                    {
                        linearGauge_night.ToolTip = "";
                    }
                }
                else
                {
                    linearGauge_night.ToolTip = "";

                }

            }
            catch (Exception ex)
            {
                GeosApplication.Instance.Logger.Log("Get an error in LinearGauge_MouseMove()", category: Category.Exception, priority: Priority.Low);
            }
        }
        #endregion

        private void ProdControl_Loaded(object sender, RoutedEventArgs e)
        {

            //if(ERMCommon.Instance.DtTimetracking!=null)
            //{
            //    ProdControl.ItemsSource = ERMCommon.Instance.DtTimetracking;
            //}
        }

        //private void UserControl_Unloaded(object sender, RoutedEventArgs e)
        //{
        //    try
        //    {
        //        //ERMCommon.Instance.Grid = ((Emdep.Geos.Modules.ERM.Views.ProductionTimelineView)sender).Grid1;
        //        ERMCommon.Instance.Grid = ((Emdep.Geos.Modules.ERM.Views.ProductionTimelineView)sender).EMPMainGrid;
        //        System.Windows.Controls.StackPanel EMPMainGrid = new System.Windows.Controls.StackPanel();
        //        //if (ERMCommon.Instance.Grid != null)
        //        //{
        //        //    //EMPMainGrid = (System.Windows.Controls.Grid)MainGrid.Parent;
        //        //    //EMPMainGrid = (System.Windows.Controls.ScrollViewer)MainGrid.Parent;
        //        //    EMPMainGrid = (System.Windows.Controls.StackPanel)ERMCommon.Instance.Grid.Parent;
        //        //    //MainGrid = new Grid();
        //        //}
        //        if (ERMCommon.Instance.Grid.Children.Count > 0)
        //        {
        //            ERMCommon.Instance.Grid.Children.RemoveAt(0);
        //            ERMCommon.Instance.Grid.Children.Clear();
        //        }


        //    }
        //    catch(Exception ex)
        //    {

        //    }
        //}


    }
}
