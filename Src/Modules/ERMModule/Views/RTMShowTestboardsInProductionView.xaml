<Window x:Class="Emdep.Geos.Modules.ERM.Views.RTMShowTestboardsInProductionView"
       xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"             
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:dxga="http://schemas.devexpress.com/winfx/2008/xaml/gauges"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
             xmlns:dxp="http://schemas.devexpress.com/winfx/2008/xaml/printing"
             xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.ERM.ViewModels"
             xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/charts" 
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
             xmlns:dxsch="http://schemas.devexpress.com/winfx/2008/xaml/scheduler"
             xmlns:Scheduler="clr-namespace:DevExpress.Xpf.Scheduler.UI;assembly=DevExpress.Xpf.Scheduler.v19.2"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxschcore="clr-namespace:DevExpress.XtraScheduler;assembly=DevExpress.XtraScheduler.v19.2.Core"
             xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             xmlns:Interactive="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:Behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:dxci="http://schemas.devexpress.com/winfx/2008/xaml/core/internal"
             xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
             xmlns:dxschint="http://schemas.devexpress.com/winfx/2008/xaml/scheduler/internal"
             xmlns:dxscht="http://schemas.devexpress.com/winfx/2008/xaml/scheduler/themekeys"
             xmlns:Converters="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:ERMApplication="clr-namespace:Emdep.Geos.Modules.ERM.CommonClasses"
             xmlns:Serialization="clr-namespace:DevExpress.Xpf.LayoutControl.Serialization;assembly=DevExpress.Xpf.LayoutControl.v19.2"
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
             xmlns:gif="http://wpfanimatedgif.codeplex.com"
            xmlns:local="clr-namespace:Emdep.Geos.Modules.ERM.Views"
        
             mc:Ignorable="d" 
              WindowState="Maximized" 
             >
   
    <Window.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding CloseButtonCommand}"/>
    </Window.InputBindings>

    <Window.Resources>
        <UIHelper:ColumnTemplateSelector x:Key="ColumnTemplateSelector"/>
        <Converters:CellBackroundColorProducedModuleConvertor x:Key="CellBackroundColorProducedModuleConvertor"/>
        <Style x:Key="HeaderHeight" TargetType="dxg:GridColumnHeader">
            <Setter Property="Height" Value="160"/>
        </Style>
        <Style x:Key="ColumnStyle" TargetType="dxg:GridColumn">
            <Setter Property="FilterPopupMode" Value="CheckedList"/>

            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=IsVertical}" Value="True">
                    <Setter Property="HeaderTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <ContentControl Content="{Binding}">
                                    <ContentControl.LayoutTransform>
                                        <RotateTransform Angle="-90"/>
                                    </ContentControl.LayoutTransform>
                                </ContentControl>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="FilterEditorHeaderTemplate">
                        <Setter.Value>
                            <DataTemplate>
                                <ContentControl Content="{Binding}">
                                    <ContentControl.LayoutTransform>
                                        <RotateTransform Angle="0"/>
                                    </ContentControl.LayoutTransform>
                                </ContentControl>
                            </DataTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="PrintColumnHeaderStyle" TargetType="dxe:TextEdit"  BasedOn="{StaticResource {dxgt:TableViewThemeKey ResourceKey=DefaultPrintCellStyle}}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=Column.DataContext.IsVertical}" Value="True">
                    <Setter Property="dxp:ExportSettings.TargetType" Value="Image"/>
                    <Setter Property="Height" Value="150"/>
                    <Setter Property="DisplayTemplate">
                        <Setter.Value>
                            <ControlTemplate>
                                <dxe:TextEdit Name="PART_Editor" HorizontalAlignment="Left" Text="{Binding Path=Column.DataContext.FieldName}" IsPrintingMode="True" >
                                    <dxe:TextEdit.LayoutTransform >
                                        <RotateTransform Angle="-90"/>
                                    </dxe:TextEdit.LayoutTransform>
                                </dxe:TextEdit>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <DataTemplate x:Key="DeliveryWeekColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                Header="{Binding HeaderText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               AllowCellMerge="{Binding AllowCellMerge}" GroupIndex="0"
                                
                                AllowBestFit="true" 
                     FixedWidth="{Binding FixedWidth}"  AllowEditing="False" 
                                AllowAutoFilter="False" 
                                Visible="True"
                                HeaderToolTip="{Binding FieldName}"
                                AllowMoving="True" 
                                ShowInColumnChooser="True" 
                                ReadOnly="True"  FilterPopupMode="Default" >
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="OTCodeColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                Header="{Binding HeaderText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               AllowCellMerge="{Binding AllowCellMerge}" 
                                
                                AllowBestFit="true" 
                     FixedWidth="{Binding FixedWidth}"  AllowEditing="False" 
                                AllowAutoFilter="False" 
                                Visible="False"
                                HeaderToolTip="{Binding FieldName}"
                                AllowMoving="True" 
                                ShowInColumnChooser="True" 
                                ReadOnly="True"  FilterPopupMode="Default" >
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>




        <DataTemplate x:Key="ModulesColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                Header="{Binding HeaderText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               AllowCellMerge="{Binding AllowCellMerge}" 
                                
                                AllowBestFit="true" 
                     FixedWidth="{Binding FixedWidth}"  AllowEditing="False" 
                                AllowAutoFilter="False" 
                                Visible="True"
                                HeaderToolTip="{Binding FieldName}"
                                AllowMoving="True" 
                                ShowInColumnChooser="True" 
                                ReadOnly="True"  FilterPopupMode="Default" >
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>



        <DataTemplate x:Key="ProducedModulesColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                Header="{Binding HeaderText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               AllowCellMerge="{Binding AllowCellMerge}"                     
                                AllowBestFit="true" 
                     FixedWidth="{Binding FixedWidth}"  AllowEditing="False" 
                                AllowAutoFilter="False" 
                                Visible="True"
                                HeaderToolTip="{Binding FieldName}"
                                AllowMoving="True" 
                                ShowInColumnChooser="True" 
                                ReadOnly="True"  FilterPopupMode="Default" >

                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>
                            <Border HorizontalAlignment="Stretch">
                                <TextBlock Text="{Binding Data.ProducedModules}" HorizontalAlignment="Right"/>
                                <Border.Background>
                                    <MultiBinding Converter="{StaticResource CellBackroundColorProducedModuleConvertor}">
                                        <Binding Path="View.DataContext.GeosAppSettingList"/>
                                        <Binding Path="RowData.Row"/>
                                    </MultiBinding>
                                </Border.Background>
                            </Border>

                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>

                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

       
        <DataTemplate x:Key="ArrayOfferOptionProductionColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding Path=FieldName}" Tag="{Binding}"  Header="{Binding HeaderText}" HeaderStyle="{StaticResource HeaderHeight}" HeaderToolTip="{Binding HeaderText}" AllowCellMerge="{Binding AllowCellMerge}"  FixedWidth="{Binding FixedWidth}"  AllowBestFit="true" Width="{Binding  Width}" HorizontalHeaderContentAlignment="Center"  Visible="{Binding Visible}" AllowMoving="False" ShowInColumnChooser="False" AllowSorting="False" 
                                ReadOnly="True" BestFitArea="All">
                    <dxg:GridColumn.EditSettings>
                        <dxe:TextEditSettings Mask="D" MaskType="Numeric" HorizontalContentAlignment="Right" MaskUseAsDisplayFormat="true" ValidateOnTextInput="True" ValidateOnEnterKeyPressed="True" AllowNullInput="False">
                        </dxe:TextEditSettings>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>
        
        <DataTemplate x:Key="InProductionColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                Header="{Binding HeaderText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               AllowCellMerge="{Binding AllowCellMerge}" 
                                
                                AllowBestFit="true" 
                     FixedWidth="{Binding FixedWidth}"  AllowEditing="False" 
                                AllowAutoFilter="False" 
                                Visible="True"
                                HeaderToolTip="{Binding FieldName}"
                                AllowMoving="True" 
                                ShowInColumnChooser="True" 
                                ReadOnly="True"  FilterPopupMode="Default" >
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>





        <DataTemplate x:Key="RowLabelsColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                Header="{Binding HeaderText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               AllowCellMerge="{Binding AllowCellMerge}" 
                                
                                AllowBestFit="true" 
                     FixedWidth="{Binding FixedWidth}"  AllowEditing="False" 
                                AllowAutoFilter="False" 
                                Visible="True"
                                HeaderToolTip="{Binding FieldName}"
                                AllowMoving="True" 
                                ShowInColumnChooser="True" 
                                ReadOnly="True"  FilterPopupMode="Default" >
                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>

                            <Border Background="{Binding Data.DeliveryDateHtmlColor}" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                                <dxe:TextEdit Name="PART_Editor" Margin="0 0 0 0"  IsReadOnly="True"  MaskShowPlaceHolders="False" ValidateOnTextInput="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  ShowBorder="False"
                                                                                            Foreground="Black">
                                </dxe:TextEdit>
                            </Border>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <DataTemplate x:Key="GrandTotalColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                Header="{Binding HeaderText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               AllowCellMerge="{Binding AllowCellMerge}" 
                                
                                AllowBestFit="true" 
                     FixedWidth="{Binding FixedWidth}"  AllowEditing="False" 
                                AllowAutoFilter="False" 
                                Visible="True"
                                HeaderToolTip="{Binding FieldName}"
                                AllowMoving="True" 
                                ShowInColumnChooser="True" 
                                ReadOnly="True"  FilterPopupMode="Default" >
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>

        <!--<DataTemplate x:Key="DeliveryDateColumnTemplate">
            <ContentControl>
                <dxg:GridColumn FieldName="{Binding FieldName,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                Header="{Binding HeaderText,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                               AllowCellMerge="{Binding AllowCellMerge}" 
                                
                                AllowBestFit="true" 
                     FixedWidth="{Binding FixedWidth}"  AllowEditing="False" 
                                AllowAutoFilter="False" 
                                Visible="True"
                                HeaderToolTip="{Binding FieldName}"
                                AllowMoving="True" 
                                ShowInColumnChooser="True" 
                                ReadOnly="True"  FilterPopupMode="Default" >

                    <dxg:GridColumn.HeaderTemplate>
                        <DataTemplate>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="{Binding StringFormat=d,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" HorizontalAlignment="Stretch" VerticalAlignment="Top"  />
                            </StackPanel>

                        </DataTemplate>
                    </dxg:GridColumn.HeaderTemplate>

                    <dxg:GridColumn.CellTemplate>
                        <DataTemplate>

                            <Border Background="{Binding Data.DeliveryDateHtmlColor}" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                                <dxe:TextEdit Name="PART_Editor" Margin="0 0 0 0" MaskType="DateTime" IsReadOnly="True"  MaskShowPlaceHolders="False" ValidateOnTextInput="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"  ShowBorder="False"
                                                                                          Mask="d"  MaskUseAsDisplayFormat="True"  Foreground="Black">
                                </dxe:TextEdit>
                            </Border>
                        </DataTemplate>
                    </dxg:GridColumn.CellTemplate>
                    <dxg:GridColumn.EditSettings>
                        <dxe:DateEditSettings  MaskType="DateTime" Mask="d" MaskUseAsDisplayFormat="True" ></dxe:DateEditSettings>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
            </ContentControl>
        </DataTemplate>-->

        <DataTemplate x:Key="SummaryTemplate">
            <ContentControl>
                <dxg:GridSummaryItem FieldName="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).FieldName, RelativeSource={RelativeSource Self}}"
                                     SummaryType="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).Type, RelativeSource={RelativeSource Self}}"
                                     DisplayFormat="{Binding Path=(dxci:DependencyObjectExtensions.DataContext).DisplayFormat, RelativeSource={RelativeSource Self}}" 
                                    
                                     />
            </ContentControl>
        </DataTemplate>

        
    </Window.Resources>

    <Grid Background="{DynamicResource AppointmentHeaderBackground}" ShowGridLines="True" >

        <dxlc:LayoutGroup Header="{Binding TestBoardInProduction}" Name="layoutGroup15" View="GroupBox"
                                   dxlc:LayoutControl.AllowHorizontalSizing="True" Margin="5,0,5,5"
                                   IsCollapsible="False" IsCollapsed="False" Orientation="Vertical" >
            <dxlc:LayoutGroup.HeaderTemplate>
                <DataTemplate>
                    <Grid ShowGridLines="True">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />

                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            
                        </Grid.RowDefinitions>
                        <TextBlock Text="{Binding}" Grid.Column="0" HorizontalAlignment="Left" VerticalAlignment="Stretch" />
                    </Grid>
                </DataTemplate>
            </dxlc:LayoutGroup.HeaderTemplate>
            <dxlc:LayoutGroup.GroupBoxStyle>
                <Style TargetType="dxlc:GroupBox">
                    <Setter Property="BorderThickness" Value="2" />

                </Style>
            </dxlc:LayoutGroup.GroupBoxStyle>

            <!--<ScrollViewer  VerticalScrollBarVisibility="Auto"  HorizontalScrollBarVisibility="Disabled">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                      
                    </Grid.RowDefinitions>-->

                    <dxg:GridControl x:Name="ProductionGridControlDashboard" DockPanel.Dock="Top" Grid.Row="0" Grid.Column="0" 
                  ItemsSource="{Binding DataTableForGridLayoutProductionInTime,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  FocusManager.IsFocusScope="True"
                  SelectedItem="{Binding SelectedObject, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                  ColumnsSource="{Binding ColumnsProductionsInTime,UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Stretch"
                  AutoGenerateColumns="None" ScrollViewer.HorizontalScrollBarVisibility="Visible"
                  ColumnGeneratorStyle="{StaticResource ColumnStyle}"
                  ColumnGeneratorTemplateSelector="{StaticResource ColumnTemplateSelector}"
                  AllowInitiallyFocusedRow="False"     
                  SelectionMode="Cell"
                  ImplyNullLikeEmptyStringWhenFiltering="True"
                  TotalSummaryGeneratorTemplate="{StaticResource SummaryTemplate}"
                  GroupSummaryGeneratorTemplate="{StaticResource SummaryTemplate}"
                  TotalSummarySource="{Binding TotalSummaryTestboardsInProduction}"
                  GroupSummarySource="{Binding GroupSummaryTestboardsInProduction}"
                                                >
                        <dxg:GridControl.TotalSummary>

                        </dxg:GridControl.TotalSummary>

                        <!--PrintColumnHeaderStyle="{StaticResource PrintColumnHeaderStyle}"-->
                        <!--ShowGroupedColumns="True"-->
                        <dxg:GridControl.View>
                            <dxg:TableView x:Name="ProductionTableView"
                                                     GroupSummaryDisplayMode="AlignByColumns"
                                          FixedLineWidth="10"
                                          
                                         AllowGrouping="True"
                                         ShowSearchPanelMode="Always"
                                     NavigationStyle="Cell"
                                     ShowFixedTotalSummary="False"
                                     ShowTotalSummary="True"
                                     ShowHorizontalLines="True"
                                     AllowPerPixelScrolling="True"
                                     ShowGroupPanel="False"
                                     ShowColumnHeaders="True"
                                     ShowVerticalLines="True"
                                     ShowIndicator="True"
                                     AutoWidth="True"
                                     HorizontalScrollbarVisibility="Visible"
                                     VerticalScrollbarVisibility="Visible"
                                     HorizontalContentAlignment="Center"
                                      FilterEditorShowOperandTypeIcon="True"
                                     RowMinHeight="20"
                                     AllowSorting="False"
                                     AllowScrollHeaders="False"
                                     AllowEditing="True"
                                     AllowColumnMoving="True"
                                     AutoMoveRowFocus="False"
                                     AllowScrollAnimation="True"
                                     AllowBestFit="True"
                                     AllowResizing="True"
                                     AllowColumnFiltering="True"
                                     AllowConditionalFormattingMenu="True"
                                     SearchPanelHorizontalAlignment="Stretch"
                                    UseLegacyFilterEditor="True"
                                  
                                         UIHelper:MultipleCellEditHelperSAMWorkPlanning.IsEnabled="True">

                                <dxmvvm:Interaction.Triggers>
                                    <dxmvvm:EventToCommand EventName="Loaded" Command="{Binding GridActionProductionLoadCommand}" CommandParameter="{Binding ElementName=ProductionGridControlDashboard}" />
                                </dxmvvm:Interaction.Triggers>

                                <dxg:TableView.TotalSummaryContentStyle>
                                    <Style  TargetType="dx:DataContentPresenter">
                                        <Setter Property="TextBlock.FontWeight" Value="Bold"/>
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </dxg:TableView.TotalSummaryContentStyle>
                                <!--<dxg:TableView.GroupRowStyle>
                                    <Style TargetType="{x:Type dxg:GroupRowControl}" >
                                <Setter Property="Background" Value="{Binding GroupColor,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  />

                                    </Style>

                                </dxg:TableView.GroupRowStyle>-->
                        <dxg:TableView.GroupRowStyle>

                            <Style TargetType="{x:Type dxg:GroupRowControl}" BasedOn="{StaticResource BaseUniversalStyle}">
                                <Setter Property="Background" Value="DimGray"/>

                                <Style.Triggers>
                                    <MultiDataTrigger>
                                        <MultiDataTrigger.Conditions>


                                            <Condition Binding="{Binding Row.GroupColor}" Value="true" />

                                        </MultiDataTrigger.Conditions>

                                        <Setter Property="Background" Value="LightBlue"/>

                                    </MultiDataTrigger>

                                </Style.Triggers>

                            </Style>

                        </dxg:TableView.GroupRowStyle>
                        <dxg:TableView.Resources>
                                    <DataTemplate x:Key="PageHeader">
                                <Grid Width="{Binding UsablePageWidth}" ShowGridLines="True">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="50" />
                                                <ColumnDefinition Width="130" />
                                            </Grid.ColumnDefinitions>
                                            <dxe:TextEdit Text=" " Width="{Binding UsablePageWidth}" Grid.ColumnSpan="3" IsPrintingMode="True" Background="#333E5E"   HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" Style="{DynamicResource TextEdit20Style}" FontWeight="Bold" Height="50" />
                                            <dxe:TextEdit Text="Leads/Offers Report" IsPrintingMode="True"     HorizontalAlignment="Stretch"
                                        VerticalAlignment="Stretch" Padding="12" Foreground="#FFFFFFFF" Style="{DynamicResource TextEdit20Style}" FontWeight="Bold"/>
                                            <Image Source="/Emdep.Geos.Modules.Crm;component/Assets/Images/GeosReportLogo.png" Height="50" Width="80"  dxp:ExportSettings.TargetType="Image" Grid.Column="2" />
                                        </Grid>
                                    </DataTemplate>

                                    <DataTemplate x:Key="PageFooter">
                                        <dxe:TextEdit HorizontalContentAlignment="Center"
                                      Width="{Binding Path=UsablePageWidth, Mode=OneWay}"
                                      dxp:ExportSettings.TargetType="PageNumber"
                                      dxp:PageNumberExportSettings.Kind="NumberOfTotal"
                                      dxp:PageNumberExportSettings.Format="Page {0} of {1}" >
                                        </dxe:TextEdit>
                                    </DataTemplate>
                                </dxg:TableView.Resources>

                            </dxg:TableView>
                        </dxg:GridControl.View>
                    </dxg:GridControl>

                <!--</Grid>
            </ScrollViewer>-->
            <!--<TextBlock   Text="{DynamicResource DeliveryVisualManagement12WeeksPlanFooter}"  Grid.Row="2" Grid.Column="0" 
                               HorizontalAlignment="Left"  VerticalAlignment="Center" Style="{StaticResource TextBlock14Style}"/>-->
        </dxlc:LayoutGroup>
        
    </Grid>
</Window>
