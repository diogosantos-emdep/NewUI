<UserControl x:Class="Emdep.Geos.Modules.Warehouse.Views.SalesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
              xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
              xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/charts" 
              xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
             xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
              xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
             xmlns:WarehouseCommon ="clr-namespace:Emdep.Geos.Modules.Warehouse"
             xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
             xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
             xmlns:local="clr-namespace:Emdep.Geos.Modules.Warehouse.Views"
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300"
             Style="{DynamicResource UserControlStyle}">
    
    
    <Grid Margin="0,5,0,0" >
       
        <Grid.RowDefinitions>
            <RowDefinition Height="40" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Label Content="{DynamicResource DashBoardSalesViewHeader}" VerticalAlignment="Top" Margin="10,-5,0,0" Style="{DynamicResource LabelTitleStyle}" HorizontalAlignment="Left" Grid.Column="0" Grid.Row="0" />

        <DockPanel Grid.Column="2" Grid.Row="0" HorizontalAlignment="Stretch" Margin="0,0,5,0" Height="45">
            <Grid HorizontalAlignment="Right" Width="Auto" Height="40" Grid.Column="1" Grid.ColumnSpan="2" Grid.Row="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="40" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70*" />
                    <ColumnDefinition Width="150" />
                    <ColumnDefinition Width="30" />

                    <ColumnDefinition Width="70*" />
                    <ColumnDefinition Width="50*" />
                    <ColumnDefinition Width="10" />

                    <ColumnDefinition Width="50*" />
                    <ColumnDefinition Width="30" />
                    <ColumnDefinition Width="80*" />
                    <ColumnDefinition Width="80*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <DockPanel Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" Height="30" >
                    <Image Style="{DynamicResource WarehouseImageStyle}" Width="24" Height="24" Margin="7,0,3,7" />
                    <TextBlock Text="{DynamicResource Warehouse}"  FontWeight="Bold" Margin="5,2,5,9" VerticalAlignment="Bottom" />
                </DockPanel>

                <dxe:ComboBoxEdit Name="CbeWareHouse" Style="{DynamicResource ComboBoxEditStyle}" Grid.Column="1" Width="140" Height="22"
                                       Margin="5,5,5,10" VerticalAlignment="Bottom" IsTextEditable="False"
                                      ItemsSource ="{Binding Source={x:Static WarehouseCommon:WarehouseCommon.Instance}, Path=WarehouseList ,UpdateSourceTrigger=PropertyChanged , Mode=TwoWay}"
                                    SelectedItem="{Binding Source={x:Static WarehouseCommon:WarehouseCommon.Instance}, Path=Selectedwarehouse,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay}"
                                      DisplayMember="Name" ShowError="False" ShowErrorToolTip="False"  >

                    <dxmvvm:Interaction.Triggers>
                        <dxmvvm:EventToCommand EventName="EditValueChanged"
                                               Command="{Binding WarehouseChangeCommand}" CommandParameter="{Binding ElementName=CbeWareHouse,Path=SelectedItem}"
                                              />
                    </dxmvvm:Interaction.Triggers>
                </dxe:ComboBoxEdit>

                <!-- Period -->
                <!--Calender Icon-->
                <dxwui:AppBar x:Name="Appbar" HideMode="AlwaysVisible" Background="Transparent" Grid.Column="3"
                                  IsSticky="True" HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch"
                                  IsOpen="True" IsExitButtonEnabled="False" >

                    <dxwui:AppBarButton x:Name="appbarbutton" ToolTip="{DynamicResource PeriodSelect}"
                                        GlyphHeight="24" GlyphWidth="24" AllowGlyphTheming="False"
                                        Style="{DynamicResource CalendarImageGlyphStyle}"
                                        GlyphStretch="Fill"
                                        Width="50" IsEllipseEnabled="False" Margin="0 -20 0 0">
                        <dxwui:AppBarButton.Flyout>
                            <dxwui:MenuFlyout ShowIndicator="True" x:Name="MenuLayout">
                                <dxwui:MenuFlyoutItem>
                                    <Grid Width="Auto" Height="Auto">
                                        <DockPanel>
                                            <StackPanel Orientation="Vertical" x:Name="PeriodCategories">
                                                <!--This Year-->
                                                <Button x:Uid="ThisYear" Content="{DynamicResource PeriodThisYear}" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="110"
                                                            Command="{Binding PeriodThisYearCommand}">
                                                </Button>

                                                <!--Last Year-->
                                                <Button x:Uid="LastYear" Content="{DynamicResource PeriodLastYear}" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                            Height="30" Width="110"
                                                            Command="{Binding PeriodLastYearCommand}">
                                                </Button>

                                                <!--Last 12 months-->
                                                <Button x:Uid="Last12Months" Content="{DynamicResource PeriodLast12Months}" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                            Height="30" Width="110"
                                                            Command="{Binding PeriodLast12MonthsCommand}">
                                                </Button>

                                                <!--Custom Range-->
                                                <Button Content="{DynamicResource PeriodCustomRange}" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="110"
                                                            Command="{Binding PeriodCustomRangeCommand}">
                                                </Button>

                                                <StackPanel Orientation="Horizontal" Margin="0,50,0,0">
                                                    <Button Content="Apply" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="60" Background="Yellow" 
                                                            Command="{Binding ApplyCommand}" CommandParameter="{Binding ElementName=MenuLayout}">
                                                    </Button>
                                                    <Button Content="Cancel" HorizontalAlignment="Center" VerticalAlignment="Center"
                                                            Height="30" Width="60" 
                                                            Command="{Binding CancelCommand}" CommandParameter="{Binding ElementName=MenuLayout}">
                                                    </Button>
                                                </StackPanel>
                                            </StackPanel>

                                            <StackPanel Visibility="{Binding DataContext.IsCalendarVisible, RelativeSource={RelativeSource AncestorType=UserControl}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" Orientation="Horizontal">
                                                <StackPanel Orientation="Vertical">
                                                    <dxe:TextEdit Text="{Binding DataContext.StartDate, RelativeSource={RelativeSource AncestorType=UserControl}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" 
                                                  Height="30" TextWrapping="Wrap" Mask="dd/MM/yyyy"  
                                                  MaskType="DateTimeAdvancingCaret"  
                                                  MaskUseAsDisplayFormat="True"
                                                  HorizontalAlignment="Stretch" IsReadOnly="True"  Margin="2,2,2,2">
                                                    </dxe:TextEdit>
                                                    <!--Calendar-->
                                                    <dxe:DateEditCalendar DateTime="{Binding DataContext.StartDate, RelativeSource={RelativeSource AncestorType=UserControl}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                                      VerticalAlignment="Center"
                                                                      ShowToday="False"
                                                                      ShowClearButton="False"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Vertical">
                                                    <dxe:TextEdit Text="{Binding DataContext.EndDate, RelativeSource={RelativeSource AncestorType=UserControl}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" 
                                                  Height="30" TextWrapping="Wrap" Mask="dd/MM/yyyy"  
                                                  MaskType="DateTimeAdvancingCaret"  
                                                  MaskUseAsDisplayFormat="True"
                                                  HorizontalAlignment="Stretch" IsReadOnly="True"  Margin="2,2,2,2">
                                                    </dxe:TextEdit>
                                                    <!--Calendar-->
                                                    <dxe:DateEditCalendar DateTime="{Binding DataContext.EndDate, RelativeSource={RelativeSource AncestorType=UserControl}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                                                      VerticalAlignment="Center"
                                                                      ShowToday="False"
                                                                      ShowClearButton="False"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </DockPanel>

                                    </Grid>
                                </dxwui:MenuFlyoutItem>
                            </dxwui:MenuFlyout>
                        </dxwui:AppBarButton.Flyout>
                    </dxwui:AppBarButton>
                </dxwui:AppBar>
                <TextBlock Text="{Binding FromDate,StringFormat=d,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.Column="4" Margin="3,0,0,0" />
                <TextBlock Text=" - " HorizontalAlignment="Center" VerticalAlignment="Center" Grid.Column="5" FontWeight="Bold" />
                <TextBlock Text="{Binding ToDate,StringFormat=d,ConverterCulture={x:Static sysglb:CultureInfo.CurrentCulture}}" HorizontalAlignment="Left" VerticalAlignment="Center" Grid.Column="6" />

                <!--refresh button-->
                <Button Content=" " Height="38" Width="38" Grid.Column="10" Command="{Binding RefreshDashboard2ViewCommand}" HorizontalAlignment="Right" Margin="0,-7,0,0">
                    <Button.ToolTip>
                        <TextBlock Text="{DynamicResource ButtonRefresh}" />
                    </Button.ToolTip>
                    <Button.ContentTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Image Style="{ DynamicResource RefreshButtonImageStyle}" Grid.Column="0" Height="24" Width="24" Margin="-10" />
                            </Grid>
                        </DataTemplate>
                    </Button.ContentTemplate>
                </Button>
            </Grid>
        </DockPanel>

        <dxlc:LayoutControl VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0" Padding="0" Grid.Row="1" 
                            Grid.Column="0" Grid.ColumnSpan="3" Orientation="Vertical" Style="{DynamicResource LayoutControlStyle}"
                            DragScrolling="False">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <dxlc:LayoutGroup Grid.Row="0">
                <dxlc:LayoutGroup Width="350">
                <dxlc:LayoutGroup Background="{Binding Color}" Grid.Row="0" UseLayoutRounding="True" x:Name="SalesStatus" VerticalAlignment="Top" Header="SALES STATUS" View="GroupBox" Orientation="Horizontal" IsCollapsible="False" HorizontalAlignment="Stretch">
                    <TextBlock Text="{DynamicResource Dashboard2_WON}" Style="{StaticResource TextBlock20Style}" VerticalAlignment="Top" HorizontalAlignment="Left"/>
                    <dxe:TextEdit 
                                IsReadOnly="True"
                                Mask="c"
                                MaskCulture="{Binding Path=CurrentCultureCurrencySymbol_warehouse, Source={x:Static GeosApplication:GeosApplication.Instance}}"
                                MaskType="Numeric"
                                MaskUseAsDisplayFormat="True"
                                FontSize="30"
                                ShowBorder="False"
                                HorizontalAlignment="Right"
                                IsPrintingMode="True"
                                Text="{Binding WonAmount}" />
                </dxlc:LayoutGroup>
                    </dxlc:LayoutGroup>
                </dxlc:LayoutGroup>
           
            <dxlc:LayoutGroup Grid.Row="1">
                <dxlc:LayoutGroup Orientation="Horizontal" >
                    <dxlc:LayoutGroup Header="{DynamicResource Dashboard2_SALESSTATUSBYCUSTOMER}" Margin="0" Padding="0" VerticalAlignment="Center" View="GroupBox" Orientation="Vertical" HorizontalAlignment="Stretch">
                        <dxc:ChartControl x:Name="ChartSalesStatusByCustomer"
                                  DataSource="{Binding GraphDataTableCustomer, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                  VerticalAlignment="Stretch" Height="585" CrosshairEnabled="True" BorderThickness="1" ScrollViewer.VerticalScrollBarVisibility="Auto">
                            <dxc:ChartControl.Legend>
                                <dxc:Legend HorizontalPosition="RightOutside" />
                            </dxc:ChartControl.Legend>
                            <dxmvvm:Interaction.Triggers>
                                <dxmvvm:EventToCommand EventName="Loaded" Command="{Binding ChartLoadCustomerCommand}" CommandParameter="{Binding ElementName=ChartSalesStatusByCustomer}" />
                                <dxmvvm:EventToCommand EventName="CustomDrawCrosshair" Command="{Binding ChartDashboardSaleCustomDrawCrosshairCommand}" PassEventArgsToCommand="True" />
                            </dxmvvm:Interaction.Triggers>
                        </dxc:ChartControl>
                    </dxlc:LayoutGroup>
                    <dxlc:LayoutGroup Header="{DynamicResource Dashboard2_SALESSTATUSBYMONTH}" Margin="0" Padding="0" VerticalAlignment="Center" View="GroupBox" Orientation="Vertical" HorizontalAlignment="Stretch">
                        <dxc:ChartControl x:Name="ChartSalesStatusByMonths" 
                                  DataSource="{Binding GraphDataTable, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                  VerticalAlignment="Stretch" Height="585" CrosshairEnabled="True" BorderThickness="1" ScrollViewer.VerticalScrollBarVisibility="Auto">
                            <dxc:ChartControl.Legend>
                                <dxc:Legend HorizontalPosition="RightOutside" />
                            </dxc:ChartControl.Legend>
                            <dxmvvm:Interaction.Triggers>
                                <dxmvvm:EventToCommand EventName="Loaded" Command="{Binding ChartLoadCommand}" CommandParameter="{Binding ElementName=ChartSalesStatusByMonths}" />
                            </dxmvvm:Interaction.Triggers>
                        </dxc:ChartControl>
                    </dxlc:LayoutGroup>
                </dxlc:LayoutGroup>
            </dxlc:LayoutGroup>

            </Grid>
        </dxlc:LayoutControl>

    </Grid>
</UserControl>
