<dxwui:WinUIDialogWindow x:Class="Emdep.Geos.Modules.Crm.Views.SearchOpportunityOrOfferView"
                         xmlns:ViewModels="clr-namespace:Emdep.Geos.Modules.Crm.ViewModels"
                            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                            xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                            xmlns:local="clr-namespace:Emdep.Geos.Modules.Crm.Views"
                            xmlns:dxwui="http://schemas.devexpress.com/winfx/2008/xaml/windowsui"
                            xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol" 
                            xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
                            xmlns:UIHelper="clr-namespace:Emdep.Geos.UI.Helper;assembly=Emdep.Geos.UI.Helper"
                            xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
                            xmlns:Validation="clr-namespace:Emdep.Geos.UI.Validations;assembly=Emdep.Geos.UI.Validations"
                            xmlns:GeosApplication="clr-namespace:Emdep.Geos.UI.Common;assembly=Emdep.Geos.UI.Common"
                            xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
                            xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
                            xmlns:sysglb="clr-namespace:System.Globalization;assembly=mscorlib"
                            xmlns:UIConverter="clr-namespace:Emdep.Geos.UI.Converters;assembly=Emdep.Geos.UI.Converters"
                            xmlns:dxefl="clr-namespace:DevExpress.Xpf.Editors.Flyout.Native;assembly=DevExpress.Xpf.Core.v18.2"
                         xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                         xmlns:behaviors="clr-namespace:Emdep.Geos.UI.Behaviors;assembly=Emdep.Geos.UI.Common"
                            mc:Ignorable="d" 
                            Title="{DynamicResource SearchOpportunityOrOrderViewHeader}"
                            TitleStyle="{DynamicResource WinUIDialogWindowTitleStyle}"
                            Style="{DynamicResource WinUIDialogWindowStyle}"
                            Height="760" Width="870">

    <dxwui:WinUIDialogWindow.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding EscapeButtonCommand}"/>
    </dxwui:WinUIDialogWindow.InputBindings>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="30"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="30"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="30"/>
        </Grid.RowDefinitions>

        <!--Site-->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Row="0" Grid.Column="1"  Text="{DynamicResource SiteTimelineGrid}" Style="{StaticResource TextBlock14Style}" VerticalAlignment="Center"  />
            <dxe:ComboBoxEdit Style="{DynamicResource ComboBoxEditStyle}" Grid.Column="3"
                                      ItemsSource="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=PlantOwnerUsersList}" Margin="5,0,5,0"
                                      DisplayMember="ShortName"
                                      EditValue="{Binding Source={x:Static GeosApplication:GeosApplication.Instance}, Path=SelectedPlantOwnerUsersList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                <dxe:ComboBoxEdit.StyleSettings>
                    <dxe:CheckedComboBoxStyleSettings />
                </dxe:ComboBoxEdit.StyleSettings>
            </dxe:ComboBoxEdit>
        </Grid>

        
        <!--Code-->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Row="2" Grid.Column="1"  Text="{DynamicResource OrderEditPOCode}" Style="{StaticResource TextBlock14Style}" VerticalAlignment="Center"  />
            <dxe:TextEdit Grid.Row="2" Grid.Column="3" Width="290"
                      Text="{Binding Code,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" VerticalContentAlignment="Center" NullText="{DynamicResource OrderEditPOCode}">
            </dxe:TextEdit>
        </Grid>
        
        
        <!--search button-->
        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="195"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Button Grid.Row="4" Grid.Column="3" 
                    Style="{DynamicResource Button16Style}"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Top"
                    Content="{DynamicResource EditActivitysearch}"
                    Command="{Binding SearchButtonCommand }"
                    Height="30"
                    Width="100">
                <Button.ContentTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="5" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Image Style="{DynamicResource SearchShortcutImageStyle}" Grid.Column="0" Height="24" Width="24" HorizontalAlignment="Left"/>
                            <TextBlock Grid.Column="2"  Text="{DynamicResource EditActivitysearch}" Style="{StaticResource TextBlock14Style}" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Right" />
                        </Grid>
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>

        </Grid>

        <Grid Grid.Row="6">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <dxg:GridControl VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Grid.Row="6"
                             ItemsSource="{Binding DataContext.TimelineGridList,UpdateSourceTrigger=PropertyChanged,Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}" 
                             SelectionMode="Row" 
                             SelectedItem="{Binding DataContext.SelectedTimeline,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay,RelativeSource={RelativeSource AncestorType=dxwui:WinUIDialogWindow}}"  
                             >

                <dxg:GridColumn Header="{DynamicResource OrderEditPOCode}" FieldName="Code" MinWidth="100" Width="120" FilterPopupMode="CheckedList" ReadOnly="True" />
                <dxg:GridColumn Header="{DynamicResource AccountViewGroup}" FieldName="Group" MinWidth="100" Width="*" FilterPopupMode="CheckedList" ReadOnly="True" />
                <dxg:GridColumn Header="{DynamicResource AccountViewPlant}" FieldName="Plant" MinWidth="100" Width="120" FilterPopupMode="CheckedList" ReadOnly="True"/>
                <dxg:GridColumn Header="{DynamicResource SiteTimelineGrid}" FieldName="ActiveSite.SiteAlias" MinWidth="100" Width="120" FilterPopupMode="CheckedList" ReadOnly="True"/>

                <dxg:GridControl.TotalSummary>
                    <dxg:GridSummaryItem x:Name="summary" FieldName="" SummaryType="Count" DisplayFormat="Total Count: {0}" Visible="True"   Alignment="Left"/>
                </dxg:GridControl.TotalSummary>

                <dxmvvm:Interaction.Behaviors>
                    <UIHelper:GridSelectingBehavior />
                </dxmvvm:Interaction.Behaviors>

                <dxg:GridControl.View>
                    <dxg:TableView x:Name="OpportuityOrOfferListTableView"
                               NavigationStyle="Row"
                               AllowHorizontalScrollingVirtualization="True" 
                               RowDetailsVisibilityMode="Visible"
                               ShowHorizontalLines="True"
                               ShowColumnHeaders="True"
                               VerticalScrollbarVisibility="Auto" 
                               HorizontalScrollbarVisibility="Auto"
                               AllowFixedColumnMenu="False"
                               AutoWidth="False"
                               ShowFixedTotalSummary="True"
                               ShowIndicator="False" 
                               AllowColumnFiltering="True"
                                   AllowGrouping="False"
                                   ShowGroupPanel="False"
                               ShowSearchPanelMode="Never"
                                          >
                        <dxmvvm:Interaction.Behaviors>

                            <dxmvvm:EventToCommand Command="{Binding DataContext.EditOpportunityOrOrderCommand, RelativeSource={RelativeSource AncestorType={x:Type dxwui:WinUIDialogWindow}},Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                           EventName="MouseDoubleClick" PassEventArgsToCommand="True"
                                                   CommandParameter="{Binding ElementName=OpportuityOrOfferListTableView}">
                            </dxmvvm:EventToCommand>

                        </dxmvvm:Interaction.Behaviors>
                    </dxg:TableView>

                    
                </dxg:GridControl.View>
                

            </dxg:GridControl>
        </Grid>

        <Grid Grid.Row="8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Grid.Row="8" Grid.Column="1"
                    Style="{DynamicResource Button16Style}"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Content="{DynamicResource CommonCancel}"
                    Command="{Binding CancelButtonCommand }"
                    Height="30"
                    Width="100" />
        </Grid>
    </Grid>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="KeyDown">
            <behaviors:InvokeDelegateCommandAction Command="{Binding CommandTextInput}" CommandParameter="{Binding Path=InvokeParameter, RelativeSource={RelativeSource Self}}"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</dxwui:WinUIDialogWindow>
